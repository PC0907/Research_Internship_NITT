Why WRB O
Did NNP O
Chinese NNP O
Spyware NNP O
Linger NNP O
in IN O
U.S NNP O
. . O

Phones NNS O
? . O

November NNP O
16 CD O
, , O
2016 CD O
In IN O
what WP O
's VBZ O
being VBG O
chalked VBN O
up RP O
as IN O
an DT O
apparent JJ O
mistake NN O
, , O
more JJR O
than IN O
120,000 CD O
Android NNP B-System
phones NNS O
sold VBN O
in IN O
the DT O
U.S. NNP O
were VBD O
shipped VBN O
with IN O
spying VBG O
code NN O
that WDT O
sent VBD O
text NN O
messages NNS O
, , O
call VB O
logs NNS O
and CC O
other JJ O
sensitive JJ O
data NNS O
to TO O
a DT O
server NN O
in IN O
Shanghai NNP O
. . O

The DT O
New NNP B-Organization
York NNP I-Organization
Times NNP I-Organization
reported VBD O
on IN O
Nov. NNP O
15 CD O
that IN O
Kryptowire NNP B-Organization
, , O
a DT O
mobile JJ O
enterprise NN O
security NN O
company NN O
, , O
discovered VBD O
the DT O
code NN O
on IN O
a DT O
lower-end JJ O
smartphone NN O
made VBN O
by IN O
BLU NNP B-Organization
Products NNPS O
of IN O
Doral NNP O
, , O
Fla NNP O
. . O

The DT O
phones NNS O
are VBP O
sold VBN O
at IN O
Best NNP B-Organization
Buy NNP I-Organization
and CC O
Amazon.com NNP B-Organization
, , O
among IN O
other JJ O
retail JJ O
outlets NNS O
. . O

Kryptowire NNP B-Organization
says VBZ O
the DT O
code NN O
, , O
which WDT O
it PRP O
found VBD O
on IN O
a DT O
BLU NNP B-Organization
R1 NNP O
HD NNP O
devices NNS O
, , O
transmitted VBD O
fine-grained JJ O
location NN O
information NN O
and CC O
allowed VBN O
for IN O
the DT O
remote JJ O
installation NN O
of IN O
other JJ O
apps NN O
. . O

Text JJ O
message NN O
and CC O
call VB O
logs NNS O
were VBD O
transmitted VBN O
every DT O
72 CD O
hours NNS O
to TO O
the DT O
Shanghai NNP O
server NN O
, , O
and CC O
once RB O
a DT O
day NN O
for IN O
other JJ O
personally RB O
identifiable JJ O
data NNS O
, , O
the DT O
company NN O
says VBZ O
. . O

It PRP O
turns VBZ O
out RP O
, , O
however RB O
, , O
that IN O
other JJ O
security NN O
researchers NNS O
noticed VBD O
suspicious JJ O
and CC O
faulty JJ O
code NN O
on IN O
BLU NNP B-Organization
devices NNS O
as RB O
early RB O
as IN O
March NNP O
2015 CD O
, , O
and CC O
it PRP O
has VBZ O
taken VBN O
nearly RB O
that RB O
long RB O
to TO O
remove VB O
it PRP O
from IN O
the DT O
company NN O
's POS O
devices NNS O
. . O

The DT O
finding NN O
, , O
in IN O
part NN O
, , O
shows VBZ O
the DT O
risk NN O
that WDT O
can MD O
come VB O
in IN O
opting VBG O
for IN O
less RBR O
expensive JJ O
smartphones NNS O
, , O
whose WP$ O
manufacturers NNS O
may MD O
not RB O
diligently VB O
fix JJ O
security NN B-Vulnerability
vulnerabilities NNS I-Vulnerability
. . O

It PRP O
's VBZ O
also RB O
raising VBG O
eyebrows NNS O
because IN O
of IN O
the DT O
connection NN O
with IN O
China NNP O
, , O
which WDT O
has VBZ O
frequently RB O
sparred VBN O
with IN O
the DT O
U.S. NNP O
over IN O
cyber JJ O
espionage NN O
. . O

BLU NNP B-Organization
Products NNP O
has VBZ O
now RB O
updated VBN O
its PRP$ O
phones NNS O
to TO O
remove VB O
the DT O
spying NN O
code NN O
, , O
which WDT O
most JJS O
likely RB O
would MD O
have VB O
never RB O
been VBN O
detected VBN O
by IN O
regular JJ O
users NNS O
. . O

The DT O
code NN O
never RB O
informed VBD O
phone NN O
users NNS O
that IN O
it PRP O
was VBD O
collecting VBG O
that IN O
data NNS O
, , O
a DT O
behavior JJ O
uniformly NN O
viewed VBN O
by IN O
many JJ O
as IN O
a DT O
serious JJ O
security NN O
concern NN O
. . O

The DT O
developer NN O
of IN O
the DT O
code NN O
, , O
Shanghai NNP B-Organization
Adups NNP I-Organization
Technology NNP I-Organization
Co. NNP I-Organization
, , O
has VBZ O
apologized VBN O
, , O
contending VBG O
that IN O
the DT O
code NN O
was VBD O
intended VBN O
for IN O
another DT O
one CD O
of IN O
its PRP$ O
clients NNS O
who WP O
requested VBD O
better JJR O
blocking NN O
of IN O
junk NN O
text NN O
messages NNS O
and CC O
marketing NN O
calls NNS O
. . O

Vulnerabilities NNS O
Reported VBN O
BLU NNP O
Products NNPS O
, , O
founded VBN O
in IN O
2009 CD O
, , O
makes VBZ O
lower-end JJ O
Android-powered JJ B-System
smartphones NNS O
that WDT O
sell VBP O
for IN O
as RB O
little JJ O
as IN O
$ $ O
50 CD O
on IN O
Amazon NNP B-Organization
. . O

Like IN O
many JJ O
original JJ O
equipment NN O
manufacturers NNS O
, , O
it PRP O
uses VBZ O
software NN O
components NNS O
from IN O
other JJ O
developers NNS O
. . O

The DT O
company NN O
uses VBZ O
a DT O
type NN O
of IN O
software NN O
from IN O
Adups NNP B-Organization
that WDT O
's VBZ O
nicknamed VBN O
FOTA NNP B-System
, , O
short RB O
for IN O
firmware JJ O
over-the-air NN O
. . O

The DT O
software NN O
manages VBZ O
the DT O
delivery NN O
of IN O
firmware NN O
updates VBZ O
over-the-air JJ O
, , O
the DT O
term NN O
used VBN O
for IN O
transmission NN O
via IN O
a DT O
mobile JJ O
network NN O
. . O

Firmware NNP O
is VBZ O
low-level JJ O
code NN O
deep NN O
in IN O
an DT O
operating NN O
system NN O
that WDT O
often RB O
has VBZ O
high JJ O
access NN O
privileges NNS O
, , O
so IN O
it PRP O
's VBZ O
critical JJ O
that IN O
it PRP O
's VBZ O
verified JJ O
and CC O
contains VBZ O
no DT O
software NN O
vulnerabilities NNS O
. . O

Long RB O
before IN O
Kryptowire NNP B-Organization
's POS O
announcement NN O
, , O
Tim NNP O
Strazzere NNP O
, , O
a DT O
mobile JJ O
security NN O
researcher NN O
with IN O
RedNaga NNP B-Organization
Security NNP I-Organization
, , O
contacted VBD O
BLU NNP O
Products NNPS O
in IN O
March NNP O
2015 CD O
after IN O
he PRP O
found VBD O
two CD O
vulnerabilities NNS O
that WDT O
could MD O
be VB O
traced VBN O
to TO O
Adup NNP B-Organization
's POS O
code NN O
. . O

Those DT O
vulnerabilities NNS O
could MD O
have VB O
enabled VBN O
someone NN O
to TO O
gain VB O
broad JJ O
access NN O
to TO O
an DT O
Android NNP B-System
device NN O
. . O

Strazzere NNP O
's POS O
colleague NN O
, , O
Jon NNP O
Sawyer NNP O
, , O
suggested VBD O
on IN O
Twitter NNP B-Organization
that IN O
the DT O
vulnerabilities NNS O
might MD O
have VB O
not RB O
been VBN O
there RB O
by IN O
mistake NN O
, , O
but CC O
rather RB O
included VBD O
as IN O
intentionally RB O
coded VBN O
backdoors NNS O
. . O

He PRP O
posted VBD O
a DT O
tweet NN O
to TO O
The DT O
New NNP B-Organization
York NNP I-Organization
Times NNP I-Organization
report NN O
, , O
sarcastically RB O
writing VBG O
, , O
" VB O
If IN O
only RB O
two CD O
people NNS O
had VBD O
called VBN O
this DT O
company NN O
out RB O
for IN O
their PRP$ O
backdoors NNS O
several JJ O
times NNS O
over IN O
the DT O
last JJ O
few JJ O
years NNS O
. . O

'' '' O
Strazzere NNP O
's POS O
experience NN O
in IN O
trying VBG O
to TO O
contact VB O
both DT O
vendors NNS O
last JJ O
year NN O
is VBZ O
typical JJ O
of IN O
the DT O
frustrations NNS O
frequently RB O
faced VBN O
by IN O
security NN O
researchers NNS O
. . O

" NN O
I PRP O
tried VBD O
reaching VBG O
out RP O
to TO O
Adups NNP B-Organization
and CC O
never RB O
heard VBN O
back RP O
, , O
'' '' O
Strazzere NNP O
tells VBZ O
Information NNP B-Organization
Security NNP I-Organization
Media NNP I-Organization
Group NNP I-Organization
. . O

" NN O
BLU NNP B-Organization
said VBD O
they PRP O
had VBD O
no DT O
security NN O
department NN O
when WRB O
I PRP O
emailed VBD O
them PRP O
. . O

'' '' O
Strazzere NNP O
says VBZ O
he PRP O
also RB O
failed VBD O
to TO O
reach VB O
MediaTek NNP B-Organization
, , O
a DT O
Taiwanese JJ O
fabless NN O
semiconductor NN O
manufacturer NN O
whose WP$ O
chipsets NNS O
that WDT O
powered VBD O
BLU NNP B-Organization
phones NNS O
also RB O
contained VBD O
Adups NNP B-Organization
software NN O
. . O

To TO O
their PRP$ O
credit NN O
, , O
both DT O
Google NNP B-Organization
and CC O
Amazon NNP B-Organization
appear VBP O
to TO O
have VB O
put VBN O
pressure NN O
on IN O
device NN O
manufacturers NNS O
to TO O
fix VB O
their PRP$ O
devices NNS O
when WRB O
flaws NNS O
are VBP O
found VBN O
, , O
Strazzere NNP O
says VBZ O
. . O

For IN O
Google NNP B-Organization
, , O
Android NNP O
security NN O
issues NNS O
- : O
even RB O
if IN O
not RB O
in IN O
the DT O
core NN O
operating NN O
code NN O
- : O
are VBP O
a DT O
reputation NN O
threat NN O
, , O
and CC O
for IN O
Amazon NNP B-Organization
, , O
a DT O
product NN O
quality NN O
issue NN O
. . O

But CC O
devices NNS O
sold VBD O
outside IN O
of IN O
Amazon NNP B-Organization
" NNP O
might MD O
not RB O
have VB O
ever RB O
seen VBN O
fixes NNS O
, , O
'' '' O
he PRP O
says VBZ O
. . O

Officials NNS O
at IN O
BLU NNP B-Organization
could MD O
n't RB O
be VB O
immediately RB O
reached VBN O
for IN O
comment NN O
. . O

Attitude NNP O
Change NNP O
The DT O
disinterest NN O
in IN O
the DT O
issues NNS O
appears VBZ O
to TO O
have VB O
changed VBN O
with IN O
The DT O
New NNP B-Organization
York NNP I-Organization
Times NNP I-Organization
report NN O
, , O
which WDT O
lit VBD O
a DT O
fire NN O
underneath NN O
Adups NNP B-Organization
and CC O
BLU NNP B-Organization
. . O

Adups NNS B-Organization
addressed VBD O
the DT O
issue NN O
in IN O
a DT O
Nov. NNP O
16 CD O
news NN O
release NN O
, , O
writing VBG O
that IN O
some DT O
products NNS O
made VBN O
by IN O
BLU NNP B-Organization
were VBD O
updated VBN O
in IN O
June NNP O
with IN O
a DT O
version NN O
of IN O
its PRP$ O
FOTA NNP B-System
that IN O
had VBD O
actually RB O
been VBN O
intended VBN O
for IN O
other JJ O
clients NNS O
who WP O
had VBD O
requested VBN O
an DT O
ability NN O
to TO O
stop VB O
text NN O
spam NN O
. . O

That DT O
version NN O
flags VBD O
messages NNS O
" VBP O
containing VBG O
certain JJ O
language NN O
associated VBN O
with IN O
junk NN O
texts NN O
and CC O
flags JJ O
numbers NNS O
associated VBN O
with IN O
junk NN O
calls NNS O
and CC O
not RB O
in IN O
a DT O
user NN O
's POS O
contacts NNS O
, , O
'' '' O
the DT O
company NN O
says VBZ O
. . O

Manufacturers NNS O
should MD O
be VB O
keeping VBG O
close JJ O
tabs NNS O
on IN O
what WDT O
software NN O
ends VBZ O
up RP O
on IN O
their PRP$ O
devices NNS O
. . O

But CC O
it PRP O
would MD O
appear VB O
that IN O
BLU NNP B-Organization
only RB O
took VBD O
action NN O
after IN O
Kryptowire NNP B-Organization
notified VBD O
it PRP O
along RP O
with IN O
Google NNP B-Organization
, , O
Adups NNP B-Organization
and CC O
Amazon NNP B-Organization
. . O

" NN O
When WRB O
BLU NNP B-Organization
raised VBD O
objections NNS O
, , O
Adups NNP B-Organization
took VBD O
immediate JJ O
measures NNS O
to TO O
disable VB O
that DT O
functionality NN O
on IN O
BLU NNP B-Organization
phones NNS O
, , O
'' '' O
Adups NNP I-Organization
says VBZ O
. . O

The DT O
greater JJR O
worry NN O
is VBZ O
that IN O
these DT O
situations NNS O
may MD O
sometimes RB O
not RB O
be VB O
simple JJ O
mistakes NNS O
. . O

Security NN O
experts NNS O
have VBP O
long RB O
warned VBN O
of IN O
the DT O
ability NN O
of IN O
advanced JJ O
adversaries NNS O
to TO O
subvert VB O
hardware NN O
and CC O
software NN O
supply NN O
chains NNS O
. . O

Also RB O
, , O
the DT O
software NN B-Vulnerability
vulnerabilities NNS I-Vulnerability
pointed VBD O
out RP O
in IN O
the DT O
FOTA NNP B-System
software NN O
by IN O
Strazzere NNP O
in IN O
2015 CD O
could MD O
have VB O
been VBN O
taken VBN O
advantage NN O
of IN O
by IN O
cybercriminals NNS O
looking VBG O
to TO O
steal VB O
bank NN O
account NN O
details NNS O
or CC O
execute VB O
other JJ O
frauds NNS O
. . O

Strazzere NNP O
advises VBZ O
that IN O
consumers NNS O
should MD O
look VB O
at IN O
the DT O
pedigree NN O
of IN O
mobile JJ O
manufacturers NNS O
and CC O
take VB O
a DT O
close JJ O
look NN O
at IN O
their PRP$ O
security NN O
track NN O
record NN O
before IN O
making VBG O
a DT O
decision NN O
on IN O
what WP O
device NN O
to TO O
buy VB O
. . O

" NN O
In IN O
the DT O
end NN O
, , O
the DT O
consumer NN O
needs VBZ O
to TO O
vote VB O
with IN O
their PRP$ O
wallet NN O
, , O
'' '' O
he PRP O
says VBZ O
. . O

Skygofree JJ B-Malware
: : O
Following VBG O
in IN O
the DT O
footsteps NNS O
of IN O
HackingTeam NNP B-Organization
16 CD O
JAN NNP O
2018 CD O
At IN O
the DT O
beginning NN O
of IN O
October NNP O
2017 CD O
, , O
we PRP O
discovered VBD O
new JJ O
Android NNP B-System
spyware NN O
with IN O
several JJ O
features NNS O
previously RB O
unseen JJ O
in IN O
the DT O
wild NN O
. . O

In IN O
the DT O
course NN O
of IN O
further JJ O
research NN O
, , O
we PRP O
found VBD O
a DT O
number NN O
of IN O
related JJ O
samples NNS O
that WDT O
point VBP O
to TO O
a DT O
long-term JJ O
development NN O
process NN O
. . O

We PRP O
believe VBP O
the DT O
initial JJ O
versions NNS O
of IN O
this DT O
malware NN O
were VBD O
created VBN O
at IN O
least JJS O
three CD O
years NNS O
ago RB O
– VBP O
at IN O
the DT O
end NN O
of IN O
2014 CD O
. . O

Since IN O
then RB O
, , O
the DT O
implant JJ O
’ NNP O
s NN O
functionality NN O
has VBZ O
been VBN O
improving VBG O
and CC O
remarkable JJ O
new JJ O
features NNS O
implemented VBN O
, , O
such JJ O
as IN O
the DT O
ability NN O
to TO O
record VB O
audio JJ O
surroundings NNS O
via IN O
the DT O
microphone NN O
when WRB O
an DT O
infected JJ O
device NN O
is VBZ O
in IN O
a DT O
specified JJ O
location NN O
; : O
the DT O
stealing NN O
of IN O
WhatsApp NNP B-System
messages NNS O
via IN O
Accessibility NNP O
Services NNPS O
; : O
and CC O
the DT O
ability NN O
to TO O
connect VB O
an DT O
infected JJ O
device NN O
to TO O
Wi-Fi NNP O
networks NNS O
controlled VBN O
by IN O
cybercriminals NNS O
. . O

We PRP O
observed VBD O
many JJ O
web NNS O
landing VBG O
pages NNS O
that WDT O
mimic VBP O
the DT O
sites NNS O
of IN O
mobile NN O
operators NNS O
and CC O
which WDT O
are VBP O
used VBN O
to TO O
spread VB O
the DT O
Android NNP B-System
implants NNS O
. . O

These DT O
domains NNS O
have VBP O
been VBN O
registered VBN O
by IN O
the DT O
attackers NNS O
since IN O
2015 CD O
. . O

According VBG O
to TO O
our PRP$ O
telemetry NN O
, , O
that WDT O
was VBD O
the DT O
year NN O
the DT O
distribution NN O
campaign NN O
was VBD O
at IN O
its PRP$ O
most RBS O
active JJ O
. . O

The DT O
activities NNS O
continue VBP O
: : O
the DT O
most RBS O
recently RB O
observed VBD O
domain NN O
was VBD O
registered VBN O
on IN O
October NNP O
31 CD O
, , O
2017 CD O
. . O

Based VBN O
on IN O
our PRP$ O
KSN NNP O
statistics NNS O
, , O
there EX O
are VBP O
several JJ O
infected JJ O
individuals NNS O
, , O
exclusively RB O
in IN O
Italy NNP O
. . O

Moreover RB O
, , O
as IN O
we PRP O
dived VBD O
deeper RBR O
into IN O
the DT O
investigation NN O
, , O
we PRP O
discovered VBD O
several JJ O
spyware NN O
tools NNS O
for IN O
Windows NNP B-System
that WDT O
form VBP O
an DT O
implant NN O
for IN O
exfiltrating VBG O
sensitive JJ O
data NNS O
on IN O
a DT O
targeted JJ O
machine NN O
. . O

The DT O
version NN O
we PRP O
found VBD O
was VBD O
built VBN O
at IN O
the DT O
beginning NN O
of IN O
2017 CD O
, , O
and CC O
at IN O
the DT O
moment NN O
we PRP O
are VBP O
not RB O
sure JJ O
whether IN O
this DT O
implant NN O
has VBZ O
been VBN O
used VBN O
in IN O
the DT O
wild NN O
. . O

We PRP O
named VBD O
the DT O
malware NN O
Skygofree NNP B-Malware
, , O
because IN O
we PRP O
found VBD O
the DT O
word NN O
in IN O
one CD O
of IN O
the DT O
domains NNS O
* VBP O
. . O

Malware NNP O
Features NNP O
Android NNP B-System
According VBG O
to TO O
the DT O
observed JJ O
samples NNS O
and CC O
their PRP$ O
signatures NNS O
, , O
early JJ O
versions NNS O
of IN O
this DT O
Android NNP B-System
malware NN O
were VBD O
developed VBN O
by IN O
the DT O
end NN O
of IN O
2014 CD O
and CC O
the DT O
campaign NN O
has VBZ O
remained VBN O
active JJ O
ever RB O
since IN O
. . O

The DT O
code NN O
and CC O
functionality NN O
have VBP O
changed VBN O
numerous JJ O
times NNS O
; : O
from IN O
simple NN O
unobfuscated JJ O
malware NN O
at IN O
the DT O
beginning NN O
to TO O
sophisticated JJ O
multi-stage NN O
spyware NN O
that WDT O
gives VBZ O
attackers NNS O
full JJ O
remote VBP O
control NN O
of IN O
the DT O
infected JJ O
device NN O
. . O

We PRP O
have VBP O
examined VBN O
all PDT O
the DT O
detected JJ O
versions NNS O
, , O
including VBG O
the DT O
latest JJS O
one NN O
that WDT O
is VBZ O
signed VBN O
by IN O
a DT O
certificate NN O
valid NN O
from IN O
September NNP O
14 CD O
, , O
2017 CD O
. . O

The DT O
implant NN O
provides VBZ O
the DT O
ability NN O
to TO O
grab VB O
a DT O
lot NN O
of IN O
exfiltrated VBN O
data NNS O
, , O
like IN O
call NN O
records NNS O
, , O
text NN O
messages NNS O
, , O
geolocation NN O
, , O
surrounding VBG O
audio NN O
, , O
calendar NN O
events NNS O
, , O
and CC O
other JJ O
memory NN O
information NN O
stored VBN O
on IN O
the DT O
device NN O
. . O

After IN O
manual JJ O
launch NN O
, , O
it PRP O
shows VBZ O
a DT O
fake JJ O
welcome JJ O
notification NN O
to TO O
the DT O
user NN O
: : O
Dear NNP O
Customer NNP O
, , O
we PRP O
’ VBP O
re JJ O
updating VBG O
your PRP$ O
configuration NN O
and CC O
it PRP O
will MD O
be VB O
ready JJ O
as RB O
soon RB O
as IN O
possible JJ O
. . O

At IN O
the DT O
same JJ O
time NN O
, , O
it PRP O
hides VBZ O
an DT O
icon NN O
and CC O
starts VBZ O
background NN O
services NNS O
to TO O
hide VB O
further JJ O
actions NNS O
from IN O
the DT O
user NN O
. . O

Service NNP O
Name NNP O
Purpose NNP O
AndroidAlarmManager NNP O
Uploading NNP O
last JJ O
recorded VBD O
.amr JJ O
audio JJ O
AndroidSystemService NNP O
Audio NNP O
recording VBG O
AndroidSystemQueues NNP O
Location NNP O
tracking VBG O
with IN O
movement NN O
detection NN O
ClearSystems NNP O
GSM NNP B-System
tracking NN O
( ( O
CID NNP O
, , O
LAC NNP O
, , O
PSC NNP O
) ) O
ClipService NNP O
Clipboard NNP O
stealing VBG O
AndroidFileManager NNP O
Uploading VBG O
all DT O
exfiltrated VBN O
data NNS O
AndroidPush NNP O
XMPP NNP O
С NNP O
& CC O
C NNP O
protocol NN O
( ( O
url.plus:5223 JJ B-Indicator
) ) O
RegistrationService NNP O
Registration NNP O
on IN O
C NNP O
& CC O
C NNP O
via IN O
HTTP NNP O
( ( O
url.plus/app/pro/ JJ B-Indicator
) ) O
Interestingly RB O
, , O
a DT O
self-protection JJ O
feature NN O
was VBD O
implemented VBN O
in IN O
almost RB O
every DT O
service NN O

. . O

Since IN O
in IN O
Android NNP B-System
8.0 CD I-System
( ( O
SDK NNP O
API NNP O
26 CD O
) ) O
the DT O
system NN O
is VBZ O
able JJ O
to TO O
kill VB O
idle JJ O
services NNS O
, , O
this DT O
code NN O
raises VBZ O
a DT O
fake JJ O
update JJ O
notification NN O
to TO O
prevent VB O
it PRP O
: : O
Cybercriminals NNS O
have VBP O
the DT O
ability NN O
to TO O
control VB O
the DT O
implant JJ O
via IN O
HTTP NNP O
, , O
XMPP NNP O
, , O
binary JJ O
SMS NNP O
and CC O
FirebaseCloudMessaging NNP O
( ( O
or CC O
GoogleCloudMessaging VBG O
in IN O
older JJR O
versions NNS O
) ) O
protocols NNS O
. . O

Such JJ O
a DT O
diversity NN O
of IN O
protocols NNS O
gives VBZ O
the DT O
attackers NNS O
more RBR O
flexible JJ O
control NN O
. . O

In IN O
the DT O
latest JJS O
implant JJ O
versions NNS O
there EX O
are VBP O
48 CD O
different JJ O
commands NNS O
. . O

You PRP O
can MD O
find VB O
a DT O
full JJ O
list NN O
with IN O
short JJ O
descriptions NNS O
in IN O
the DT O
Appendix NNP O
. . O

Here RB O
are VBP O
some DT O
of IN O
the DT O
most RBS O
notable JJ O
: : O
‘ JJ O
geofence NN O
’ NN O
– NN O
this DT O
command NN O
adds VBZ O
a DT O
specified JJ O
location NN O
to TO O
the DT O
implant JJ O
’ NNP O
s VBD O
internal JJ O
database NN O
and CC O
when WRB O
it PRP O
matches VBZ O
a DT O
device NN O
’ NNP O
s VBD O
current JJ O
location NN O
the DT O
malware NN O
triggers NNS O
and CC O
begins VBZ O
to TO O
record VB O
surrounding VBG O
audio NN O
. . O

” JJ O
social JJ O
” NN O
– NN O
this DT O
command NN O
that WDT O
starts VBZ O
the DT O
‘ JJ O
AndroidMDMSupport NNP O
’ NNP O
service NN O
– NN O
this DT O
allows VBZ O
the DT O
files NNS O
of IN O
any DT O
other JJ O
installed JJ O
application NN O
to TO O
be VB O
grabbed VBN O
. . O

The DT O
service NN O
name NN O
makes VBZ O
it PRP O
clear JJ O
that IN O
by IN O
applications NNS O
the DT O
attackers NNS O
mean VBP O
MDM NNP O
solutions NNS O
that WDT O
are VBP O
business-specific JJ O
tools NNS O
. . O

The DT O
operator NN O
can MD O
specify VB O
a DT O
path NN O
with IN O
the DT O
database NN O
of IN O
any DT O
targeted JJ O
application NN O
and CC O
server-side JJ O
PHP NNP O
script NN O
name NN O
for IN O
uploading VBG O
. . O

Several JJ O
hardcoded VBD O
applications NNS O
targeted VBN O
by IN O
the DT O
MDM-grabbing NNP O
command NN O
‘ NNP O
wifi NN O
’ NNP O
– NNP O
this DT O
command NN O
creates VBZ O
a DT O
new JJ O
Wi-Fi JJ O
connection NN O
with IN O
specified JJ O
configurations NNS O
from IN O
the DT O
command NN O
and CC O
enable JJ O
Wi-Fi JJ O
if IN O
it PRP O
is VBZ O
disabled VBN O
. . O

So RB O
, , O
when WRB O
a DT O
device NN O
connects VBZ O
to TO O
the DT O
established VBN O
network NN O
, , O
this DT O
process NN O
will MD O
be VB O
in IN O
silent JJ O
and CC O
automatic JJ O
mode NN O
. . O

This DT O
command NN O
is VBZ O
used VBN O
to TO O
connect VB O
the DT O
victim NN O
to TO O
a DT O
Wi-Fi JJ O
network NN O
controlled VBN O
by IN O
the DT O
cybercriminals NNS O
to TO O
perform VB O
traffic NN O
sniffing VBG O
and CC O
man-in-the-middle JJ O
( ( O
MitM NNP O
) ) O
attacks NNS O
. . O

addWifiConfig NN O
method NN O
code NN O
fragments NNS O
‘ VBP O
camera NN O
’ NN O
– NN O
this DT O
command NN O
records VBZ O
a DT O
video/capture NN O
a DT O
photo NN O
using VBG O
the DT O
front-facing JJ O
camera NN O
when WRB O
someone NN O
next JJ O
unlocks VBZ O
the DT O
device NN O
. . O

Some DT O
versions NNS O
of IN O
the DT O
Skygofree NNP B-Malware
feature NN O
the DT O
self-protection NN O
ability NN O
exclusively RB O
for IN O
Huawei NNP B-Organization
devices NNS O
. . O

There EX O
is VBZ O
a DT O
‘ NN O
protected VBN O
apps JJ O
’ JJ O
list NN O
in IN O
this DT O
brand NN O
’ NNP O
s NN O
smartphones NNS O
, , O
related VBN O
to TO O
a DT O
battery-saving JJ O
concept NN O
. . O

Apps NNP O
not RB O
selected VBD O
as IN O
protected JJ O
apps NN O
stop NN O
working VBG O
once RB O
the DT O
screen NN O
is VBZ O
off IN O
and CC O
await VB O
re-activation NN O
, , O
so IN O
the DT O
implant NN O
is VBZ O
able JJ O
to TO O
determine VB O
that IN O
it PRP O
is VBZ O
running VBG O
on IN O
a DT O
Huawei NNP B-Organization
device NN O
and CC O
add VB O
itself PRP O
to TO O
this DT O
list NN O
. . O

Due JJ O
to TO O
this DT O
feature NN O
, , O
it PRP O
is VBZ O
clear JJ O
that IN O
the DT O
developers NNS O
paid VBD O
special JJ O
attention NN O
to TO O
the DT O
work NN O
of IN O
the DT O
implant NN O
on IN O
Huawei NNP B-Organization
devices NNS O
. . O

Also RB O
, , O
we PRP O
found VBD O
a DT O
debug JJ O
version NN O
of IN O
the DT O
implant NN O
( ( O
70a937b2504b3ad6c623581424c7e53d CD B-Indicator
) ) O
that WDT O
contains VBZ O
interesting JJ O
constants NNS O
, , O
including VBG O
the DT O
version NN O
of IN O
the DT O
spyware NN O
. . O

Debug NNP O
BuildConfig NNP O
with IN O
the DT O
version NN O
After IN O
a DT O
deep JJ O
analysis NN O
of IN O
all DT O
discovered JJ O
versions NNS O
of IN O
Skygofree NNP B-Malware
, , O
we PRP O
made VBD O
an DT O
approximate JJ O
timeline NN O
of IN O
the DT O
implant JJ O
’ NN O
s JJ O
evolution NN O
. . O

Mobile NNP O
implant JJ O
evolution NN O
timeline NN O
However RB O
, , O
some DT O
facts NNS O
indicate VBP O
that IN O
the DT O
APK NNP O
samples NNS O
from IN O
stage NN O
two CD O
can MD O
also RB O
be VB O
used VBN O
separately RB O
as IN O
the DT O
first JJ O
step NN O
of IN O
the DT O
infection NN O
. . O

Below NNP O
is VBZ O
a DT O
list NN O
of IN O
the DT O
payloads NNS O
used VBN O
by IN O
the DT O
Skygofree NNP B-Malware
implant NN O
in IN O
the DT O
second JJ O
and CC O
third JJ O
stages NNS O
. . O

Reverse NNP O
shell NN O
payload VBZ O
The DT O
reverse NN O
shell NN O
module NN O
is VBZ O
an DT O
external JJ O
ELF NNP O
file NN O
compiled VBN O
by IN O
the DT O
attackers NNS O
to TO O
run VB O
on IN O
Android NNP B-System
. . O

The DT O
choice NN O
of IN O
a DT O
particular JJ O
payload NN O
is VBZ O
determined VBN O
by IN O
the DT O
implant JJ O
’ NNP O
s NN O
version NN O
, , O
and CC O
it PRP O
can MD O
be VB O
downloaded VBN O
from IN O
the DT O
command NN O
and CC O
control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server RB O
soon RB O
after IN O
the DT O
implant NN O
starts VBZ O
, , O
or CC O
after IN O
a DT O
specific JJ O
command NN O
. . O

In IN O
the DT O
most RBS O
recent JJ O
case NN O
, , O
the DT O
choice NN O
of IN O
the DT O
payload NN O
zip NN O
file NN O
depends VBZ O
on IN O
the DT O
device NN O
process NN O
architecture NN O
. . O

For IN O
now RB O
, , O
we PRP O
observe VBP O
only RB O
one CD O
payload NN O
version NN O
for IN O
following VBG O
the DT O
ARM NNP B-System
CPUs NNP O
: : O
arm64-v8a JJ B-System
, , O
armeabi JJ B-System
, , O
armeabi-v7a JJ B-System
. . O

Note NN O
that IN O
in IN O
almost RB O
all DT O
cases NNS O
, , O
this DT O
payload NN O
file NN O
, , O
contained VBN O
in IN O
zip NN O
archives NNS O
, , O
is VBZ O
named VBN O
‘ JJ O
setting VBG B-Indicator
’ NN O
or CC O
‘ VB O
setting.o JJ B-Indicator
’ NN O
. . O

The DT O
main JJ O
purpose NN O
of IN O
this DT O
module NN O
is VBZ O
providing VBG O
reverse NN O
shell NN O
features NNS O
on IN O
the DT O
device NN O
by IN O
connecting VBG O
with IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
’ NNP O
s NN O
socket NN O
. . O

Reverse NNP O
shell NN O
payload VBZ O
The DT O
payload NN O
is VBZ O
started VBN O
by IN O
the DT O
main JJ O
module NN O
with IN O
a DT O
specified VBN O
host NN O
and CC O
port NN O
as IN O
a DT O
parameter NN O
that WDT O
is VBZ O
hardcoded VBN O
to TO O
‘ VB O
54.67.109.199 CD B-Indicator
’ NN O
and CC O
‘ $ O
30010 CD B-Indicator
’ NN O
in IN O
some DT O
versions NNS O
: : O
Alternatively RB O
, , O
they PRP O
could MD O
be VB O
hardcoded VBN O
directly RB O
into IN O
the DT O
payload NN O
code NN O
: : O
We PRP O
also RB O
observed VBD O
variants NNS O
that WDT O
were VBD O
equipped VBN O
with IN O
similar JJ O
reverse NN O
shell NN O
payloads NNS O
directly RB O
in IN O
the DT O
main JJ O
APK NNP O
/lib/ NNP O
path NN O
. . O

Equipped NNP O
reverse NN O
shell NN O
payload NN O
with IN O
specific JJ O
string NN O
After IN O
an DT O
in-depth JJ O
look NN O
, , O
we PRP O
found VBD O
that IN O
some DT O
versions NNS O
of IN O
the DT O
reverse NN O
shell NN O
payload NN O
code NN O
share NN O
similarities VBZ O
with IN O
PRISM NNP B-Malware
– VBP O
a DT O
stealth NN O
reverse NN O
shell NN O
backdoor NN O
that WDT O
is VBZ O
available JJ O
on IN O
Github NNP B-Organization
. . O

Reverse NNP O
shell NN O
payload NN O
from IN O
update_dev.zip JJ B-Indicator
Exploit NNP O
payload NN O
At IN O
the DT O
same JJ O
time NN O
, , O
we PRP O
found VBD O
an DT O
important JJ O
payload NN O
binary NN O
that WDT O
is VBZ O
trying VBG O
to TO O
exploit VB O
several JJ O
known VBN O
vulnerabilities NNS O
and CC O
escalate JJ O
privileges NNS O
. . O

According VBG O
to TO O
several JJ O
timestamps NNS O
, , O
this DT O
payload NN O
is VBZ O
used VBN O
by IN O
implant JJ O
versions NNS O
created VBN O
since IN O
2016 CD O
. . O

It PRP O
can MD O
also RB O
be VB O
downloaded VBN O
by IN O
a DT O
specific JJ O
command NN O
. . O

The DT O
exploit JJ O
payload NN O
contains VBZ O
following VBG O
file JJ O
components NNS O
: : O
Component NNP O
name NN O
Description NNP O
run_root_shell/arrs_put_user.o/arrs_put_user/poc NN B-Indicator
Exploit NNP O
ELF NNP O
db NN O
Sqlite3 NNP O
tool NN O
ELF NNP O
device.db NN B-Indicator
Sqlite3 NNP O
database NN O
with IN O
supported JJ O
devices NNS O
and CC O
their PRP$ O
constants NNS O
needed VBN O
for IN O
privilege NN O
escalation NN O
‘ NNP O
device.db NN B-Indicator
’ NNP O
is VBZ O
a DT O
database NN O
used VBN O
by IN O
the DT O
exploit NN O
. . O

It PRP O
contains VBZ O
two CD O
tables NNS O
– VBP O
‘ JJ O
supported_devices NNS O
’ NN O
and CC O
‘ NNP O
device_address NN O
’ NN O
. . O

The DT O
first JJ O
table NN O
contains VBZ O
205 CD O
devices NNS O
with IN O
some DT O
Linux NNP B-System
properties NNS O
; : O
the DT O
second JJ O
contains VBZ O
the DT O
specific JJ O
memory NN O
addresses NNS O
associated VBN O
with IN O
them PRP O
that WDT O
are VBP O
needed VBN O
for IN O
successful JJ O
exploitation NN O
. . O

You PRP O
can MD O
find VB O
a DT O
full JJ O
list NN O
of IN O
targeted JJ O
models NNS O
in IN O
the DT O
Appendix NNP O
. . O

Fragment NN O
of IN O
the DT O
database NN O
with IN O
targeted JJ O
devices NNS O
and CC O
specific JJ O
memory NN O
addresses NNS O
If IN O
the DT O
infected JJ O
device NN O
is VBZ O
not RB O
listed VBN O
in IN O
this DT O
database NN O
, , O
the DT O
exploit JJ O
tries NNS O
to TO O
discover VB O
these DT O
addresses NNS O
programmatically RB O
. . O

After IN O
downloading VBG O
and CC O
unpacking JJ O
, , O
the DT O
main JJ O
module NN O
executes VBZ O
the DT O
exploit JJ O
binary JJ O
file NN O
. . O

Once RB O
executed VBN O
, , O
the DT O
module NN O
attempts NNS O
to TO O
get VB O
root JJ O
privileges NNS O
on IN O
the DT O
device NN O
by IN O
exploiting VBG O
the DT O
following JJ O
vulnerabilities NNS O
: : O
CVE-2013-2094 JJ B-Vulnerability
CVE-2013-2595 JJ B-Vulnerability
CVE-2013-6282 JJ B-Vulnerability
CVE-2014-3153 NNP B-Vulnerability
( ( O
futex JJ B-Vulnerability
aka RB O
TowelRoot NNP B-Vulnerability
) ) O
CVE-2015-3636 NNP B-Vulnerability
Exploitation NNP O
process NN O
After IN O
an DT O
in-depth JJ O
look NN O
, , O
we PRP O
found VBD O
that IN O
the DT O
exploit JJ O
payload NN O
code NN O
shares NNS O
several JJ O
similarities NNS O
with IN O
the DT O
public JJ O
project NN O
android-rooting-tools NNS O
. . O

Decompiled VBN O
exploit JJ O
function NN O
code NN O
fragment NN O
run_with_mmap NN O
function NN O
from IN O
the DT O
android-rooting-tools JJ B-System
project NN O
As IN O
can MD O
be VB O
seen VBN O
from IN O
the DT O
comparison NN O
, , O
there EX O
are VBP O
similar JJ O
strings NNS O
and CC O
also RB O
a DT O
unique JJ O
comment NN O
in IN O
Italian JJ O
, , O
so IN O
it PRP O
looks VBZ O
like IN O
the DT O
attackers NNS O
created VBD O
this DT O
exploit NN O
payload NN O
based VBN O
on IN O
android-rooting-tools NNS B-System
project NN O
source NN O
code NN O
. . O

Busybox NNP O
payload NN O
Busybox NNP O
is VBZ O
public JJ O
software NN O
that WDT O
provides VBZ O
several JJ O
Linux NNP O
tools NNS O
in IN O
a DT O
single JJ O
ELF NNP O
file NN O
. . O

In IN O
earlier JJR O
versions NNS O
, , O
it PRP O
operated VBD O
with IN O
shell NN O
commands NNS O
like IN O
this DT O
: : O
Stealing VBG O
WhatsApp NNP O
encryption NN O
key NN O
with IN O
Busybox NNP B-Malware
Social NNP I-Malware
payload NN I-Malware
Actually RB O
, , O
this DT O
is VBZ O
not RB O
a DT O
standalone NN O
payload NN O
file NN O
– NN O
in IN O
all PDT O
the DT O
observed JJ O
versions NNS O
its PRP$ O
code NN O
was VBD O
compiled VBN O
with IN O
exploit JJ O
payload NN O
in IN O
one CD O
file NN O
( ( O
‘ JJ O
poc_perm NN O
’ NNP O
, , O
‘ NNP O
arrs_put_user NN O
’ NN O
, , O
‘ NNP O
arrs_put_user.o VBZ O
’ NNP O
) ) O
. . O

This DT O
is VBZ O
due JJ O
to TO O
the DT O
fact NN O
that IN O
the DT O
implant JJ O
needs NNS O
to TO O
escalate VB O
privileges NNS O
before IN O
performing VBG O
social JJ O
payload NN O
actions NNS O
. . O

This DT O
payload NN O
is VBZ O
also RB O
used VBN O
by IN O
the DT O
earlier JJR O
versions NNS O
of IN O
the DT O
implant NN O
. . O

It PRP O
has VBZ O
similar JJ O
functionality NN O
to TO O
the DT O
‘ NNP O
AndroidMDMSupport NNP O
’ NNP O
command NN O
from IN O
the DT O
current JJ O
versions NNS O
– VBP O
stealing VBG O
data NNS O
belonging NN O
to TO O
other JJ O
installed JJ O
applications NNS O
. . O

The DT O
payload NN O
will MD O
execute VB O
shell NN O
code NN O
to TO O
steal VB O
data NNS O
from IN O
various JJ O
applications NNS O
. . O

The DT O
example NN O
below IN O
steals NNS O
Facebook NNP B-System
data NNS O
: : O
All PDT O
the DT O
other JJ O
hardcoded VBD O
applications NNS O
targeted VBN O
by IN O
the DT O
payload NN O
: : O
Package NN O
name NN O
Name NNP O
jp.naver.line.android JJ B-Indicator
LINE NNP B-System
: : I-System
Free NNP I-System
Calls NNP I-System
& CC I-System
Messages NNP I-System
com.facebook.orca VBP B-Indicator
Facebook NNP B-System
messenger NN I-System
com.facebook.katana NN B-Indicator
Facebook NNP B-System
com.whatsapp NN B-Indicator
WhatsApp NNP B-System
com.viber.voip VBZ B-Indicator
Viber NNP B-System
Parser NNP O
payload NN O
Upon NNP O
receiving VBG O
a DT O
specific JJ O
command NN O
, , O
the DT O
implant NN O
can MD O
download VB O
a DT O
special JJ O
payload NN O
to TO O
grab VB O
sensitive JJ O
information NN O
from IN O
external JJ O
applications NNS O
. . O

The DT O
case NN O
where WRB O
we PRP O
observed VBD O
this DT O
involved JJ O
WhatsApp NNP B-System
. . O

In IN O
the DT O
examined JJ O
version NN O
, , O
it PRP O
was VBD O
downloaded VBN O
from IN O
: : O
hxxp NN B-Indicator
: : I-Indicator
//url JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
plus/Updates/tt/parser.apk VBZ I-Indicator
The DT O
payload NN O
can MD O
be VB O
a DT O
.dex NN O
or CC O
.apk NN O
file NN O
which WDT O
is VBZ O
a DT O
Java-compiled JJ O
Android NNP B-System
executable NN O
. . O

After IN O
downloading VBG O
, , O
it PRP O
will MD O
be VB O
loaded VBN O
by IN O
the DT O
main JJ O
module NN O
via IN O
DexClassLoader NNP O
api NN O
: : O
As IN O
mentioned VBN O
, , O
we PRP O
observed VBD O
a DT O
payload NN O
that WDT O
exclusively RB O
targets VBZ O
the DT O
WhatsApp NNP B-System
messenger NN I-System
and CC O
it PRP O
does VBZ O
so RB O
in IN O
an DT O
original JJ O
way NN O
. . O

The DT O
payload NN O
uses VBZ O
the DT O
Android NNP B-System
Accessibility NNP O
Service NNP O
to TO O
get VB O
information NN O
directly RB O
from IN O
the DT O
displayed JJ O
elements NNS O
on IN O
the DT O
screen NN O
, , O
so IN O
it PRP O
waits VBZ O
for IN O
the DT O
targeted JJ O
application NN O
to TO O
be VB O
launched VBN O
and CC O
then RB O
parses VBZ O
all DT O
nodes NNS O
to TO O
find VB O
text JJ O
messages NNS O
: : O
Note NN O
that IN O
the DT O
implant NN O
needs VBZ O
special JJ O
permission NN O
to TO O
use VB O
the DT O
Accessibility NNP O
Service NNP O
API NNP O
, , O
but CC O
there EX O
is VBZ O
a DT O
command NN O
that WDT O
performs VBZ O
a DT O
request NN O
with IN O
a DT O
phishing VBG O
text NN O
displayed VBN O
to TO O
the DT O
user NN O
to TO O
obtain VB O
such JJ O
permission NN O
. . O

Windows IN B-System
We PRP O
have VBP O
found VBN O
multiple JJ O
components NNS O
that WDT O
form VBP O
an DT O
entire JJ O
spyware NN O
system NN O
for IN O
the DT O
Windows NNP B-System
platform NN O
. . O

Name NN O
MD5 NNP O
Purpose NNP O
msconf.exe VBD B-Indicator
55fb01048b6287eadcbd9a0f86d21adf CD B-Indicator
Main NNP O
module NN O
, , O
reverse NN O
shell NN O
network.exe RB B-Indicator
f673bb1d519138ced7659484c0b66c5b JJ B-Indicator
Sending NNP O
exfiltrated VBD O
data NNS O
system.exe NN B-Indicator
d3baa45ed342fbc5a56d974d36d5f73f NN B-Indicator
Surrounding VBG O
sound JJ O
recording NN O
by IN O
mic JJ O
update.exe JJ B-Indicator
395f9f87df728134b5e3c1ca4d48e9fa CD B-Indicator
Keylogging NNP O
wow.exe NN B-Indicator

16311b16fd48c1c87c6476a455093e7a CD B-Indicator
Screenshot NNP O
capturing VBG O
skype_sync2.exe RB B-Indicator
6bcc3559d7405f25ea403317353d905f CD B-Indicator
Skype NNP B-System
call NN O
recording VBG O
to TO O
MP3 NNP O
All NNP O
modules NNS O
, , O
except IN O
skype_sync2.exe NN B-Indicator
, , O
are VBP O
written VBN O
in IN O
Python NNP B-System
and CC O
packed VBD O
to TO O
binary JJ O
files NNS O
via IN O
the DT O
Py2exe NNP B-System
tool NN O
. . O

This DT O
sort NN O
of IN O
conversion NN O
allows NNS O
Python NNP B-System
code NN O
to TO O
be VB O
run VBN O
in IN O
a DT O
Windows NNP B-System
environment NN O
without IN O
pre-installed JJ O
Python NNP B-System
binaries NNS O
. . O

msconf.exe NN B-Indicator
is VBZ O
the DT O
main JJ O
module NN O
that WDT O
provides VBZ O
control NN O
of IN O
the DT O
implant NN O
and CC O
reverse NN O
shell NN O
feature NN O
. . O

It PRP O
opens VBZ O
a DT O
socket NN O
on IN O
the DT O
victim NN O
’ NNP O
s NN O
machine NN O
and CC O
connects NNS O
with IN O
a DT O
server-side JJ O
component NN O
of IN O
the DT O
implant NN O
located VBN O
at IN O
54.67.109.199:6500 CD B-Indicator
. . O

Before IN O
connecting VBG O
with IN O
the DT O
socket NN O
, , O
it PRP O
creates VBZ O
a DT O
malware NN O
environment NN O
in IN O
‘ NNP O
APPDATA/myupd NNP B-Indicator
’ NNP O
and CC O
creates VBZ O
a DT O
sqlite3 JJ O
database NN O
there EX O
– NNP O
‘ NNP O
myupd_tmp\\mng.db NN B-Indicator
’ NN O
: : O
CREATE NNP O
TABLE NNP O
MANAGE NNP O
( ( O
ID NNP O
INT NNP O
PRIMARY NNP O
KEY NNP O
NOT NNP O
NULL NNP O
, , O
Send NNP O
INT NNP O
NOT NNP O
NULL NNP O
, , O
Keylogg NNP O
INT NNP O
NOT NNP O
NULL NNP O
, , O
Screenshot NNP O
INT NNP O
NOT NNP O
NULL NNP O
, , O
Audio NNP O
INT NNP O
NOT NNP O
NULL NNP O
) ) O
; : O
INSERT NNP O
INTO NNP O
MANAGE NNP O
( ( O
ID NNP O
, , O
Send NNP O
, , O
Keylogg NNP O
, , O
Screenshot NNP O
, , O
Audio NNP O

) ) O
VALUES NNP O
( ( O
1 CD O
, , O
1 CD O
, , O
1 CD O
, , O
1 CD O
, , O
0 CD O
) ) O
Finally RB O
, , O
the DT O
malware NN O
modifies VBZ O
the DT O
‘ JJ O
Software\Microsoft\Windows\CurrentVersion\Run NNP B-Indicator
’ NNP O
registry NN O
key NN O
to TO O
enable VB O
autostart NN O
of IN O
the DT O
main JJ O
module NN O
. . O

The DT O
code NN O
contains VBZ O
multiple JJ O
comments NNS O
in IN O
Italian JJ O
, , O
here RB O
is VBZ O
the DT O
most RBS O
noteworthy JJ O
example NN O
: : O
“ JJ O
Receive NNP O
commands NNS O
from IN O
the DT O
remote JJ O
server NN O
, , O
here RB O
you PRP O
can MD O
set VB O
the DT O
key JJ O
commands NNS O
to TO O
command VB O
the DT O
virus NN O
” NN O
Here RB O
are VBP O
the DT O
available JJ O
commands NNS O
: : O
Name NN O
Description NNP O
cd NN O
Change NNP O
current JJ O
directory NN O
to TO O
specified VBN O
quit NN O
Close NNP O
the DT O
socket NN O
nggexe JJ O
Execute NNP O
received VBD O
command NN O
via IN O
Python NNP B-System
’ NNP O
s NN O
subprocess.Popen NN O
( ( O
) ) O
without IN O
outputs NNS O
ngguploads NNS O
Upload NNP O
specified VBD O
file NN O
to TO O
the DT O
specified VBN O
URL NNP O
nggdownloads NNS O
Download NNP O
content NN O
from IN O
the DT O
specified VBN O
URLs NNP O
and CC O
save VB O
to TO O
specified VBN O
file NN O
nggfilesystem NN O
Dump NNP O
file NN O
structure NN O
of IN O

the DT O
C NNP O
: : O
path NN O
, , O
save VB O
it PRP O
to TO O
the DT O
file NN O
in IN O
json NN O
format NN O
and CC O
zip NN O
it PRP O
nggstart_screen JJ O
nggstop_screen JJ O
Enable/disable NNP O
screenshot NN O
module NN O
. . O

When WRB O
enabled VBN O
, , O
it PRP O
makes VBZ O
a DT O
screenshot JJ O
every DT O
25 CD O
seconds NNS O
nggstart_key JJ O
nggstop_key JJ O
Enable/disable JJ O
keylogging NN O
module NN O
nggstart_rec IN O
nggstop_rec JJ O
Enable/disable JJ O
surrounding VBG O
sounds NNS O
recording VBG O
module NN O
ngg_status JJ O
Send NNP O
components NNS O
status NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
socket NN O
* NNP O
any DT O
other JJ O
* JJ O
Execute NNP O
received VBD O
command NN O
via IN O
Python NNP B-System
’ NNP O
s NN O
subprocess.Popen NN O
( ( O
) ) O
, , O
output NN O
result NN O
will MD O
be VB O
sent VBN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
socket NN O
. . O

All DT O
modules NNS O
set VBN O
hidden JJ O
attributes NNS O
to TO O
their PRP$ O
files NNS O
: : O
Module NNP O
Paths NNP O
Exfiltrated NNP O
data NNS O
format RB O
msconf.exe CD B-Indicator
% NN B-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd/gen/ NNP I-Indicator
% NN I-Indicator
Y NNP I-Indicator
% NN I-Indicator
m NN I-Indicator
% NN I-Indicator
d- JJ I-Indicator
% NN I-Indicator
H NNP I-Indicator
% NN I-Indicator
M NNP I-Indicator
% NN I-Indicator
S_filesystem.zip NNP I-Indicator
( ( I-Indicator
file JJ I-Indicator
structure NN I-Indicator
dump NN I-Indicator
) ) I-Indicator
system.exe NN I-Indicator
% NN I-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd/aud/ NNP I-Indicator
% NN I-Indicator
d NN I-Indicator
% NN I-Indicator
m NN I-Indicator
% NN I-Indicator
Y NNP I-Indicator
% NN I-Indicator
H NNP I-Indicator
% NN I-Indicator
M NNP I-Indicator
% NN I-Indicator
S.wav NNP I-Indicator
( ( I-Indicator
surrounding VBG I-Indicator
sounds NNS I-Indicator
) ) I-Indicator
update.exe VBP I-Indicator
% NN I-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd_tmp/txt/ NNP I-Indicator
% NN I-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd/txt/ NNP I-Indicator
% NN I-Indicator
Y NNP I-Indicator
% NN I-Indicator
m NN I-Indicator

% NN I-Indicator
d- JJ I-Indicator
% NN I-Indicator
H NNP I-Indicator
% NN I-Indicator
M NNP I-Indicator
% NN I-Indicator
S.txt NNP I-Indicator
( ( I-Indicator
keylogging VBG I-Indicator
) ) I-Indicator
wow.exe NN I-Indicator
% NN I-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd/scr/ NNP I-Indicator
% NN I-Indicator
Y NNP I-Indicator
% NN I-Indicator
m NN I-Indicator
% NN I-Indicator
d- JJ I-Indicator
% NN I-Indicator
H NNP I-Indicator
% NN I-Indicator
M NNP I-Indicator
% NN I-Indicator
S.jpg NNP I-Indicator
( ( I-Indicator
screenshots NNS I-Indicator
) ) I-Indicator
skype_sync2.exe VBP I-Indicator
% NN I-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd_tmp/skype/ NNP I-Indicator
% NN I-Indicator
APPDATA NNP I-Indicator
% NN I-Indicator
/myupd/skype/ NNP I-Indicator
yyyyMMddHHmmss_in.mp3 NN I-Indicator
yyyyMMddHHmmss_out.mp3 NN B-Indicator
( ( O
skype JJ O
calls VBZ O
records NNS O
) ) O
Moreover RB O
, , O
we PRP O
found VBD O
one CD O
module NN O
written VBN O

in IN O
.Net JJ B-System
– NN O
skype_sync2.exe NN B-Indicator
. . O

The DT O
main JJ O
purpose NN O
of IN O
this DT O
module NN O
is VBZ O
to TO O
exfiltrate VB O
Skype NNP B-System
call NN O
recordings NNS O
. . O

Just RB O
like IN O
the DT O
previous JJ O
modules NNS O
, , O
it PRP O
contains VBZ O
multiple JJ O
strings NNS O
in IN O
Italian JJ O
. . O

After IN O
launch NN O
, , O
it PRP O
downloads VBZ O
a DT O
codec NN O
for IN O
MP3 NNP O
encoding VBG O
directly RB O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
: : O
http NN B-Indicator
: : I-Indicator
//54.67.109.199/skype_resource/libmp3lame.dll VB I-Indicator
The DT O
skype_sync2.exe NN B-Indicator
module NN O
has VBZ O
a DT O
compilation NN O
timestamp NN O
– NNP O
Feb NNP O
06 CD O
2017 CD O
and CC O
the DT O
following JJ O
PDB NNP O
string NN O
: : O
\\vmware-host\Shared JJ B-Indicator
Folders\dati\Backup\Projects\REcodin_2\REcodin_2\obj\x86\Release\REcodin_2.pdb NNP B-Indicator
network.exe NN B-Indicator
is VBZ O
a DT O

module NN O
for IN O
submitting VBG O
all DT O
exfiltrated VBN O
data NNS O
to TO O
the DT O
server NN O
. . O

In IN O
the DT O
observed JJ O
version NN O
of IN O
the DT O
implant NN O
it PRP O
doesn VBZ O
’ JJ O
t NNS O
have VBP O
an DT O
interface NN O
to TO O
work VB O
with IN O
the DT O
skype_sync2.exe NN B-Indicator
module NN O
. . O

network.exe RB B-Indicator
submitting VBG O
to TO O
the DT O
server NN O
code NN O
snippet NN O
Code NNP O
similarities VBZ O
We PRP O
found VBD O
some DT O
code NN O
similarities NNS O
between IN O
the DT O
implant NN O
for IN O
Windows NNP B-System
and CC O
other JJ O
public JJ O
accessible JJ O
projects NNS O
. . O

https NN B-Indicator
: : I-Indicator
//github.com/El3ct71k/Keylogger/ NN I-Indicator
It PRP O
appears VBZ O
the DT O
developers NNS O
have VBP O
copied VBN O
the DT O
functional JJ O
part NN O
of IN O
the DT O
keylogger NN O
module NN O
from IN O
this DT O
project NN O
. . O

update.exe JJ B-Indicator
module NN O
and CC O
Keylogger NNP O
by IN O
‘ NNP O
El3ct71k NNP O
’ NNP O
code NN O
comparison NN O
Xenotix NNP B-System
Python NNP I-System
Keylogger NNP I-System
including VBG O
specified VBN O
mutex JJ O
‘ NNP O
mutex_var_xboz NN O
’ NN O
. . O

update.exe JJ B-Indicator
module NN O
and CC O
Xenotix NNP B-System
Python NNP I-System
Keylogger NNP I-System
code NN O
comparison NN O
‘ NNP O
addStartup NN O
’ NNP O
method NN O
from IN O
msconf.exe NN B-Indicator
module NN O
‘ NNP O
addStartup NN O
’ NNP O
method NN O
from IN O
Xenotix NNP B-System
Python NNP I-System
Keylogger NNP I-System
Distribution NNP O
We PRP O
found VBD O
several JJ O
landing NN O
pages NNS O
that WDT O
spread VBP O
the DT O
Android NNP B-System
implants NNS O
. . O

Malicious JJ O
URL NNP O
Referrer NNP O
Dates NNP O
http NN B-Indicator
: : I-Indicator
//217.194.13.133/tre/internet/Configuratore_3.apk JJ I-Indicator
http NN B-Indicator
: : I-Indicator
//217.194.13.133/tre/internet/ JJ I-Indicator
2015-02-04 JJ O
to TO O
present JJ O
time NN O
http NN B-Indicator
: : I-Indicator
//217.194.13.133/appPro_AC.apk JJ I-Indicator
– JJ O
2015-07-01 JJ O
http NN B-Indicator
: : I-Indicator
//217.194.13.133/190/configurazione/vodafone/smartphone/VODAFONE CD I-Indicator
% NN I-Indicator
20Configuratore CD I-Indicator
% NN I-Indicator
20v5_4_2.apk CD I-Indicator
http NN B-Indicator
: : I-Indicator
//217.194.13.133/190/configurazione/vodafone/smartphone/index.html NN I-Indicator

2015-01-20 JJ O
to TO O
present JJ O
time NN O
http NN B-Indicator
: : I-Indicator
//217.194.13.133/190/configurazione/vodafone/smartphone/Vodafone CD I-Indicator
% NN I-Indicator
20Configuratore.apk CD I-Indicator
http NN B-Indicator
: : I-Indicator
//217.194.13.133/190/configurazione/vodafone/smartphone/index.html NN I-Indicator
currently RB O
active JJ O
http NN B-Indicator
: : I-Indicator
//vodafoneinfinity.sytes.net/tim/internet/Configuratore_TIM.apk JJ I-Indicator
http NN B-Indicator
: : I-Indicator
//vodafoneinfinity.sytes.net/tim/internet/ JJ I-Indicator
2015-03-04 JJ O
http NN B-Indicator
: : I-Indicator
//vodafoneinfinity.sytes.net/190/configurazione/vodafone/smartphone/VODAFONE NN I-Indicator

% NN I-Indicator
20Configuratore CD I-Indicator
% NN I-Indicator
20v5_4_2.apk CD I-Indicator
http NN B-Indicator
: : I-Indicator
//vodafoneinfinity.sytes.net/190/configurazione/vodafone/smartphone/ JJ I-Indicator
2015-01-14 JJ O
http NN B-Indicator
: : I-Indicator
//windupdate.serveftp.com/wind/LTE/WIND CD I-Indicator
% NN I-Indicator
20Configuratore CD I-Indicator
% NN I-Indicator
20v5_4_2.apk CD I-Indicator
http NN B-Indicator
: : I-Indicator
//windupdate.serveftp.com/wind/LTE/ JJ I-Indicator
2015-03-31 JJ O
http NN B-Indicator
: : I-Indicator
//119.network/lte/Internet-TIM-4G-LTE.apk JJ I-Indicator
http NN B-Indicator
: : I-Indicator
//119.network/lte/download.html NN I-Indicator

2015-02-04 JJ O
2015-07-20 JJ O
http NN B-Indicator
: : I-Indicator
//119.network/lte/Configuratore_TIM.apk JJ I-Indicator
2015-07-08 JJ O
Many NNP O
of IN O
these DT O
domains NNS O
are VBP O
outdated VBN O
, , O
but CC O
almost RB O
all DT O
( ( O
except IN O
one CD O
– NNP O
appPro_AC.apk NN B-Indicator
) ) O
samples NNS O
located VBN O
on IN O
the DT O
217.194.13.133 CD B-Indicator
server NN O
are VBP O
still RB O
accessible JJ O
. . O

All PDT O
the DT O
observed JJ O
landing NN O
pages NNS O
mimic VBP O
the DT O
mobile NN O
operators NNS O
’ VBP O
web NN O
pages NNS O
through IN O
their PRP$ O
domain NN O
name NN O
and CC O
web JJ O
page NN O
content NN O
as RB O
well RB O
. . O

Further JJ O
research NN O
of IN O
the DT O
attacker NN O
’ NNP O
s VBZ O
infrastructure NN O
revealed VBD O
more RBR O
related JJ O
mimicking NN O
domains NNS O
. . O

Unfortunately RB O
, , O
for IN O
now RB O
we PRP O
can MD O
’ VB O
t NNS O
say VBP O
in IN O
what WP O
environment NN O
these DT O
landing VBG O
pages NNS O
were VBD O
used VBN O
in IN O
the DT O
wild JJ O
, , O
but CC O
according VBG O
to TO O
all PDT O
the DT O
information NN O
at IN O
our PRP$ O
dsiposal NN O
, , O
we PRP O
can MD O
assume VB O
that IN O
they PRP O
are VBP O
perfect JJ O
for IN O
exploitation NN O
using VBG O
malicious JJ O
redirects NNS O
or CC O
man-in-the-middle JJ O
attacks NNS O
. . O

For IN O
example NN O
, , O
this DT O
could MD O
be VB O
when WRB O
the DT O
victim NN O
’ NNP O
s NN O
device NN O
connects NNS O
to TO O
a DT O
Wi-Fi JJ O
access NN O
point NN O
that WDT O
is VBZ O
infected VBN O
or CC O
controlled VBN O
by IN O
the DT O
attackers NNS O
. . O

Artifacts NNS O
During IN O
the DT O
research NN O
, , O
we PRP O
found VBD O
plenty NN O
of IN O
traces NNS O
of IN O
the DT O
developers NNS O
and CC O
those DT O
doing VBG O
the DT O
maintaining NN O
. . O

As IN O
already RB O
stated VBN O
in IN O
the DT O
‘ NNP O
malware NN O
features NNS O
’ VBP O
part NN O
, , O
there EX O
are VBP O
multiple JJ O
giveaways NNS O
in IN O
the DT O
code NN O
. . O

Here RB O
are VBP O
just RB O
some DT O
of IN O
them PRP O
: : O
ngglobal JJ O
– NN O
FirebaseCloudMessaging NNP O
topic NN O
name NN O
Issuer NNP O
: : O
CN NNP O
= NNP O
negg FW O
– NNP O
from IN O
several JJ O
certificates NNS O
negg.ddns JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
, , O
negg1.ddns JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
, , O
negg2.ddns JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
– NNP O
C NNP O
& CC O
C NNP O
servers NNS O
NG NNP O
SuperShell NNP O
– NNP O
string VBG O
from IN O
the DT O
reverse NN O
shell NN O
payload NN O
ngg JJ O
– NNP O
prefix NN O
in IN O
commands NNS O
names NNS O
of IN O
the DT O
implant NN O
for IN O
Windows NNP B-System
Signature NNP O
with IN O
specific JJ O
issuer NN O
Whois NNP O
records NNS O
and CC O
IP NNP O
relationships NNS O
provide VBP O
many JJ O
interesting JJ O
insights NNS O
as RB O
well RB O
. . O

There EX O
are VBP O
a DT O
lot NN O
of IN O
other JJ O
‘ NNP O
Negg NNP O
’ NNP O
mentions NNS O
in IN O
Whois NNP O
records NNS O
and CC O
references NNS O
to TO O
it PRP O
. . O

For IN O
example NN O
: : O
Conclusions NNPS O
The DT O
Skygofree NNP B-Malware
Android NNP B-System
implant NN O
is VBZ O
one CD O
of IN O
the DT O
most RBS O
powerful JJ O
spyware NN O
tools NNS O
that IN O
we PRP O
have VBP O
ever RB O
seen VBN O
for IN O
this DT O
platform NN O
. . O

As IN O
a DT O
result NN O
of IN O
the DT O
long-term JJ O
development NN O
process NN O
, , O
there EX O
are VBP O
multiple JJ O
, , O
exceptional JJ O
capabilities NNS O
: : O
usage NN O
of IN O
multiple JJ O
exploits NNS O
for IN O
gaining VBG O
root NN O
privileges NNS O
, , O
a DT O
complex JJ O
payload NN O
structure NN O
, , O
never-before-seen JJ O
surveillance NN O
features NNS O
such JJ O
as IN O
recording VBG O
surrounding VBG O
audio NN O
in IN O
specified JJ O
locations NNS O
. . O

Given VBN O
the DT O
many JJ O
artifacts NNS O
we PRP O
discovered VBD O
in IN O
the DT O
malware NN O
code NN O
, , O
as RB O
well RB O
as IN O
infrastructure NN O
analysis NN O
, , O
we PRP O
are VBP O
pretty JJ O
confident JJ O
that IN O
the DT O
developer NN O
of IN O
the DT O
Skygofree NNP B-Malware
implants NNS O
is VBZ O
an DT O
Italian JJ O
IT NNP O
company NN O
that WDT O
works VBZ O
on IN O
surveillance NN O
solutions NNS O
, , O
just RB O
like IN O
HackingTeam NNP B-Organization
. . O

HenBox NN B-Malware
: : O
The DT O
Chickens NNP O
Come NNP O
Home NNP O
to TO O
Roost NNP O
March NNP O
13 CD O
, , O
2018 CD O
at IN O
5:00 CD O
AM NNP O
Unit NNP O
42 CD O
recently RB O
discovered VBD O
a DT O
new JJ O
Android NNP B-System
malware NN O
family NN O
we PRP O
named VBD O
“ NNP O
HenBox NNP B-Malware
” NNP O
masquerading VBG O
as IN O
a DT O
variety NN O
of IN O
legitimate JJ O
Android NNP B-System
apps NN O
. . O

We PRP O
chose VBD O
the DT O
name NN O
“ NNP O
HenBox NNP B-Malware
” NNP O
based VBN O
on IN O
metadata NNS O
found VBN O
in IN O
most JJS O
of IN O
the DT O
malicious JJ O
apps NN O
such JJ O
as IN O
package NN O
names NNS O
and CC O
signer NN O
detail NN O
. . O

HenBox NNP B-Malware
masquerades NNS O
as IN O
apps NN O
such JJ O
as IN O
VPN NNP O
and CC O
Android NNP B-System
system NN O
apps NN O
and CC O
often RB O
installs VBZ O
legitimate JJ O
versions NNS O
of IN O
these DT O
apps NNS O
along IN O
with IN O
HenBox NNP B-Malware
to TO O
trick VB O
users NNS O
into IN O
thinking VBG O
they PRP O
downloaded VBD O
the DT O
legitimate JJ O
app NN O
. . O

While IN O
some DT O
of IN O
the DT O
legitimate JJ O
apps NN O
HenBox NNP B-Malware
use NN O
as IN O
decoys NNS O
can MD O
be VB O
found VBN O
on IN O
Google NNP B-System
Play NNP I-System
, , O
HenBox NNP B-Malware
apps VBP O
themselves PRP O
have VBP O
only RB O
been VBN O
found VBN O
on IN O
third-party JJ O
( ( O
non-Google JJ O
Play NNP B-System
) ) O
app NN O
stores NNS O
. . O

HenBox NNP B-Malware
appears VBZ O
to TO O
primarily RB O
target VB O
the DT O
Uyghurs NNP O
– VBZ O
a DT O
minority NN O
Turkic NNP O
ethnic JJ O
group NN O
that WDT O
is VBZ O
primarily RB O
Muslim NNP O
and CC O
lives VBZ O
mainly RB O
in IN O
the DT O
Xinjiang NNP O
Uyghur NNP O
Autonomous NNP O
Region NNP O
in IN O
North NNP O
West NNP O
China NNP O
. . O

It PRP O
also RB O
targets VBZ O
devices NNS O
made VBN O
by IN O
Chinese JJ O
manufacturer NN O
Xiaomi NNP B-Organization
and CC O
those DT O
running VBG O
MIUI NNP B-System
, , O
an DT O
operating NN O
system NN O
based VBN O
on IN O
Google NNP B-System
Android NNP I-System
made VBN O
by IN O
Xiaomi NNP B-Organization
. . O

Smartphones NNS O
are VBP O
the DT O
dominant JJ O
form NN O
of IN O
internet JJ O
access NN O
in IN O
the DT O
region NN O
and CC O
Xinjiang NNP O
was VBD O
recently RB O
above IN O
the DT O
national JJ O
average NN O
of IN O
internet NN O
users NNS O
in IN O
China NNP O
. . O

The DT O
result NN O
is VBZ O
a DT O
large JJ O
online JJ O
population NN O
who WP O
have VBP O
been VBN O
the DT O
subject NN O
of IN O
numerous JJ O
cyber-attacks NNS O
in IN O
the DT O
past NN O
. . O

Once RB O
installed VBN O
, , O
HenBox NNP B-Malware
steals VBZ O
information NN O
from IN O
the DT O
devices NNS O
from IN O
a DT O
myriad NN O
of IN O
sources NNS O
, , O
including VBG O
many JJ O
mainstream NN O
chat NN O
, , O
communication NN O
, , O
and CC O
social JJ O
media NNS O
apps NN O
. . O

The DT O
stolen VBN O
information NN O
includes VBZ O
personal JJ O
and CC O
device JJ O
information NN O
. . O

Of IN O
note NN O
, , O
in IN O
addition NN O
to TO O
tracking VBG O
the DT O
compromised JJ O
device NN O
’ NNP O
s NN O
location NN O
, , O
HenBox NNP B-Malware
also RB O
harvests VBZ O
all DT O
outgoing VBG O
phone NN O
numbers NNS O
with IN O
an DT O
“ JJ O
86 CD O
” JJ O
prefix NN O
, , O
which WDT O
is VBZ O
the DT O
country NN O
code NN O
for IN O
the DT O
People NNP O
’ NNP O
s VBZ O
Republic NNP O
of IN O
China NNP O
( ( O
PRC NNP O
) ) O
. . O

It PRP O
can MD O
also RB O
access NN O
the DT O
phone NN O
’ NNP O
s NN O
cameras NNS O
and CC O
microphone NN O
. . O

HenBox NNP B-Malware
has VBZ O
ties NNS O
to TO O
infrastructure NN O
used VBN O
in IN O
targeted JJ O
attacks NNS O
with IN O
a DT O
focus NN O
on IN O
politics NNS O
in IN O
South NNP O
East NNP O
Asia NNP O
. . O

These DT O
attackers NNS O
have VBP O
used VBN O
additional JJ O
malware NN O
families NNS O
in IN O
previous JJ O
activity NN O
dating VBG O
to TO O
at IN O
least JJS O
2015 CD O
that WDT O
include VBP O
PlugX NNP B-Malware
, , O
Zupdax NNP B-Malware
, , O
9002 CD B-Malware
, , O
and CC O
Poison NNP B-Malware
Ivy NNP I-Malware
. . O

This DT O
also RB O
aligns VBZ O
with IN O
HenBox NNP B-Malware
’ NNP O
s FW O
timeline NN O
, , O
as IN O
in IN O
total NN O
we PRP O
have VBP O
identified VBN O
almost RB O
200 CD O
HenBox NNP B-Malware
samples NNS O
, , O
with IN O
the DT O
oldest JJS O
dating NN O
to TO O
2015 CD O
. . O

Most JJS O
of IN O
the DT O
samples NNS O
we PRP O
found VBD O
date NN O
from IN O
the DT O
last JJ O
half NN O
of IN O
2017 CD O
, , O
fewer JJR O
samples NNS O
date NN O
from IN O
2016 CD O
, , O
and CC O
a DT O
handful NN O
date NN O
back RB O
to TO O
2015 CD O
. . O

In IN O
2018 CD O
, , O
we PRP O
have VBP O
already RB O
observed VBN O
a DT O
small JJ O
but CC O
consistent JJ O
number NN O
of IN O
samples NNS O
. . O

We PRP O
believe VBP O
this DT O
indicates VBZ O
a DT O
fairly RB O
sustained VBN O
campaign NN O
that WDT O
has VBZ O
gained VBN O
momentum NN O
over IN O
recent JJ O
months NNS O
. . O

HenBox NNP B-Malware
Enters NNP O
the DT O
Uyghur NNP B-System
App NNP I-System
Store NNP I-System
In IN O
May NNP O
2016 CD O
, , O
a DT O
HenBox NNP B-Malware
app NN O
was VBD O
downloaded VBN O
from IN O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
. . O

Specifically RB O
, , O
the DT O
app NN O
was VBD O
an DT O
Android JJ B-System
Package NN I-System
( ( O
APK NNP O
) ) O
file NN O
that WDT O
will MD O
be VB O
discussed VBN O
in IN O
more JJR O
detail NN O
shortly RB O
. . O

The DT O
domain NN O
name NN O
, , O
language NN O
of IN O
the DT O
site NN O
and CC O
app JJ O
content NN O
hosted VBD O
suggest JJS O
this DT O
site NN O
is VBZ O
a DT O
third-party JJ O
app NN O
store NN O
for IN O
whom WP O
the DT O
intended JJ O
users NNS O
are VBP O
the DT O
Uyghurs NNP O
. . O

Such JJ O
app NN O
stores NNS O
are VBP O
so-called JJ O
because IN O
they PRP O
are VBP O
not RB O
officially RB O
supported VBN O
by IN O
Android NNP B-System
, , O
nor CC O
are VBP O
they PRP O
provided VBN O
by IN O
Google NNP B-Organization
, , O
unlike IN O
the DT O
Play NNP B-System
Store NNP I-System
. . O

Third-party JJ O
app NN O
stores NNS O
are VBP O
ubiquitous JJ O
in IN O
China NNP O
for IN O
a DT O
number NN O
of IN O
reasons NNS O
including VBG O
: : O
evermore RB O
powerful JJ O
Chinese JJ B-Organization
Original NNP I-Organization
Equipment NNP I-Organization
Manufacturers NNP I-Organization
( ( I-Organization
OEM NNP I-Organization
) ) I-Organization
, , O
a DT O
lack NN O
of IN O
an DT O
official JJ O
Chinese JJ O
Google NNP B-System
Play NNP I-System
app RB O
store NN O
, , O
and CC O
a DT O
growing VBG O
smartphone NN O
market NN O
. . O

The DT O
HenBox NNP B-Malware
app NN O
downloaded VBD O
in IN O
May NNP O
2016 CD O
was VBD O
masquerading VBG O
as IN O
the DT O
DroidVPN NNP B-Indicator
app NN O
. . O

At IN O
the DT O
time NN O
of IN O
writing NN O
, , O
the DT O
content NN O
served VBD O
at IN O
the DT O
given VBN O
URL NNP O
on IN O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
, , O
is VBZ O
now RB O
a DT O
legitimate JJ O
version NN O
of IN O
the DT O
DroidVPN NNP B-Indicator
app NN O
, , O
and CC O
looks VBZ O
as IN O
shown VBN O
in IN O
Figure NNP O
1 CD O
below NN O
. . O

henbox_2 JJ O
Figure NNP O
1 CD O
Uyghurapps NNP B-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
app NN O
store NN O
showing VBG O
the DT O
current JJ O
DroidVPN NNP B-Indicator
app NN O
Virtual NNP O
Private NNP O
Network NNP O
( ( O
VPN NNP O
) ) O
tools VBZ O
allow JJ O
connections NNS O
to TO O
remote VB O
private JJ O
networks NNS O
, , O
increasing VBG O
the DT O
security NN O
and CC O
privacy NN O
of IN O
the DT O
user NN O
’ NNP O
s NN O
communications NNS O
. . O

According VBG O
to TO O
the DT O
DroidVPN NNP B-Indicator
app NN O
description NN O
, , O
it PRP O
“ VBZ O
helps VBZ O
bypass VB O
regional JJ O
internet NN O
restrictions NNS O
, , O
web JJ O
filtering NN O
and CC O
firewalls NNS O
by IN O
tunneling VBG O
traffic NN O
over IN O
ICMP. NNP O
” NNP O
Some DT O
features NNS O
may MD O
require VB O
devices NNS O
to TO O
be VB O
rooted VBN O
to TO O
function NN O
and CC O
according VBG O
to TO O
some DT O
3rd CD O
party NN O
app NN O
stores NNS O
, , O
unconditional JJ O
rooting NN O
is VBZ O
required VBN O
, , O
which WDT O
has VBZ O
additional JJ O
security NN O
implications NNS O
for IN O
the DT O
device NN O
. . O

We PRP O
have VBP O
not RB O
been VBN O
able JJ O
to TO O
ascertain VB O
how WRB O
the DT O
DroidVPN NNP B-Indicator
app NN O
on IN O
the DT O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
app NN O
store NN O
was VBD O
replaced VBN O
with IN O
the DT O
malicious JJ O
HenBox NNP B-Malware
app NN O
; : O
however RB O
, , O
some DT O
indicators NNS O
point VBP O
to TO O
the DT O
server NN O
running VBG O
an DT O
outdated JJ O
version NN O
of IN O
Apache NNP O
Web NNP O
Server NNP O
on IN O
a DT O
Windows NNP B-System
32-Bit CD O
operating NN O
system NN O
. . O

In IN O
light NN O
of IN O
this DT O
, , O
we PRP O
believe VBP O
an DT O
attack NN O
against IN O
unpatched JJ B-Vulnerability
vulnerabilities NNS I-Vulnerability
is VBZ O
a DT O
reasonable JJ O
conjecture NN O
for IN O
how WRB O
the DT O
server NN O
was VBD O
compromised VBN O
. . O

The DT O
HenBox NNP O
app NN O
downloaded VBD O
in IN O
May NNP O
2016 CD O
, , O
as IN O
described VBN O
in IN O
Table JJ O
1 CD O
below IN O
, , O
masquerades NNS O
as IN O
a DT O
legitimate JJ O
version NN O
of IN O
the DT O
DroidVPN NNP B-Indicator
app NN O
by IN O
using VBG O
the DT O
same JJ O
app NN O
name NN O
“ NNP O
DroidVPN NNP B-System
” NNP O
and CC O
the DT O
same JJ O
iconography NN O
used VBN O
when WRB O
displaying VBG O
the DT O
app NN O
in IN O
Android NNP B-System
’ NNP O
s VBD O
launcher JJR O
view NN O
, , O
as IN O
highlighted VBN O
in IN O
Figure NNP O
2 CD O
below IN O
Table JJ O
1 CD O
. . O

APK NNP O
SHA256 NNP O
Size NNP O
( ( O
bytes NNS O
) ) O
First NNP O
Seen NNP O
App NNP O
Package NNP O
name NN O
App NNP O
name NN O
0589bed1e3b3d6234c30061be3be1cc6685d786ab3a892a8d4dae8e2d7ed92f7 CD B-Indicator
2,740,860 CD O
May NNP O
2016 CD O
com.android.henbox NN B-Indicator
DroidVPN NNP B-System
Table NNP O
1 CD O
Details NNP O
of IN O
the DT O
HenBox NNP B-Malware
DroidVPN NNP B-System
app NN O
on IN O
the DT O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
app NN O
store NN O
henbox_3 JJ O
Figure NNP O
2 CD O
HenBox NNP B-Malware
app NN O
installed VBD O
, , O
purporting VBG O
to TO O
be VB O
DroidVPN NNP B-Indicator
Depending VBG O
on IN O
the DT O
language NN O
setting VBG O
on IN O
the DT O
device NN O
, , O
and CC O
for IN O
this DT O
particular JJ O
variant NN O
of IN O
HenBox NNP B-Malware
, , O
the DT O
installed JJ O
HenBox NNP B-Malware
app NN O
may MD O
have VB O
the DT O
name NN O
“ NNP O
Backup NNP O
” NNP O
but CC O
uses VBZ O
the DT O
same JJ O
DroidVPN NNP B-Indicator
logo NN O
. . O

Other JJ O
variants NNS O
use IN O
other JJ O
names NNS O
and CC O
logos NNS O
, , O
as IN O
described VBN O
later RB O
. . O

Given VBN O
the DT O
DroidVPN NNP B-Indicator
look NN O
and CC O
feel VB O
being VBG O
used VBN O
by IN O
this DT O
variant NN O
of IN O
HenBox NNP B-Malware
, , O
it PRP O
’ VBZ O
s JJ O
highly RB O
likely JJ O
the DT O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
page NN O
for IN O
DroidVPN NNP B-Indicator
remained VBD O
identical JJ O
when WRB O
serving VBG O
either RB O
HenBox NNP B-Malware
or CC O
DroidVPN NNP B-Indicator
apps RB O
, , O
just RB O
that IN O
the DT O
legitimate JJ O
APK NNP O
file NN O
had VBD O
been VBN O
replaced VBN O
with IN O
HenBox NNP O
for IN O
an DT O
unknown JJ O
period NN O
of IN O
time NN O
. . O

In IN O
addition NN O
to TO O
the DT O
look NN O
and CC O
feel NN O
of IN O
DroidVPN NNP B-Indicator
, , O
this DT O
HenBox NNP B-Malware
variant NN O
also RB O
contained VBD O
a DT O
legitimate JJ O
DroidVPN NNP B-Indicator
app NN O
within IN O
its PRP$ O
APK NNP O
package NN O
as IN O
an DT O
asset NN O
, , O
which WDT O
could MD O
be VB O
compared VBN O
to TO O
a DT O
resource NN O
item NN O
within IN O
a DT O
Windows NNP B-System
Portable NNP I-System
Executable NNP I-System
( ( O
PE NNP O
) ) O
file NN O
. . O

Once RB O
the DT O
HenBox NNP B-Malware
app NN O
is VBZ O
installed VBN O
and CC O
launched VBN O
, , O
it PRP O
launches VBZ O
an DT O
install JJ O
process NN O
for IN O
the DT O
embedded JJ O
app NN O
as IN O
a DT O
decoy NN O
to TO O
other JJ O
malicious JJ O
behaviors NNS O
occurring VBG O
in IN O
the DT O
background NN O
, , O
and CC O
to TO O
satisfy VB O
the DT O
victim NN O
with IN O
the DT O
app NN O
they PRP O
were VBD O
requesting VBG O
, , O
assuming VBG O
they PRP O
requested VBD O
to TO O
download VB O
a DT O
particular JJ O
app NN O
, , O
such JJ O
as IN O
DroidVPN NNP B-System
. . O

The DT O
version NN O
of IN O
the DT O
legitimate JJ O
DroidVPN NNP B-Indicator
embedded VBD O
inside IN O
this DT O
HenBox NNP B-Malware
variant NN O
is VBZ O
the DT O
same JJ O
version NN O
of IN O
DroidVPN NNP B-Indicator
available JJ O
for IN O
download NN O
from IN O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
, , O
at IN O
the DT O
time NN O
of IN O
writing NN O
. . O

It PRP O
’ VBZ O
s JJ O
worth JJ O
noting NN O
, , O
newer JJR O
versions NNS O
of IN O
the DT O
DroidVPN NNP B-System
app NN O
are VBP O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
, , O
as RB O
well RB O
as IN O
in IN O
some DT O
other JJ O
third-party JJ O
app NN O
stores NNS O
, , O
which WDT O
could MD O
indicate VB O
uyghurapps JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
is VBZ O
not RB O
awfully RB O
well RB O
maintained VBN O
or CC O
updated VBN O
to TO O
the DT O
latest JJS O
apps NN O
available JJ O
. . O

At IN O
the DT O
time NN O
of IN O
writing NN O
, , O
to TO O
our PRP$ O
knowledge NN O
no DT O
other JJ O
third-party JJ O
app NN O
stores NNS O
, , O
nor CC O
the DT O
official JJ O
Google NNP B-System
Play NNP I-System
store NN O
, , O
were VBD O
or CC O
are VBP O
hosting VBG O
this DT O
malicious JJ O
HenBox NNP B-Malware
variant NN O
masquerading VBG O
as IN O
DroidVPN NNP B-Indicator
. . O

The DT O
Right NNP O
App NNP O
at IN O
the DT O
Right JJ O
Time NNP O
The DT O
malicious JJ O
HenBox NNP B-Malware
and CC O
embedded VBD O
DroidVPN NNP B-Indicator
app JJ O
combination NN O
is VBZ O
one CD O
instance NN O
of IN O
the DT O
type NN O
of IN O
legitimate JJ O
apps IN O
the DT O
attackers NNS O
choose VBP O
to TO O
mimic VB O
to TO O
compromise VB O
their PRP$ O
victims NNS O
. . O

These DT O
threat NN O
actors NNS O
frequently RB O
offer VBP O
malicious JJ O
apps NN O
purporting NN O
to TO O
be VB O
legitimate JJ O
apps NN O
that WDT O
are VBP O
broadly RB O
used VBN O
or CC O
important JJ O
to TO O
a DT O
targeted JJ O
population NN O
. . O

It PRP O
’ VBZ O
s JJ O
worth NN O
noting VBG O
however RB O
, , O
about IN O
one-third NN O
of IN O
the DT O
HenBox NNP B-Malware
apps NN O
contained VBD O
embedded JJ O
APK NNP O
objects VBZ O
that WDT O
did VBD O
not RB O
refer VB O
to TO O
legitimate VB O
apps NN O
. . O

Some DT O
were VBD O
only RB O
3 CD O
bytes NNS O
long RB O
, , O
containing VBG O
strings NNS O
such JJ O
as IN O
“ JJ O
ddd NN O
” NN O
and CC O
“ $ O
333 CD O
” NNP O
, , O
or CC O
were VBD O
otherwise RB O
corrupted VBN O
. . O

Beyond IN O
the DT O
previously RB O
mentioned VBN O
DroidVPN NNP B-Indicator
example NN O
, , O
other JJ O
viable JJ O
embedded VBN O
apps NN O
we PRP O
found VBD O
include VBP O
apps NNS O
currently RB O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
, , O
as RB O
well RB O
as IN O
many JJ O
third-party JJ O
app NN O
stores NNS O
. . O

Table JJ O
2 CD O
below IN O
lists NNS O
some DT O
of IN O
these DT O
apps NNS O
with IN O
their PRP$ O
respective JJ O
metadata NNS O
. . O

Sample JJ O
1 CD O
marks NNS O
the DT O
first JJ O
HenBox NNP B-Malware
sample NN O
we PRP O
saw VBD O
embedding VBG O
a DT O
legitimate JJ O
app NN O
within IN O
its PRP$ O
assets NNS O
to TO O
be VB O
dropped VBN O
and CC O
installed VBN O
on IN O
the DT O
victim NN O
device NN O
as IN O
a DT O
decoy NN O
. . O

The DT O
legitimate JJ O
app NN O
in IN O
question NN O
was VBD O
a DT O
Uyghur NNP O
language NN O
keyboard NN O
app NN O
targeted VBN O
at IN O
native JJ O
speakers NNS O
of IN O
the DT O
Uyghur NNP O
language NN O
and CC O
their PRP$ O
smartphones NNS O
. . O

Sample NN O
2 CD O
, , O
has VBZ O
the DT O
package NN O
name NN O
cn.android.setting VBG B-Indicator
masquerading VBG O
as IN O
Android NNP O
’ NNP O
s VBD O
Settings NNP B-System
app NN I-System
, , O
which WDT O
has VBZ O
a DT O
similar JJ O
package NN O
name NN O
( ( O
com.android.settings NNS B-Indicator
) ) O
. . O

This DT O
variant NN O
of IN O
HenBox NNP B-Malware
also RB O
used VBD O
the DT O
common JJ O
green JJ O
Android NNP B-System
figure NN O
as IN O
the DT O
app NN O
logo NN O
and CC O
was VBD O
named VBN O
设置 NNP O
( ( O
“ NNP O
Backup NNP O
” NNP O
in IN O
English NNP O
) ) O
. . O

This DT O
variant JJ O
’ NN O
s NN O
app NN O
name NN O
, , O
along IN O
with IN O
many JJ O
others NNS O
, , O
is VBZ O
written VBN O
in IN O
Chinese NNP O
and CC O
describes VBZ O
the DT O
app NN O
as IN O
a DT O
backup NN O
tool NN O
. . O

Please NNP O
see VB O
the DT O
IOCs NNP O
section NN O
for IN O
all DT O
app NN O
and CC O
package NN O
name NN O
combinations NNS O
. . O

Interestingly RB O
, , O
the DT O
embedded JJ O
app NN O
in IN O
sample JJ O
2 CD O
is VBZ O
not RB O
a DT O
version NN O
of IN O
the DT O
Android NNP B-System
Settings NNP I-System
app NN O
but CC O
instead RB O
the DT O
“ NNP O
Amaq NNP B-System
Agency NNP I-System
” NNP O
app NN O
, , O
which WDT O
reports VBZ O
on IN O
ISIS NNP O
related JJ O
news NN O
. . O

Reports NNS O
indicate VBP O
fake JJ O
versions NNS O
of IN O
the DT O
Amaq NNP B-System
app NN O
exist NN O
, , O
likely RB O
in IN O
order NN O
to TO O
spy VB O
on IN O
those DT O
that WDT O
use VBP O
it PRP O
. . O

A DT O
month NN O
after IN O
observing VBG O
sample JJ O
2 CD O
, , O
we PRP O
obtained VBD O
another DT O
which WDT O
used VBD O
the DT O
same JJ O
package NN O
name NN O
as IN O
sample NN O
2 CD O
( ( O
cn.android.setting VBG B-Indicator
) ) O
. . O

However RB O
, , O
this DT O
time NN O
the DT O
app NN O
name NN O
for IN O
both DT O
HenBox NNP B-Malware
and CC O
the DT O
embedded JJ O
app NN O
were VBD O
identical JJ O
: : O
Islamawazi NN B-System
. . O

Islamawazi NNP B-System
is VBZ O
also RB O
known VBN O
as IN O
the DT O
Turkistan NNP B-Organization
Islamic NNP I-Organization
Party NNP I-Organization
or CC O
“ NNP O
TIP NNP O
” NNP O
. . O

This DT O
organization NN O
was VBD O
formerly RB O
known VBN O
as IN O
the DT O
East NNP B-Organization
Turkestan NNP I-Organization
Islamic NNP I-Organization
Party NNP I-Organization
and CC O
is VBZ O
purported VBN O
to TO O
be VB O
an DT O
Islamic NNP O
extremist NN O
separatist NN O
organization NN O
founded VBN O
by IN O
Uyghur NNP O
jihadists NNS O
. . O

The DT O
embedded JJ O
app NN O
appears VBZ O
to TO O
be VB O
a DT O
media NNS O
player NN O
. . O

These DT O
examples NNS O
, , O
together RB O
with IN O
the DT O
HenBox NNP B-Malware
app NN O
placed VBD O
on IN O
a DT O
very RB O
specific JJ O
third-party JJ O
app NN O
store NN O
, , O
point NN O
clearly RB O
to TO O
at IN O
least JJS O
some DT O
of IN O
the DT O
intended JJ O
targets NNS O
of IN O
these DT O
malicious JJ O
apps NN O
being VBG O
Uyghurs NNP O
, , O
specifically RB O
those DT O
with IN O
interest NN O
in IN O
or CC O
association NN O
with IN O
terrorist JJ O
groups NNS O
. . O

These DT O
threat NN O
actors NNS O
appear VBP O
to TO O
be VB O
choosing VBG O
the DT O
right JJ O
apps NN O
– NNP O
those DT O
that WDT O
could MD O
be VB O
popular JJ O
with IN O
locals NNS O
in IN O
the DT O
region NN O
, , O
at IN O
the DT O
right JJ O
time NN O
– NNP O
while IN O
tensions NNS O
grow VBP O
in IN O
this DT O
region NN O
of IN O
China NNP O
, , O
to TO O
ensure VB O
a DT O
good JJ O
victim NN O
install-base NN O
. . O

HenBox NNP B-Malware
Roosts NNP O
HenBox NNP B-Malware
has VBZ O
evolved VBN O
over IN O
the DT O
past JJ O
three CD O
years NNS O
, , O
and CC O
of IN O
the DT O
almost RB O
two CD O
hundred VBD O
HenBox NNP B-Malware
apps NN O
in IN O
AutoFocus NNP O
, , O
the DT O
vast JJ O
majority NN O
contain VBP O
several JJ O
native JJ O
libraries NNS O
as RB O
well RB O
as IN O
other JJ O
components NNS O
in IN O
order NN O
to TO O
achieve VB O
their PRP$ O
objective NN O
. . O

Most JJS O
components NNS O
are VBP O
obfuscated VBN O
in IN O
some DT O
way NN O
, , O
whether IN O
it PRP O
be VB O
simple JJ O
XOR NNP O
with IN O
a DT O
single-byte JJ O
key NN O
, , O
or CC O
through IN O
the DT O
use NN O
of IN O
ZIP NNP B-System
or CC O
Zlib NNP B-System
compression NN O
wrapped VBD O
with IN O
RC4 NNP O
encryption NN O
. . O

These DT O
components NNS O
are VBP O
responsible JJ O
for IN O
a DT O
myriad NN O
of IN O
functions NNS O
including VBG O
handling VBG O
decryption NN O
, , O
network NN O
communications NNS O
, , O
gaining VBG O
super-user JJ O
privileges NNS O
, , O
monitoring VBG O
system NN O
logs NNS O
, , O
loading VBG O
additional JJ O
Dalvik NNP O
code NN O
files NNS O
, , O
tracking VBG O
the DT O
device NN O
location NN O
and CC O
more JJR O
. . O

The DT O
remainder NN O
of IN O
this DT O
section NN O
describes VBZ O
at IN O
a DT O
high-level JJ O
what WP O
HenBox NNP O
is VBZ O
capable JJ O
of IN O
, , O
and CC O
how WRB O
it PRP O
operates VBZ O
. . O

The DT O
description NN O
is VBZ O
based VBN O
on IN O
analysis NN O
of IN O
the DT O
sample NN O
described VBD O
in IN O
Table JJ O
3 CD O
below IN O
, , O
which WDT O
was VBD O
of IN O
interest NN O
given VBN O
its PRP$ O
C2 NNP O
domain NN B-Indicator
mefound NN I-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
overlaps NNS O
with IN O
PlugX NNP B-Malware
, , O
Zupdax NNP B-Malware
, , O
and CC O
Poison NNP B-Malware
Ivy NNP I-Malware
malware NN O
families NNS O
discussed VBN O
in IN O
more RBR O
detail NN O
later RB O
. . O

SHA256 NNP O
Package NNP O
Name NNP O
App NNP O
Name NNP O
a6c7351b09a733a1b3ff8a0901c5bde VBZ B-Indicator
fdc3b566bfcedcdf5a338c3a97c9f249b JJ O
com.android.henbox NN B-Indicator
备份 NNP O
( ( O
Backup NNP O
) ) O
Table NNP O
3 CD O
HenBox NNP B-Malware
variant NN O
used VBN O
in IN O
description NN O
Once IN O
this DT O
variant NN O
of IN O
HenBox NNP B-Malware
is VBZ O
installed VBN O
on IN O
the DT O
victim NN O
’ NNP O
s NN O
device NN O
, , O
the DT O
app NN O
can MD O
be VB O
executed VBN O
in IN O
two CD O
different JJ O
ways NNS O
: : O
One CD O
method NN O
for IN O
executing VBG O
HenBox NNP B-Malware
is VBZ O
for IN O
the DT O
victim NN O
to TO O
launch VB O
the DT O
malicious JJ O
app NN O
( ( O
named VBN O
“ NNP O
Backup NNP O
” NNP O
, , O
in IN O

this DT O
instance NN O
) ) O
from IN O
the DT O
launcher JJR O
view NN O
on IN O
their PRP$ O
device NN O
, , O
as IN O
shown VBN O
in IN O
Figure NNP O
3 CD O
below NN O
. . O

This DT O
runs VBZ O
code NN O
in IN O
the DT O
onCreate NN O
( ( O
) ) O
method NN O
of IN O
the DT O
app NN O
’ NNP O
s VBZ O
MainActivity NNP O
class NN O
, , O
which WDT O
in IN O
effect NN O
is VBZ O
the DT O
program NN O
’ NNP O
s VBZ O
entry NN O
point NN O
. . O

This DT O
process NN O
is VBZ O
defined VBN O
in IN O
the DT O
app NN O
’ NNP O
s NN O
AndroidManifest.xml NNP O
config NN O
file NN O
, , O
as IN O
shown VBN O
in IN O
the DT O
following JJ O
snippet NN O
. . O

Doing VBG O
so RB O
executes VBZ O
code NN O
checking VBG O
if IN O
the DT O
device NN O
is VBZ O
manufactured VBN O
by IN O
Xiaomi NNP B-Organization
, , O
or CC O
if IN O
Xiaomi JJ B-Organization
’ NNP I-Organization
s NN I-Organization
fork NN O
of IN O
Android NNP B-System
is VBZ O
running VBG O
on IN O
the DT O
device NN O
. . O

Under IN O
these DT O
conditions NNS O
, , O
the DT O
app NN O
continues VBZ O
executing VBG O
and CC O
the DT O
intent NN O
of IN O
targeting VBG O
Xiaomi NNP B-Organization
devices NNS O
and CC O
users NNS O
could MD O
be VB O
inferred VBN O
, , O
however RB O
poorly RB O
written VBN O
code NN O
results NNS O
in IN O
execution NN O
in IN O
more RBR O
environments NNS O
than IN O
perhaps RB O
intended VBN O
; : O
further JJ O
checks NNS O
are VBP O
made VBN O
to TO O
ascertain VB O
whether IN O
the DT O
app NN O
is VBZ O
running VBG O
on IN O
an DT O
emulator NN O
, , O
perhaps RB O
to TO O
evade VB O
researcher NN O
analysis NN O
environments NNS O
. . O

Assuming VBG O
these DT O
checks NNS O
pass NN O
, , O
one CD O
of IN O
the DT O
main JJ O
ELF NNP O
libraries NNS O
is VBZ O
loaded VBN O
that IN O
orchestrates VBZ O
other JJ O
components NNS O
and CC O
provides VBZ O
functionality NN O
to TO O
the DT O
app NN O
’ NNP O
s NN O
Dalvik NNP O
code NN O
through IN O
the DT O
Java NNP O
Native NNP O
Interface NNP O
( ( O
JNI NNP O
) ) O
. . O

HenBox NNP B-Malware
checks VBZ O
whether IN O
this DT O
execution NN O
is VBZ O
its PRP$ O
first JJ O
by IN O
using VBG O
Android NNP B-System
’ NNP O
s NN O
shared VBD O
preferences NNS O
feature NN O
to TO O
persist VB O
XML NNP O
key-value JJ O
pair NN O
data NNS O
. . O

If IN O
it PRP O
is VBZ O
the DT O
first JJ O
execution NN O
, , O
and CC O
if IN O
the DT O
app NN O
’ NNP O
s VBZ O
path NN O
does VBZ O
not RB O
contain VB O
“ JJ O
/system/app NNP B-Indicator
” NNP O
( ( O
i.e NN O
. . O

HenBox NNP B-Malware
is VBZ O
not RB O
running VBG O
as IN O
a DT O
system NN O
app NN O
) ) O
, , O
another DT O
ELF NNP O
library NN O
is VBZ O
loaded VBN O
to TO O
aid VB O
with IN O
executing VBG O
super-user JJ O
commands NNS O
. . O

The DT O
second JJ O
method NN O
uses VBZ O
intents NNS O
, , O
broadcasts NNS O
, , O
and CC O
receivers NNS O
to TO O
execute VB O
HenBox NNP O
code NN O
. . O

Providing VBG O
the DT O
app NN O
has VBZ O
registered VBN O
an DT O
intent NN O
to TO O
process VB O
particular JJ O
events NNS O
from IN O
the DT O
system NN O
, , O
and CC O
one CD O
of IN O
said VBD O
events NNS O
occurs NNS O
, , O
HenBox NNP O
is VBZ O
effectively RB O
brought VBN O
to TO O
life NN O
through IN O
external JJ O
stimulus NN O
from IN O
another DT O
app NN O
on IN O
the DT O
system NN O
broadcasting VBG O
a DT O
request NN O
, , O
or CC O
the DT O
system NN O
itself PRP O
broadcasting VBG O
a DT O
particular JJ O
event NN O
has VBZ O
occurred VBN O
. . O

These DT O
intents NNS O
are VBP O
typically RB O
defined VBN O
statically RB O
in IN O
the DT O
app NN O
’ NNP O
s NN O
AndroidManifest.xml NNP O
config NN O
file NN O
; : O
some DT O
HenBox NNP B-Malware
variants NNS O
register VBP O
further JJ O
intents NNS O
from IN O
their PRP$ O
code NN O
at IN O
run-time NN O
. . O

Once RB O
a DT O
matching JJ O
intent NN O
is VBZ O
triggered VBN O
, , O
the DT O
respective JJ O
Receiver NNP O
code NN O
will MD O
be VB O
executed VBN O
, , O
leading VBG O
to TO O
other JJ O
HenBox NNP O
behaviors NNS O
being VBG O
launched VBN O
, , O
which WDT O
are VBP O
described VBN O
later RB O
. . O

Table JJ O
4 CD O
below IN O
lists NNS O
the DT O
intents NNS O
that WDT O
are VBP O
statically RB O
registered VBN O
in IN O
this DT O
HenBox NNP B-Malware
variant NN O
’ NNP O
s NN O
AndroidManifest.xml NNP O
config NN O
file NN O
, , O
together RB O
with IN O
a DT O
description NN O
of IN O
what WP O
that DT O
intent NN O
does VBZ O
, , O
and CC O
when WRB O
it PRP O
would MD O
be VB O
used VBN O
. . O

Depending VBG O
on IN O
the DT O
intent NN O
triggered VBD O
, , O
one CD O
of IN O
two CD O
Receivers NNS O
would MD O
be VB O
called VBN O
, , O
in IN O
this DT O
instance NN O
they PRP O
are VBP O
called VBN O
Boot NNP O
or CC O
Time NNP O
but CC O
the DT O
name NN O
is VBZ O
somewhat RB O
immaterial JJ O
. . O

Receiver NNP O
Intent NNP O
Name NNP O
Description NNP O
BootReceiver NNP O
android.intent.action.BOOT_COMPLETED NN B-Indicator
System NNP O
notification NN O
that IN O
the DT O
device NN O
has VBZ O
finished VBN O
booting NN O
. . O

android.intent.action.restart VB B-Indicator
A DT O
legacy NN O
intent NN O
used VBN O
to TO O
indicate VB O
a DT O
system NN O
restart NN O
. . O

android.intent.action.SIM_STATE_CHANGED NN B-Indicator
System NNP O
notification NN O
that IN O
the DT O
SIM NNP O
card NN O
has VBZ O
changed VBN O
or CC O
been VBN O
removed VBN O
. . O

android.intent.action.PACKAGE_INSTALL NN B-Indicator
System NNP O
notification NN O
that IN O
the DT O
download NN O
and CC O
eventual JJ O
installation NN O
of IN O
an DT O
app JJ O
package NN O
is VBZ O
happening VBG O
( ( O
this DT O
is VBZ O
deprecated VBN O
) ) O
android.intent.action.PACKAGE_ADDED NN B-Indicator
System NNP O
notification NN O
that IN O
a DT O
new JJ O
app NN O
package NN O
has VBZ O
been VBN O
installed VBN O
on IN O
the DT O
device NN O
, , O
including VBG O
the DT O
name NN O
of IN O
said VBD O
package NN O
. . O

com.xiaomi.smarthome.receive_alarm NN B-Indicator
Received VBD O
notifications NNS O
from IN O
Xiaomi NNP B-Organization
’ NNP O
s VBD O
smart JJ O
home NN O
IoT NNP O
devices NNS O
. . O

TimeReceiver RB O
android.intent.action.ACTION_TIME_CHANGED JJ B-Indicator
System NNP O
notification NN O
that IN O
the DT O
time NN O
was VBD O
set VBN O
. . O

android.intent.action.CONNECTIVITY_CHANGE NN B-Indicator
System NNP O
notification NN O
that IN O
a DT O
change NN O
in IN O
network NN O
connectivity NN O
has VBZ O
occurred VBN O
, , O
either DT O
lost VBD O
or CC O
established VBN O
. . O

Since IN O
Android NNP B-System
version NN O
7 CD O
( ( O
Nougat NNP B-System
) ) O
this DT O
information NN O
is VBZ O
gathered VBN O
using VBG O
other JJ O
means NNS O
, , O
perhaps RB O
inferring VBG O
the DT O
devices NNS O
used VBN O
by IN O
potential JJ O
victim NN O
run VBN O
older JJR O
versions NNS O
of IN O
Android NNP B-System
. . O

Table JJ O
4 CD O
HenBox NNP B-Malware
variant NN O
's POS O
Intents NNS O
and CC O
Receivers NNPS O
Most JJS O
of IN O
the DT O
intents NNS O
registered VBN O
in IN O
the DT O
AndroidManifest.xml NNP O
file NN O
, , O
or CC O
loaded VBD O
during IN O
run-time NN O
, , O
are VBP O
commonly RB O
found VBN O
in IN O
malicious JJ O
Android NNP B-System
apps NN O
. . O

What WP O
’ VBD O
s PRP O
more RBR O
interesting JJ O
, , O
and CC O
much RB O
less JJR O
common JJ O
, , O
is VBZ O
the DT O
inclusion NN O
of IN O
the DT O
com.xiaomi.smarthome.receive_alarm NN B-Indicator
intent NN O
filter NN O
. . O

Xiaomi NN B-Organization
, , O
a DT O
privately RB O
owned VBN O
Chinese JJ O
electronics NNS O
and CC O
software NN O
company NN O
, , O
is VBZ O
the DT O
5th JJ O
largest JJS O
smart JJ O
phone NN O
manufacturer NN O
in IN O
the DT O
world NN O
and CC O
also RB O
manufactures VBZ O
IoT NNP O
devices NNS O
for IN O
the DT O
home NN O
. . O

Most JJS O
devices NNS O
can MD O
be VB O
controlled VBN O
by IN O
Xiaomi NNP B-Organization
’ NNP O
s VBD O
“ NNP O
MiHome NNP B-System
” NNP O
Android NNP B-System
app NN O
, , O
which WDT O
is VBZ O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
with IN O
between IN O
1,000,000 CD O
and CC O
5,000,000 CD O
downloads NNS O
. . O

Given VBN O
the DT O
nature NN O
of IN O
connected JJ O
devices NNS O
in IN O
smart JJ O
homes NNS O
, , O
it PRP O
’ VBZ O
s JJ O
highly RB O
likely JJ O
many JJ O
of IN O
these DT O
devices NNS O
, , O
and CC O
indeed RB O
the DT O
controller NN O
app NN O
itself PRP O
, , O
communicate NN O
with IN O
one CD O
another DT O
sending NN O
status NN O
notifications NNS O
, , O
alerts NNS O
and CC O
so RB O
on IN O
. . O

Such JJ O
notifications NNS O
would MD O
be VB O
received VBN O
by IN O
the DT O
MiHome NNP B-System
app NN O
or CC O
any DT O
other JJ O
, , O
such JJ O
as IN O
HenBox NNP B-Malware
, , O
so RB O
long RB O
as IN O
they PRP O
register VBP O
their PRP$ O
intent NN O
to TO O
do VB O
so RB O
. . O

This DT O
could MD O
essentially RB O
allow VB O
for IN O
external JJ O
devices NNS O
to TO O
act VB O
as IN O
a DT O
trigger NN O
to TO O
execute VB O
the DT O
malicious JJ O
HenBox NNP B-Malware
code NN O
, , O
or CC O
perhaps RB O
afford JJ O
additional JJ O
data NNS O
HenBox NNP B-Malware
can MD O
collect VB O
and CC O
exfiltrate VB O
. . O

Either DT O
method NN O
to TO O
load VB O
HenBox NNP B-Malware
ultimately RB O
results NNS O
in IN O
an DT O
instance NN O
of IN O
a DT O
service NN O
being VBG O
launched VBN O
. . O

This DT O
service NN O
hides VBZ O
the DT O
app NN O
from IN O
plain NN O
sight NN O
and CC O
loads VBZ O
another DT O
ELF NNP O
library NN O
to TO O
gather VB O
environmental JJ O
information NN O
about IN O
the DT O
device NN O
, , O
such JJ O
as IN O
running VBG O
processes NNS O
and CC O
apps NN O
, , O
and CC O
details NNS O
about IN O
device NN O
hardware NN O
, , O
primarily RB O
through IN O
parsing VBG O
system NN O
logs NNS O
and CC O
querying VBG O
running VBG O
processes NNS O
. . O

The DT O
service NN O
continues VBZ O
by IN O
loading VBG O
an DT O
ELF NNP O
, , O
created VBN O
by IN O
Baidu NNP B-Organization
, , O
which WDT O
is VBZ O
capable JJ O
of IN O
tracking VBG O
the DT O
device NN O
location NN O
before IN O
setting VBG O
up RP O
a DT O
monitor NN O
to TO O
harvest VB O
phone NN O
numbers NNS O
associated VBN O
with IN O
outgoing VBG O
calls NNS O
for IN O
those DT O
numbers NNS O
with IN O
a DT O
country NN O
code NN O
“ NNP O
+86 NNP O
” NNP O
prefix NN O
, , O
which WDT O
relates VBZ O
to TO O
the DT O
People NNP O
’ NNP O
s VBZ O
Republic NNP O
of IN O
China NNP O
. . O

Further JJ O
assets NNS O
are VBP O
decrypted VBN O
and CC O
deployed VBN O
, , O
including VBG O
another DT O
Dalvik NNP O
DEX NNP O
code NN O
file NN O
, , O
which WDT O
has VBZ O
various JJ O
capabilities NNS O
including VBG O
registering VBG O
itself PRP O
as IN O
the DT O
incoming NN O
SMS NNP O
handler NN O
for IN O
the DT O
device NN O
to TO O
intercept VB O
SMS NNP O
messages NNS O
, , O
loading VBG O
another DT O
ELF NNP O
library NN O
that WDT O
includes VBZ O
a DT O
version NN O
of IN O
BusyBox NNP B-System
- : O
a DT O
package NN O
containing VBG O
various JJ O
stripped-down JJ O
Unix NNP O
tools NNS O
useful JJ O
for IN O
administering VBG O
such JJ O
systems NNS O
– NNP O
and CC O
, , O
interestingly RB O
, , O
is VBZ O
capable JJ O
of IN O
turning VBG O
off RP O
the DT O
sound NN O
played VBD O
when WRB O
the DT O
device NN O
’ NNP O
s NN O
cameras NNS O
take VBP O
pictures NNS O
. . O

The DT O
Android NNP B-System
permissions NNS O
requested VBN O
by IN O
HenBox NNP B-Malware
, , O
as IN O
defined VBN O
in IN O
the DT O
apps NN O
’ NNP O
AndroidManifest.xml NNP O
files NNS O
, , O
range NN O
from IN O
accessing VBG O
location NN O
and CC O
network NN O
settings NNS O
to TO O
messages NNS O
, , O
call NN O
, , O
and CC O
contact NN O
data NNS O
. . O

HenBox NNP B-Malware
can MD O
also RB O
access NN O
sensors NNS O
such JJ O
as IN O
the DT O
device NN O
camera NN O
( ( O
s NN O
) ) O
and CC O
the DT O
microphone NN O
. . O

Beyond IN O
the DT O
Android NNP B-System
app NN O
itself PRP O
, , O
other JJ O
components NNS O
such JJ O
as IN O
the DT O
aforementioned JJ O
ELF NNP O
libraries NNS O
have VBP O
additional JJ O
data-stealing NN O
capabilities NNS O
. . O

One CD O
ELF NNP O
library NN O
, , O
libloc4d.so NN B-Indicator
, , O
handles NNS O
amongst VBP O
other JJ O
things NNS O
the DT O
loading NN O
of IN O
the DT O
app-decoded JJ O
ELF NNP O
library NN O
file NN O
“ NNP O
sux NN O
” NN O
, , O
as RB O
well RB O
as IN O
handling VBG O
connectivity NN O
to TO O
the DT O
C2 NNP O
. . O

The DT O
sux NN O
library JJ O
appears VBZ O
to TO O
be VB O
a DT O
customized JJ O
super NN O
user NN O
( ( O
su NN O
) ) O
tool NN O
that WDT O
includes VBZ O
code NN O
from IN O
the DT O
com.koushikdutta.superuser NN B-Indicator
app NN O
and CC O
carries VBZ O
the DT O
equivalent NN O
of IN O
a DT O
super JJ O
user NN O
( ( O
su NN O
) ) O
binary NN O
in IN O
order NN O
to TO O
run VB O
privileged JJ O
commands NNS O
on IN O
the DT O
system NN O
. . O

The DT O
primary JJ O
goal NN O
of IN O
sux NN O
appears VBZ O
to TO O
be VB O
steal JJ O
messages NNS O
and CC O
other JJ O
data NNS O
from IN O
popular JJ O
messaging NN O
and CC O
social JJ O
media NNS O
apps RB O
specified VBD O
within IN O
the DT O
HenBox NNP B-Malware
sample NN O
. . O

A DT O
similar JJ O
tool NN O
, , O
with IN O
the DT O
same JJ O
filename NN O
, , O
has VBZ O
been VBN O
discussed VBN O
in IN O
previous JJ O
research NN O
but CC O
the DT O
SpyDealer NNP B-Malware
malware NN O
appears VBZ O
unrelated JJ O
to TO O
HenBox NNP B-Malware
. . O

More RBR O
likely JJ O
, , O
this DT O
is VBZ O
a DT O
case NN O
of IN O
common JJ O
attack NN O
tools NNS O
being VBG O
re-used JJ O
between IN O
different JJ O
threat NN O
actor NN O
groups NNS O
. . O

This DT O
particular JJ O
HenBox NNP B-Malware
variant NN O
, , O
as IN O
listed VBN O
in IN O
Table JJ O
3 CD O
above IN O
, , O
harvests NNS O
data VBP O
from IN O
two CD O
popular JJ O
messaging NN O
and CC O
social JJ O
media NNS O
apps NN O
: : O
Voxer NNP B-System
Walkie NNP B-System
Talkie NNP I-System
Messenger NNP B-System
( ( O
com.rebelvox.voxer NN B-Indicator
) ) O
and CC O
Tencent NNP B-Organization
’ NNP O
s VBD O
WeChat NNP B-System
( ( O
com.tencent.mm NN B-Indicator
) ) O
. . O

These DT O
types NNS O
of IN O
apps NN O
tend VBP O
to TO O
store VB O
their PRP$ O
data NNS O
in IN O
databases NNS O
and CC O
, , O
as IN O
an DT O
example NN O
, , O
HenBox NNP B-Malware
accesses VBZ O
Voxer NNP O
’ NNP O
s VBD O
database NN O
from IN O
the DT O
file NN O
“ NNP O
/data/data/com.rebelvox.voxer/databases/rv.db NNP B-Indicator
” NNP O
. . O

Once RB O
opened VBN O
, , O
HenBox NNP B-Malware
runs VBZ O
the DT O
following JJ O
query NN O
to TO O
gather VB O
message NN O
information NN O
. . O

Not RB O
long RB O
after IN O
this DT O
variant NN O
was VBD O
public JJ O
, , O
newer JJR O
variants NNS O
of IN O
HenBox NNP B-Malware
were VBD O
seen VBN O
, , O
and CC O
some DT O
had VBD O
significant JJ O
increases NNS O
in IN O
the DT O
number NN O
of IN O
targeted JJ O
apps NN O
. . O

Table JJ O
5 CD O
describes VBZ O
the DT O
latest JJS O
variant NN O
seen VBN O
in IN O
AutoFocus NNP O
. . O

SHA256 NNP O
Package NNP O
Name NNP O
App NNP O
Name NNP O
First NNP O
Seen NNP O
07994c9f2eeeede199dd6b4e760fce3 CD B-Indicator
71f03f3cc4307e6551c18d2fbd024a24f CD B-Indicator
com.android.henbox NN B-Indicator
备份 NNP O
( ( O
Backup NNP O
) ) O
January NNP O
3rd CD O
2018 CD O
Table JJ O
6 CD O
contains VBZ O
an DT O
updated JJ O
list NN O
of IN O
targeted JJ O
apps NN O
from IN O
which WDT O
this DT O
newer NN O
variant NN O
of IN O
HenBox NNP B-Malware
is VBZ O
capable JJ O
of IN O
harvesting VBG O
data NNS O
. . O

Interestingly RB O
, , O
the DT O
two CD O
communication NN O
apps NNS O
described VBN O
above IN O
as IN O
being VBG O
targeted VBN O
by IN O
the DT O
HenBox NNP O
variant NN O
listed VBN O
in IN O
Table JJ O
3 CD O
do VBP O
not RB O
appear VB O
in IN O
this DT O
updated JJ O
list NN O
. . O

Package NN O
Name NNP O
App NNP O
Name NNP O
com.whatsapp NN B-Indicator
WhatsApp NNP B-System
Messenger NNP B-System
com.pugna.magiccall NN B-Indicator
n/a RB O
org.telegram.messenger JJ B-Indicator
Telegram NNP B-System
com.facebook.katana NN B-Indicator
Facebook NNP B-System
com.twitter.android NN B-Indicator
Twitter NNP B-System
jp.naver.line.android NN B-Indicator
LINE NNP B-System
: : O
Free NNP O
Calls NNP O
& CC O
Messages NNP O
com.instanza.cocovoice NN B-Indicator
Coco NNP O
com.beetalk NN B-Indicator
BeeTalk NNP B-System
com.gtomato.talkbox NN B-Indicator
TalkBox NNP B-System
Voice NNP O
Messenger NNP B-System
- : O
PTT NNP O
com.viber.voip VBZ B-Indicator
Viber NNP B-System
Messenger NNP B-System
com.immomo.momo NN B-Indicator
MOMO陌陌 NNP B-System
com.facebook.orca NN B-Indicator
Messenger NNP B-System
– NNP O
Text NNP O
and CC O
Video NNP O
Chat NNP O
for IN O
Free NNP O
com.skype.rover NN B-Indicator

Skype NNP B-System
; : O
3rd CD O
party NN O
stores NNS O
only RB O
Most JJS O
of IN O
these DT O
apps NNS O
are VBP O
well RB O
established VBN O
and CC O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
, , O
however RB O
, , O
com.skype.rover NN B-Indicator
appears VBZ O
to TO O
be VB O
available JJ O
only RB O
on IN O
third-party JJ O
app NN O
stores NNS O
. . O

The DT O
same JJ O
is VBZ O
likely JJ O
to TO O
be VB O
the DT O
case NN O
for IN O
com.pugna.magiccall NN B-Indicator
but CC O
this DT O
is VBZ O
unknown JJ O
currently RB O
. . O

It PRP O
’ VBZ O
s JJ O
clear JJ O
to TO O
see VB O
that IN O
the DT O
capabilities NNS O
of IN O
HenBox NNP B-Malware
are VBP O
very RB O
comprehensive JJ O
, , O
both DT O
in IN O
terms NNS O
of IN O
an DT O
Android NNP B-System
app NN O
with IN O
its PRP$ O
native JJ O
libraries NNS O
and CC O
given VBN O
the DT O
amount NN O
of IN O
data NNS O
it PRP O
can MD O
glean VB O
from IN O
a DT O
victim NN O
. . O

Such JJ O
data NNS O
includes VBZ O
contact NN O
and CC O
location NN O
information NN O
, , O
phone NN O
and CC O
message NN O
activity NN O
, , O
the DT O
ability NN O
to TO O
record NN O
from IN O
the DT O
microphone NN O
, , O
camera NN O
, , O
and CC O
other JJ O
sensors NNS O
as RB O
well RB O
as IN O
the DT O
capability NN O
to TO O
access NN O
data NNS O
from IN O
many JJ O
popular JJ O
messaging NN O
and CC O
social JJ O
media NNS O
apps NN O
. . O

Infrastructure NN O
While IN O
investigating VBG O
HenBox NNP B-Malware
we PRP O
discovered VBD O
infrastructure NN O
ties NNS O
to TO O
other JJ O
malware JJ O
families NNS O
associated VBN O
with IN O
targeted JJ O
attacks NNS O
against IN O
Windows NNP B-System
users NNS O
– VBP O
notable JJ O
overlaps NNS O
included VBD O
PlugX NNP B-Malware
, , O
Zupdax NNP B-Malware
, , O
9002 CD B-Malware
, , O
and CC O
Poison NNP B-Malware
Ivy NNP I-Malware
. . O

The DT O
overall JJ O
image NN O
of IN O
these DT O
ties NNS O
is VBZ O
below IN O
in IN O
Figure NNP O
5 CD O
and CC O
paints NNS O
a DT O
picture NN O
of IN O
an DT O
adversary NN O
with IN O
at IN O
least JJS O
5 CD O
malware JJ O
families NNS O
in IN O
their PRP$ O
toolbox NN O
dating VBG O
back RB O
to TO O
at IN O
least JJS O
2015 CD O
. . O

The DT O
overlap NN O
between IN O
the DT O
HenBox NNP B-Malware
and CC O
9002 CD B-Malware
malware NN O
families NNS O
Unit NNP O
42 CD O
has VBZ O
seen VBN O
involves NNS O
three CD O
shared VBD O
C2s NNP O
between IN O
several JJ O
samples NNS O
; : O
the DT O
first JJ O
IP NNP O
below NN O
is VBZ O
used VBN O
for IN O
more JJR O
than IN O
half NN O
of IN O
the DT O
HenBox NNP B-Malware
samples VBZ O
we PRP O
have VBP O
seen VBN O
to TO O
date NN O
: : O
47.90.81 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
23 CD I-Indicator
222.139.212 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
16 CD I-Indicator
lala513.gicp JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
The DT O
overlaps NNS O
between IN O
the DT O
Henbox NNP B-Malware
, , O
PlugX NNP B-Malware
, , O
Zupdax NNP B-Malware
, , O
and CC O
Poison NNP B-Malware
Ivy NNP I-Malware
malware NN O
families NNS O
involves VBZ O
a DT O
web NN O
of IN O
shared VBN O
C2s NNP O
and CC O
IP NNP O
resolutions NNS O
centered VBD O
around IN O
the DT O
below NN O
: : O
59.188.196 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
172 CD I-Indicator
cdncool NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
( ( O
and CC O
third-levels NNS O
of IN O
this DT O
domain NN O
) ) O
www3.mefound NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
www5.zyns NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
w3.changeip NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
org NN I-Indicator
Ties NNS O
to TO O
previous JJ O
activity NN O
The DT O
registrant NN O
of IN O
cdncool NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
also RB O
registered VBD O
six CD O
other JJ O
domains NNS O
. . O

To TO O
date NN O
, , O
Unit NNP O
42 CD O
has VBZ O
seen VBN O
four CD O
of IN O
the DT O
seven CD O
( ( O
the DT O
first JJ O
three CD O
in IN O
the DT O
list NN O
below IN O
, , O
along IN O
with IN O
cdncool NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] NNP I-Indicator
com NN I-Indicator
) ) O
used VBN O
in IN O
malicious JJ O
activity NN O
and CC O
it PRP O
is VBZ O
reasonable JJ O
to TO O
assume VB O
the DT O
remaining VBG O
three CD O
are VBP O
or CC O
were VBD O
intended VBN O
to TO O
serve VB O
the DT O
same JJ O
purpose NN B-Indicator
. . I-Indicator

tcpdo NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
adminsysteminfo NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
md5c NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
linkdatax NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
csip6 NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
biz NN I-Indicator
adminloader NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
Unit NNP O
42 CD O
published VBD O
a DT O
blog NN O
in IN O
July NNP O
2016 CD O
about IN O
9002 CD B-Malware
malware NN O
being VBG O
delivered VBN O
using VBG O
a DT O
combination NN O
of IN O
shortened JJ O
links NNS O
and CC O
a DT O
file NN O
hosted VBN O
on IN O
Google NNP O
Drive NNP O
. . O

The DT O
spear JJ O
phishing NN O
emails NNS O
had VBD O
Myanmar NNP O
political-themed JJ O
lures NNS O
and CC O
, , O
if IN O
the DT O
9002 CD B-Malware
C2 NNP O
server NN O
responded VBD O
, , O
the DT O
Trojan NNP O
sent NN O
system NN O
specific JJ O
information NN O
along IN O
with IN O
the DT O
string NN O
“ NNP O
jackhex NN O
” NN O
. . O

“ JJ O
jackhex NN O
” NN O
has VBZ O
also RB O
been VBN O
part NN O
of IN O
a DT O
C2 NNP O
for IN O
what WP O
is VBZ O
likely JJ O
related JJ O
Poison NNP B-Malware
Ivy NNP I-Malware
activity NN O
detailed VBD O
below IN O
, , O
along IN O
with IN O
additional JJ O
infrastructure NN O
ties NNS O
. . O

The DT O
C2 NNP O
for IN O
the DT O
aforementioned JJ O
9002 CD B-Malware
sample NN O
was VBD O
logitechwkgame JJ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
, , O
which WDT O
resolved VBD O
to TO O
the DT O
IP NNP O
address NN O
222.239.91 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
30 CD I-Indicator
. . O

At IN O
the DT O
same JJ O
time NN O
, , O
the DT O
domain NN B-Indicator
admin.nslookupdns JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
also RB O
resolved VBD O
to TO O
the DT O
same JJ O
IP NNP O
address NN O
, , O
suggesting VBG O
that IN O
these DT O
two CD O
domains NNS O
are VBP O
associated VBN O
with IN O
the DT O
same JJ O
threat NN O
actors NNS O
. . O

In IN O
addition NN O
, , O
admin.nslookupdns JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
was VBD O
a DT O
C2 NNP O
for IN O
Poison NNP B-Malware
Ivy NNP I-Malware
samples NNS O
associated VBN O
with IN O
attacks NNS O
on IN O
Myanmar NNP O
and CC O
other JJ O
Asian JJ O
countries NNS O
discussed VBN O
in IN O
a DT O
blog NN O
published VBN O
by IN O
Arbor NNP B-Organization
Networks NNP I-Organization
in IN O
April NNP O
2016 CD O
. . O

Another DT O
tie NN O
between IN O
the DT O
activity NN O
is VBZ O
the DT O
C2 NNP O
jackhex.md5c NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
, , O
which WDT O
was VBD O
also RB O
used VBN O
as IN O
a DT O
Poison NNP B-Malware
Ivy NNP I-Malware
C2 NNP O
in IN O
the DT O
Arbor NNP B-Organization
Networks NNP I-Organization
blog NN O
. . O

“ JJ O
jackhex NN O
” NN O
is VBZ O
not RB O
a DT O
common JJ O
word NN O
or CC O
phrase NN O
and CC O
, , O
as IN O
noted VBN O
above IN O
, , O
was VBD O
also RB O
seen VBN O
in IN O
the DT O
beacon NN O
activity NN O
with IN O
the DT O
previously RB O
discussed JJ O
9002 CD B-Malware
sample NN O
. . O

Finally RB O
, , O
since IN O
publishing VBG O
the DT O
9002 CD B-Malware
blog NN O
, , O
Unit NNP O
42 CD O
has VBZ O
also RB O
seen VBN O
the DT O
aforementioned JJ O
9002 CD B-Malware
C2 NNP O
used VBD O
as IN O
a DT O
Poison NNP B-Malware
Ivy NNP I-Malware
C2 NNP O
with IN O
a DT O
Myanmar NNP O
political-themed JJ O
lure NN O
. . O

In IN O
our PRP$ O
9002 CD B-Malware
blog NN O
we PRP O
noted VBD O
some DT O
additional JJ O
infrastructure NN O
used VBN O
either CC O
as IN O
C2s NNP O
for IN O
related JJ O
Poison NNP B-Malware
Ivy NNP I-Malware
samples VBZ O
, , O
or CC O
domain NN O
registrant JJ O
overlap NN O
with IN O
those DT O
C2 NNP O
domains NNS O
. . O

When WRB O
we PRP O
published VBD O
that IN O
blog NN O
Unit NNP O
42 CD O
hadn NN O
’ NNP O
t NN O
seen VBN O
any DT O
of IN O
the DT O
three CD O
registrants NNS O
overlap VBP O
domains NNS O
used VBN O
in IN O
malicious JJ O
activity NN O
. . O

Since IN O
then RB O
, , O
we PRP O
have VBP O
seen VBN O
Poison NNP B-Malware
Ivy NNP I-Malware
samples VBZ O
using VBG O
third-levels NNS O
of IN O
querlyurl NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
, , O
lending VBG O
further JJ O
credence NN O
the DT O
remaining VBG O
two CD O
domains NNS O
, , O
gooledriveservice NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
and CC O
appupdatemoremagic JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
are VBP O
or CC O
were VBD O
intended VBN O
for IN O
malicious JJ O
use NN O
. . O

While IN O
we PRP O
do VBP O
not RB O
have VB O
complete JJ O
targeting NN O
, , O
information NN O
associated VBN O
with IN O
these DT O
Poison NNP B-Malware
Ivy NNP I-Malware
samples NNS O
, , O
several JJ O
of IN O
the DT O
decoy NN O
files NNS O
were VBD O
in IN O
Chinese JJ O
and CC O
appear VB O
to TO O
be VB O
part NN O
of IN O
a DT O
2016 CD O
campaign NN O
targeting VBG O
organizations NNS O
in IN O
Taiwan NNP O
with IN O
political-themed JJ O
lures NNS O
. . O

Conclusion NNP O
Typically RB O
masquerading VBG O
as IN O
legitimate JJ O
Android NNP B-Malware
system NN O
apps NN O
, , O
and CC O
sometimes RB O
embedding VBG O
legitimate JJ O
apps NN O
within IN O
them PRP O
, , O
the DT O
primary JJ O
goal NN O
of IN O
the DT O
malicious JJ O
HenBox NNP B-Malware
appears VBZ O
to TO O
be VB O
to TO O
spy VB O
on IN O
those DT O
who WP O
install VBP O
them PRP O
. . O

Using VBG O
similar JJ O
traits NNS O
, , O
such JJ O
as IN O
copycat NN O
iconography NN O
and CC O
app NN O
or CC O
package NN O
names NNS O
, , O
victims NNS O
are VBP O
likely JJ O
socially RB O
engineered VBN O
into IN O
installing VBG O
the DT O
malicious JJ O
apps NN O
, , O
especially RB O
when WRB O
available JJ O
on IN O
so-called JJ O
third-party NN O
( ( O
i.e NN O
. . O

non-Google JJ O
Play NNP B-System
) ) O
app NN O
stores NNS O
which WDT O
often RB O
have VBP O
fewer JJR O
security NN O
and CC O
vetting NN O
procedures NNS O
for IN O
the DT O
apps NN O
they PRP O
host VBP O
. . O

It PRP O
’ VBZ O
s RBR O
possible JJ O
, , O
as IN O
with IN O
other JJ O
Android NNP B-System
malware NN O
, , O
that IN O
some DT O
apps NN O
may MD O
also RB O
be VB O
available JJ O
on IN O
forums NNS O
, , O
file-sharing JJ O
sites NNS O
or CC O
even RB O
sent VBD O
to TO O
victims NNS O
as IN O
email NN O
attachments NNS O
, , O
and CC O
we PRP O
were VBD O
only RB O
able JJ O
to TO O
determine VB O
the DT O
delivery NN O
mechanism NN O
for IN O
a DT O
handful NN O
of IN O
the DT O
apps NN O
we PRP O
have VBP O
been VBN O
able JJ O
to TO O
find VB O
. . O

The DT O
hosting NN O
locations NNS O
seen VBN O
for IN O
some DT O
HenBox NNP B-Malware
samples NNS O
, , O
together RB O
with IN O
the DT O
nature NN O
of IN O
some DT O
embedded JJ O
apps NN O
including VBG O
: : O
those DT O
targeted VBN O
at IN O
extremist NN O
groups NNS O
, , O
those DT O
who WP O
use VBP O
VPN NNP O
or CC O
other JJ O
privacy-enabling JJ O
apps NN O
, , O
and CC O
those DT O
who WP O
speak VBP O
the DT O
Uyghur NNP O
language NN O
, , O
highlights VBZ O
the DT O
victim NN O
profile IN O
the DT O
threat NN O
actors NNS O
were VBD O
seeking VBG O
to TO O
attack VB O
. . O

The DT O
targets NNS O
and CC O
capabilities NNS O
of IN O
HenBox NNP B-Malware
, , O
in IN O
addition NN O
to TO O
the DT O
ties NNS O
to TO O
previous JJ O
activity NN O
using VBG O
four CD O
different JJ O
Windows NNP O
malware NN O
families NNS O
with IN O
political-themed JJ O
lures NNS O
against IN O
several JJ O
different JJ O
South NNP O
East NNP O
Asian JJ O
countries NNS O
, , O
indicates VBZ O
this DT O
activity NN O
likely JJ O
represents VBZ O
an DT O
at IN O
least JJS O
three-year-old JJ O
espionage NN O
campaign NN O
. . O

THURSDAY NNP O
, , O
OCTOBER NNP O
11 CD O
, , O
2018 CD O
GPlayed NNP B-Malware
Trojan NNP O
- : O
.Net JJ O
playing NN O
with IN O
Google NNP B-Organization
Market NNP O
Introduction NNP O
In IN O
a DT O
world NN O
where WRB O
everything NN O
is VBZ O
always RB O
connected VBN O
, , O
and CC O
mobile JJ O
devices NNS O
are VBP O
involved VBN O
in IN O
individuals NNS O
' POS O
day-to-day NN O
lives NNS O
more JJR O
and CC O
more RBR O
often RB O
, , O
malicious JJ O
actors NNS O
are VBP O
seeing VBG O
increased JJ O
opportunities NNS O
to TO O
attack VB O
these DT O
devices NNS O
. . O

Cisco NNP B-Organization
Talos NNP I-Organization
has VBZ O
identified VBN O
the DT O
latest JJS O
attempt NN O
to TO O
penetrate VB O
mobile JJ O
devices NNS O
— VBP O
a DT O
new JJ O
Android NNP B-System
trojan NN O
that IN O
we PRP O
have VBP O
dubbed VBN O
" JJ O
GPlayed NNP B-Malware
. . O

'' '' O
This DT O
is VBZ O
a DT O
trojan NN O
with IN O
many JJ O
built-in JJ O
capabilities NNS O
. . O

At IN O
the DT O
same JJ O
time NN O
, , O
it PRP O
's VBZ O
extremely RB O
flexible JJ O
, , O
making VBG O
it PRP O
a DT O
very RB O
effective JJ O
tool NN O
for IN O
malicious JJ O
actors NNS O
. . O

The DT O
sample NN O
we PRP O
analyzed VBD O
uses NNS O
an DT O
icon JJ O
very RB O
similar JJ O
to TO O
Google NNP B-System
Apps NNP I-System
, , O
with IN O
the DT O
label NN O
" NN O
Google NNP B-System
Play NNP I-System
Marketplace NNP I-System
'' '' O
to TO O
disguise VB O
itself PRP O
. . O

The DT O
malicious JJ O
application NN O
is VBZ O
on IN O
the DT O
left-hand JJ O
side NN O
. . O

What WP O
makes VBZ O
this DT O
malware NN O
extremely RB O
powerful JJ O
is VBZ O
the DT O
capability NN O
to TO O
adapt VB O
after IN O
it PRP O
's VBZ O
deployed VBN O
. . O

In IN O
order NN O
to TO O
achieve VB O
this DT O
adaptability NN O
, , O
the DT O
operator NN O
has VBZ O
the DT O
capability NN O
to TO O
remotely RB O
load JJ O
plugins NNS O
, , O
inject JJ O
scripts NNS O
and CC O
even RB O
compile VB O
new JJ O
.NET NNP B-System
code NN O
that WDT O
can MD O
be VB O
executed VBN O
. . O

Our PRP$ O
analysis NN O
indicates VBZ O
that IN O
this DT O
trojan NN O
is VBZ O
in IN O
its PRP$ O
testing NN O
stage NN O
but CC O
given VBN O
its PRP$ O
potential JJ O
, , O
every DT O
mobile JJ O
user NN O
should MD O
be VB O
aware JJ O
of IN O
GPlayed NNP B-Malware
. . O

Mobile JJ O
developers NNS O
have VBP O
recently RB O
begun VBN O
eschewing VBG O
traditional JJ O
app NN O
stores NNS O
and CC O
instead RB O
want VB O
to TO O
deliver VB O
their PRP$ O
software NN O
directly RB O
through IN O
their PRP$ O
own JJ O
means NNS O
. . O

But CC O
GPlayed NNP B-Malware
is VBZ O
an DT O
example NN O
of IN O
where WRB O
this DT O
can MD O
go VB O
wrong JJ O
, , O
especially RB O
if IN O
a DT O
mobile JJ O
user NN O
is VBZ O
not RB O
aware JJ O
of IN O
how WRB O
to TO O
distinguish VB O
a DT O
fake JJ O
app NN O
versus IN O
a DT O
real JJ O
one CD O
. . O

Trojan NNP O
architecture NN O
and CC O
capabilities NNS O
This DT O
malware NN O
is VBZ O
written VBN O
in IN O
.NET NNP B-System
using VBG O
the DT O
Xamarin NNP B-System
environment NN O
for IN O
mobile JJ O
applications NNS O
. . O

The DT O
main JJ O
DLL NNP O
is VBZ O
called VBN O
" JJ O
Reznov.DLL NNP B-Indicator
. . O

'' '' O
This DT O
DLL NNP O
contains VBZ O
one CD O
root NN O
class NN O
called VBN O
" CD O
eClient NN O
, , O
'' '' O
which WDT O
is VBZ O
the DT O
core NN O
of IN O
the DT O
trojan NN O
. . O

The DT O
imports NNS O
reveal VBP O
the DT O
use NN O
of IN O
a DT O
second JJ O
DLL NNP O
called VBD O
" NNP O
eCommon.dll NN B-Indicator
. . O

'' '' O
We PRP O
determined VBD O
that IN O
the DT O
" NN O
eCommon NN O
'' '' O
file NN O
contains VBZ O
support NN O
code NN O
and CC O
structures NNS O
that WDT O
are VBP O
platform JJ O
independent JJ O
. . O

The DT O
main JJ O
DLL NNP O
also RB O
contains VBZ O
eClient JJ O
subclasses NNS O
that WDT O
implement VBP O
some DT O
of IN O
the DT O
native JJ O
capabilities NNS O
. . O

The DT O
package NN O
certificate NN O
is VBZ O
issued VBN O
under IN O
the DT O
package NN O
name NN O
, , O
which WDT O
also RB O
resembles VBZ O
the DT O
name NN O
of IN O
the DT O
main JJ O
DLL NNP O
name NN O
. . O

Certificate NNP O
information NN O
The DT O
Android NNP B-System
package NN O
is VBZ O
named VBN O
" JJ O
verReznov.Coampany NN B-Indicator
. . O

'' '' O
The DT O
application NN O
uses VBZ O
the DT O
label NN O
" NNP O
Installer NNP B-Indicator
'' '' O
and CC O
its PRP$ O
name NN O
is VBZ O
" JJ O
android.app.Application NN B-Indicator
. . O

'' '' O
Package NN O
permissions VBZ O
The DT O
trojan NN O
declares VBZ O
numerous JJ O
permissions NNS O
in IN O
the DT O
manifest JJS O
, , O
from IN O
which WDT O
we PRP O
should MD O
highlight VB O
the DT O
BIND_DEVICE_ADMIN NNP O
, , O
which WDT O
provides VBZ O
nearly RB O
full JJ O
control NN O
of IN O
the DT O
device NN O
to TO O
the DT O
trojan NN O
. . O

This DT O
trojan NN O
is VBZ O
highly RB O
evolved VBN O
in IN O
its PRP$ O
design NN O
. . O

It PRP O
has VBZ O
modular JJ O
architecture NN O
implemented VBN O
in IN O
the DT O
form NN O
of IN O
plugins NNS O
, , O
or CC O
it PRP O
can MD O
receive VB O
new JJ O
.NET NNP B-System
source NN O
code NN O
, , O
which WDT O
will MD O
be VB O
compiled VBN O
on IN O
the DT O
device NN O
in IN O
runtime NN O
. . O

Initialization NN O
of IN O
the DT O
compiler NN O
object VBP O
The DT O
plugins NNS O
can MD O
be VB O
added VBN O
in IN O
runtime NN O
, , O
or CC O
they PRP O
can MD O
be VB O
added VBN O
as IN O
a DT O
package NN O
resource NN O
at IN O
packaging NN O
time NN O
. . O

This DT O
means VBZ O
that IN O
the DT O
authors NNS O
or CC O
the DT O
operators NNS O
can MD O
add VB O
capabilities NNS O
without IN O
the DT O
need NN O
to TO O
recompile VB O
and CC O
upgrade VB O
the DT O
trojan JJ O
package NN O
on IN O
the DT O
device NN O
. . O

Trojan NNP O
native JJ O
capabilities NNS O
This DT O
is VBZ O
a DT O
full-fledged JJ O
trojan NN O
with IN O
capabilities NNS O
ranging VBG O
from IN O
those DT O
of IN O
a DT O
banking NN O
trojan NN O
to TO O
a DT O
full JJ O
spying NN O
trojan NN O
. . O

This DT O
means VBZ O
that IN O
the DT O
malware NN O
can MD O
do VB O
anything NN O
from IN O
harvest PDT O
the DT O
user NN O
's POS O
banking NN O
credentials NNS O
, , O
to TO O
monitoring VBG O
the DT O
device NN O
's POS O
location NN O
. . O

There EX O
are VBP O
several JJ O
indicators NNS O
( ( O
see VB O
section NN O
" NNP O
trojan NN O
activity NN O
'' '' O
below NN O
) ) O
that IN O
it PRP O
is VBZ O
in IN O
its PRP$ O
last JJ O
stages NNS O
of IN O
development NN O
, , O
but CC O
it PRP O
has VBZ O
the DT O
potential JJ O
to TO O
be VB O
a DT O
serious JJ O
threat NN O
. . O

Trojan NN O
details NNS O
Upon IN O
boot NN O
, , O
the DT O
trojan NN O
will MD O
start VB O
by IN O
populating VBG O
a DT O
shared JJ O
preferences NNS O
file NN O
with IN O
the DT O
configuration NN O
it PRP O
has VBZ O
on IN O
its PRP$ O
internal JJ O
structures NNS O
. . O

Afterward RB O
, , O
it PRP O
will MD O
start VB O
several JJ O
timers NNS O
to TO O
execute VB O
different JJ O
tasks NNS O
. . O

The DT O
first JJ O
timer NN O
will MD O
be VB O
fired VBN O
on IN O
the DT O
configured JJ O
interval NN O
( ( O
20 CD O
seconds NNS O
in IN O
this DT O
case NN O
) ) O
, , O
pinging VBG O
the DT O
command NN O
and CC O
control NN O
( ( O
C2 NNP O
) ) O
server NN O
. . O

The DT O
response NN O
can MD O
either RB O
be VB O
a DT O
simple JJ O
" NNP O
OK NNP O
, , O
'' '' O
or CC O
can MD O
be VB O
a DT O
request NN O
to TO O
perform VB O
some DT O
action NN O
on IN O
the DT O
device NN O
. . O

The DT O
second JJ O
timer NN O
will MD O
run VB O
every DT O
five CD O
seconds NNS O
and CC O
it PRP O
will MD O
try VB O
to TO O
enable VB O
the DT O
WiFi NNP O
if IN O
it PRP O
's VBZ O
disabled JJ O
. . O

The DT O
third JJ O
timer NN O
will MD O
fire VB O
every DT O
10 CD O
seconds NNS O
and CC O
will MD O
attempt VB O
to TO O
register VB O
the DT O
device NN O
into IN O
the DT O
C2 NNP O
and CC O
register VB O
wake-up JJ O
locks NNS O
on IN O
the DT O
system NN O
to TO O
control VB O
the DT O
device NN O
's POS O
status NN O
. . O

During IN O
the DT O
trojan JJ O
registration NN O
stage NN O
, , O
the DT O
trojan NN O
exfiltrates VBZ O
private JJ O
information NN O
such JJ O
as IN O
the DT O
phone NN O
's POS O
model NN O
, , O
IMEI NNP O
, , O
phone NN O
number NN O
and CC O
country NN O
. . O

It PRP O
will MD O
also RB O
report VB O
the DT O
version NN O
of IN O
Android NNP B-System
that IN O
the DT O
phone NN O
is VBZ O
running VBG O
and CC O
any DT O
additional JJ O
capabilities NNS O
. . O

Device NNP O
registration NN O
This DT O
is VBZ O
the DT O
last JJ O
of IN O
the DT O
three CD O
main JJ O
timers NNS O
that WDT O
are VBP O
created VBN O
. . O

The DT O
trojan NN O
will MD O
register VB O
the DT O
SMS NNP O
handler NN O
, , O
which WDT O
will MD O
forward VB O
the DT O
contents NNS O
and CC O
the DT O
sender NN O
of IN O
all DT O
of IN O
the DT O
SMS NNP O
messages NNS O
on IN O
the DT O
phone NN O
to TO O
the DT O
C2 NNP O
. . O

The DT O
final JJ O
step NN O
in IN O
the DT O
trojan NN O
's POS O
initialization NN O
is VBZ O
the DT O
escalation NN O
and CC O
maintenance NN O
of IN O
privileges NNS O
in IN O
the DT O
device NN O
. . O

This DT O
is VBZ O
done VBN O
both DT O
by IN O
requesting VBG O
admin JJ O
privileges NNS O
on IN O
the DT O
device NN O
and CC O
asking VBG O
the DT O
user NN O
to TO O
allow VB O
the DT O
application NN O
to TO O
access NN O
the DT O
device NN O
's POS O
settings NNS O
. . O

Privilege NNP O
escalation NN O
requests VBZ O
The DT O
screens NNS O
asking VBG O
for IN O
the DT O
user NN O
's POS O
approval NN O
wo MD O
n't RB O
close VB O
unless IN O
the DT O
user NN O
approves VBZ O
the DT O
privilege NN O
escalation NN O
. . O

If IN O
the DT O
user NN O
closes VBZ O
the DT O
windows NNS O
, , O
they PRP O
will MD O
appear VB O
again RB O
due JJ O
to TO O
the DT O
timer NN O
configuration NN O
. . O

After IN O
the DT O
installation NN O
of IN O
the DT O
trojan NN O
, , O
it PRP O
will MD O
wait VB O
randomly RB O
between IN O
three CD O
and CC O
five CD O
minutes NNS O
to TO O
activate VB O
one CD O
of IN O
the DT O
native JJ O
capabilities NNS O
— IN O
these DT O
are VBP O
implemented VBN O
on IN O
the DT O
eClient NN O
subclass NN O
called VBN O
" NNP O
GoogleCC NNP O
. . O

'' '' O
This DT O
class NN O
will MD O
open VB O
a DT O
WebView NNP O
with IN O
a DT O
Google-themed JJ B-Organization
page NN O
asking VBG O
for IN O
payment NN O
in IN O
order NN O
to TO O
use VB O
the DT O
Google NNP B-Organization
services NNS O
. . O

This DT O
will MD O
take VB O
the DT O
user NN O
through IN O
several JJ O
steps NNS O
until IN O
it PRP O
collects VBZ O
all PDT O
the DT O
necessary JJ O
credit NN O
card NN O
information NN O
, , O
which WDT O
will MD O
be VB O
checked VBN O
online JJ O
and CC O
exfiltrated VBD O
to TO O
the DT O
C2 NNP O
. . O

During IN O
this DT O
process NN O
, , O
an DT O
amount NN O
of IN O
money NN O
, , O
configured VBN O
by IN O
the DT O
malicious JJ O
operator NN O
, , O
is VBZ O
requested VBN O
to TO O
the DT O
user NN O
. . O

Steps NNS O
to TO O
request VB O
the DT O
user NN O
's POS O
credit NN O
card NN O
information NN O
In IN O
our PRP$ O
sample NN O
configuration NN O
, , O
the DT O
request NN O
for IN O
the DT O
views NNS O
above IN O
can MD O
not RB O
be VB O
canceled VBN O
or CC O
removed VBN O
from IN O
the DT O
screen NN O
— NNP O
behaving NN O
just RB O
like IN O
a DT O
screen NN O
lock NN O
that WDT O
wo MD O
n't RB O
be VB O
disabled VBN O
without IN O
providing VBG O
credit NN O
card NN O
information NN O
. . O

All DT O
communication NN O
with IN O
the DT O
C2 NNP O
is VBZ O
done VBN O
over IN O
HTTP NNP O
. . O

It PRP O
will MD O
use VB O
either CC O
a DT O
standard JJ O
web NN O
request NN O
or CC O
it PRP O
will MD O
write VB O
data NNS O
into IN O
a DT O
web NN O
socket NN O
if IN O
the DT O
first JJ O
method NN O
fails NNS O
. . O

The DT O
C2 NNP O
can MD O
also RB O
use VB O
WebSocket NNP O
as IN O
a DT O
backup NN O
communication NN O
channel NN O
. . O

Before IN O
sending VBG O
any DT O
data NNS O
to TO O
the DT O
C2 NNP O
using VBG O
the DT O
trojan NN O
attempts VBZ O
to TO O
disguise VB O
its PRP$ O
data NNS O
, , O
the DT O
data NN O
is VBZ O
serialized VBN O
using VBG O
JSON NNP O
, , O
which WDT O
is VBZ O
then RB O
encoded VBN O
in IN O
Base64 NNP O
. . O

However RB O
, , O
the DT O
trojan NN O
replaces VBZ O
the DT O
'= NN O
' POS O
by IN O
'AAAZZZXXX NNS O
' POS O
, , O
the DT O
'+ NNP O
' POS O
by IN O
'| NNS O
' POS O
and CC O
the DT O
'/ NNP O
' POS O
by IN O
' POS O
. . O

' '' O
to TO O
disguise VB O
the DT O
Base64 NNP O
. . O

Request NNP O
encoding VBG O
process NN O
The DT O
HTTP NNP O
requests NNS O
follow VBP O
the DT O
format NN O
below IN O
, , O
while IN O
on IN O
the DT O
WebSocket NNP O
only RB O
the DT O
query NN O
data NN O
is VBZ O
written VBN O
. . O

? . O

q= SYM O
- : O
: : O
As IN O
is VBZ O
common JJ O
with IN O
trojans NNS O
, , O
the DT O
communication NN O
is VBZ O
always RB O
initiated VBN O
by IN O
the DT O
trojan NN O
on IN O
the DT O
device NN O
to TO O
the DT O
C2 NNP O
. . O

The DT O
request NN O
codes NNS O
are VBP O
actually RB O
replies NNS O
to TO O
the DT O
C2 NNP O
action NN O
requests NNS O
, , O
which WDT O
are VBP O
actually RB O
called VBN O
" JJ O
responses NNS O
. . O

'' '' O
There EX O
are VBP O
27 CD O
response NN O
codes NNS O
that IN O
the DT O
C2 NNP O
can MD O
use VB O
to TO O
make VB O
requests NNS O
to TO O
the DT O
trojan NN O
, , O
which WDT O
pretty RB O
much JJ O
match VB O
what WP O
's VBZ O
listed VBN O
in IN O
the DT O
capabilities NNS O
section NN O
. . O

Error NNP O
Registration NNP O
Ok NNP O
Empty NNP O
SendSMS NNP O
RequestGoogleCC NNP O
Wipe NNP O
OpenBrowser NNP O
SendUSSD NNP O
RequestSMSList NNP O
RequestAppList NNP O
RequestLocation NNP O
ShowNotification NNP O
SetLockPassword NNP O
LockNow NNP O
MuteSound NNP O
LoadScript NNP O
LoadPlugin NNP O
ServerChange NNP O
StartApp NNP O
CallPhone NNP O
SetPingTimer NNP O
SMSBroadcast NNP O
RequestContacts NNP O
AddInject NNP O
RemoveInject NNP O
Evaluate NNP O
Another DT O
feature NN O
of IN O
this DT O
trojan NN O
is VBZ O
the DT O
ability NN O
to TO O
register VB O
injects NNS O
, , O
which WDT O
are VBP O
JavaScript NNP O
snippets NNS O
of IN O
code NN O
. . O

These DT O
will MD O
be VB O
executed VBN O
in IN O
a DT O
WebView NNP O
object NN O
created VBN O
by IN O
the DT O
trojan NN O
. . O

This DT O
gives VBZ O
the DT O
operators NNS O
the DT O
capability NN O
to TO O
trick VB O
the DT O
user NN O
into IN O
accessing VBG O
any DT O
site NN O
while IN O
stealing VBG O
the DT O
user NN O
's POS O
cookies NNS O
or CC O
forging VBG O
form NN O
fields NNS O
, , O
like IN O
account NN O
numbers NNS O
or CC O
phone NN O
numbers NNS O
. . O

Trojan NN O
activity NN O
At IN O
the DT O
time NN O
of IN O
the DT O
writing NN O
of IN O
this DT O
post NN O
, , O
all DT O
URLs NNP O
( ( O
see VB O
IOC NNP O
section NN O
) ) O
found VBD O
on IN O
the DT O
sample NN O
were VBD O
inactive JJ O
, , O
and CC O
it PRP O
does VBZ O
not RB O
seem VB O
to TO O
be VB O
widespread JJ O
. . O

There EX O
are VBP O
some DT O
indicators NNS O
that IN O
this DT O
sample NN O
is VBZ O
just RB O
a DT O
test NN O
sample NN O
on IN O
its PRP$ O
final JJ O
stages NNS O
of IN O
development NN O
. . O

There EX O
are VBP O
several JJ O
strings NNS O
and CC O
labels NNS O
still RB O
mentioning VBG O
'test JJS O
' '' O
or CC O
'testcc POS O
' '' O
— NNS O
even RB O
the DT O
URL NNP O
used VBD O
for IN O
the DT O
credit NN O
card NN O
data NNS O
exfiltration NN O
is VBZ O
named VBN O
" JJ O
testcc.php NN B-Indicator
. . O

'' '' O
Debug NNP O
information NN O
on IN O
logcat NN O
Another DT O
indicator NN O
is VBZ O
the DT O
amount NN O
of IN O
debugging VBG O
information NN O
the DT O
trojan NN O
is VBZ O
still RB O
generating VBG O
— PRP O
a DT O
production-level JJ O
trojan NN O
would MD O
keep VB O
its PRP$ O
logging NN O
to TO O
a DT O
minimum NN O
. . O

The DT O
only JJ O
sample NN O
was VBD O
found VBN O
on IN O
public JJ O
repositories NNS O
and CC O
almost RB O
seemed VBD O
to TO O
indicate VB O
a DT O
test NN O
run NN O
to TO O
determine VB O
the DT O
detection NN O
ratio NN O
of IN O
the DT O
sample NN O
. . O

We PRP O
have VBP O
observed VBN O
this DT O
trojan NN O
being VBG O
submitted VBN O
to TO O
public JJ O
antivirus NN O
testing VBG O
platforms NNS O
, , O
once RB O
as IN O
a DT O
package NN O
and CC O
once RB O
for IN O
each DT O
DLL NNP O
to TO O
determine VB O
the DT O
detection NN O
ratio NN O
. . O

The DT O
sample NN O
analyzed VBD O
was VBD O
targeted VBN O
at IN O
Russian-speaking NNP O
users NNS O
, , O
as IN O
most JJS O
of IN O
the DT O
user JJ O
interaction NN O
pages NNS O
are VBP O
written VBN O
in IN O
Russian NNP O
. . O

However RB O
, , O
given VBN O
the DT O
way NN O
the DT O
trojan NN O
is VBZ O
built VBN O
, , O
it PRP O
is VBZ O
highly RB O
customizable JJ O
, , O
meaning VBG O
that IN O
adapting VBG O
it PRP O
to TO O
a DT O
different JJ O
language NN O
would MD O
be VB O
extremely RB O
easy JJ O
. . O

The DT O
wide JJ O
range NN O
of IN O
capabilities NNS O
does VBZ O
n't RB O
limit VB O
this DT O
trojan NN O
to TO O
a DT O
specific JJ O
malicious JJ O
activity NN O
like IN O
a DT O
banking NN O
trojan NN O
or CC O
a DT O
ransomware NN O
. . O

This DT O
makes VBZ O
it PRP O
impossible JJ O
to TO O
create VB O
a DT O
target NN O
profile NN O
. . O

Conclusion NN O
This DT O
trojan NN O
shows VBZ O
a DT O
new JJ O
path NN O
for IN O
threats NNS O
to TO O
evolve VB O
. . O

Having VBG O
the DT O
ability NN O
to TO O
move VB O
code NN O
from IN O
desktops NNS O
to TO O
mobile VB O
platforms NNS O
with IN O
no DT O
effort NN O
, , O
like IN O
the DT O
eCommon.DLL NN B-Indicator
demonstrates VBZ O
that IN O
malicious JJ O
actors NNS O
can MD O
create VB O
hybrid JJ O
threats NNS O
faster RBR O
and CC O
with IN O
fewer JJR O
resources NNS O
involved VBN O
than IN O
ever RB O
before IN O
. . O

This DT O
trojan NN O
's POS O
design NN O
and CC O
implementation NN O
is VBZ O
of IN O
an DT O
uncommonly JJ O
high JJ O
level NN O
, , O
making VBG O
it PRP O
a DT O
dangerous JJ O
threat NN O
. . O

These DT O
kinds NNS O
of IN O
threats NNS O
will MD O
become VB O
more RBR O
common JJ O
, , O
as IN O
more JJR O
and CC O
more JJR O
companies NNS O
decide VBP O
to TO O
publish VB O
their PRP$ O
software NN O
directly RB O
to TO O
consumers NNS O
. . O

There EX O
have VBP O
been VBN O
several JJ O
recent JJ O
examples NNS O
of IN O
companies NNS O
choosing VBG O
to TO O
release VB O
their PRP$ O
software NN O
directly RB O
to TO O
consumers NNS O
, , O
bypassing VBG O
traditional JJ O
storefronts NNS O
. . O

The DT O
average JJ O
user NN O
might MD O
not RB O
have VB O
the DT O
necessary JJ O
skills NNS O
to TO O
distinguish VB O
legitimate JJ O
sites NNS O
from IN O
malicious JJ O
ones NNS O
. . O

We PRP O
've VBP O
seen VBN O
that IN O
this DT O
has VBZ O
been VBN O
the DT O
case NN O
for IN O
many JJ O
years NNS O
with IN O
spear-phishing JJ O
campaigns NNS O
on IN O
desktop NN O
and CC O
mobile JJ O
platforms NNS O
, , O
so RB O
, , O
unfortunately RB O
, , O
it PRP O
does VBZ O
n't RB O
seem VB O
that IN O
this DT O
will MD O
change VB O
any DT O
time NN O
soon RB O
. . O

And CC O
this DT O
just RB O
means VBZ O
attackers NNS O
will MD O
continue VB O
to TO O
be VB O
successful JJ O
. . O

Coverage NNP O
Additional NNP O
ways NNS O
our PRP$ O
customers NNS O
can MD O
detect VB O
and CC O
block VB O
this DT O
threat NN O
are VBP O
listed VBN O
below IN O
. . O

Advanced NNP B-System
Malware NNP I-System
Protection NNP I-System
( ( I-System
AMP NNP I-System
) ) I-System
is VBZ O
ideally RB O
suited VBN O
to TO O
prevent VB O
the DT O
execution NN O
of IN O
the DT O
malware NN O
used VBN O
by IN O
these DT O
threat NN O
actors NNS O
. . O

Cisco NNP B-System
Cloud NNP I-System
Web NNP I-System
Security NNP I-System
( ( I-System
CWS NNP I-System
) ) I-System
or CC O
Web NNP B-System
Security NNP I-System
Appliance NNP I-System
( ( I-System
WSA NNP I-System
) ) I-System
web VBP O
scanning VBG O
prevents NNS O
access NN O
to TO O
malicious JJ O
websites NNS O
and CC O
detects NNS O
malware VBP O
used VBN O
in IN O
these DT O
attacks NNS O
. . O

Email NNP O
Security NNP O
can MD O
block VB O
malicious JJ O
emails NNS O
sent VBN O
by IN O
threat NN O
actors NNS O
as IN O
part NN O
of IN O
their PRP$ O
campaign NN O
. . O

Network NNP O
Security NNP O
appliances NNS O
such JJ O
as IN O
Next-Generation NNP B-System
Firewall NNP I-System
( ( I-System
NGFW NNP I-System
) ) I-System
, , O
Next-Generation NNP B-System
Intrusion NNP I-System
Prevention NNP I-System
System NNP I-System
( ( I-System
NGIPS NNP I-System
) ) I-System
, , O
and CC O
Meraki NNP B-System
MX NNP I-System
can MD O
detect VB O
malicious JJ O
activity NN O
associated VBN O
with IN O
this DT O
threat NN O
. . O

AMP NNP O
Threat NNP O
Grid NNP O
helps VBZ O
identify VB O
malicious JJ O
binaries NNS O
and CC O
build VB O
protection NN O
into IN O
all DT O
Cisco NNP B-Organization
Security NNP O
products NNS O
. . O

Umbrella NN B-System
, , O
our PRP$ O
secure JJ O
internet NN O
gateway NN O
( ( O
SIG NNP O
) ) O
, , O
blocks VBZ O
users NNS O
from IN O
connecting VBG O
to TO O
malicious JJ O
domains NNS O
, , O
IPs NNP O
, , O
and CC O
URLs NNP O
, , O
whether IN O
users NNS O
are VBP O
on IN O
or CC O
off IN O
the DT O
corporate JJ O
network NN O
. . O

Open NNP O
Source NNP O
Snort NNP O
Subscriber NNP O
Rule NNP O
Set NNP O
customers NNS O
can MD O
stay VB O
up RB O
to TO O
date NN O
by IN O
downloading VBG O
the DT O
latest JJS O
rule NN O
pack NN O
available JJ O
for IN O
purchase NN O
on IN O
Snort.org NNP O
. . O

Indicators NNS O
of IN O
compromise NN O
( ( O
IOC NNP O
) ) O
URLs NNP O
hxxp NN B-Indicator
: : I-Indicator
//5.9.33.226:5416 JJ I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//172.110.10.171:85/testcc.php JJ I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//sub1.tdsworker.ru:5555/3ds/ JJ I-Indicator
Hash NNP O
values NNS O
Package.apk NNP B-Indicator
- : O
A342a16082ea53d101f556b50532651cd3e3fdc7d9e0be3aa136680ad9c6a69f NNP B-Indicator
eCommon.dl SYM B-Indicator
- : O
604deb75eedf439766896f05799752de268baf437bf89a7185540627ab4a4bd1 CD B-Indicator

Reznov.dll NNP B-Indicator
- : O
17b8665cdbbb94482ca970a754d11d6e29c46af6390a2d8e8193d8d6a527dec3 CD B-Indicator
Custom NNP O
activity NN O
prefix NN O
com.cact.CAct NN B-Indicator
Cerberus NNP B-Malware
- : O
A DT O
new JJ O
banking NN O
Trojan NN O
from IN O
the DT O
underworld NN O
August NNP O
2019 CD O
In IN O
June NNP O
2019 CD O
, , O
ThreatFabric NNP B-Organization
analysts NNS O
found VBD O
a DT O
new JJ O
Android NNP B-System
malware NN O
, , O
dubbed VBN O
“ JJ O
Cerberus NNP B-Malware
” NNP O
, , O
being VBG O
rented VBN O
out RP O
on IN O
underground JJ O
forums NNS O
. . O

Its PRP$ O
authors NNS O
claim VBP O
that IN O
it PRP O
was VBD O
used VBN O
for IN O
private JJ O
operations NNS O
for IN O
two CD O
years NNS O
preceding VBG O
the DT O
start NN O
of IN O
the DT O
rental NN O
. . O

They PRP O
also RB O
state NN O
that IN O
the DT O
code NN O
is VBZ O
written VBN O
from IN O
scratch NN O
and CC O
is VBZ O
not RB O
using VBG O
parts NNS O
of IN O
other JJ O
existing VBG O
banking NN O
Trojans NNS O
unlike IN O
many JJ O
other JJ O
Trojans NNPS O
that WDT O
are VBP O
either DT O
based VBN O
completely RB O
on IN O
the DT O
source NN O
of IN O
another DT O
Trojan NNP O
( ( O
such JJ O
as IN O
the DT O
leaked JJ O
Anubis NNP B-Malware
source NN O
code NN O
that WDT O
is VBZ O
now RB O
being VBG O
resold VBN O
) ) O
or CC O
at IN O
least JJS O
borrow JJ O
parts NNS O
of IN O
other JJ O
Trojans NNPS O
. . O

After IN O
thorough JJ O
analysis NN O
we PRP O
can MD O
confirm VB O
that DT O
Cerberus NNP B-Malware
was VBD O
indeed RB O
not RB O
based VBN O
on IN O
the DT O
Anubis NNP B-Malware
source NN O
code NN O
. . O

One CD O
peculiar JJ O
thing NN O
about IN O
the DT O
actor NN O
group NN O
behind IN O
this DT O
banking NN O
malware NN O
is VBZ O
that IN O
they PRP O
have VBP O
an DT O
“ JJ O
official NN O
” NNP O
twitter NN B-Organization
account NN O
that IN O
they PRP O
use VBP O
to TO O
post VB O
promotional JJ O
content NN O
( ( O
even RB O
videos NNS O
) ) O
about IN O
the DT O
malware NN O
. . O

Oddly RB O
enough RB O
they PRP O
also RB O
use VBP O
it PRP O
to TO O
make VB O
fun NN O
of IN O
the DT O
AV NNP O
community NN O
, , O
sharing VBG O
detection NN O
screenshots NNS O
from IN O
VirusTotal NNP B-Organization
( ( O
thus RB O
leaking VBG O
IoC NNP O
) ) O
and CC O
even RB O
engaging VBG O
in IN O
discussions NNS O
with IN O
malware NN O
researchers NNS O
directly RB O
The DT O
following VBG O
screenshot NN O
shows NNS O
tweets NNS O
from IN O
their PRP$ O
advertisement NN O
campaign NN O
: : O
That DT O
unusual JJ O
behavior NN O
could MD O
be VB O
explained VBN O
by IN O
the DT O
combination NN O
of IN O
the DT O
need NN O
for IN O
attention NN O
and CC O
a DT O
probable JJ O
lack NN O
of IN O
experience NN O
. . O

What WP O
is VBZ O
sure JJ O
is VBZ O
that IN O
the DT O
gap NN O
in IN O
the DT O
Android NNP B-System
banking NN O
malware NN O
rental JJ O
business NN O
left VBD O
open JJ O
after IN O
the DT O
rental NN O
of IN O
the DT O
Anubis NNP B-Malware
2 CD I-Malware
and CC O
RedAlert NNP B-Malware
2 CD I-Malware
Trojans NNPS O
ended VBD O
provides VBZ O
a DT O
good JJ O
opportunity NN O
for IN O
the DT O
actors NNS O
behind IN O
Cerberus NNP B-Malware
to TO O
grow VB O
their PRP$ O
business NN O
quickly RB O
. . O

The DT O
Android NNP B-System
banking NN O
Trojan NNP O
rental NN O
business NN O
Rental NNP O
of IN O
banking NN O
Trojans NNPS O
is VBZ O
not RB O
new JJ O
. . O

It PRP O
was VBD O
an DT O
existing VBG O
business NN O
model NN O
when WRB O
computer-based JJ O
banking NN O
malware NN O
was VBD O
the DT O
only JJ O
form NN O
of IN O
banking NN O
malware NN O
and CC O
has VBZ O
shifted VBN O
to TO O
the DT O
Android NNP B-System
equivalent NN O
a DT O
few JJ O
years NNS O
later RB O
. . O

The DT O
life NN O
span NN O
of IN O
Android NNP B-System
banking NN O
malware NN O
is VBZ O
limited VBN O
to TO O
either CC O
the DT O
will MD O
of IN O
its PRP$ O
author NN O
( ( O
s PRP O
) ) O
to TO O
support VB O
it PRP O
or CC O
the DT O
arrest NN O
of IN O
those DT O
actors NNS O
. . O

This DT O
malware-life-cycle NN O
has VBZ O
been VBN O
observed VBN O
to TO O
reoccur VB O
every DT O
few JJ O
years NNS O
, , O
bringing VBG O
new JJ O
malware NN O
families NNS O
into IN O
light NN O
. . O

Each DT O
time NN O
a DT O
rented VBN O
malware NN O
reaches VBZ O
the DT O
end NN O
of IN O
its PRP$ O
life NN O
it PRP O
provides VBZ O
the DT O
opportunity NN O
for IN O
other JJ O
actors NNS O
a DT O
to TO O
take VB O
over RP O
the DT O
malware JJ O
rental JJ O
market-share NN O
. . O

As IN O
visible JJ O
on IN O
following VBG O
chart NN O
, , O
the DT O
lifespan NN O
of IN O
many JJ O
well-known JJ O
rented VBN O
Android NNP B-System
bankers NNS O
is VBZ O
usually RB O
no RB O
more JJR O
than IN O
one CD O
or CC O
two CD O
years NNS O
. . O

When WRB O
the DT O
family NN O
ceases VBZ O
to TO O
exist VB O
a DT O
new JJ O
one CD O
is VBZ O
already RB O
available JJ O
to TO O
fill VB O
the DT O
void NN O
, , O
proving VBG O
that IN O
the DT O
demand NN O
for IN O
such JJ O
malware NN O
is VBZ O
always RB O
present JJ O
and CC O
that IN O
therefore RB O
Cerberus NNP B-Malware
has VBZ O
a DT O
good JJ O
chance NN O
to TO O
survive VB O
. . O

After IN O
the DT O
actor NN O
behind IN O
RedAlert NNP B-Malware
2 CD I-Malware
decided VBD O
to TO O
quit VB O
the DT O
rental JJ O
business NN O
, , O
we PRP O
observed VBD O
a DT O
surge NN O
in IN O
Anubis NNP B-Malware
samples NNS O
in IN O
the DT O
wild NN O
. . O

After IN O
the DT O
Anubis NNP B-Malware
actor NN O
was VBD O
allegedly RB O
arrested VBN O
and CC O
the DT O
source NN O
code NN O
was VBD O
leaked VBN O
there EX O
was VBD O
also RB O
huge JJ O
increase NN O
in IN O
the DT O
number NN O
of IN O
Anubis NNP B-Malware
samples NNS O
found VBN O
in IN O
the DT O
wild JJ O
, , O
but CC O
the DT O
new JJ O
actors NNS O
using VBG O
Anubis NNP B-Malware
have VBP O
no DT O
support NN O
or CC O
updates NNS O
. . O

Due JJ O
to TO O
this DT O
Cerberus NNP B-Malware
will MD O
come VB O
in IN O
handy JJ O
for IN O
actors NNS O
that WDT O
want VBP O
to TO O
focus VB O
on IN O
performing VBG O
fraud NN O
without IN O
having VBG O
to TO O
develop VB O
and CC O
maintain VB O
a DT O
botnet NN O
and CC O
C2 NNP O
infrastructure NN O
. . O

Analysis NN O
of IN O
evasion NN O
techniques NNS O
Along IN O
with IN O
the DT O
standard JJ O
payload NN O
and CC O
string NN O
obfuscation NN O
, , O
Cerberus NNP B-Malware
uses VBZ O
a DT O
rather RB O
interesting JJ O
technique NN O
to TO O
prevent VB O
analysis NN O
of IN O
the DT O
Trojan NNP O
. . O

Using VBG O
the DT O
device NN O
accelerometer NN O
sensor NN O
it PRP O
implements VBZ O
a DT O
simple JJ O
pedometer NN O
that WDT O
is VBZ O
used VBN O
to TO O
measure VB O
movements NNS O
of IN O
the DT O
victim NN O
. . O

The DT O
idea NN O
is VBZ O
simple JJ O
- : O
if IN O
the DT O
infected JJ O
device NN O
belongs NNS O
to TO O
a DT O
real JJ O
person NN O
, , O
sooner NN O
or CC O
later RB O
this DT O
person NN O
will MD O
move VB O
around RB O
, , O
increasing VBG O
the DT O
step NN O
counter NN O
. . O

The DT O
Trojan NNP O
uses VBZ O
this DT O
counter NN O
to TO O
activate VB O
the DT O
bot NN O
- : O
if IN O
aforementioned VBN O
step NN O
counter NN O
hits VBZ O
the DT O
pre-configured JJ O
threshold NN O
it PRP O
considers VBZ O
running VBG O
on IN O
the DT O
device NN O
to TO O
be VB O
safe JJ O
. . O

This DT O
simple JJ O
measure NN O
prevents VBZ O
the DT O
Trojan NNP O
from IN O
running VBG O
and CC O
being VBG O
analyzed VBN O
in IN O
dynamic JJ O
analysis NN O
environments NNS O
( ( O
sandboxes NNS O
) ) O
and CC O
on IN O
the DT O
test NN O
devices NNS O
of IN O
malware NN O
analysts NNS O
. . O

The DT O
code NN O
responsible JJ O
for IN O
this DT O
verification NN O
is VBZ O
shown VBN O
in IN O
the DT O
following JJ O
snippet NN O
: : O
How WRB O
it PRP O
works VBZ O
When WRB O
the DT O
malware NN O
is VBZ O
first RB O
started VBN O
on IN O
the DT O
device NN O
it PRP O
will MD O
begin VB O
by IN O
hiding VBG O
its PRP$ O
icon NN O
from IN O
the DT O
application NN O
drawer NN O
. . O

Then RB O
it PRP O
will MD O
ask VB O
for IN O
the DT O
accessibility NN O
service NN O
privilege NN O
as IN O
visible JJ O
in IN O
the DT O
following JJ O
screenshot NN O
: : O
After IN O
the DT O
user NN O
grants VBZ O
the DT O
requested JJ O
privilege NN O
, , O
Cerberus NNP B-Malware
starts VBZ O
to TO O
abuse VB O
it PRP O
by IN O
granting VBG O
itself PRP O
additional JJ O
permissions NNS O
, , O
such JJ O
as IN O
permissions NNS O
needed VBN O
to TO O
send VB O
messages NNS O
and CC O
make VB O
calls NNS O
, , O
without IN O
requiring VBG O
any DT O
user JJ O
interaction NN O
. . O

It PRP O
also RB O
disables VBZ O
Play NNP B-System
Protect NNP I-System
( ( O
Google NNP B-Organization
’ NNP O
s NN O
preinstalled VBD O
antivirus JJ O
solution NN O
) ) O
to TO O
prevent VB O
its PRP$ O
discovery NN O
and CC O
deletion NN O
in IN O
the DT O
future NN O
. . O

After IN O
conveniently RB O
granting VBG O
itself PRP O
additional JJ O
privileges NNS O
and CC O
securing VBG O
its PRP$ O
persistence NN O
on IN O
the DT O
device NN O
, , O
Cerberus NNP B-Malware
registers VBZ O
the DT O
infected JJ O
device NN O
in IN O
the DT O
botnet NN O
and CC O
waits NNS O
for IN O
commands NNS O
from IN O
the DT O
C2 NNP O
server NN O
while IN O
also RB O
being VBG O
ready JJ O
to TO O
perform VB O
overlay NN O
attacks NNS O
. . O

The DT O
commands NNS O
supported VBN O
by IN O
the DT O
analyzed JJ O
version NN O
of IN O
the DT O
Cerberus NNP B-Malware
bot NN O
are VBP O
listed VBN O
below IN O
. . O

As IN O
can MD O
be VB O
seen VBN O
, , O
the DT O
possibilities NNS O
offered VBN O
by IN O
the DT O
bot NN O
are VBP O
pretty JJ O
common JJ O
. . O

Command NNP O
Description NNP O
push NN O
Shows VBZ O
a DT O
push JJ O
notification NN O
. . O

Clicking VBG O
on IN O
thenotification NN O
will MD O
result VB O
in IN O
launching VBG O
a DT O
specified VBN O
app NN O
startApp NN O
Starts VBZ O
the DT O
specified JJ O
application NN O
getInstallApps NN O
Gets VBZ O
the DT O
list NN O
of IN O
installedapplications NNS O
on IN O
the DT O
infected JJ O
device NN O
getContacts NNS O
Gets VBZ O
the DT O
contact NN O
names NNS O
and CC O
phone NN O
numbers NNS O
from IN O
the DT O
addressbook NN O
on IN O
the DT O
infected JJ O
device NN O
deleteApplication NN O
Triggers VBZ O
the DT O
deletion NN O
of IN O
the DT O
specified JJ O
application NN O
forwardCall NN O
Enables NNP O
call NN O
forwarding NN O
to TO O
the DT O
specified VBN O
number NN O
sendSms NN O
Sends VBZ O
a DT O
text JJ O
message NN O
with IN O
specified JJ O
text NN O
from IN O
the DT O
infecteddevice NN O
to TO O
the DT O
specified VBN O
phone NN O
number NN O
startInject JJ O
Triggers NNP O
the DT O
overlay NN O
attack NN O
against IN O
the DT O
specified JJ O
application NN O
startUssd NN O

Calls VBZ O
the DT O
specified JJ O
USSD NNP O
code NN O
openUrl NN O
Opens VBZ O
the DT O
specified JJ O
URL NNP O
in IN O
the DT O
WebView NNP O
getSMS NN O
Gets NNP O
all DT O
text NN O
messages NNS O
from IN O
the DT O
infected JJ O
device NN O
killMe NN O
Triggers VBZ O
the DT O
kill NN O
switch NN O
for IN O
the DT O
bot NN O
updateModule NN O
Updates VBZ O
the DT O
payload NN O
module NN O
Cerberus NNP B-Malware
features VBZ O
Cerberus NNP B-Malware
malware NN O
has VBZ O
the DT O
same JJ O
capabilities NNS O
as IN O
most JJS O
other JJ O
Android NNP B-System
banking NN O
Trojans NNS O
such JJ O
as IN O
the DT O
use NN O
of IN O
overlay NN O
attacks NNS O
, , O
SMS NNP O
control NN O
and CC O
contact JJ O
list NN O
harvesting NN O
. . O

The DT O
Trojan NNP O
can MD O
also RB O
leverage VB O
keylogging VBG O
to TO O
broaden VB O
the DT O
attack NN O
scope NN O
. . O

Overall JJ O
, , O
Cerberus NNP B-Malware
has VBZ O
a DT O
pretty RB O
common JJ O
feature NN O
list NN O
and CC O
although IN O
the DT O
malware NN O
seems VBZ O
to TO O
have VB O
been VBN O
written VBN O
from IN O
scratch NN O
there RB O
does VBZ O
not RB O
seem VB O
to TO O
be VB O
any DT O
innovative JJ O
functionality NN O
at IN O
this DT O
time NN O
. . O

For IN O
example NN O
, , O
some DT O
of IN O
the DT O
more RBR O
advanced JJ O
banking NN O
Trojans NNPS O
now RB O
offer VBP O
features NNS O
such JJ O
as IN O
a DT O
back-connect JJ O
proxy NN O
, , O
screen-streaming NN O
and CC O
even RB O
remote VB O
control NN O
. . O

Cerberus NNP B-Malware
embeds VBZ O
the DT O
following JJ O
set NN O
of IN O
features NNS O
that WDT O
allows VBZ O
itself PRP O
to TO O
remain VB O
under IN O
the DT O
radar NN O
and CC O
successfully RB O
perform JJ O
attacks NNS O
: : O
Overlaying NN O
: : O
Dynamic NNP O
( ( O
Local JJ O
injects NNS O
obtained VBN O
from IN O
C2 NNP O
) ) O
Keylogging NNP O
SMS NNP O
harvesting NN O
: : O
SMS NNP O
listing VBG O
SMS NNP O
harvesting NN O
: : O
SMS NNP O
forwarding VBG O
Device NNP O
info NN O
collection NN O
Contact NNP O
list NN O
collection NN O
Application NNP O
listing NN O
Location NNP O
collection NN O
Overlaying NN O
: : O
Targets NNS O
list VBP O
update JJ O
SMS NNP O
: : O
Sending VBG O
Calls NNS O
: : O
USSD NNP O
request NN O
making VBG O
Calls NNS O
: : O
Call VB O
forwarding VBG O
Remote JJ O
actions NNS O
: : O
App NNP O
installing VBG O
Remote JJ O
actions NNS O
: : O
App NNP O
starting VBG O
Remote JJ O
actions NNS O
: : O
App NNP O
removal NN O
Remote NNP O
actions NNS O
: : O
Showing VBG O
arbitrary JJ O
web NN O
pages NNS O
Remote VBP O
actions NNS O
: : O
Screen-locking NN O

Notifications NNS O
: : O
Push NNP O
notifications NNS O
C2 NNP O
Resilience NN O
: : O
Auxiliary JJ O
C2 NNP O
list NN O
Self-protection NN O
: : O
Hiding VBG O
the DT O
App NNP O
icon JJ O
Self-protection NN O
: : O
Preventing VBG O
removal JJ O
Self-protection NN O
: : O
Emulation-detection JJ O
Architecture NN O
: : O
Modular JJ O
Overlay NNP O
attack NN O
Most NNP O
Android NNP O
banking NN O
Trojans NNPS O
use VBP O
overlay NN O
attacks NNS O
to TO O
trick VB O
the DT O
victim NN O
into IN O
providing VBG O
their PRP$ O
personal JJ O
information NN O
( ( O
such JJ O
as IN O
but CC O
not RB O
limited JJ O
to TO O
: : O
credit NN O
card NN O
information NN O
, , O
banking NN O
credentials NNS O
, , O
mail NN O
credentials NNS O
) ) O
and CC O
Cerberus NNP B-Malware
is VBZ O
no DT O
exception NN O
. . O

In IN O
this DT O
particular JJ O
case NN O
, , O
the DT O
bot NN O
abuses VBZ O
the DT O
accessibility NN O
service NN O
privilege NN O
to TO O
obtain VB O
the DT O
package NN O
name NN O
of IN O
the DT O
foreground NN O
application NN O
and CC O
determine VB O
whether IN O
or CC O
not RB O
to TO O
show VB O
a DT O
phishing NN O
overlay NN O
window NN O
, , O
as IN O
shown VBN O
in IN O
the DT O
following JJ O
code NN O
snippet NN O
: : O
Targets VBZ O
Some DT O
examples NNS O
of IN O
phishing NN O
overlays NNS O
are VBP O
shown VBN O
below IN O
. . O

They PRP O
exist VBP O
in IN O
two CD O
types NNS O
: : O
the DT O
credentials NNS O
stealers NNS O
( ( O
first JJ O
2 CD O
screenshots NNS O
) ) O
and CC O
the DT O
credit NN O
card NN O
grabbers NNS O
( ( O
last JJ O
screenshot NN O
) ) O
. . O

The DT O
only JJ O
active JJ O
target NN O
list NN O
observed VBD O
in IN O
the DT O
wild NN O
is VBZ O
available JJ O
in IN O
the DT O
appendix NN O
and CC O
contains VBZ O
a DT O
total NN O
of IN O
30 CD O
unique JJ O
targets NNS O
. . O

It PRP O
is VBZ O
interesting VBG O
to TO O
observe VB O
that IN O
the DT O
actual JJ O
target NN O
list NN O
contains NNS O
: : O
7 CD O
French JJ O
banking NN O
apps NN O
7 CD O
U.S. NNP O
banking NN O
apps RB O
1 CD O
Japanese JJ O
banking NN O
app JJ O
15 CD O
non-banking JJ O
apps NN O
This DT O
uncommon JJ O
target NN O
list NN O
might MD O
either RB O
be VB O
the DT O
result NN O
of IN O
specific JJ O
customer NN O
demand NN O
, , O
or CC O
due JJ O
to TO O
some DT O
actors NNS O
having VBG O
partially RB O
reused VBN O
an DT O
existing VBG O
target NN O
list NN O
. . O

Conclusion NNP O
Although IN O
not RB O
yet RB O
mature JJ O
enough RB O
to TO O
provide VB O
the DT O
equivalent NN O
of IN O
a DT O
full-blown JJ O
set NN O
of IN O
Android NNP B-System
banking NN O
malware NN O
features NNS O
( ( O
such JJ O
as IN O
RAT NNP O
, , O
RAT NNP O
with IN O
ATS NNP O
( ( O
Automated NNP O
Transaction NNP O
Script NNP O
) ) O
, , O
back-connect JJ O
proxy NN O
, , O
media NNS O
streaming VBG O
) ) O
, , O
or CC O
providing VBG O
an DT O
exhaustive JJ O
target NN O
list NN O
, , O
Cerberus NNP B-Malware
should MD O
not RB O
be VB O
taken VBN O
lightly RB O
. . O

Due JJ O
to TO O
the DT O
current JJ O
absence NN O
of IN O
maintained VBN O
and CC O
supported VBN O
Android NNP B-Malware
banking VBG O
Malware-as-a-Service NNP O
in IN O
the DT O
underground JJ O
community NN O
, , O
there EX O
is VBZ O
a DT O
certainly RB O
demand NN O
for IN O
a DT O
new JJ O
service NN O
. . O

Cerberus NNP B-Malware
is VBZ O
already RB O
capable JJ O
to TO O
fulfill VB O
this DT O
demand NN O
. . O

In IN O
addition NN O
to TO O
the DT O
feature NN O
base NN O
it PRP O
already RB O
possesses VBZ O
and CC O
the DT O
money NN O
that WDT O
can MD O
be VB O
made VBN O
from IN O
the DT O
rental NN O
, , O
it PRP O
could MD O
evolve VB O
to TO O
compete VB O
with IN O
the DT O
mightiest JJS O
Android JJ B-System
banking NN O
Trojans NNPS O
. . O

Next JJ O
to TO O
the DT O
features NNS O
, , O
we PRP O
expect VBP O
the DT O
target NN O
list NN O
to TO O
be VB O
expanded VBN O
to TO O
contain VB O
additional JJ O
( ( O
banking VBG O
) ) O
apps NN O
in IN O
the DT O
near JJ O
future NN O
. . O

Knowledge NNP O
of IN O
the DT O
threat NN O
landscape NN O
and CC O
implementation NN O
of IN O
the DT O
right JJ O
detection NN O
tools NNS O
remains VBZ O
crucial JJ O
to TO O
be VB O
able JJ O
to TO O
protect VB O
yourself PRP O
from IN O
fraud NN O
; : O
Cerberus NNP B-Malware
is VBZ O
yet RB O
a DT O
new JJ O
Trojan NNP O
active JJ O
in IN O
the DT O
wild NN O
! . O

Appendix NNP O
Samples NNP O
Some DT O
of IN O
the DT O
latest JJS O
Cerberus NN B-Malware
samples NNS O
found VBN O
in IN O
the DT O
wild NN O
: : O
App NNP O
name NN O
Package NNP O
name NN O
SHA NNP O
256 CD O
hash NN O
Flash NNP B-System
Player NNP I-System
com.uxlgtsvfdc.zipvwntdy VBD B-Indicator
728a6ea44aab94a2d0ebbccbf0c1b4a93fbd9efa8813c19a88d368d6a46b4f4f CD B-Indicator
Flash NNP B-System
Player NNP I-System
com.ognbsfhszj.hqpquokjdp NN B-Indicator
fe28aba6a942b6713d7142117afdf70f5e731c56eff8956ecdb40cdc28c7c329 NN B-Indicator

Flash NNP B-System
Player NNP I-System
com.mwmnfwt.arhkrgajn NN B-Indicator
ffa5ac3460998e7b9856fc136ebcd112196c3abf24816ccab1fbae11eae4954c NN B-Indicator
Flash NNP B-System
Player NNP I-System
com.wogdjywtwq.oiofvpzpxyo VBD B-Indicator
6ac7e7ed83b4b57cc4d28f14308d69d062d29a544bbde0856d5697b0fc50cde4 CD B-Indicator
Flash NNP B-System
Player NNP I-System
com.hvdnaiujzwo.fovzeukzywfr NN B-Indicator

cfd77ddc5c1ebb8498c899a68ea75d2616c1c92a0e618113d7c9e5fcc650094b NN B-Indicator
Flash NNP B-System
Player NNP I-System
com.gzhlubw.pmevdiexmn VBD B-Indicator
3f2ed928789c200e21fd0c2095619a346f75d84f76f1e54a8b3153385850ea63 CD B-Indicator
Target NNP O
list NN O
The DT O
actual JJ O
observed JJ O
list NN O
of IN O
mobile JJ O
apps NN O
targeted VBN O
by IN O
Cerberus NNP B-Malware
contains VBZ O
a DT O
total NN O
of IN O
30 CD O
unique JJ O
applications NNS O
. . O

This DT O
list NN O
is VBZ O
expected VBN O
to TO O
expand VB O
: : O
Package NN O
name NN O
Application NNP O
name NN O
com.android.vending VBG B-Indicator
Play NNP B-System
Market NNP I-System
com.boursorama.android.clients NNS B-Indicator
Boursorama NNP I-Indicator
Banque NNP B-System
com.caisseepargne.android.mobilebanking VBG B-Indicator
Banque NNP B-System
com.chase.sig.android JJ B-Indicator
Chase NNP B-System
Mobile NNP I-System
com.clairmail.fth NN B-Indicator
Fifth NNP B-System
Third NNP I-System
Mobile NNP I-System
Banking NNP I-System
com.connectivityapps.hotmail NN B-Indicator
Connect NNP B-System
for IN I-System
Hotmail NNP I-System
com.google.android.gm NN B-Indicator
Gmail NNP B-System
com.imo.android.imoim NN B-Indicator
imo NN B-System
free JJ O
video NN O
calls NNS O
and CC O
chat NNS O
com.infonow.bofa VBD B-Indicator
Bank NNP B-System
of IN I-System
America NNP I-System

Mobile NNP I-System
Banking NNP I-System
com.IngDirectAndroid NN B-Indicator
ING NNP O
com.instagram.android NN B-Indicator
Instagram NNP I-Indicator
com.konylabs.capitalone NN B-Indicator
Capital NNP B-System
One® NNP I-System
Mobile NNP I-System
com.mail.mobile.android.mail NN B-Indicator
mail.com NN I-Indicator
mail NN B-System
com.microsoft.office.outlook NN B-Indicator
Microsoft NNP B-System
Outlook NNP I-System
com.snapchat.android NN B-Indicator
Snapchat NNP B-System
com.tencent.mm VBZ B-Indicator
WeChat NNP B-System
com.twitter.android NN B-Indicator
Twitter NNP B-System
com.ubercab NN B-Indicator
Uber NNP B-Organization
com.usaa.mobile.android.usaa NN B-Indicator
USAA NNP B-System
Mobile NNP I-System
com.usbank.mobilebanking VBG B-Indicator
U.S. NNP I-Indicator
Bank NNP O
- : O
Inspired VBN O
by IN O
customers NNS O
com.viber.voip JJ B-Indicator
Viber NNP B-System
com.wf.wellsfargomobile NN B-Indicator

Wells NNP B-System
Fargo NNP I-System
Mobile NNP I-System
com.whatsapp NN B-Indicator
WhatsApp NNP B-System
com.yahoo.mobile.client.android.mail NN B-Indicator
Yahoo NNP B-System
Mail NNP I-System
– NNP O
Organized NNP O
Email NNP O
fr.banquepopulaire.cyberplus NN B-Indicator
Banque NNP B-System
Populaire NNP O
fr.creditagricole.androidapp NN B-Indicator
Ma NNP B-System
Banque NNP I-System
jp.co.rakuten_bank.rakutenbank NN B-Indicator
楽天銀行 NNP O
-個人のお客様向けアプリ NNP O
mobi.societegenerale.mobile.lappli NN B-Indicator
L NNP O
’ NNP O
Appli NNP O
Société NNP O
Générale NNP O
net.bnpparibas.mescomptes VBZ B-Indicator
Mes NNP O
Comptes NNP O
BNP NNP O
Paribas NNP O
org.telegram.messenger NN B-Indicator
Telegram NNP I-Indicator
Triout NNP B-Malware
- : O
Spyware NN O
Framework NN O

for IN O
Android NNP B-System
with IN O
Extensive NNP O
Surveillance NNP O
Capabilities NNP O
August NNP O
20 CD O
, , O
2018 CD O
No NNP O
operating VBG O
system NN O
is VBZ O
safe JJ O
from IN O
malware NN O
, , O
as IN O
cyber NN O
criminals NNS O
will MD O
always RB O
want VB O
to TO O
steal VB O
, , O
spy VB O
or CC O
tamper VB O
with IN O
your PRP$ O
data NNS O
. . O

The DT O
proliferation NN O
of IN O
Android NNP B-Malware
devices NNS O
– VBP O
from IN O
smartphones NNS O
to TO O
tablets NNS O
and CC O
smart JJ O
TVs NNP O
– NNP O
has VBZ O
opened VBN O
up RP O
new JJ O
possibilities NNS O
for IN O
malware NN O
developers NNS O
, , O
as IN O
all PDT O
these DT O
devices NNS O
pack VBP O
microphones NNS O
, , O
cameras NNS O
and CC O
location-tracking JJ O
hardware NN O
they PRP O
can MD O
turn VB O
into IN O
the DT O
perfect JJ O
spy NN O
tools NNS O
. . O

Bitdefender NN B-Organization
researchers NNS O
have VBP O
identified VBN O
a DT O
new JJ O
Android NNP B-System
spyware NN O
, , O
dubbed VBN O
Triout NNP B-Malware
, , O
which WDT O
appears VBZ O
to TO O
act VB O
as IN O
a DT O
framework NN O
for IN O
building VBG O
extensive JJ O
surveillance NN O
capabilities NNS O
into IN O
seemingly RB O
benign JJ O
applications NNS O
. . O

Found NNP O
bundled VBD O
with IN O
a DT O
repackaged JJ O
app NN O
, , O
the DT O
spyware NN O
’ NNP O
s NN O
surveillance NN O
capabilities NNS O
involve VBP O
hiding VBG O
its PRP$ O
presence NN O
on IN O
the DT O
device NN O
, , O
recording VBG O
phone NN O
calls NNS O
, , O
logging VBG O
incoming VBG O
text JJ O
messages NNS O
, , O
recoding VBG O
videos NNS O
, , O
taking VBG O
pictures NNS O
and CC O
collecting VBG O
GPS NNP B-System
coordinates NNS O
, , O
then RB O
broadcasting VBG O
all DT O
of IN O
that DT O
to TO O
an DT O
attacker-controlled JJ O
C NNP O
& CC O
C NNP O
( ( O
command NN O
and CC O
control NN O
) ) O
server NN O
. . O

It PRP O
’ VBZ O
s JJ O
interesting VBG O
that IN O
Triout NNP B-Malware
, , O
which WDT O
is VBZ O
detected VBN O
by IN O
Bitdefender NNP B-Organization
’ NNP O
s FW O
machine NN O
learning VBG O
algorithms NN O
, , O
was VBD O
first RB O
submitted VBN O
from IN O
Russia NNP O
, , O
and CC O
most JJS O
scans/reports NNS O
came VBD O
from IN O
Israel NNP O
. . O

The DT O
sample NN O
’ NNP O
s NN O
first RB O
appearance RB O
seems VBZ O
to TO O
be VB O
May NNP O
15 CD O
, , O
2018 CD O
, , O
when WRB O
it PRP O
was VBD O
uploaded VBN O
to TO O
VirusTotal NNP B-Organization
, , O
but CC O
it PRP O
’ VBZ O
s JJ O
unclear JJ O
how WRB O
the DT O
tainted JJ O
sample NN O
is VBZ O
disseminated VBN O
. . O

Third-party JJ O
marketplaces NNS O
or CC O
some DT O
other JJ O
attacker-controlled JJ O
domains NNS O
are VBP O
likely JJ O
used VBN O
to TO O
host VB O
the DT O
sample NN O
. . O

A DT O
subsequent JJ O
investigation NN O
revealed VBD O
that IN O
the DT O
spyware NN O
has VBZ O
the DT O
following JJ O
capabilities NNS O
: : O
Records NNS O
every DT O
phone NN O
call NN O
( ( O
literally RB O
the DT O
conversation NN O
as IN O
a DT O
media NNS O
file NN O
) ) O
, , O
then RB O
sends VBZ O
it PRP O
together RB O
with IN O
the DT O
caller NN O
id NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
( ( O
incall3.php JJ B-Indicator
and CC O
outcall3.php NN B-Indicator
) ) O
Logs NNP O
every DT O
incoming NN O
SMS NNP O
message NN O
( ( O
SMS NNP O
body NN O
and CC O
SMS NNP O
sender NN O
) ) O
to TO O
C NNP O
& CC O
C NNP O
( ( O
script3.php NN B-Indicator
) ) O
Has VBZ O
capability NN O
to TO O
hide VB O
self PRP O
Can MD O
send VB O
all DT O
call NN O
logs NNS O
( ( O
“ JJ O
content NN B-Indicator
: : I-Indicator
//call_log/calls NNS I-Indicator
” VBP O
, , O
info NN O
: : O
callname NN O
, , O
callnum NN O
, , O
calldate NN O
, , O
calltype NN O
, , O
callduration NN O

) ) O
to TO O
C NNP O
& CC O
C NNP O
( ( O
calllog.php NN B-Indicator
) ) O
Whenever IN O
the DT O
user NN O
snaps VBZ O
a DT O
picture NN O
, , O
either RB O
with IN O
the DT O
front NN O
or CC O
rear JJ O
camera NN O
, , O
it PRP O
gets VBZ O
sent VBN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
( ( O
uppc.php JJ B-Indicator
, , O
fi JJ O
npic.php FW B-Indicator
orreqpic.php NN B-Indicator
) ) O
Can MD O
send VB O
GPS NNP B-System
coordinates NNS O
to TO O
C NNP O
& CC O
C NNP O
( ( O
gps3.php NN B-Indicator
) ) O
The DT O
C NNP O
& CC O
C NNP O
server NN O
to TO O
which WDT O
the DT O
application NN O
seems VBZ O
to TO O
be VB O
sending VBG O
collected VBN O
data NNS O
appears VBZ O
to TO O
be VB O
operational JJ O
, , O
as IN O
of IN O
this DT O
writing NN O
, , O
and CC O
running VBG O
since IN O
May NNP O
2018 CD O
. . O

January NNP O
23 CD O
, , O
2017 CD O
SpyNote NNP B-Malware
RAT NNP I-Malware
posing VBG O
as IN O
Netflix NNP B-System
app NN I-System
As IN O
users NNS O
have VBP O
become VBN O
more RBR O
attached JJ O
to TO O
their PRP$ O
mobile JJ O
devices NNS O
, , O
they PRP O
want VBP O
everything NN O
on IN O
those DT O
devices NNS O
. . O

There EX O
’ NNP O
s VBD O
an DT O
app NN O
for IN O
just RB O
about IN O
any DT O
facet NN O
of IN O
one CD O
’ NN O
s VBZ O
personal JJ O
and CC O
professional JJ O
life NN O
, , O
from IN O
booking VBG O
travel NN O
and CC O
managing NN O
projects NNS O
, , O
to TO O
buying VBG O
groceries NNS O
and CC O
binge-watching VBG O
the DT O
latest JJS O
Netflix NNP B-Organization
series NN O
. . O

The DT O
iOS NN B-System
and CC O
Android NNP B-System
apps NN O
for IN O
Netflix NNP B-Organization
are VBP O
enormously RB O
popular JJ O
, , O
effectively RB O
turning VBG O
a DT O
mobile JJ O
device NN O
into IN O
a DT O
television NN O
with IN O
which WDT O
users NNS O
can MD O
stream VB O
full JJ O
movies NNS O
and CC O
TV NN O
programs NNS O
anytime RB O
, , O
anywhere RB O
. . O

But CC O
the DT O
apps NN O
, , O
with IN O
their PRP$ O
many JJ O
millions NNS O
of IN O
users NNS O
, , O
have VBP O
captured VBN O
the DT O
attention NN O
of IN O
the DT O
bad JJ O
actors NNS O
, , O
too RB O
, , O
who WP O
are VBP O
exploiting VBG O
the DT O
popularity NN O
of IN O
Netflix NNP B-Organization
to TO O
spread VB O
malware NN O
. . O

Recently RB O
, , O
the DT O
ThreatLabZ NNP B-Organization
research NN O
team NN O
came VBD O
across IN O
a DT O
fake JJ B-System
Netflix NNP I-System
app NN I-System
, , O
which WDT O
turned VBD O
out RP O
to TO O
be VB O
a DT O
new JJ O
variant NN O
of IN O
SpyNote NNP B-Malware
RAT NNP I-Malware
( ( O
Remote NNP O
Access NNP O
Trojan NNP O
) ) O
. . O

SpyNote NNP B-Malware
RAT NNP I-Malware
is VBZ O
capable JJ O
of IN O
performing VBG O
a DT O
variety NN O
of IN O
alarming VBG O
functions NNS O
that WDT O
includes VBZ O
: : O
Activating VBG O
the DT O
device NN O
’ NNP O
s VBZ O
microphone NN O
and CC O
listening VBG O
to TO O
live VB O
conversations NNS O
Executing VBG O
commands NNS O
on IN O
the DT O
device NN O
Copying NNP O
files NNS O
from IN O
the DT O
device NN O
to TO O
a DT O
Command NNP O
& CC O
Control NNP O
( ( O
C NNP O
& CC O
C NNP O
) ) O
center NN O
Recording VBG O
screen JJ O
captures NNS O
Viewing VBG O
contacts NNS O
Reading VBG O
SMS NNP O
messages VBZ O
The DT O
screenshot NN O
below IN O
shows NNS O
part NN O
of IN O
the DT O
sandbox NN O
’ NNP O
s VBZ O
report NN O
on IN O
the DT O
SpyNote NNP B-Malware
RAT NNP I-Malware
’ NNP O
s JJ O
signature NN O
and CC O
detected JJ O
functions NNS O
: : O
The DT O
fake JJ O
Netflix NNP B-Organization
app NN O
we PRP O
are VBP O
analyzing VBG O
in IN O
this DT O
blog NN O
appears VBZ O
to TO O
be VB O
built VBN O
using VBG O
an DT O
updated JJ O
version NN O
of IN O
SpyNote NNP B-Malware
RAT NNP I-Malware
builder NN O
, , O

which WDT O
was VBD O
leaked VBN O
last JJ O
year NN O
. . O

Technical NNP O
details NNS O
Please NNP O
note NN O
that IN O
our PRP$ O
research NN O
is VBZ O
not RB O
about IN O
the DT O
legitimate JJ O
Netflix NNP B-System
app NN I-System
on IN O
Google NNP B-System
Play NNP I-System
. . O

The DT O
spyware NN O
in IN O
this DT O
analysis NN O
was VBD O
portraying VBG O
itself PRP O
as IN O
the DT O
Netflix NNP B-System
app NN I-System
. . O

Once RB O
installed VBN O
, , O
it PRP O
displayed VBD O
the DT O
icon NN O
found VBD O
in IN O
the DT O
actual JJ O
Netflix NNP B-System
app NN I-System
on IN O
Google NNP B-System
Play NNP I-System
. . O

As RB O
soon RB O
as IN O
the DT O
user NN O
clicks VBZ O
the DT O
spyware NN O
’ NNP O
s VBZ O
icon NN O
for IN O
the DT O
first JJ O
time NN O
, , O
nothing NN O
seems VBZ O
to TO O
happen VB O
and CC O
the DT O
icon NN O
disappears VBZ O
from IN O
the DT O
home NN O
screen NN O
. . O

This DT O
is VBZ O
a DT O
common JJ O
trick NN O
played VBN O
by IN O
malware NN O
developers NNS O
, , O
making VBG O
the DT O
user NN O
think VBP O
the DT O
app NN O
may MD O
have VB O
been VBN O
removed VBN O
. . O

But CC O
, , O
behind IN O
the DT O
scenes NNS O
, , O
the DT O
malware NN O
has VBZ O
not RB O
been VBN O
removed VBN O
; : O
instead RB O
it PRP O
starts VBZ O
preparing VBG O
its PRP$ O
onslaught NN O
of IN O
attacks NNS O
. . O

For IN O
contacting VBG O
C NNP O
& CC O
C NNP O
, , O
the DT O
spyware NN O
was VBD O
found VBN O
to TO O
be VB O
using VBG O
free JJ O
DNS NNP B-Indicator
services NNS O
, , O
as IN O
shown VBN O
in IN O
the DT O
screenshot JJ O
below IN O
: : O
SpyNote JJ B-Malware
RAT NNP I-Malware
uses VBZ O
an DT O
unusual JJ O
trick NN O
to TO O
make VB O
sure JJ O
that IN O
it PRP O
remains VBZ O
up RP O
and CC O
running VBG O
and CC O
that IN O
the DT O
spying NN O
does VBZ O
not RB O
stop VB O
. . O

It PRP O
does VBZ O
so RB O
using VBG O
the DT O
Services NNPS O
, , O
Broadcast NNP O
Receivers NNP O
, , O
and CC O
Activities NNP O
components NNS O
of IN O
the DT O
Android NNP B-System
platform NN O
. . O

Services NNS O
can MD O
perform VB O
long-running JJ O
operations NNS O
in IN O
the DT O
background NN O
and CC O
does VBZ O
not RB O
need VB O
a DT O
user JJ O
interface NN O
. . O

Broadcast NN O
Receivers NNS O
are VBP O
Android JJ B-System
components NNS O
that WDT O
can MD O
register VB O
themselves PRP O
for IN O
particular JJ O
events NNS O
. . O

Activities NNS O
are VBP O
key JJ O
building NN O
blocks NNS O
, , O
central JJ O
to TO O
an DT O
app NN O
’ NNP O
s NN O
navigation NN O
, , O
for IN O
example NN O
. . O

The DT O
SpyNote NNP B-Malware
RAT NNP I-Malware
registers VBZ O
a DT O
service NN O
called VBN O
AutoStartup NNP O
and CC O
a DT O
broadcast NN O
receiver NN O
named VBN O
BootComplete NNP O
. . O

MainActivity NN O
registers NNS O
BootComplete NNP O
with IN O
a DT O
boot NN O
event NN O
, , O
so IN O
that DT O
whenever VBZ O
the DT O
device NN O
is VBZ O
booted VBN O
, , O
BootComplete NNP O
gets VBZ O
triggered VBN O
. . O

BootComplete NNP O
starts VBZ O
the DT O
AutoStartup NNP O
service NN O
and CC O
the DT O
AutoStartup NNP O
service NN O
makes VBZ O
sure JJ O
that IN O
MainActivity NNP O
is VBZ O
always RB O
running VBG O
. . O

What WP O
follows VBZ O
are VBP O
some DT O
of IN O
the DT O
features NNS O
exhibited VBN O
by IN O
SpyNote NNP B-Malware
RAT NNP I-Malware
. . O

Command NNP O
execution NN O
Command NNP O
execution NN O
can MD O
create VB O
havoc NN O
for IN O
victim NN O
if IN O
the DT O
malware NN O
developer NN O
decides VBZ O
to TO O
execute VB O
commands NNS O
in IN O
the DT O
victim NN O
’ NNP O
s NN O
device NN O
. . O

Leveraging VBG O
this DT O
feature NN O
, , O
the DT O
malware NN O
developer NN O
can MD O
root VB O
the DT O
device NN O
using VBG O
a DT O
range NN O
of IN O
vulnerabilities NNS O
, , O
well-known JJ O
or CC O
zero-day JJ O
. . O

The DT O
following JJ O
screenshot NN O
shows VBZ O
the DT O
command NN O
execution NN O
functionality NN O
in IN O
action NN O
: : O
The DT O
paramString NN O
parameter NN O
shown VBN O
in IN O
the DT O
above JJ O
screenshot NN O
can MD O
be VB O
any DT O
command NN O
received VBN O
from IN O
C NNP O
& CC O
C NNP O
. . O

Screen JJ O
capture NN O
and CC O
audio JJ O
recording NN O
SpyNote NNP B-Malware
RAT NNP I-Malware
was VBD O
able JJ O
to TO O
take VB O
screen NN O
captures NNS O
and CC O
, , O
using VBG O
the DT O
device NN O
’ NNP O
s VBZ O
microphone NN O
, , O
listen VB O
to TO O
audio VB O
conversations NNS O
. . O

This DT O
capability NN O
was VBD O
confirmed VBN O
when WRB O
the DT O
Android NNP B-System
permission NN O
, , O
called VBN O
android.permission.RECORD_AUDIO NN B-Indicator
, , O
was VBD O
being VBG O
requested VBN O
along IN O
with IN O
code NN O
found VBN O
in IN O
the DT O
app NN O
. . O

SpyNote NNP B-Malware
RAT NNP I-Malware
captured VBD O
the DT O
device NN O
’ NNP O
s NN O
screen NN O
activities NNS O
along IN O
with IN O
audio JJ O
using VBG O
the DT O
MediaProjectionCallback NNP O
functionality NN O
( ( O
available JJ O
with IN O
Lollipop NNP B-System
, , O
the DT O
Android NNP B-System
5.0 CD I-System
release NN O
, , O
and CC O
later RB O
) ) O
and CC O
saved VBD O
the DT O
output NN O
in IN O
a DT O
file NN O
named VBN O
" NNP O
video.mp4 NN B-Indicator
'' '' O
as IN O
shown VBN O
in IN O
the DT O
following JJ O
screenshot JJ O
SMS NNP O
stealing VBG O
SpyNote NNP B-Malware
RAT NNP I-Malware
was VBD O
also RB O
observed JJ O
stealing VBG O
SMS NNP O
messages NNS O
from IN O
the DT O
affected JJ O
devices NNS O
, , O
as IN O
shown VBN O
in IN O
screenshot JJ O
below IN O
: : O
Stealing VBG O
contacts NNS O
The DT O
ability NN O
to TO O
steal VB O
contacts NNS O
is VBZ O
a DT O
favorite JJ O
feature NN O
for IN O
spyware NN O
developers NNS O
, , O
as IN O
the DT O
stolen JJ O
contacts NNS O
can MD O
be VB O
used VBN O
to TO O
further RBR O
spread VB O
the DT O
spyware NN O

. . O

The DT O
following JJ O
screenshot NN O
shows VBZ O
the DT O
contacts NNS O
being VBG O
stolen VBN O
and CC O
written VBN O
in IN O
a DT O
local JJ O
array NN O
, , O
which WDT O
is VBZ O
then RB O
sent VBN O
to TO O
C NNP O
& CC O
C NNP O
: : O
Uninstalling VBG O
apps RP O
Uninstalling VBG O
apps NN O
is VBZ O
another DT O
function NN O
favored VBN O
by IN O
developers NNS O
of IN O
Android NNP B-System
spyware NN O
and CC O
malware NN O
. . O

They PRP O
tend VBP O
to TO O
target VB O
any DT O
antivirus JJ O
protections NNS O
on IN O
the DT O
device NN O
and CC O
uninstall VB O
them PRP O
, , O
which WDT O
increases VBZ O
the DT O
possibility NN O
of IN O
their PRP$ O
malware NN O
persisting VBG O
on IN O
the DT O
device NN O
. . O

Following VBG O
screenshot NN O
shows NNS O
this DT O
functionality NN O
in IN O
action NN O
: : O
Other JJ O
functions NNS O
In IN O
addition NN O
to TO O
the DT O
functionalities NNS O
we PRP O
’ VBP O
ve JJ O
described NN O
, , O
the DT O
SpyNote NNP B-Malware
RAT NNP I-Malware
was VBD O
exhibiting VBG O
many JJ O
other JJ O
behaviors NNS O
that WDT O
make VBP O
it PRP O
more RBR O
robust JJ O
than IN O
most JJS O
off-the-shelf JJ O
malware NN O
. . O

SpyNote NNP B-Malware
RAT NNP I-Malware
was VBD O
designed VBN O
to TO O
function VB O
only RB O
over IN O
Wi-Fi NNP O
, , O
which WDT O
is VBZ O
the DT O
preferable JJ O
mode NN O
for IN O
Android NNP B-System
malware NN O
to TO O
send VB O
files NNS O
to TO O
C NNP O
& CC O
C NNP O
. . O

The DT O
screenshot NN O
below IN O
shows NNS O
SpyNote NNP B-Malware
RAT NNP I-Malware
scanning VBG O
for IN O
Wi-Fi NNP O
and CC O
enabling VBG O
it PRP O
if IN O
a DT O
known JJ O
channel NN O
is VBZ O
found VBN O
: : O
Additional JJ O
features NNS O
- : O
SpyNote NNP B-Malware
RAT NNP I-Malware
could MD O
click VB O
photos NNS O
using VBG O
the DT O
device NN O
's POS O
camera NN O
, , O
based VBN O
on IN O
commands NNS O
from IN O
C NNP O
& CC O
C NNP O
. . O

- : O
There EX O
were VBD O
two CD O
interesting JJ O
sub-classes NNS O
found VBD O
inside RB O
Main NNP O
Activity NNP O
: : O
Receiver NN O
and CC O
Sender NNP O
. . O

Receiver NNP O
was VBD O
involved VBN O
in IN O
receiving VBG O
commands NNS O
from IN O
the DT O
Server NNP O
and CC O
the DT O
main JJ O
functionality NN O
of IN O
Sender NNP O
was VBD O
to TO O
send VB O
all PDT O
the DT O
data NNS O
collected VBN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
over IN O
Wi-Fi NNP O
. . O

- : O
SpyNote NN B-Malware
RAT NNP I-Malware
was VBD O
also RB O
collecting VBG O
the DT O
device NN O
’ NNP O
s NN O
location NN O
to TO O
identify VB O
the DT O
exact JJ O
location NN O
of IN O
the DT O
victim NN O
. . O

SpyNote NNP B-Malware
RAT NNP I-Malware
builder VB O
The DT O
SpyNote NNP B-Malware
Remote NNP O
Access NNP O
Trojan NNP O
( ( O
RAT NNP O
) ) O
builder NN O
is VBZ O
gaining VBG O
popularity NN O
in IN O
the DT O
hacking NN O
community NN O
, , O
so IN O
we PRP O
decided VBD O
to TO O
study VB O
its PRP$ O
pervasiveness NN O
. . O

What WP O
we PRP O
found VBD O
were VBD O
several JJ O
other JJ O
fake JJ O
apps NN O
developed VBD O
using VBG O
the DT O
SpyNote NNP B-Malware
builder NN O
, , O
which WDT O
should MD O
come VB O
as IN O
a DT O
warning NN O
to TO O
Android NNP B-System
users NNS O
. . O

Some DT O
of IN O
the DT O
targeted JJ O
apps NN O
were VBD O
: : O
Whatsapp NNP B-System
YouTube NNP B-System
Video NNP I-System
Downloader NNP I-System
Google NNP B-System
Update NNP I-System
Instagram NNP B-System
Hack NNP B-System
Wifi NNP I-System
AirDroid NNP B-System
WifiHacker NNP B-System
Facebook NNP B-System
Photoshop NNP B-System
SkyTV NNP B-System
Hotstar NNP B-System
Trump NNP B-System
Dash NNP I-System
PokemonGo NNP B-System
With IN O
many JJ O
more JJR O
to TO O
come VB O
. . O

Furthermore RB O
, , O
we PRP O
found VBD O
that IN O
in IN O
just RB O
the DT O
first JJ O
two CD O
weeks NNS O
of IN O
2017 CD O
, , O
there EX O
have VBP O
been VBN O
more JJR O
than IN O
120 CD O
such JJ O
spyware JJ O
variants NNS O
already RB O
built VBN O
using VBG O
the DT O
same JJ O
SpyNote NNP B-Malware
Trojan NNP O
builder NN O
as IN O
SpyNote NNP B-Malware
RAT NNP I-Malware
and CC O
roaming VBG O
in IN O
the DT O
wild NN O
. . O

A DT O
complete JJ O
list NN O
of IN O
sample JJ O
hashes NNS O
is VBZ O
available JJ O
here RB O
. . O

Conclusion NNP O
The DT O
days NNS O
when WRB O
one CD O
needed VBN O
in-depth JJ O
coding NN O
knowledge NN O
to TO O
develop VB O
malware NN O
are VBP O
long JJ O
gone VBN O
. . O

Nowadays NNS O
, , O
script NN O
kiddies NNS O
can MD O
build VB O
a DT O
piece NN O
of IN O
malware NN O
that WDT O
can MD O
create VB O
real JJ O
havoc NN O
. . O

Moreover RB O
, , O
there EX O
are VBP O
many JJ O
toolkits NNS O
like IN O
the DT O
SpyNote NNP B-Malware
Trojan NNP O
builder NN O
that WDT O
enable JJ O
users NNS O
to TO O
build VB O
malware NN O
with IN O
ease NN O
and CC O
few JJ O
clicks NNS O
. . O

In IN O
particular JJ O
, , O
avoid JJ O
side-loading JJ O
apps NN O
from IN O
third-party JJ O
app NN O
stores NNS O
and CC O
avoid VB O
the DT O
temptation NN O
to TO O
play VB O
games NNS O
that WDT O
are VBP O
not RB O
yet RB O
available JJ O
on IN O
Android NNP B-System
. . O

Yes UH O
, , O
we PRP O
are VBP O
talking VBG O
about IN O
SuperMarioRun NNP B-System
, , O
which WDT O
was VBD O
recently RB O
launched VBN O
by IN O
Nintendo NNP B-Organization
only RB O
for IN O
iOS JJ B-System
users NNS O
. . O

Recent JJ O
blogs NNS O
by IN O
the DT O
Zscaler NNP B-Organization
research NN O
team NN O
explain VB O
how WRB O
some DT O
variants NNS O
of IN O
Android NNP B-Malware
malware NN O
are VBP O
exploiting VBG O
the DT O
popularity NN O
of IN O
this DT O
game NN O
and CC O
tricking VBG O
Android NNP B-System
users NNS O
into IN O
downloading VBG O
a DT O
fake JJ O
version NN O
. . O

( ( O
Have VBP O
a DT O
look NN O
here RB O
and CC O
here RB O
. . O

) ) O
You PRP O
should MD O
also RB O
avoid VB O
the DT O
temptation NN O
to TO O
play VB O
games NNS O
from IN O
sources NNS O
other JJ O
than IN O
legitimate JJ O
app NN O
stores NNS O
; : O
such JJ O
games NNS O
are VBP O
not RB O
safe JJ O
and CC O
may MD O
bring VB O
harm NN O
to TO O
your PRP$ O
reputation NN O
and CC O
your PRP$ O
bank NN O
account NN O
. . O

FakeSpy NNP B-Malware
Masquerades NNP O
as IN O
Postal NNP O
Service NNP O
Apps NNP O
Around IN O
the DT O
World NNP O
July NNP O
1 CD O
, , O
2020 CD O
KEY NNP O
FINDINGS NNP O
The DT O
Cybereason NNP B-Organization
Nocturnus NNP I-Organization
team NN O
is VBZ O
investigating VBG O
a DT O
new JJ O
campaign NN O
involving VBG O
FakeSpy NNP B-Malware
, , O
an DT O
Android NNP B-System
mobile NN O
malware NN O
that WDT O
emerged VBD O
around IN O
October NNP O
2017 CD O
. . O

FakeSpy NNP B-Malware
is VBZ O
an DT O
information NN O
stealer NN O
used VBN O
to TO O
steal VB O
SMS NNP O
messages NNS O
, , O
send VBP O
SMS NNP O
messages NNS O
, , O
steal JJ O
financial JJ O
data NNS O
, , O
read JJ O
account NN O
information NN O
and CC O
contact NN O
lists NNS O
, , O
steal JJ O
application NN O
data NNS O
, , O
and CC O
do VBP O
much RB O
more RBR O
. . O

FakeSpy NNP B-Malware
first RB O
targeted VBD O
South JJ O
Korean JJ O
and CC O
Japanese JJ O
speakers NNS O
. . O

However RB O
, , O
it PRP O
has VBZ O
begun VBN O
to TO O
target VB O
users NNS O
all DT O
around IN O
the DT O
world NN O
, , O
especially RB O
users NNS O
in IN O
countries NNS O
like IN O
China NNP O
, , O
Taiwan NNP O
, , O
France NNP O
, , O
Switzerland NNP O
, , O
Germany NNP O
, , O
United NNP O
Kingdom NNP O
, , O
United NNP O
States NNPS O
, , O
and CC O
others NNS O
. . O

FakeSpy NNP B-Malware
masquerades NNS O
as IN O
legitimate JJ O
postal JJ O
service NN O
apps NN O
and CC O
transportation NN O
services NNS O
in IN O
order NN O
to TO O
gain VB O
the DT O
users NNS O
' POS O
trust NN O
. . O

Once RB O
installed VBN O
, , O
the DT O
application NN O
requests NNS O
permissions NNS O
so RB O
that IN O
it PRP O
may MD O
control VB O
SMS NNP O
messages NNS O
and CC O
steal JJ O
sensitive JJ O
data NNS O
on IN O
the DT O
device NN O
, , O
as RB O
well RB O
as IN O
proliferate NN O
to TO O
other JJ O
devices NNS O
in IN O
the DT O
target NN O
device NN O
’ NNP O
s VBZ O
contact JJ O
list NN O
. . O

Cybereason NNP B-Organization
's POS O
investigation NN O
shows VBZ O
that IN O
the DT O
threat NN O
actor NN O
behind IN O
the DT O
FakeSpy NNP B-Malware
campaign NN O
is VBZ O
a DT O
Chinese-speaking JJ O
group NN O
dubbed VBD O
" NNP O
Roaming NNP B-Organization
Mantis NNP I-Organization
'' '' O
, , O
a DT I-Organization
group NN O
that WDT O
has VBZ O
led VBN O
similar JJ O
campaigns NNS O
. . O

FakeSpy NNP B-Malware
has VBZ O
been VBN O
in IN O
the DT O
wild NN O
since IN O
2017 CD O
; : O
this DT O
latest JJS O
campaign NN O
indicates VBZ O
that IN O
it PRP O
has VBZ O
become VBN O
more RBR O
powerful JJ O
. . O

Code NNP O
improvements NNS O
, , O
new JJ O
capabilities NNS O
, , O
anti-emulation NN O
techniques NNS O
, , O
and CC O
new JJ O
, , O
global JJ O
targets NNS O
all DT O
suggest VBP O
that IN O
this DT O
malware NN O
is VBZ O
well-maintained JJ O
by IN O
its PRP$ O
authors NNS O
and CC O
continues VBZ O
to TO O
evolve VB O
. . O

TABLE NN O
OF IN O
CONTENTS NNP O
Key NNP O
Findings NNP O
Introduction NNP O
Threat NNP O
Analysis NNP O
Fakespy NNP B-Malware
Code NNP O
Analysis NNP O
Dynamic NNP O
Library NNP O
Loading NNP O
Stealing NNP O
Sensitive JJ O
Information NNP O
Anti-Emulator NNP O
Techniques NNP O
Under IN O
Active NNP O
Development NNP O
Who NNP O
is VBZ O
Behind NNP O
Fakespy NNP B-Malware
's POS O
Smishing VBG O
Campaigns NNP O
? . O

Conclusions NNS O
Cybereason NNP B-Organization
Mobile NNP I-Organization
Detects NNPS O
and CC O
Stops NNP O
FakeSpy NNP B-Malware
Indicators NNPS O
of IN O
Compromise NNP O
INTRODUCTION NNP O
For IN O
the DT O
past JJ O
several JJ O
weeks NNS O
, , O
Cybereason NNP B-Organization
has VBZ O
been VBN O
investigating VBG O
a DT O
new JJ O
version NN O
of IN O
Android NNP B-System
malware NN O
dubbed VBN O
FakeSpy NNP B-Malware
, , O
which WDT O
was VBD O
first RB O
identified VBN O
in IN O
October NNP O
2017 CD O
and CC O
reported VBD O
again RB O
in IN O
October NNP O
2018 CD O
. . O

A DT O
new JJ O
campaign NN O
is VBZ O
up RB O
and CC O
running VBG O
using VBG O
newly RB O
improved VBN O
, , O
significantly RB O
more RBR O
powerful JJ O
malware NN O
as IN O
compared VBN O
to TO O
previous JJ O
versions NNS O
. . O

FakeSpy NNP B-Malware
is VBZ O
under IN O
active JJ O
development NN O
and CC O
is VBZ O
evolving VBG O
rapidly RB O
; : O
new JJ O
versions NNS O
are VBP O
released VBN O
every DT O
week NN O
with IN O
additional JJ O
evasion NN O
techniques NNS O
and CC O
capabilities NNS O
. . O

Our PRP$ O
analysis NN O
shows VBZ O
that IN O
the DT O
threat NN O
actor NN O
behind IN O
the DT O
FakeSpy NNP B-Malware
malware NN O
is VBZ O
a DT O
Chinese-speaking JJ O
group NN O
, , O
commonly RB O
referred VBD O
to TO O
as IN O
" JJ O
Roaming VBG B-Organization
Mantis NN I-Organization
'' '' O
, , O
a DT I-Organization
group NN O
that WDT O
is VBZ O
known VBN O
to TO O
have VB O
launched VBN O
similar JJ O
campaigns NNS O
in IN O
the DT O
past NN O
. . O

FakeSpy NNP B-Malware
is VBZ O
an DT O
information NN O
stealer NN O
that WDT O
exfiltrates VBZ O
and CC O
sends VBZ O
SMS NNP O
messages NNS O
, , O
steals NNS O
financial JJ O
and CC O
application NN O
data NNS O
, , O
reads VBZ O
account NN O
information NN O
and CC O
contact NN O
lists NNS O
, , O
and CC O
more JJR O
. . O

The DT O
malware NN O
uses VBZ O
smishing VBG O
, , O
or CC O
SMS NNP O
phishing NN O
, , O
to TO O
infiltrate VB O
target NN O
devices NNS O
, , O
which WDT O
is VBZ O
a DT O
technique NN O
that WDT O
relies VBZ O
on IN O
social JJ O
engineering NN O
. . O

The DT O
attackers NNS O
send VBP O
fake JJ O
text NN O
messages NNS O
to TO O
lure VB O
the DT O
victims NNS O
to TO O
click VB O
on IN O
a DT O
malicious JJ O
link NN O
. . O

The DT O
link NN O
directs VBZ O
them PRP O
to TO O
a DT O
malicious JJ O
web NN O
page NN O
, , O
which WDT O
prompts VBZ O
them PRP O
to TO O
download VB O
an DT O
Android NNP O
application NN O
package NN O
( ( O
APK NNP O
) ) O
. . O

This DT O
most RBS O
recent JJ O
FakeSpy NNP B-Malware
campaign NN O
appears VBZ O
to TO O
target VB O
users NNS O
of IN O
postal JJ O
services NNS O
around IN O
the DT O
world NN O
. . O

New NNP O
versions NNS O
of IN O
FakeSpy NNP B-Malware
masquerade NN O
as IN O
government NN O
post NN O
office NN O
apps NN O
and CC O
transportation NN O
services NNS O
apps NN O
. . O

Our PRP$ O
analysis NN O
indicates VBZ O
that IN O
the DT O
threat NN O
actors NNS O
are VBP O
no RB O
longer RBR O
limiting VBG O
their PRP$ O
campaigns NNS O
to TO O
East NNP O
Asian JJ O
countries NNS O
, , O
but CC O
are VBP O
targeting VBG O
additional JJ O
countries NNS O
around IN O
the DT O
world NN O
. . O

THREAT JJ O
ANALYSIS NNP O
Infection NNP O
Vector NNP O
: : O
Smishing VBG O
Your PRP$ O
Device NNP O
Thus NNP O
far RB O
, , O
FakeSpy NNP B-Malware
campaigns NNS O
are VBP O
characterized VBN O
by IN O
SMS NNP O
phishing NN O
( ( O
a.k.a NN O
. . O

smishing VBG O
) ) O
. . O

These DT O
SMS NNP O
messages NNS O
masquerade VBD O
as IN O
a DT O
message NN O
from IN O
the DT O
local JJ O
post NN O
office NN O
and CC O
link NN O
to TO O
the DT O
FakeSpy NNP B-Malware
download NN O
. . O

In IN O
a DT O
previous JJ O
campaign NN O
reported VBN O
by IN O
JPCERT NNP B-Organization
, , O
mobile JJ O
users NNS O
were VBD O
alerted VBN O
by IN O
phishy JJ O
messages NNS O
containing VBG O
“ JJ O
delivery NN O
updates VBZ O
” VBP O
purportedly RB O
from IN O
Sagawa NNP B-Organization
Express NNP I-Organization
. . O

Fake NNP O
SMS NNP O
message NN O
luring VBG O
users NNS O
to TO O
enter VB O
a DT O
fake JJ O
website NN O
, , O
which WDT O
contains VBZ O
the DT O
malicious JJ O
APK NNP O
( ( O
JPCERT NNP B-Organization
report NN O
) ) O
. . O

Clicking VBG O
the DT O
SMS NNP O
link NN O
brings VBZ O
the DT O
user NN O
to TO O
a DT O
fake JJ O
website NN O
that WDT O
prompts VBZ O
them PRP O
to TO O
download VB O
and CC O
install VB O
the DT O
FakeSpy NNP B-Malware
APK NNP O
, , O
which WDT O
is VBZ O
masquerading VBG O
as IN O
a DT O
local JJ O
postal JJ O
service NN O
app NN O
. . O

Targeting VBG O
Postal NNP O
and CC O
Transportation NNP O
Services NNP O
Companies NNP O
One NNP O
of IN O
the DT O
most RBS O
significant JJ O
findings NNS O
is VBZ O
that IN O
new JJ O
versions NNS O
of IN O
FakeSpy NNP B-Malware
target NN O
not RB O
only JJ O
Korean JJ O
and CC O
Japanese JJ O
speakers NNS O
, , O
but CC O
also RB O
almost RB O
any DT O
postal JJ O
service NN O
company NN O
around IN O
the DT O
world NN O
. . O

Example NN O
of IN O
more RBR O
recent JJ O
FakeSpy NNP B-Malware
campaigns NNS O
targeting VBG O
France NNP O
. . O

New NNP O
FakeSpy NNP B-Malware
campaign NN O
applications NNS O
leveraging VBG O
fake VBP O
postal JJ O
services NNS O
apps NN O
. . O

All DT O
recent JJ O
FakeSpy NNP B-Malware
versions NNS O
contain VBP O
the DT O
same JJ O
code NN O
with IN O
minor JJ O
changes NNS O
. . O

The DT O
FakeSpy NNP B-Malware
malware NN O
has VBZ O
been VBN O
found VBN O
to TO O
masquerade VB O
as IN O
any DT O
of IN O
the DT O
following JJ O
companies NNS O
: : O
United NNP B-Organization
States NNPS I-Organization
Postal NNP I-Organization
Service NNP I-Organization
- : O
An DT O
independent JJ O
agency NN O
of IN O
the DT O
executive NN O
branch NN O
of IN O
the DT O
United NNP O
States NNPS O
federal JJ O
government NN O
. . O

USPS NNP B-Organization
is VBZ O
the DT O
most RBS O
well-known JJ O
branch NN O
of IN O
the DT O
US NNP O
government NN O
and CC O
provides VBZ O
a DT O
publicly RB O
funded JJ O
postal JJ O
service NN O
. . O

Royal NNP B-Organization
Mail NNP I-Organization
- : O
British JJ O
postal JJ O
service NN O
and CC O
courier NN O
company NN O
. . O

For IN O
most JJS O
of IN O
its PRP$ O
history NN O
it PRP O
operated VBD O
as IN O
a DT O
government NN O
department NN O
or CC O
public JJ O
corporation NN O
. . O

Deutsche NNP B-Organization
Post NNP I-Organization
- : O
Deutsche NN O
Post NNP O
DHL NNP B-Organization
Group NNP I-Organization
, , O
a DT O
German JJ O
multinational JJ O
package NN O
delivery NN O
and CC O
supply NN O
chain NN O
management NN O
company NN O
headquartered VBD O
in IN O
Bonn NNP O
. . O

La NNP B-Organization
Poste NNP I-Organization
- : O
La NNP O
Poste NNP O
is VBZ O
a DT O
public JJ O
limited JJ O
postal JJ O
service NN O
company NN O
in IN O
France NNP O
. . O

Japan NNP B-Organization
Post NNP I-Organization
- : O
A DT O
private JJ O
Japanese JJ O
post NN O
, , O
logistics NNS O
and CC O
courier NN O
headquartered VBN O
in IN O
Tokyo NNP O
. . O

Yamato NNP B-Organization
Transport NNP I-Organization
- : O
One CD O
of IN O
Japan NNP O
's POS O
largest JJS O
door-to-door JJ O
delivery NN O
service NN O
companies NNS O
, , O
also RB O
in IN O
Tokyo NNP O
. . O

Chunghwa NNP B-Organization
Post NNP I-Organization
- : O
The DT O
government-owned JJ O
corporation NN O
Chunghwa NNP B-Organization
is VBZ O
the DT O
official JJ O
postal JJ O
service NN O
of IN O
Taiwan NNP O
. . O

Swiss JJ B-Organization
Post NNP I-Organization
- : O
The DT O
national JJ O
postal JJ O
service NN O
of IN O
Switzerland NNP O
, , O
a DT O
fully RB O
state-owned JJ O
limited JJ O
company NN O
( ( O
AG NNP O
) ) O
regulated VBN O
by IN O
public JJ O
law NN O
. . O

The DT O
fake NN O
applications NNS O
are VBP O
built VBN O
using VBG O
WebView NNP B-System
, , O
a DT O
popular JJ O
extension NN O
of IN O
Android NNP B-System
’ NNP O
s VBZ O
View NNP O
class NN O
that WDT O
lets VBZ O
the DT O
developer NN O
show NN O
a DT O
webpage NN O
. . O

FakeSpy NNP B-Malware
uses VBZ O
this DT O
view NN O
to TO O
redirect VB O
users NNS O
to TO O
the DT O
original JJ O
post NN O
office NN O
carrier NN O
webpage NN O
on IN O
launch NN O
of IN O
the DT O
application NN O
, , O
continuing VBG O
the DT O
deception NN O
. . O

This DT O
allows VBZ O
the DT O
application NN O
to TO O
appear VB O
legitimate JJ O
, , O
especially RB O
given VBN O
these DT O
applications NNS O
icons NNS O
and CC O
user JJ O
interface NN O
. . O

New NNP O
FakeSpy NNP B-Malware
applications NNS O
masquerading VBG O
as IN O
post NN O
office NN O
apps NN O
. . O

FAKESPY NNP B-Malware
CODE NNP O
ANALYSIS NNP O
Once RB O
the DT O
user NN O
clicks NNS O
on IN O
the DT O
malicious JJ O
link NN O
from IN O
the DT O
SMS NNP O
message NN O
, , O
the DT O
app NN O
asks VBZ O
them PRP O
to TO O
approve VB O
installation NN O
from IN O
unknown JJ O
resources NNS O
. . O

This DT O
configuration NN O
can MD O
be VB O
toggled VBN O
on IN O
by IN O
going VBG O
to TO O
‘ VB O
Settings NNP O
’ NNP O
- : O
> NN O
‘ JJ O
Security NNP O
’ NNP O
- : O
> NN O
‘ NNP O
Unknown NNP O
Resources NNP O
’ NNP O
. . O

PackageInstaller NN O
shows VBZ O
the DT O
app NN O
’ NNP O
s NN O
permission NN O
access NN O
and CC O
asks NNS O
for IN O
the DT O
user NN O
's POS O
approval NN O
, , O
which WDT O
then RB O
installs VBZ O
the DT O
application NN O
. . O

This DT O
analysis NN O
dissects VBZ O
FakeSpy NNP B-Malware
’ NNP O
s VBD O
Chunghwa NNP O
Post NNP O
app JJ O
version NN O
, , O
which WDT O
emerged VBD O
in IN O
April NNP O
2020 CD O
. . O

During IN O
the DT O
installation NN O
, , O
the DT O
malware NN O
asks VBZ O
for IN O
the DT O
following JJ O
permissions NNS O
: : O
READ_PHONE_STATE NNP O
- : O
Allows VBZ O
read-only JJ O
access NN O
to TO O
the DT O
phone NN O
state NN O
, , O
including VBG O
the DT O
current JJ O
cellular JJ O
network NN O
information NN O
, , O
the DT O
status NN O
of IN O
any DT O
ongoing JJ O
calls NNS O
, , O
and CC O
a DT O
list NN O
of IN O
any DT O
PhoneAccounts NNS O
registered VBN O
on IN O
the DT O
device NN O
. . O

READ_SMS NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
read VB O
text JJ O
messages NNS O
. . O

RECEIVE_SMS NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
receive VB O
SMS NNP O
messages NNS O
. . O

WRITE_SMS NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
write VB O
to TO O
SMS NNP O
messages NNS O
stored VBN O
on IN O
the DT O
device NN O
or CC O
SIM NNP O
card NN O
, , O
including VBG O
y NN O
deleting NN O
messages NNS O
. . O

SEND_SMS NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
send VB O
SMS NNP O
messages NNS O
. . O

INTERNET NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
open VB O
network NN O
sockets NNS O
. . O

WRITE_EXTERNAL_STORAGE NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
write VB O
to TO O
external JJ O
storage NN O
. . O

READ_EXTERNAL_STORAGE NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
read VB O
from IN O
external JJ O
storage NN O
. . O

RECEIVE_BOOT_COMPLETED NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
receive VB O
a DT O
broadcast NN O
after IN O
the DT O
system NN O
finishes VBZ O
booting VBG O
. . O

GET_TASKS NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
get VB O
information NN O
about IN O
current JJ O
or CC O
recently RB O
run VB O
tasks NNS O
. . O

( ( O
deprecated VBN O
in IN O
API NNP O
level NN O
21 CD O
) ) O
SYSTEM_ALERT_WINDOW NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
create VB O
windows NNS O
shown VBN O
on IN O
top NN O
of IN O
all DT O
other JJ O
apps NN O
. . O

WAKE_LOCK NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
use VB O
PowerManager NNP O
WakeLocks NNP O
to TO O
keep VB O
the DT O
processor NN O
from IN O
sleeping VBG O
or CC O
the DT O
screen NN O
from IN O
dimming VBG O
. . O

ACCESS_NETWORK_STATE NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
access NN O
information NN O
about IN O
networks NNS O
. . O

REQUEST_IGNORE_BATTERY_OPTIMIZATIONS NNP O
- : O
Whitelists VBZ O
the DT O
application NN O
to TO O
allow VB O
it PRP O
to TO O
ignore VB O
battery NN O
optimizations NNS O
. . O

READ_CONTACTS NNP O
- : O
Allows VBZ O
the DT O
application NN O
to TO O
read VB O
the DT O
user NN O
's POS O
contacts NNS O
data NNS O
. . O

FakeSpy NNP B-Malware
package NN O
permissions NNS O
. . O

On IN O
opening VBG O
the DT O
app NN O
, , O
two CD O
pop-up JJ O
messages NNS O
appear VBP O
on IN O
screen NN O
: : O
Change NNP O
SMS NNP O
App NNP O
: : O
This DT O
sets VBZ O
permissions NNS O
to TO O
intercept VB O
every DT O
SMS NNP O
received VBN O
on IN O
the DT O
device NN O
and CC O
send VB O
a DT O
copy NN O
of IN O
these DT O
messages NNS O
to TO O
the DT O
C2 NNP O
server NN O
. . O

Ignore RB O
Battery NNP O
Optimization NN O
: : O
This DT O
sets VBZ O
permissions NNS O
to TO O
continue VB O
to TO O
operate VB O
at IN O
full JJ O
capacity NN O
while IN O
the DT O
phone NN O
's POS O
screen NN O
is VBZ O
turned VBN O
off RB O
and CC O
the DT O
phone NN O
locked VBD O
. . O

These DT O
requests NNS O
rely VBP O
on IN O
the DT O
end NN O
user NN O
accepting VBG O
the DT O
permission NN O
changes NNS O
and CC O
points NNS O
to TO O
the DT O
importance NN O
of IN O
healthy JJ O
skepticism NN O
when WRB O
giving VBG O
applications NNS O
permissions NNS O
. . O

FakeSpy NNP B-Malware
Chunghwa NNP B-Organization
Post NNP I-Organization
version NN O
installation NN O
process NN O
and CC O
application NN O
UI NNP O
. . O

DYNAMIC NNP O
LIBRARY NNP O
LOADING NNP O
Once RB O
the DT O
application NN O
has VBZ O
finished VBN O
the DT O
installation NN O
process NN O
, , O
the DT O
malware NN O
starts VBZ O
its PRP$ O
real JJ O
malicious JJ O
activity NN O
. . O

The DT O
malicious JJ O
application NN O
da.hao.pao.bin NN B-Indicator
( ( O
Chunghwa NNP B-Organization
Post NNP I-Organization
) ) O
loads VBZ O
a DT O
library JJ O
file NN O
libmsy.so NN B-Indicator
used VBN O
to TO O
execute VB O
the DT O
packed JJ O
mycode.jar NN B-Indicator
file NN I-Indicator
. . O

The DT O
JAR NNP O
file NN O
is VBZ O
the DT O
decrypted JJ O
version NN O
of IN O
the DT O
file NN O
tong.luo NN B-Indicator
, , O
which WDT O
is VBZ O
located VBN O
in IN O
the DT O
assets NNS O
folder VBP O
. . O

Decompiled VBN O
APK NNP O
resources NNS O
. . O

By IN O
comparing VBG O
the DT O
sizes NN O
of IN O
the DT O
encrypted JJ O
asset NN O
file NN O
tong.luo NN B-Indicator
vs IN O
the DT O
decrypted JJ O
JAR NNP O
file NN O
mycode.jar NN B-Indicator
, , O
it PRP O
is VBZ O
interesting VBG O
to TO O
note VB O
that IN O
it PRP O
is VBZ O
the DT O
same JJ O
file NN O
( ( O
almost RB O
the DT O
same JJ O
size NN O
) ) O
. . O

Comparing VBG O
encrypted VBN O
vs NN O
decrypted VBN O
asset NN O
file NN O
. . O

After IN O
libmsy.so JJ B-Indicator
decrypts NNS O
the DT O
asset NN O
file NN O
tong.luo NN B-Indicator
, , O
it PRP O
loads VBZ O
mycode.jar JJ B-Indicator
dynamically RB O
into IN O
FakeSpy NNP B-Malware
’ NNP O
s NN O
process NN O
, , O
as IN O
is VBZ O
shown VBN O
from IN O
the DT O
output NN O
of IN O
the DT O
“ NNP O
adb NN O
logcat NN O
” NNP O
command NN O
. . O

Logcat NNP O
logs VBZ O
show NN O
FakeSpy NNP B-Malware
uses VBZ O
libmsy.so NN B-Indicator
to TO O
execute VB O
the DT O
malicious JJ O
packed JJ O
mycode.jar NN B-Indicator
file NN I-Indicator
. . O

By IN O
analyzing VBG O
running VBG O
processes NNS O
on IN O
the DT O
infected JJ O
device NN O
, , O
it PRP O
shows VBZ O
that IN O
the DT O
malware NN O
creates VBZ O
a DT O
child JJ O
process NN O
of IN O
itself PRP O
to TO O
perform VB O
the DT O
multi-process JJ O
ptrace NN O
anti-debugging NN O
technique NN O
. . O

FakeSpy NNP B-Malware
uses VBZ O
an DT O
anti-debugging JJ O
technique NN O
by IN O
creating VBG O
another DT O
child NN O
process NN O
of IN O
itself PRP O
. . O

By IN O
performing VBG O
a DT O
deep JJ O
analysis NN O
of IN O
the DT O
malware NN O
, , O
we PRP O
were VBD O
able JJ O
to TO O
extract VB O
the DT O
unpacked JJ O
JAR NNP O
file NN O
mycode.jar NN B-Indicator
and CC O
reveal VB O
some DT O
very RB O
interesting JJ O
code NN O
. . O

STEALING NNP O
SENSITIVE NNP O
INFORMATION NNP O
FakeSpy NNP B-Malware
has VBZ O
multiple VBN O
built VBN O
in IN O
information NN O
stealing VBG O
capabilities NNS O
. . O

The DT O
first JJ O
function NN O
is VBZ O
used VBN O
for IN O
contact JJ O
information NN O
stealing NN O
: : O
the DT O
function NN O
upCon JJ O
steals NNS O
all DT O
contacts NNS O
in IN O
the DT O
contact NN O
list NN O
and CC O
their PRP$ O
information NN O
. . O

Then RB O
, , O
it PRP O
sends VBZ O
it PRP O
to TO O
the DT O
C2 NNP O
server NN O
using VBG O
the DT O
URL NNP O
that WDT O
ends VBZ O
with IN O
/servlet/ContactUpload NN B-Indicator
. . O

The DT O
stolen VBN O
data NN O
fields NNS O
are VBP O
: : O
Mobile NNP O
- : O
The DT O
infected JJ O
device NN O
phone NN O
number NN O
and CC O
contact JJ O
’ NNP O
s NN O
phone NN O
number NN O
Contacts NNP O
- : O
A DT O
headline NN O
used VBN O
for IN O
the DT O
attacker NN O
to TO O
distinguish VB O
between IN O
the DT O
type NN O
of IN O
stolen VBN O
information NN O
he PRP O
gets VBZ O
Name NNP O
- : O
Contact NNP O
’ NNP O
s VBZ O
full JJ O
name NN O
( ( O
Display NNP O
name NN O
) ) O
upCon NN O
( ( O
upload JJ O
contact NN O
) ) O
function NN O
used VBN O
for IN O
stealing VBG O
contact JJ O
list NN O
information NN O
. . O

For IN O
testing VBG O
purposes NNS O
we PRP O
inserted VBD O
a DT O
fake JJ O
contacts NNS O
list NN O
to TO O
our PRP$ O
Android NNP B-System
Emulator NNP O
and CC O
observed VBD O
resultant JJ O
behavior NN O
. . O

Exfiltrated VBN O
contact JJ O
list NN O
data NNS O
sent VBD O
to TO O
the DT O
C2 NNP O
server NN O
. . O

The DT O
second JJ O
stealing NN O
function NN O
is VBZ O
the DT O
onStartCommand NN O
, , O
which WDT O
steals VBZ O
infected JJ O
device NN O
data NNS O
and CC O
additional JJ O
information NN O
. . O

The DT O
stolen VBN O
data NN O
is VBZ O
sent VBN O
to TO O
the DT O
C2 NNP O
server NN O
using VBG O
the DT O
URL NNP O
ending VBG O
with IN O
/servlet/xx NNP B-Indicator
. . O

The DT O
stolen VBN O
data NN O
fields NNS O
are VBP O
: : O
Mobile NNP O
- : O
The DT O
infected JJ O
device NN O
phone NN O
number NN O
Machine NNP O
- : O
The DT O
device NN O
model NN O
( ( O
in IN O
our PRP$ O
example NN O
: : O
Google NNP B-System
Pixel NNP I-System
2 CD I-System
) ) O
Sversion NNP O
- : O
The DT O
OS NNP O
version NN O
Bank NNP O
- : O
Checks NNS O
if IN O
there EX O
are VBP O
any DT O
banking-related JJ O
or CC O
cryptocurrency NN O
trading NN O
apps NN O
Provider NNP O
- : O
The DT O
telecommunication NN O
provider NN O
( ( O
IMSI NNP O
value NN O
in IN O
device JJ O
settings NNS O
) ) O
npki VBP O
- : O
Checks NNS O
if IN O
the DT O
folder NN O
named VBN O
NPKI NNP O
( ( O
National NNP O
Public NNP O
Key NNP O
Infrastructure NNP O
) ) O
might MD O
contain VB O
authentication NN O
certificates NNS O
related VBN O
to TO O
financial JJ O
transactions NNS O
onStartCommand VBP O
function NN O
for IN O
stealing VBG O
device NN O
information NN O
and CC O
additional JJ O
sensitive JJ O
data NNS O
. . O

Exfiltrated NNP O
device NN O
information NN O
and CC O
additional JJ O
sensitive JJ O
data NNS O
sent VBD O
to TO O
the DT O
C2 NNP O
server NN O
. . O

FakeSpy NNP B-Malware
asks VBZ O
to TO O
be VB O
the DT O
default NN O
SMS NNP O
app NN O
because IN O
it PRP O
uses VBZ O
the DT O
function NN O
onReceive NN O
to TO O
intercept VB O
incoming VBG O
SMS NNP O
messages NNS O
. . O

It PRP O
saves VBZ O
the DT O
messages NNS O
’ VBP O
metadata NNS O
and CC O
content NN O
, , O
filters VBZ O
the DT O
information NN O
by IN O
fields NNS O
, , O
and CC O
sends VBZ O
them PRP O
to TO O
the DT O
C2 NNP O
server NN O
using VBG O
the DT O
URL NNP O
/servlet/SendMassage2 NNP B-Indicator
. . O

The DT O
fields NNS O
it PRP O
collects VBZ O
are VBP O
: : O
Mobile NNP O
- : O
The DT O
phone NN O
number NN O
which WDT O
sent VBD O
the DT O
SMS NNP O
Content NNP O
- : O
The DT O
message NN O
body NN O
Sender NNP O
- : O
The DT O
contact NN O
name NN O
who WP O
sent VBD O
the DT O
message NN O
Time NNP O
- : O
The DT O
time NN O
the DT O
message NN O
was VBD O
received VBN O
onReceive JJ O
function NN O
used VBN O
to TO O
intercept VB O
incoming VBG O
SMS NNP O
messages NNS O
. . O

The DT O
malware NN O
uses VBZ O
the DT O
function NN O
sendAll NN O
to TO O
send VB O
messages NNS O
that WDT O
spread VBP O
the DT O
malware NN O
to TO O
other JJ O
devices NNS O
. . O

It PRP O
sends VBZ O
a DT O
smishing JJ O
message NN O
to TO O
the DT O
entire JJ O
contact NN O
list NN O
of IN O
the DT O
infected JJ O
device NN O
along IN O
with IN O
the DT O
malicious JJ O
link NN O
to TO O
the DT O
FakeSpy NNP B-Malware
installation NN O
page NN O
. . O

sendAll NN O
function NN O
used VBN O
to TO O
spread VB O
malicious JJ O
messages NNS O
to TO O
the DT O
contact NN O
list NN O
. . O

Another DT O
interesting JJ O
feature NN O
in IN O
FakeSpy NNP B-Malware
’ NNP O
s NN O
code NN O
is VBZ O
the DT O
collection NN O
of IN O
the DT O
device NN O
's POS O
IMEI NNP O
( ( O
International NNP O
Mobile NNP O
Station NNP O
Equipment NNP O
Identity NNP O
) ) O
number NN O
and CC O
all DT O
installed VBN O
applications NNS O
using VBG O
the DT O
function NN O
upAppinfos NN O
. . O

It PRP O
sends VBZ O
all DT O
of IN O
this DT O
data NN O
to TO O
the DT O
C2 NNP O
server NN O
using VBG O
the DT O
URL NNP O
ending VBG O
with IN O
/servlet/AppInfos NNP B-Indicator
. . O

upAppinfos JJ O
function NN O
used VBN O
for IN O
obtaining VBG O
the DT O
device NN O
IMEI NNP O
and CC O
all DT O
of IN O
its PRP$ O
installed JJ O
applications NNS O
. . O

FakeSpy NNP B-Malware
is VBZ O
able JJ O
to TO O
check VB O
the DT O
network NN O
connectivity NN O
status NN O
by IN O
using VBG O
the DT O
function NN O
isNetworkAvailable NN O
. . O

What WP O
makes VBZ O
this DT O
function NN O
more RBR O
suspicious JJ O
is VBZ O
the DT O
two CD O
strings NNS O
written VBN O
in IN O
Chinese JJ O
characters NNS O
: : O
===状态=== NN O
( ( O
===Status=== NNP O
) ) O
- : O
Checks VBZ O
whether IN O
the DT O
device NN O
is VBZ O
connected VBN O
to TO O
a DT O
network NN O
===类型=== NN O
( ( O
===Type=== NNP O
) ) O
- : O
Checks VBZ O
whether IN O
the DT O
device NN O
sees VBZ O
available JJ O
nearby JJ O
Wifi NNP O
networks NNS O
isNetworkAvailable JJ O
function NN O
used VBN O
for IN O
monitoring VBG O
network NN O
connectivity NN O
status NN O
. . O

ANTI-EMULATOR NNP O
TECHNIQUES NNP O
FakeSpy NNP B-Malware
appears VBZ O
to TO O
use VB O
multiple JJ O
techniques NNS O
to TO O
evade VB O
detection NN O
via IN O
the DT O
emulator NN O
. . O

It PRP O
shows VBZ O
that IN O
the DT O
malware NN O
can MD O
detect VB O
whether IN O
it PRP O
’ NNP O
s VBD O
running VBG O
in IN O
an DT O
emulated JJ O
environment NN O
or CC O
a DT O
real JJ O
mobile JJ O
device NN O
, , O
and CC O
can MD O
change VB O
its PRP$ O
code NN O
pattern NN O
accordingly RB O
. . O

The DT O
first JJ O
example NN O
of IN O
this DT O
is VBZ O
in IN O
the DT O
onStart NN O
function NN O
, , O
where WRB O
the DT O
malware NN O
looks VBZ O
for IN O
the DT O
string NN O
“ NNP O
Emulator NNP O
” NNP O
and CC O
a DT O
x86 NN O
processor NN O
model NN O
. . O

Anti-emulator JJ O
code NN O
. . O

In IN O
order NN O
to TO O
simulate VB O
this DT O
technique NN O
, , O
we PRP O
took VBD O
two CD O
videos JJ O
side NN O
by IN O
side NN O
of IN O
how WRB O
FakeSpy NNP B-Malware
( ( O
the DT O
Royal NNP B-Organization
Mail NNP I-Organization
sample NN O
) ) O
behaves VBZ O
differently RB O
on IN O
a DT O
physical JJ O
device NN O
versus IN O
an DT O
emulator NN O
. . O

FakeSpy NNP B-Malware
behavior NN O
on IN O
physical JJ O
device NN O
vs NN O
emulator NN O
( ( O
anti-emulator NN O
) ) O
. . O

This DT O
simulation NN O
shows VBZ O
that IN O
FakeSpy NNP B-Malware
behaves VBZ O
differently RB O
on IN O
a DT O
physical JJ O
device NN O
versus IN O
an DT O
emulator NN O
. . O

When WRB O
executed VBD O
the DT O
second JJ O
time NN O
by IN O
clicking VBG O
on IN O
the DT O
app NN O
on IN O
the DT O
physical JJ O
device NN O
, , O
FakeSpy NNP B-Malware
redirects VBZ O
to TO O
the DT O
app JJ O
settings NNS O
. . O

In IN O
contrast NN O
, , O
on IN O
the DT O
emulator NN O
, , O
a DT O
toast JJ O
message NN O
is VBZ O
displayed VBN O
that IN O
shows VBZ O
“ VB O
Install NNP O
completed VBD O
” NNP O
, , O
at IN O
which WDT O
point NN O
FakeSpy NNP B-Malware
removes VBZ O
its PRP$ O
shortcut NN O
from IN O
the DT O
device NN O
's POS O
homescreen NN O
. . O

Another DT O
example NN O
of IN O
FakeSpy NNP B-Malware
’ NNP O
s VBD O
anti-emulation NN O
techniques NNS O
is VBZ O
how WRB O
it PRP O
uses VBZ O
the DT O
getMachine NN O
function NN O
, , O
which WDT O
uses VBZ O
the DT O
TelephonyManager NNP O
class NN O
to TO O
check VB O
for IN O
the DT O
deviceID NN O
, , O
phone NN O
number NN O
, , O
IMEI NNP O
, , O
and CC O
IMSI NNP O
. . O

Some DT O
emulators NNS O
build VBP O
their PRP$ O
phone NN O
number NN O
out IN O
of IN O
the DT O
default NN O
number NN O
created VBN O
in IN O
the DT O
emulator NN O
software NN O
and CC O
the DT O
port NN B-Indicator
number NN I-Indicator
: : I-Indicator
5554. CD I-Indicator
getMachine NN O
function NN O
using VBG O
anti-emulator NN O
technique NN O
. . O

UNDER NNP O
ACTIVE NNP O
DEVELOPMENT NNP O
An DT O
analysis NN O
of IN O
new JJ O
FakeSpy NNP B-Malware
samples NNS O
to TO O
old JJ O
ones NNS O
showed VBD O
code JJ O
discrepancies NNS O
and CC O
new JJ O
features NNS O
. . O

These DT O
artifacts NNS O
indicate VBP O
that IN O
FakeSpy NNP B-Malware
's POS O
campaign NN O
is VBZ O
still RB O
live JJ O
and CC O
under IN O
development NN O
. . O

The DT O
newer JJR O
version NN O
of IN O
FakeSpy NNP B-Malware
uses VBZ O
new JJ O
URL NNP O
addresses NNS O
for IN O
malicious JJ O
communication NN O
with IN O
FakeSpy NNP B-Malware
. . O

The DT O
function NN O
main JJ O
uses VBZ O
a DT O
DES NNP O
encryption NN O
algorithm NN O
to TO O
encode VB O
these DT O
addresses NNS O
. . O

The DT O
examples NNS O
below IN O
show VBP O
the DT O
plaintext JJ O
key NN O
“ NNP O
TEST NNP O
” NN O
to TO O
decrypt VB O
encoded JJ O
hexadecimal JJ O
strings NNS O
( ( O
jUtils.decrypt NN O
( ( O
) ) O
) ) O
. . O

These DT O
encoded VBD O
strings NNS O
contain VBP O
the DT O
new JJ O
URL NNP O
addresses VBZ O
not RB O
seen VBN O
in IN O
older JJR O
versions NNS O
of IN O
FakeSpy NNP B-Malware
. . O

Comparing VBG O
strings NNS O
from IN O
an DT O
old JJ O
FakeSpy NNP B-Malware
sample NN O
to TO O
a DT O
new JJ O
one CD O
. . O

WHO WP O
IS VBZ O
BEHIND NNP O
FAKESPY NNP B-Malware
’ NNP O
S NNP O
SMISHING NNP O
CAMPAIGNS NNP O
? . O

The DT O
Cybereason NNP B-Organization
Nocturnus NNP I-Organization
team NN O
suspects VBZ O
that IN O
the DT O
malware NN O
operators NNS O
and CC O
authors NNS O
are VBP O
Chinese JJ O
speakers NNS O
. . O

Our PRP$ O
findings NNS O
, , O
along IN O
with IN O
previous JJ O
research NN O
, , O
indicates VBZ O
that IN O
the DT O
threat NN O
actor NN O
behind IN O
these DT O
recent JJ O
campaigns NNS O
is VBZ O
likely JJ O
a DT O
Chinese JJ O
group NN O
dubbed VBD O
“ NNP O
Roaming NNP B-Organization
Mantis NNP I-Organization
” NNP O
. . O

Roaming VBG B-Organization
Mantis NNP I-Organization
is VBZ O
believed VBN O
to TO O
be VB O
a DT O
Chinese JJ O
threat NN O
actor NN O
group NN O
first RB O
discovered VBN O
in IN O
April NNP O
2018 CD O
that WDT O
has VBZ O
continuously RB O
evolved VBN O
. . O

In IN O
the DT O
beginning NN O
, , O
this DT O
threat NN O
group NN O
mainly RB O
targeted VBD O
Asian JJ O
countries NNS O
. . O

Now RB O
, , O
they PRP O
are VBP O
expanding VBG O
their PRP$ O
activity NN O
to TO O
audiences NNS O
all DT O
around IN O
the DT O
world NN O
. . O

As IN O
part NN O
of IN O
their PRP$ O
activities NNS O
, , O
they PRP O
are VBP O
known VBN O
for IN O
hijacking VBG O
DNS NNP O
settings NNS O
on IN O
Japanese JJ O
routers NNS O
that WDT O
redirect VBP O
users NNS O
to TO O
malicious JJ O
IP NNP O
addresses NNS O
, , O
creating VBG O
disguised VBN O
malicious JJ O
Android NNP B-System
apps NN O
that WDT O
appear VBP O
as IN O
popular JJ O
apps NN O
, , O
stealing VBG O
Apple NNP B-Organization
ID NNP O
credentials NNS O
by IN O
creating VBG O
Apple NNP B-Organization
phishing NN O
pages NNS O
, , O
as RB O
well RB O
as IN O
performing VBG O
web NN O
crypto NN O
mining NN O
on IN O
browsers NNS O
. . O

CONNECTION NN O
TO NNP O
CHINA NNP O
Chinese NNP O
server JJ O
infrastructure NN O
: : O
FakeSpy NNP B-Malware
applications NNS O
send VBP O
stolen VBN O
information NN O
to TO O
C2 NNP O
domains NNS O
with IN O
.club JJ B-Indicator
TLDs NNP I-Indicator
and CC O
URLs NNP O
ending VBG O
with IN O
/servlet/ NNP B-Indicator
[ NNP I-Indicator
C2 NNP I-Indicator
Command NNP I-Indicator
] NNP I-Indicator
( ( O
mentioned VBN O
above IN O
in IN O
the DT O
“ NN O
Stealing NNP O
Sensitive NNP O
Information NNP O
” NNP O
section NN O
) ) O
. . O

All DT O
of IN O
these DT O
domains NNS O
are VBP O
registered VBN O
to TO O
‘ VB O
Li NNP O
Jun NNP O
Biao NNP O
’ NNP O
on IN O
Bizcn NNP B-Organization
, , I-Organization
Inc NNP I-Organization
, , O
a DT O
Chinese JJ O
Internet NNP O
application NN O
service NN O
provider NN O
. . O

Chinese JJ O
language NN O
traces NNS O
in IN O
the DT O
code NN O
: : O
During IN O
the DT O
investigation NN O
, , O
the DT O
Cybereason NNP B-Organization
Nocturnus NNP I-Organization
team NN O
discovered VBD O
code NN O
artifacts NNS O
that WDT O
may MD O
indicate VB O
Chinese JJ O
threat NN O
actors NNS O
. . O

For IN O
example NN O
, , O
we PRP O
found VBD O
several JJ O
suspicious JJ O
strings NNS O
written VBN O
in IN O
the DT O
Chinese JJ O
language NN O
in IN O
a DT O
function NN O
called VBN O
isNetworkAvailable JJ O
, , O
previously RB O
discussed VBN O
in IN O
this DT O
blog NN O
: : O
An DT O
almost RB O
identical JJ O
function NN O
is VBZ O
mentioned VBN O
in IN O
an DT O
earlier JJR O
research NN O
, , O
that IN O
ties NNS O
FakeSpy NNP B-Malware
and CC O
other JJ O
malware NN O
to TO O
the DT O
Roaming NNP B-Organization
Mantis NNP I-Organization
group NN O
. . O

Chinese JJ O
APK NNP O
names NNS O
: : O
Some DT O
of IN O
FakeSpy NNP B-Malware
’ NNP O
s NN O
APK NNP O
package NN O
names RB O
contain JJ O
anglicized VBN O
Chinese NNP O
( ( O
Mandarin NNP O
) ) O
words NNS O
that WDT O
might MD O
be VB O
related VBN O
to TO O
Chinese JJ O
songs NNS O
and CC O
lyrics NNS O
, , O
food NN O
, , O
provinces NNS O
, , O
etc FW O
. . O

CONCLUSIONS NNP O
FakeSpy NNP B-Malware
was VBD O
first RB O
seen VBN O
in IN O
October NNP O
2017 CD O
and CC O
until IN O
recently RB O
mainly RB O
targeted VBD O
East NNP O
Asian JJ O
countries NNS O
. . O

Our PRP$ O
research NN O
shows VBZ O
fresh JJ O
developments NNS O
in IN O
the DT O
malware NN O
’ NNP O
s NN O
code NN O
and CC O
sophistication NN O
, , O
as RB O
well RB O
as IN O
an DT O
expansion NN O
to TO O
target VB O
Europe NNP O
and CC O
North NNP O
America NNP O
. . O

This DT O
mobile JJ O
malware NN O
masquerades NNS O
as IN O
legitimate JJ O
, , O
trusted VBD O
postal JJ O
service NN O
applications NNS O
so IN O
that IN O
it PRP O
can MD O
gain VB O
the DT O
users NNPS O
trust NN O
. . O

Once IN O
it PRP O
has VBZ O
been VBN O
installed VBN O
, , O
it PRP O
requests VBZ O
permissions NNS O
from IN O
the DT O
user NN O
so IN O
that IN O
it PRP O
can MD O
steal VB O
sensitive JJ O
data NNS O
, , O
manipulate NN O
SMS NNP O
messages NNS O
, , O
and CC O
potentially RB O
infect JJ O
contacts NNS O
of IN O
the DT O
user NN O
. . O

The DT O
malware NN O
now RB O
targets VBZ O
more JJR O
countries NNS O
all DT O
over IN O
the DT O
world NN O
by IN O
masquerading VBG O
as IN O
official JJ O
post NN O
office NN O
and CC O
transportation NN O
services NNS O
apps NN O
. . O

These DT O
apps JJ O
appear VBP O
legitimate JJ O
due JJ O
to TO O
their PRP$ O
app NN O
logo NN O
, , O
UI NNP O
appearance NN O
, , O
and CC O
redirects VBZ O
to TO O
the DT O
carrier NN O
webpage NN O
-- : O
all DT O
luring JJ O
end NN O
users NNS O
to TO O
believe VB O
it PRP O
’ NNP O
s VBD O
the DT O
original JJ O
one NN O
. . O

In IN O
this DT O
blog NN O
, , O
we PRP O
showed VBD O
that IN O
the DT O
threat NN O
actor NN O
behind IN O
the DT O
recent JJ O
FakeSpy NNP B-Malware
campaign NN O
is VBZ O
a DT O
Chinese-speaking JJ O
group NN O
called VBD O
“ CD O
Roaming NNP B-Organization
Mantis NNP I-Organization
” NNP O
known VBN O
to TO O
operate VB O
mainly RB O
in IN O
Asia NNP O
. . O

It PRP O
is VBZ O
interesting VBG O
to TO O
see VB O
that IN O
the DT O
group NN O
has VBZ O
expanded VBN O
their PRP$ O
operation NN O
to TO O
other JJ O
regions NNS O
, , O
such JJ O
as IN O
the DT O
United NNP O
States NNPS O
and CC O
Europe NNP O
. . O

The DT O
malware NN O
authors NNS O
seem VBP O
to TO O
be VB O
putting VBG O
a DT O
lot NN O
of IN O
effort NN O
into IN O
improving VBG O
this DT O
malware NN O
, , O
bundling VBG O
it PRP O
with IN O
numerous JJ O
new JJ O
upgrades NNS O
that WDT O
make VBP O
it PRP O
more RBR O
sophisticated JJ O
, , O
evasive JJ O
, , O
and CC O
well-equipped JJ O
. . O

These DT O
improvements NNS O
render VBP O
FakeSpy NNP B-Malware
one CD O
of IN O
the DT O
most RBS O
powerful JJ O
information NN O
stealers NNS O
on IN O
the DT O
market NN O
. . O

We PRP O
anticipate VBP O
this DT O
malware NN O
to TO O
continue VB O
to TO O
evolve VB O
with IN O
additional JJ O
new JJ O
features NNS O
; : O
the DT O
only JJ O
question NN O
now RB O
is VBZ O
when WRB O
we PRP O
will MD O
see VB O
the DT O
next JJ O
wave NN O
. . O

First RB O
Twitter‑controlled VBN B-System
Android NNP B-System
botnet NN O
discovered VBD O
Detected VBN O
by IN O
ESET NNP B-Organization
as IN O
Android/Twitoor NNP B-Malware
, , O
this DT O
malware NN O
is VBZ O
unique JJ O
because IN O
of IN O
its PRP$ O
resilience NN O
mechanism NN O
. . O

Instead RB O
of IN O
being VBG O
controlled VBN O
by IN O
a DT O
traditional JJ O
command-and-control NN O
server NN O
, , O
it PRP O
receives VBZ O
instructions NNS O
via IN O
tweets NNS O
. . O

24 CD O
Aug NNP O
2016 CD O
- : O
02:05PM CD O
Android/Twitoor NNP B-Malware
is VBZ O
a DT O
backdoor NN O
capable JJ O
of IN O
downloading VBG O
other JJ O
malware NN O
onto IN O
an DT O
infected JJ O
device NN O
. . O

It PRP O
has VBZ O
been VBN O
active JJ O
for IN O
around IN O
one CD O
month NN O
. . O

This DT O
malicious JJ O
app NN O
, , O
detected VBN O
by IN O
ESET NNP B-Organization
as IN O
a DT O
variant NN O
of IN O
Android/Twitoor.A NNP B-Malware
, , O
can MD O
’ VB O
t RB O
be VB O
found VBN O
on IN O
any DT O
official JJ O
Android NNP B-System
app NN I-System
store NN I-System
– IN O
it PRP O
probably RB O
spreads VBZ O
by IN O
SMS NNP O
or CC O
via IN O
malicious JJ O
URLs NNP O
. . O

It PRP O
impersonates VBZ O
a DT O
porn JJ O
player NN O
app NN O
or CC O
MMS NNP O
application NN O
but CC O
without IN O
having VBG O
their PRP$ O
functionality NN O
. . O

After IN O
launching VBG O
, , O
it PRP O
hides VBZ O
its PRP$ O
presence NN O
on IN O
the DT O
system NN O
and CC O
checks VBZ O
the DT O
defined JJ O
Twitter NNP B-System
account NN O
at IN O
regular JJ O
intervals NNS O
for IN O
commands NNS O
. . O

Based VBN O
on IN O
received JJ O
commands NNS O
, , O
it PRP O
can MD O
either VB O
download RB O
malicious JJ O
apps NN O
or CC O
switch VB O
the DT O
C NNP O
& CC O
C NNP O
Twitter NNP B-System
account NN O
to TO O
another DT O
one NN O
. . O

“ NN O
Using VBG O
Twitter NNP B-System
instead RB O
of IN O
command-and-control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
servers NNS O
is VBZ O
pretty JJ O
innovative JJ O
for IN O
an DT O
Android NNP B-System
botnet. NN O
” NNP O
“ NNP O
Using NNP O
Twitter NNP B-Organization
instead RB O
of IN O
command-and-control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
servers NNS O
is VBZ O
pretty JJ O
innovative JJ O
for IN O
an DT O
Android NNP B-System
botnet NN O
, , O
” NNP O
says VBZ O
Lukáš NNP O
Štefanko NNP O
, , O
the DT O
ESET NNP B-Organization
malware NN O
researcher NN O
who WP O
discovered VBD O
the DT O
malicious JJ O
app NN O
. . O

Malware NNP O
that WDT O
enslaves VBZ O
devices NNS O
to TO O
form VB O
botnets NNS O
needs VBZ O
to TO O
be VB O
able JJ O
to TO O
receive VB O
updated JJ O
instructions NNS O
. . O

That DT O
communication NN O
is VBZ O
an DT O
Achilles NNP O
heel NN O
for IN O
any DT O
botnet NN O
– IN O
it PRP O
may MD O
raise VB O
suspicion NN O
and CC O
, , O
cutting VBG O
the DT O
bots NNS O
off RP O
is VBZ O
always RB O
lethal JJ O
to TO O
the DT O
botnet NN O
’ NNP O
s NN O
functioning NN O
. . O

Additionally RB O
, , O
should MD O
the DT O
command-and-control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
servers NNS O
get VBP O
seized VBN O
by IN O
the DT O
authorities NNS O
, , O
it PRP O
would MD O
ultimately RB O
lead VB O
to TO O
disclosing VBG O
information NN O
about IN O
the DT O
entire JJ O
botnet NN O
. . O

To TO O
make VB O
the DT O
Twitoor NNP B-Malware
botnet NN O
’ NNP O
s VBZ O
communication NN O
more RBR O
resilient JJ O
, , O
botnet JJ O
designers NNS O
took VBD O
various JJ O
steps NNS O
like IN O
encrypting VBG O
their PRP$ O
messages NNS O
, , O
using VBG O
complex JJ O
topologies NNS O
of IN O
the DT O
C NNP O
& CC O
C NNP O
network NN O
– NN O
or CC O
using VBG O
innovative JJ O
means NNS O
for IN O
communication NN O
, , O
among IN O
them PRP O
the DT O
use NN O
of IN O
social JJ O
networks NNS O
. . O

“ IN O
These DT O
communication NN O
channels NNS O
are VBP O
hard JJ O
to TO O
discover VB O
and CC O
even RB O
harder JJR O
to TO O
block VB O
entirely RB O
. . O

On IN O
the DT O
other JJ O
hand NN O
, , O
it PRP O
’ VBZ O
s RBR O
extremely RB O
easy JJ O
for IN O
the DT O
crooks NNS O
to TO O
re-direct JJ O
communications NNS O
to TO O
another DT O
freshly RB O
created VBN O
account NN O
, , O
” NN O
explains NNS O
Štefanko VBP O
. . O

In IN O
the DT O
Windows NNP B-System
space NN O
, , O
Twitter NNP B-Organization
, , O
founded VBN O
in IN O
2006 CD O
, , O
was VBD O
first RB O
used VBN O
to TO O
control VB O
botnets NNS O
as RB O
early RB O
as IN O
in IN O
2009 CD O
. . O

Android NNP B-System
bots NNS O
have VBP O
also RB O
already RB O
been VBN O
found VBN O
being VBG O
controlled VBN O
via IN O
other JJ O
non-traditional JJ O
means NNS O
– JJ O
blogs NNS O
or CC O
some DT O
of IN O
the DT O
many JJ O
cloud JJ O
messaging VBG O
systems NNS O
like IN O
Google NNP B-Organization
’ NNP O
s VBD O
or CC O
Baidu NNP B-Organization
’ NNP O
s NN O
– NN O
but CC O
Twitoor NNP B-Malware
is VBZ O
the DT O
first JJ O
Twitter-based JJ B-System
bot NN O
malware NN O
, , O
according VBG O
to TO O
Štefanko NNP O
. . O

“ NN O
In IN O
the DT O
future NN O
, , O
we PRP O
can MD O
expect VB O
that IN O
the DT O
bad JJ O
guys NNS O
will MD O
try VB O
to TO O
make VB O
use NN O
of IN O
Facebook NNP B-System
statuses NNS O
or CC O
deploy NN O
LinkedIn NNP B-System
and CC O
other JJ O
social JJ O
networks NNS O
” VBP O
, , O
states NNS O
ESET NNP B-Organization
’ NNP O
s VBD O
researcher NN O
. . O

Currently RB O
, , O
the DT O
Twitoor NNP B-Malware
trojan NN O
has VBZ O
been VBN O
downloading VBG O
several JJ O
versions NNS O
of IN O
mobile JJ O
banking NN O
malware NN O
. . O

However RB O
, , O
the DT O
botnet NN O
operators NNS O
can MD O
start VB O
distributing VBG O
other JJ O
malware NN O
, , O
including VBG O
ransomware NN O
, , O
at IN O
any DT O
time NN O
warns VBZ O
Štefanko NNP O
. . O

“ JJ O
Twitoor NNP B-Malware
serves VBZ O
as IN O
another DT O
example NN O
of IN O
how WRB O
cybercriminals NNS O
keep VBP O
on IN O
innovating VBG O
their PRP$ O
business NN O
, , O
” NNP O
Stefanko NNP O
continues VBZ O
. . O

“ IN O
The DT O
takeaway NN O
? . O

Internet NNP O
users NNS O
should MD O
keep VB O
on IN O
securing VBG O
their PRP$ O
activities NNS O
with IN O
good JJ O
security NN O
solutions NNS O
for IN O
both DT O
computers NNS O
and CC O
mobile JJ O
devices. NN O
” NN O
Hashes NNP O
: : O
E5212D4416486AF42E7ED1F58A526AEF77BE89BE NNP B-Indicator
A9891222232145581FE8D0D483EDB4B18836BCFC NNP B-Indicator
AFF9F39A6CA5D68C599B30012D79DA29E2672C6E NNP B-Indicator
Insidious NNP O
Android NNP B-System
malware NN O
gives VBZ O
up RP O
all DT O
malicious JJ O
features NNS O
but CC O
one CD O
to TO O
gain VB O
stealth NN O
ESET NNP B-Organization
researchers NNS O
detect VBP O
a DT O
new JJ O
way NN O
of IN O
misusing VBG O
Accessibility NNP O

Service NNP O
, , O
the DT O
Achilles NNP O
’ NNP O
heel NN O
of IN O
Android NNP B-System
security NN O
22 CD O
May NNP O
2020 CD O
- : O
03:00PM CD O
ESET NNP B-Organization
researchers NNS O
have VBP O
analyzed VBN O
an DT O
extremely RB O
dangerous JJ O
Android NNP B-System
app NN O
that WDT O
can MD O
perform VB O
a DT O
host NN O
of IN O
nefarious JJ O
actions NNS O
, , O
notably RB O
wiping VBG O
out RP O
the DT O
victim NN O
’ NNP O
s VBD O
bank NN O
account NN O
or CC O
cryptocurrency NN O
wallet NN O
and CC O
taking VBG O
over RP O
their PRP$ O
email NN O
or CC O
social JJ O
media NNS O
accounts NNS O
. . O

Called VBN O
“ NN O
DEFENSOR NNP B-Malware
ID NNP I-Malware
” NNP O
, , O
the DT O
banking NN O
trojan NN O
was VBD O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
at IN O
the DT O
time NN O
of IN O
the DT O
analysis NN O
. . O

The DT O
app NN O
is VBZ O
fitted VBN O
with IN O
standard JJ O
information-stealing JJ O
capabilities NNS O
; : O
however RB O
, , O
this DT O
banker NN O
is VBZ O
exceptionally RB O
insidious JJ O
in IN O
that DT O
after IN O
installation NN O
it PRP O
requires VBZ O
a DT O
single JJ O
action NN O
from IN O
the DT O
victim NN O
– NNP O
enable JJ O
Android NNP B-System
’ NNP O
s VBP O
Accessibility NNP O
Service NNP O
– NNP O
to TO O
fully RB O
unleash VB O
the DT O
app NN O
’ NNP O
s VBZ O
malicious JJ O
functionality NN O
. . O

The DT O
DEFENSOR NNP B-Malware
ID NNP I-Malware
app NN O
made VBD O
it PRP O
onto IN O
the DT O
heavily RB O
guarded VBN O
Google NNP B-System
Play NNP I-System
store VBD I-System
thanks NNS O
to TO O
its PRP$ O
extreme JJ O
stealth NN O
. . O

Its PRP$ O
creators NNS O
reduced VBD O
the DT O
app NN O
’ NNP O
s VBZ O
malicious JJ O
surface NN O
to TO O
the DT O
bare NN O
minimum NN O
by IN O
removing VBG O
all DT O
potentially RB O
malicious JJ O
functionalities NNS O
but CC O
one CD O
: : O
abusing VBG O
Accessibility NNP O
Service NNP O
. . O

Accessibility NNP O
Service NNP O
is VBZ O
long RB O
known VBN O
to TO O
be VB O
the DT O
Achilles NNP O
’ NNP O
heel NN O
of IN O
the DT O
Android NNP B-System
operating NN O
system NN O
. . O

Security NNP O
solutions NNS O
can MD O
detect VB O
it PRP O
in IN O
countless JJ O
combinations NNS O
with IN O
other JJ O
suspicious JJ O
permissions NNS O
and CC O
functions NNS O
, , O
or CC O
malicious JJ O
functionalities NNS O
– VBP O
but CC O
when WRB O
faced VBN O
with IN O
no DT O
additional JJ O
functionality NN O
nor CC O
permission NN O
, , O
all DT O
failed VBD O
to TO O
trigger VB O
any DT O
alarm NN O
on IN O
DEFENSOR NNP B-Malware
ID NNP I-Malware
. . O

By IN O
“ NNP O
all DT O
” NNP O
we PRP O
mean VBP O
all DT O
security NN O
mechanisms NNS O
guarding VBG O
the DT O
official JJ O
Android NNP B-System
app NN I-System
store NN I-System
( ( O
including VBG O
the DT O
detection NN O
engines NNS O
of IN O
the DT O
members NNS O
of IN O
the DT O
App NNP B-Organization
Defense NNP I-Organization
Alliance NNP I-Organization
) ) O
and CC O
all DT O
security NN O
vendors NNS O
participating VBG O
in IN O
the DT O
VirusTotal JJ B-Organization
program NN O
( ( O
see VB O
Figure NNP O
1 CD O
) ) O
. . O

DEFENSOR NNP B-Malware
ID NNP I-Malware
was VBD O
released VBN O
on IN O
Feb NNP O
3 CD O
, , O
2020 CD O
and CC O
last JJ O
updated JJ O
to TO O
v1.4 VB O
on IN O
May NNP O
6 CD O
, , O
2020 CD O
. . O

The DT O
latest JJS O
version NN O
is VBZ O
analyzed VBN O
here RB O
; : O
we PRP O
weren VBP O
’ JJ O
t NN O
able JJ O
to TO O
determine VB O
if IN O
the DT O
earlier JJR O
versions NNS O
were VBD O
also RB O
malicious JJ O
. . O

According VBG O
to TO O
its PRP$ O
profile NN O
at IN O
Google NNP B-System
Play NNP I-System
( ( O
see VB O
Figure NNP O
2 CD O
) ) O
the DT O
app NN O
reached VBD O
a DT O
mere JJ O
10+ CD O
downloads NNS O
. . O

We PRP O
reported VBD O
it PRP O
to TO O
Google NNP B-Organization
on IN O
May NNP O
16 CD O
, , O
2020 CD O
and CC O
since IN O
May NNP O
19 CD O
, , O
2020 CD O
the DT O
app NN O
has VBZ O
no RB O
longer RB O
been VBN O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
. . O

The DT O
developer NN O
name NN O
used VBN O
, , O
GAS NNP O
Brazil NNP O
, , O
suggests VBZ O
the DT O
criminals NNS O
behind IN O
the DT O
app NN O
targeted VBD O
Brazilian JJ O
users NNS O
. . O

Apart RB O
from IN O
including VBG O
the DT O
country NN O
’ VBZ O
s JJ O
name NN O
, , O
the DT O
app NN O
’ NNP O
s NN O
name NN O
is VBZ O
probably RB O
intended VBN O
to TO O
imply VB O
a DT O
relationship NN O
with IN O
the DT O
antifraud JJ O
solution NN O
named VBN O
GAS NNP B-System
Tecnologia NNP I-System
. . O

That DT O
security NN O
software NN O
is VBZ O
commonly RB O
installed VBN O
on IN O
computers NNS O
in IN O
Brazil NNP O
as IN O
several JJ O
banks NNS O
require VBP O
it PRP O
to TO O
log VB O
into IN O
their PRP$ O
online NN O
banking NN O
. . O

However RB O
, , O
there EX O
is VBZ O
also RB O
an DT O
English JJ O
version NN O
of IN O
the DT O
DEFENSOR NNP B-Malware
ID NNP I-Malware
app NN O
( ( O
see VB O
Figure NNP O
3 CD O
) ) O
besides IN O
the DT O
Portuguese NNP O
one CD O
, , O
and CC O
that DT O
app NN O
has VBZ O
neither DT O
geographical JJ O
nor CC O
language NN O
restrictions NNS O
. . O

Playing VBG O
further PRP O
off IN O
the DT O
suggested VBN O
GAS NNP B-System
Tecnologia NNP I-System
link NN O
, , O
the DT O
app NN O
promises VBZ O
better JJR O
security NN O
for IN O
its PRP$ O
users NNS O
. . O

The DT O
description NN O
in IN O
Portuguese JJ O
promises NNS O
more JJR O
protection NN O
for IN O
the DT O
user NN O
’ NNP O
s NN O
applications NNS O
, , O
including VBG O
end-to-end JJ O
encryption NN O
. . O

Deceptively RB O
, , O
the DT O
app NN O
was VBD O
listed VBN O
in IN O
the DT O
Education NNP O
section NN O
. . O

Functionality NN O
After IN O
starting VBG O
, , O
DEFENSOR NNP B-Malware
ID NNP I-Malware
requests VBZ O
the DT O
following JJ O
permissions NNS O
: : O
allow VB O
modify NN O
system NN O
settings NNS O
permit VBP O
drawing VBG O
over IN O
other JJ O
apps NN O
, , O
and CC O
activate VBP O
accessibility NN O
services NNS O
. . O

If IN O
an DT O
unsuspecting JJ O
user NN O
grants NNS O
these DT O
permissions NNS O
( ( O
see VB O
Figure NNP O
4 CD O
) ) O
, , O
the DT O
trojan NN O
can MD O
read VB O
any DT O
text JJ O
displayed NN O
in IN O
any DT O
app NN O
the DT O
user NN O
may MD O
launch VB O
– NNP O
and CC O
send VB O
it PRP O
to TO O
the DT O
attackers NNS O
. . O

This DT O
means VBZ O
the DT O
attackers NNS O
can MD O
steal VB O
the DT O
victim NN O
’ NNP O
s NN O
credentials NNS O
for IN O
logging VBG O
into IN O
apps NN O
, , O
SMS NNP O
and CC O
email JJ O
messages NNS O
, , O
displayed JJ O
cryptocurrency NN O
private JJ O
keys NNS O
, , O
and CC O
even RB O
software-generated JJ O
2FA CD O
codes NNS O
. . O

The DT O
fact NN O
the DT O
trojan NN O
can MD O
steal VB O
both DT O
the DT O
victim NN O
’ NNP O
s NN O
credentials NNS O
and CC O
also RB O
can MD O
control VB O
their PRP$ O
SMS NNP O
messages NNS O
and CC O
generated VBD O
2FA CD O
codes NNS O
means VBZ O
DEFENSOR NNP B-Malware
ID NNP I-Malware
’ NNP O
s NN O
operators NNS O
can MD O
bypass VB O
two-factor JJ O
authentication NN O
. . O

This DT O
opens VBZ O
the DT O
door NN O
to TO O
, , O
for IN O
example NN O
, , O
fully RB O
controlling VBG O
the DT O
victim NN O
’ NNP O
s VBD O
bank NN O
account NN O
. . O

To TO O
make VB O
sure JJ O
the DT O
trojan NN O
survives VBZ O
a DT O
device NN O
restart NN O
, , O
it PRP O
abuses VBZ O
already RB O
activated VBN O
accessibility NN O
services NNS O
that WDT O
will MD O
launch VB O
the DT O
trojan NN O
right RB O
after IN O
start NN O
. . O

Our PRP$ O
analysis NN O
shows VBZ O
the DT O
DEFENSOR NNP B-Malware
ID NNP I-Malware
trojan NN O
can MD O
execute VB O
17 CD O
commands NNS O
received VBN O
from IN O
the DT O
attacker-controlled JJ O
server NN O
such JJ O
as IN O
uninstalling VBG O
an DT O
app NN O
, , O
launching VBG O
an DT O
app NN O
and CC O
then RB O
performing VBG O
any DT O
click/tap JJ O
action NN O
controlled VBN O
remotely RB O
by IN O
the DT O
attacker NN O
( ( O
see VB O
Figure NNP O
5 CD O
) ) O
. . O

In IN O
2018 CD O
, , O
we PRP O
saw VBD O
similar JJ O
behavior NN O
, , O
but CC O
all PDT O
the DT O
click JJ O
actions NNS O
were VBD O
hardcoded VBN O
and CC O
suited VBN O
only RB O
for IN O
the DT O
app NN O
of IN O
the DT O
attacker NN O
’ NNP O
s NN O
choice NN O
. . O

In IN O
this DT O
case NN O
, , O
the DT O
attacker NN O
can MD O
get VB O
the DT O
list NN O
of IN O
all DT O
installed VBN O
apps NNS O
and CC O
then RB O
remotely RB O
launch VBP O
the DT O
victim NN O
’ NNP O
s VBZ O
app NN O
of IN O
their PRP$ O
choice NN O
to TO O
either DT O
steal JJ O
credentials NNS O
or CC O
perform VB O
malicious JJ O
actions NNS O
( ( O
e.g NN O
. . O

send VB O
funds NNS O
via IN O
a DT O
wire NN O
transfer NN O
) ) O
. . O

We PRP O
believe VBP O
that IN O
this DT O
is VBZ O
the DT O
reason NN O
the DT O
DEFENSOR NNP B-Malware
ID NNP I-Malware
trojan NN O
requests VBZ O
the DT O
user NN O
to TO O
allow VB O
“ NNP O
Modify NNP O
system NN O
settings NNS O
” VBP O
. . O

Subsequently RB O
, , O
the DT O
malware NN O
will MD O
change VB O
the DT O
screen NN O
off IN O
time-out NN O
to TO O
10 CD O
minutes NNS O
. . O

This DT O
means VBZ O
that IN O
, , O
unless IN O
victims NNS O
lock VBP O
their PRP$ O
devices NNS O
via IN O
the DT O
hardware NN O
button NN O
, , O
the DT O
timer NN O
provides VBZ O
plenty NN O
of IN O
time NN O
for IN O
the DT O
malware NN O
to TO O
remotely RB O
perform VB O
malicious JJ O
, , O
in-app JJ O
operations NNS O
. . O

If IN O
the DT O
device NN O
gets VBZ O
locked VBN O
, , O
the DT O
malware NN O
can MD O
’ VB O
t JJ O
unlock NN O
it PRP O
. . O

Malware NNP O
data NNS O
leak NN O
When WRB O
we PRP O
analyzed VBD O
the DT O
sample NN O
, , O
we PRP O
realized VBD O
that IN O
the DT O
malware NN O
operators NNS O
left VBD O
the DT O
remote JJ O
database NN O
with IN O
some DT O
of IN O
the DT O
victims NNS O
’ NNP O
data NNS O
freely RB O
accessible JJ O
, , O
without IN O
any DT O
authentication NN O
. . O

The DT O
database NN O
contained VBD O
the DT O
last JJ O
activity NN O
performed VBD O
on IN O
around IN O
60 CD O
compromised JJ O
devices NNS O
. . O

We PRP O
found VBD O
no DT O
other JJ O
information NN O
stolen VBN O
from IN O
the DT O
victims NNS O
to TO O
be VB O
accessible JJ O
. . O

Thanks NNS O
to TO O
this DT O
data NN O
leak NN O
, , O
we PRP O
were VBD O
able JJ O
to TO O
confirm VB O
that IN O
the DT O
malware NN O
really RB O
worked VBD O
as IN O
designed VBN O
: : O
the DT O
attacker NN O
had VBD O
access NN O
to TO O
the DT O
victims NNS O
’ VBP O
entered VBN O
credentials NNS O
, , O
displayed VBD O
or CC O
written VBN O
emails NNS O
and CC O
messages NNS O
, , O
etc FW O
. . O

Once RB O
we PRP O
reached VBD O
the DT O
non-secured JJ O
database NN O
, , O
we PRP O
were VBD O
able JJ O
to TO O
directly RB O
observe VB O
the DT O
app NN O
’ NNP O
s VBZ O
malicious JJ O
behavior NN O
. . O

To TO O
illustrate VB O
the DT O
level NN O
of IN O
threat NN O
the DT O
DEFENSOR NNP B-Malware
ID NNP I-Malware
app NN O
posed VBD O
, , O
we PRP O
performed VBD O
three CD O
tests NNS O
. . O

First RB O
, , O
we PRP O
launched VBD O
a DT O
banking NN O
app NN O
and CC O
entered VBD O
the DT O
credentials NNS O
there RB O
. . O

The DT O
credentials NNS O
were VBD O
immediately RB O
available JJ O
in IN O
the DT O
leaky JJ O
database NN O
– NNP O
see VBP O
Figure NNP O
6 CD O
. . O

Figure NN O
6 CD O
. . O

The DT O
banking NN O
app JJ O
test NN O
: : O
the DT O
credentials NNS O
as IN O
entered VBN O
( ( O
left VBN O
) ) O
and CC O
as IN O
available JJ O
in IN O
the DT O
database NN O
( ( O
right JJ O
) ) O
Second NNP O
, , O
we PRP O
wrote VBD O
a DT O
test NN O
message NN O
in IN O
an DT O
email JJ O
client NN O
. . O

We PRP O
saw VBD O
the DT O
message NN O
uploaded VBD O
to TO O
the DT O
attackers NNS O
’ VBP O
server RB O
within IN O
a DT O
second JJ O
– NNP O
see VBP O
Figure NNP O
7 CD O
. . O

Figure NN O
7 CD O
. . O

The DT O
email JJ O
message NN O
test NN O
: : O
the DT O
message NN O
as IN O
written VBN O
( ( O
left VBN O
) ) O
and CC O
as IN O
available JJ O
in IN O
the DT O
database NN O
( ( O
right JJ O
) ) O
Third NNP O
, , O
we PRP O
documented VBD O
the DT O
trojan NN O
retrieving VBG O
the DT O
Google NNP B-System
Authenticator NNP I-System
2FA CD O
code NN O
. . O

Figure NN O
8 CD O
. . O

The DT O
software NN O
generated VBD O
2FA CD O
code NN O
as IN O
it PRP O
appeared VBD O
on IN O
the DT O
device NN O
’ NNP O
s NN O
display NN O
( ( O
left VBN O
) ) O
and CC O
as IN O
available JJ O
in IN O
the DT O
database NN O
( ( O
right JJ O
) ) O
Along IN O
with IN O
the DT O
malicious JJ O
DEFENSOR NNP O
ID NNP O
app NN O
, , O
another DT O
malicious JJ O
app NN O
named VBN O
Defensor NNP B-Malware
Digital NNP I-Malware
was VBD O
discovered VBN O
. . O

Both DT O
apps NN O
shared VBD O
the DT O
same JJ O
C NNP O
& CC O
C NNP O
server NN O
, , O
but CC O
we PRP O
couldn VBP O
’ JJ O
t NN O
investigate VB O
the DT O
latter NN O
as IN O
it PRP O
had VBD O
already RB O
been VBN O
removed VBN O
from IN O
the DT O
Google NNP B-System
Play NNP I-System
store NN I-System
. . O

Indicators NNS O
of IN O
Compromise NNP O
( ( O
IoCs NNP O
) ) O
Package NN O
Name NNP O
Hash NNP O
ESET NNP B-Organization
detection NN O
name NN O
com.secure.protect.world NN B-Indicator
F17AEBC741957AA21CFE7C7D7BAEC0900E863F61 NNP B-Indicator
Android/Spy.BanBra.A NNP B-Indicator
com.brazil.android.free VBP B-Indicator
EA069A5C96DC1DB0715923EB68192FD325F3D3CE NNP B-Indicator
Android/Spy.BanBra.A NNP B-Indicator
MITRE NNP B-Organization
ATT NNP O
& CC O
CK NNP O
techniques VBZ O
Tactic NNP O
ID NNP O
Name NNP O
Description NNP O
Initial NNP O
Access NNP O
T1475 NNP O
Deliver NNP O
Malicious NNP O
App NNP O

via IN O
Authorized NNP O
App NNP B-System
Store NNP I-System
Impersonates NNP O
security NN O
app NN O
on IN O
Google NNP B-System
Play NNP I-System
. . O

T1444 NNP O
Masquerade NNP O
as IN O
Legitimate NNP O
Application NNP O
Impersonates NNP O
legitimate VBP O
GAS NNP B-System
Tecnologia NNP I-System
application NN O
. . O

Discovery NNP O
T1418 NNP O
Application NNP O
Discovery NNP O
Sends NNP O
list NN O
of IN O
installed JJ O
apps NN O
on IN O
device NN O
. . O

Impact NNP O
T1516 NNP O
Input NNP O
Injection NNP O
Can NNP O
enter NN O
text NN O
and CC O
perform VB O
clicks NNS O
on IN O
behalf NN O
of IN O
user NN O
. . O

Collection NNP O
T1417 NNP O
Input NNP O
Capture NNP O
Records NNP O
user NN O
input NN O
data NNS O
. . O

Command NNP O
and CC O
Control NNP O
T1437 NNP O
Standard NNP O
Application NNP O
Layer NNP O
Protocol NNP O
Uses VBZ O
Firebase NNP O
Cloud NNP O
Messaging NNP O
for IN O
C NNP O
& CC O
C NNP O
. . O

