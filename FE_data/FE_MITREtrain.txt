Super NNP B-Malware
Mario NNP I-Malware
Run NNP I-Malware
Malware NNP I-Malware
# # O
2 CD O
– JJ O
DroidJack NNP B-Malware
RAT NNP I-Malware
Gamers NNP O
love VBP O
Mario NNP B-System
and CC O
Pokemon NNP B-System
, , O
but CC O
so RB O
do JJ O
malware NN O
authors NNS O
. . O

A DT O
few JJ O
days NNS O
back RB O
, , O
we PRP O
wrote VBD O
about IN O
an DT O
Android NNP B-System
Marcher NNP B-Malware
trojan NN O
variant NN O
posing NN O
as IN O
the DT O
Super NNP B-System
Mario NNP I-System
Run NNP I-System
game NN O
for IN O
Android NNP B-System
. . O

We PRP O
have VBP O
found VBN O
another DT O
instance NN O
of IN O
malware NN O
posing VBG O
as IN O
the DT O
Super NNP B-System
Mario NNP I-System
Run NNP I-System
Android NNP B-System
app NN O
, , O
and CC O
this DT O
time NN O
it PRP O
has VBZ O
taken VBN O
the DT O
form NN O
of IN O
DroidJack NNP B-Malware
RAT NNP I-Malware
( ( O
remote JJ O
access NN O
trojan NN O
) ) O
. . O

Proofpoint NNP B-Organization
wrote VBD O
about IN O
the DT O
DroidJack NNP B-Malware
RAT NNP I-Malware
side-loaded JJ O
with IN O
the DT O
Pokemon NNP B-System
GO NNP I-System
app VBZ O
back RB O
in IN O
July NNP O
2016 CD O
; : O
the DT O
difference NN O
here RB O
is VBZ O
that IN O
there EX O
is VBZ O
no DT O
game NN O
included VBD O
in IN O
the DT O
malicious JJ O
package NN O
. . O

The DT O
authors NNS O
are VBP O
trying VBG O
to TO O
latch VB O
onto IN O
the DT O
popularity NN O
of IN O
the DT O
Super NNP B-System
Mario NNP I-System
Run NNP I-System
game NN O
to TO O
target VB O
eagerly RB O
waiting VBG O
Android NNP B-System
users NNS O
. . O

Details NNS O
: : O
Name NN O
: : O
Super NNP B-System
Mario NNP I-System
Run NNP I-System
Package NNP O
Name NN O
: : O
net.droidjack.server JJ B-Indicator
MD5 NNP O
: : O
69b4b32e4636f1981841cbbe3b927560 CD B-Indicator
Technical JJ O
Analysis NN O
: : O
The DT O
malicious JJ O
package NN O
claims NNS O
to TO O
be VB O
the DT O
Super NNP B-System
Mario NNP I-System
Run NNP I-System
game NN O
, , O
as IN O
shown VBN O
in IN O
the DT O
permissions NNS O
screenshot VBP O
below IN O
, , O
but CC O
in IN O
reality NN O
this DT O
is VBZ O
a DT O
malicious JJ O
RAT NNP O
called VBD O
DroidJack NNP B-Malware
( ( O
also RB O
known VBN O
as IN O
SandroRAT NNP B-Malware
) ) O
that WDT O
is VBZ O
getting VBG O
installed VBN O
. . O

Once RB O
installed VBN O
, , O
the DT O
RAT NNP O
registers VBZ O
the DT O
infected JJ O
device NN O
as IN O
shown VBN O
below IN O
. . O

DroidJack NNP B-Malware
RAT NNP I-Malware
starts VBZ O
capturing VBG O
sensitive JJ O
information NN O
like IN O
call NN O
data NNS O
, , O
SMS NNP O
data NN O
, , O
videos NN O
, , O
photos NNS O
, , O
etc FW O
. . O

Observe NNP O
below IN O
the DT O
code NN O
routine NN O
for IN O
call NN O
recording NN O
. . O

This DT O
RAT NNP O
records VBZ O
all PDT O
the DT O
calls NNS O
and CC O
stores NNS O
the DT O
recording NN O
to TO O
an DT O
“ JJ O
.amr NN B-Indicator
” NNP O
file NN O
. . O

The DT O
following NN O
is VBZ O
the DT O
code NN O
routine NN O
for IN O
video NN O
capturing NN O
. . O

Here RB O
, , O
the DT O
RAT NNP O
stores NNS O
all PDT O
the DT O
captured JJ O
videos NNS O
in IN O
a DT O
“ JJ O
video.3gp NN B-Indicator
” NNP O
file NN O
. . O

It PRP O
also RB O
harvests VBZ O
call NN O
details NNS O
and CC O
SMS NNP O
logs NNS O
as IN O
shown VBN O
below IN O
. . O

Upon IN O
further JJ O
inspection NN O
, , O
we PRP O
have VBP O
observed VBN O
that IN O
this DT O
RAT NNP O
extracts VBZ O
WhatsApp NNP B-System
data NNS O
too RB O
. . O

The DT O
RAT NNP O
stores NNS O
all PDT O
the DT O
data NNS O
in IN O
a DT O
database NN O
( ( O
DB NNP O
) ) O
in IN O
order NN O
to TO O
send VB O
it PRP O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server NN O
. . O

The DT O
following NN O
are VBP O
the DT O
DBs NNP O
created VBD O
and CC O
maintained VBN O
by IN O
the DT O
RAT NNP O
. . O

We PRP O
saw VBD O
the DT O
following VBG O
hardcoded VBD O
C NNP O
& CC O
C NNP O
server NN O
location NN O
in IN O
the DT O
RAT NNP O
package NN O
: : O
Conclusion NN O
: : O
The DT O
DroidJack NNP B-Malware
RAT NNP I-Malware
is VBZ O
another DT O
example NN O
of IN O
a DT O
growing VBG O
trend NN O
in IN O
which WDT O
malware NN O
authors NNS O
seek VBP O
to TO O
exploit VB O
public JJ O
interest NN O
as IN O
a DT O
way NN O
to TO O
spread VB O
malware NN O
. . O

In IN O
this DT O
case NN O
, , O
like IN O
others NNS O
before IN O
, , O
the DT O
event NN O
of IN O
a DT O
popular JJ O
game NN O
release NN O
became VBD O
an DT O
opportunity NN O
to TO O
trick VB O
unsuspecting VBG O
users NNS O
into IN O
downloading VBG O
the DT O
RAT NNP O
. . O

As IN O
a DT O
reminder NN O
, , O
it PRP O
is VBZ O
always RB O
a DT O
good JJ O
practice NN O
to TO O
download VB O
apps NNS O
only RB O
from IN O
trusted VBN O
app NN O
stores NNS O
such JJ O
as IN O
Google NNP B-System
Play NNP I-System
. . O

This DT O
practice NN O
can MD O
be VB O
enforced VBN O
by IN O
unchecking VBG O
the DT O
" NNP O
Unknown NNP O
Sources NNPS O
'' '' O
option NN O
under IN O
the DT O
" JJ O
Security NNP O
'' '' O
settings NNS O
of IN O
your PRP$ O
device NN O
. . O

XLoader NN B-Malware
Disguises VBZ O
as IN O
Android NNP B-System
Apps NNP O
, , O
Has NNP O
FakeSpy NNP B-Malware
Links NNP O
This DT O
new JJ O
XLoader NN B-Malware
variant NN O
poses VBZ O
as IN O
a DT O
security NN O
app NN O
for IN O
Android NNP B-System
devices NNS O
, , O
and CC O
uses VBZ O
a DT O
malicious JJ O
iOS NN B-System
profile NN O
to TO O
affect VB O
iPhone NN B-System
and CC O
iPad JJ B-System
devices NNS O
. . O

By IN O
: : O
Hara NNP O
Hiroaki NNP O
, , O
Lilang NNP O
Wu NNP O
, , O
Lorin NNP O
Wu NNP O
April NNP O
02 CD O
, , O
2019 CD O
In IN O
previous JJ O
attacks NNS O
, , O
XLoader NN B-Malware
posed VBD O
as IN O
Facebook NNP B-System
, , O
Chrome NNP B-System
and CC O
other JJ O
legitimate JJ O
applications NNS O
to TO O
trick VB O
users NNS O
into IN O
downloading VBG O
its PRP$ O
malicious JJ O
app NN O
. . O

Trend NNP B-Organization
Micro NNP I-Organization
researchers NNS O
found VBD O
a DT O
new JJ O
variant NN O
that WDT O
uses VBZ O
a DT O
different JJ O
way NN O
to TO O
lure VB O
users NNS O
. . O

This DT O
new JJ O
XLoader NN B-Malware
variant NN O
poses VBZ O
as IN O
a DT O
security NN O
app NN O
for IN O
Android NNP B-System
devices NNS O
, , O
and CC O
uses VBZ O
a DT O
malicious JJ O
iOS NN B-System
profile NN O
to TO O
affect VB O
iPhone NN B-System
and CC O
iPad JJ B-System
devices NNS O
. . O

Aside RB O
from IN O
a DT O
change NN O
in IN O
its PRP$ O
deployment NN O
techniques NNS O
, , O
a DT O
few JJ O
changes NNS O
in IN O
its PRP$ O
code NN O
set VBN O
it PRP O
apart RB O
from IN O
its PRP$ O
previous JJ O
versions NNS O
. . O

This DT O
newest JJS O
variant NN O
has VBZ O
been VBN O
labeled VBN O
XLoader NNP B-Malware
version NN O
6.0 CD O
( ( O
detected VBN O
as IN O
AndroidOS_XLoader.HRXD NNP B-Indicator
) ) O
, , O
following VBG O
the DT O
last JJ O
version NN O
discussed VBD O
in IN O
a DT O
previous JJ O
research NN O
on IN O
the DT O
malware NN O
family NN O
. . O

Infection NN O
chain NN O
The DT O
threat NN O
actors NNS O
behind IN O
this DT O
version NN O
used VBD O
several JJ O
fake JJ O
websites NNS O
as IN O
their PRP$ O
host NN O
— NN O
copying NN O
that IN O
of IN O
a DT O
Japanese JJ O
mobile JJ O
phone NN O
operator NN O
’ NNP O
s VBZ O
website NN O
in IN O
particular JJ O
— NN O
to TO O
trick VB O
users NNS O
into IN O
downloading VBG O
the DT O
fake JJ O
security NN O
Android NNP B-System
application NN O
package NN O
( ( O
APK NNP O
) ) O
. . O

Monitoring VBG O
efforts NNS O
on IN O
this DT O
new JJ O
variant NN O
revealed VBD O
that IN O
the DT O
malicious JJ O
websites NNS O
are VBP O
spread VBN O
through IN O
smishing NN O
. . O

The DT O
infection NN O
has VBZ O
not RB O
spread VBN O
very RB O
widely RB O
at IN O
the DT O
time NN O
of IN O
writing NN O
, , O
but CC O
we PRP O
’ VBP O
ve JJ O
seen VBN O
that IN O
many JJ O
users NNS O
have VBP O
already RB O
received VBN O
its PRP$ O
SMS NNP O
content NN O
. . O

In IN O
the DT O
past NN O
, , O
XLoader NN B-Malware
showed VBD O
the DT O
ability NN O
to TO O
mine VB O
cryptocurrency NN O
on IN O
PCs NNS O
and CC O
perform VB O
account NN O
phishing VBG O
on IN O
iOS JJ B-System
devices NNS O
. . O

This DT O
new JJ O
wave NN O
also RB O
presents VBZ O
unique JJ O
attack NN O
vectors NNS O
based VBN O
on IN O
the DT O
kind NN O
of IN O
device NN O
it PRP O
has VBZ O
accessed VBN O
. . O

In IN O
the DT O
case NN O
of IN O
Android NNP B-System
devices NNS O
, , O
accessing VBG O
the DT O
malicious JJ O
website NN O
or CC O
pressing VBG O
any DT O
of IN O
the DT O
buttons NNS O
will MD O
prompt VB O
the DT O
download NN O
of IN O
the DT O
APK NNP O
. . O

However RB O
, , O
successfully RB O
installing VBG O
this DT O
malicious JJ O
APK NNP O
requires VBZ O
that IN O
the DT O
user NN O
has VBZ O
allowed VBN O
the DT O
installation NN O
of IN O
such JJ O
apps NNS O
as IN O
controlled VBN O
in IN O
the DT O
Unknown NNP O
Sources NNP O
settings NNS O
. . O

If IN O
users NNS O
allow VBP O
such JJ O
apps NNS O
to TO O
be VB O
installed VBN O
, , O
then RB O
it PRP O
can MD O
be VB O
actively RB O
installed VBN O
on IN O
the DT O
victim NN O
’ NNP O
s NN O
device NN O
. . O

The DT O
infection NN O
chain NN O
is VBZ O
slightly RB O
more RBR O
roundabout NN O
in IN O
the DT O
case NN O
of IN O
Apple NNP B-System
devices NNS O
. . O

Accessing VBG O
the DT O
same JJ O
malicious JJ O
site NN O
would MD O
redirect VB O
its PRP$ O
user NN O
to TO O
another DT O
malicious JJ O
website NN O
( ( O
hxxp JJ B-Indicator
: : I-Indicator
//apple-icloud JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
qwq-japan JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
or CC O
hxxp NN B-Indicator
: : I-Indicator
//apple-icloud JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
zqo-japan JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] NNP I-Indicator
com NN I-Indicator
) ) O
that WDT O
prompts VBZ O
the DT O
user NN O
to TO O
install VB O
a DT O
malicious JJ O
iOS NN B-System
configuration NN O
profile NN O
to TO O
solve VB O
a DT O
network NN O
issue NN O
preventing VBG O
the DT O
site NN O
to TO O
load NN O
. . O

If IN O
the DT O
user NN O
installs VBZ O
the DT O
profile NN O
, , O
the DT O
malicious JJ O
website NN O
will MD O
open VB O
, , O
revealing VBG O
it PRP O
to TO O
be VB O
an DT O
Apple NNP B-Organization
phishing NN O
site NN O
, , O
as IN O
seen VBN O
in IN O
figure NN O
2 CD O
. . O

Technical JJ O
analysis NN O
Most JJS O
of IN O
this DT O
new JJ O
attack NN O
’ NNP O
s NN O
routines NNS O
are VBP O
similar JJ O
to TO O
those DT O
of IN O
the DT O
previous JJ O
XLoader NN B-Malware
versions NNS O
. . O

However RB O
, , O
as IN O
mentioned VBN O
earlier RBR O
, , O
an DT O
analysis NN O
of IN O
this DT O
new JJ O
variant NN O
showed VBD O
some DT O
changes NNS O
in IN O
its PRP$ O
code NN O
in IN O
line NN O
with IN O
its PRP$ O
new JJ O
deployment NN O
method NN O
. . O

We PRP O
discuss VBP O
these DT O
changes NNS O
and CC O
its PRP$ O
effect NN O
on IN O
Android NNP B-System
and CC O
Apple NNP B-System
devices NNS O
. . O

Malicious JJ O
APK NNP O
Like IN O
its PRP$ O
previous JJ O
versions NNS O
, , O
XLoader VBP B-Malware
6.0 CD I-Malware
abuses NNS O
social JJ O
media NNS O
user JJ O
profiles NNS O
to TO O
hide VB O
its PRP$ O
real JJ O
C NNP O
& CC O
C NNP O
addresses VBZ O
, , O
but CC O
this DT O
time NN O
its PRP$ O
threat NN O
actors NNS O
chose VBD O
the DT O
social JJ O
media NNS O
platform NN O
Twitter NNP B-Organization
, , O
which WDT O
was VBD O
never RB O
used VBN O
in IN O
previous JJ O
attacks NNS O
. . O

The DT O
real JJ O
C NNP O
& CC O
C NNP O
address NN O
is VBZ O
encoded VBN O
in IN O
the DT O
Twitter NNP B-Organization
names NNS O
, , O
and CC O
can MD O
only RB O
be VB O
revealed VBN O
once RB O
decoded VBN O
. . O

This DT O
adds VBZ O
an DT O
extra JJ O
layer NN O
against IN O
detection NN O
. . O

The DT O
code NN O
for IN O
this DT O
characteristic JJ O
and CC O
the DT O
corresponding JJ O
Twitter NNP B-Organization
accounts NNS O
can MD O
be VB O
seen VBN O
in IN O
figures NNS O
3 CD O
and CC O
4 CD O
respectively RB O
. . O

Version NN O
6.0 CD O
also RB O
adds VBZ O
a DT O
command NN O
called VBN O
“ CD O
getPhoneState NN O
” NN O
, , O
which WDT O
collects VBZ O
unique JJ O
identifiers NNS O
of IN O
mobile JJ O
devices NNS O
such JJ O
as IN O
IMSI NNP O
, , O
ICCID NNP O
, , O
Android NNP B-System
ID NNP O
, , O
and CC O
device NN O
serial JJ O
number NN O
. . O

This DT O
addition NN O
is VBZ O
seen VBN O
in IN O
Figure NNP O
5 CD O
. . O

Considering VBG O
the DT O
other JJ O
malicious JJ O
behaviors NNS O
of IN O
XLoader NN B-Malware
, , O
this DT O
added JJ O
operation NN O
could MD O
be VB O
very RB O
dangerous JJ O
as IN O
threat NN O
actors NNS O
can MD O
use VB O
it PRP O
to TO O
perform VB O
targeted JJ O
attacks NNS O
. . O

Malicious JJ O
iOS NN B-System
profile NN O
In IN O
the DT O
case NN O
of IN O
Apple NNP B-System
devices NNS O
, , O
the DT O
downloaded VBN O
malicious JJ O
iOS NN B-System
profile NN O
gathers NNS O
the DT O
following NN O
: : O
Unique JJ O
device NN O
identifier NN O
( ( O
UDID NNP O
) ) O
International NNP O
Mobile NNP O
Equipment NNP O
Identity NNP O
( ( O
IMEI NNP O
) ) O
Integrated VBD O
Circuit NNP O
Card NNP O
ID NNP O
( ( O
ICCID NNP O
) ) O
Mobile NNP O
equipment NN O
identifier NN O
( ( O
MEID NNP O
) ) O
Version NNP O
number NN O
Product NNP O
number NN O
The DT O
profile JJ O
installations NNS O
differ VBP O
depending VBG O
on IN O
the DT O
iOS NN B-System
. . O

For IN O
versions NNS O
11.0 CD O
and CC O
11.4 CD O
, , O
the DT O
installation NN O
is VBZ O
straightforward RB O
. . O

If IN O
a DT O
user NN O
visits VBZ O
the DT O
profile NN O
host NN O
website NN O
and CC O
allows VBZ O
the DT O
installer NN O
to TO O
download VB O
, , O
the DT O
iOS NN B-System
system NN O
will MD O
go VB O
directly RB O
to TO O
the DT O
“ NNP O
Install NNP O
Profile NNP O
” NNP O
page NN O
( ( O
which WDT O
shows VBZ O
a DT O
verified JJ O
safety NN O
certificate NN O
) ) O
, , O
and CC O
then RB O
request VB O
the DT O
users NNS O
’ VBP O
passcode NN O
for IN O
the DT O
last JJ O
step NN O
of IN O
installation NN O
. . O

On IN O
later JJ O
versions NNS O
, , O
specifically RB O
iOS JJ B-System
12.1.1 CD I-System
and CC O
iOS JJ B-System
12.2 CD I-System
, , O
the DT O
process NN O
is VBZ O
different JJ O
. . O

After IN O
the DT O
profile NN O
is VBZ O
downloaded VBN O
, , O
the DT O
iOS NN B-System
system NN O
will MD O
first VB O
ask VB O
users NNS O
to TO O
review VB O
the DT O
profile NN O
in IN O
their PRP$ O
settings NNS O
if IN O
they PRP O
want VBP O
to TO O
install VB O
it PRP O
. . O

Users NNS O
can MD O
see VB O
a DT O
“ NNP O
Profile NNP O
Downloaded NNP O
” NNP O
added VBD O
in IN O
their PRP$ O
settings NNS O
( ( O
this DT O
feature NN O
is VBZ O
in IN O
iOS JJ B-System
12.2 CD I-System
, , O
but CC O
not RB O
on IN O
iOS NNS B-System
12.1.1 CD I-System
) ) O
. . O

This DT O
gives VBZ O
users VBZ O
a DT O
chance NN O
to TO O
see VB O
details NNS O
and CC O
better JJR O
understand VBP O
any DT O
changes NNS O
made VBN O
. . O

After IN O
the DT O
review NN O
, , O
the DT O
process NN O
is VBZ O
the DT O
same JJ O
as IN O
above IN O
. . O

After IN O
the DT O
profile NN O
is VBZ O
installed VBN O
, , O
the DT O
user NN O
will MD O
then RB O
be VB O
redirected VBN O
to TO O
another DT O
Apple NNP B-Organization
phishing NN O
site NN O
. . O

The DT O
phishing NN O
site NN O
uses VBZ O
the DT O
gathered JJ O
information NN O
as IN O
its PRP$ O
GET NNP O
parameter NN O
, , O
allowing VBG O
the DT O
attacker NN O
to TO O
access NN O
the DT O
stolen VBN O
information NN O
. . O

Ongoing VBG O
activity NN O
While IN O
monitoring VBG O
this DT O
particular JJ O
threat NN O
, , O
we PRP O
found VBD O
another DT O
XLoader NN B-Malware
variant NN O
posing NN O
as IN O
a DT O
pornography NN O
app NN O
aimed VBN O
at IN O
South JJ O
Korean JJ O
users NNS O
. . O

The DT O
" NNP O
porn NN O
kr NN O
sex NN O
'' '' O
APK NNP O
connects VBZ O
to TO O
a DT O
malicious JJ O
website NN O
that WDT O
runs VBZ O
XLoader NN B-Malware
in IN O
the DT O
background NN O
. . O

The DT O
website JJ O
uses VBZ O
a DT O
different JJ O
fixed JJ O
twitter NN B-Organization
account NN O
( ( O
https NN B-Indicator
: : I-Indicator
//twitter.com/fdgoer343 NN I-Indicator
) ) O
. . O

This DT O
attack NN O
, , O
however RB O
, , O
seems VBZ O
exclusive JJ O
to TO O
Android NNP B-System
users NNS O
, , O
as IN O
it PRP O
does VBZ O
not RB O
have VB O
the DT O
code NN O
to TO O
attack VB O
iOS JJ B-System
devices NNS O
. . O

Succeeding VBG O
monitoring NN O
efforts NNS O
revealed VBD O
a DT O
newer NN O
variant NN O
that WDT O
exploits VBZ O
the DT O
social JJ O
media NNS O
platforms NNS O
Instagram NNP B-Organization
and CC O
Tumblr NNP B-Organization
instead RB O
of IN O
Twitter NNP B-Organization
to TO O
hide VB O
its PRP$ O
C NNP O
& CC O
C NNP O
address NN O
. . O

We PRP O
labeled VBD O
this DT O
new JJ O
variant JJ O
XLoader NN B-Malware
version NN O
7.0 CD O
, , O
because IN O
of IN O
the DT O
different JJ O
deployment NN O
method NN O
and CC O
its PRP$ O
use NN O
of IN O
the DT O
native JJ O
code NN O
to TO O
load VB O
the DT O
payload NN O
and CC O
hide NN O
in IN O
Instagram NNP B-Organization
and CC O
Tumblr NNP B-Organization
profiles NNS O
. . O

These DT O
more RBR O
recent JJ O
developments NNS O
indicate VBP O
that IN O
XLoader NN B-Malware
is VBZ O
still RB O
evolving VBG O
. . O

Adding VBG O
connections NNS O
to TO O
FakeSpy NNP B-Malware
We PRP O
have VBP O
been VBN O
seeing VBG O
activity NN O
from IN O
XLoader NN B-Malware
since IN O
2018 CD O
, , O
and CC O
have VBP O
since IN O
followed VBN O
up RP O
our PRP$ O
initial JJ O
findings NNS O
with IN O
a DT O
detailed JJ O
research NN O
revealing VBG O
a DT O
wealth NN O
of IN O
activity NN O
dating VBG O
back RB O
to TO O
as RB O
early RB O
as IN O
January NNP O
2015 CD O
, , O
which WDT O
outlined VBD O
a DT O
major JJ O
discovery—its NNS O
connection NN O
to TO O
FakeSpy NNP B-Malware
. . O

The DT O
emergence NN O
of IN O
XLoader $ B-Malware
6.0 CD I-Malware
does VBZ O
not RB O
only RB O
indicate VB O
that IN O
the DT O
threat NN O
actors NNS O
behind IN O
it PRP O
remain VBP O
active JJ O
; : O
it PRP O
also RB O
holds VBZ O
fresh JJ O
evidence NN O
of IN O
its PRP$ O
connection NN O
to TO O
FakeSpy NNP B-Malware
. . O

One CD O
such JJ O
immediately RB O
apparent JJ O
connection NN O
was VBD O
the DT O
similar JJ O
deployment NN O
technique NN O
used VBN O
by IN O
both DT O
XLoader NNP B-Malware
6.0 CD I-Malware
and CC O
FakeSpy NNP B-Malware
. . O

It PRP O
had VBD O
again RB O
cloned VBN O
a DT O
different JJ O
legitimate JJ O
Japanese JJ O
website NN O
to TO O
host VB O
its PRP$ O
malicious JJ O
app NN O
, , O
similar JJ O
to TO O
what WP O
FakeSpy NNP B-Malware
had VBD O
also RB O
done VBN O
before RB O
. . O

Their PRP$ O
similarity NN O
is VBZ O
made VBN O
more RBR O
apparent JJ O
by IN O
looking VBG O
at IN O
their PRP$ O
naming NN O
method NN O
for IN O
downloadable JJ O
files NNS O
, , O
domain NN O
structure NN O
of IN O
fake JJ O
websites NNS O
and CC O
other JJ O
details NNS O
of IN O
their PRP$ O
deployment NN O
techniques NNS O
, , O
exemplified VBN O
in IN O
figure NN O
10 CD O
. . O

XLoader NN B-Malware
6.0 CD I-Malware
also RB O
mirrors NNS O
the DT O
way NN O
FakeSpy NNP B-Malware
hides VBZ O
its PRP$ O
real JJ O
C NNP O
& CC O
C NNP O
server NN O
. . O

When WRB O
before IN O
it PRP O
had VBD O
used VBN O
several JJ O
different JJ O
social JJ O
media NNS O
platforms NNS O
, , O
it PRP O
now RB O
uses VBZ O
the DT O
Twitter NNP B-Organization
platform NN O
, , O
something NN O
FakeSpy NNP B-Malware
has VBZ O
done VBN O
in IN O
its PRP$ O
past JJ O
attacks NNS O
. . O

Analysis NN O
of IN O
the DT O
malicious JJ O
iOS NN B-System
profile NN O
also RB O
revealed VBD O
further JJ O
connections NNS O
, , O
as IN O
the DT O
profile NN O
can MD O
also RB O
be VB O
downloaded VBN O
from IN O
a DT O
website NN O
that WDT O
FakeSpy NNP B-Malware
deployed VBD O
early RB O
this DT O
year NN O
. . O

Conclusion NN O
and CC O
security NN O
recommendations NNS O
The DT O
continued JJ O
monitoring NN O
of IN O
XLoader NN B-Malware
showed VBD O
how WRB O
its PRP$ O
operators NNS O
continuously RB O
changed VBD O
its PRP$ O
features NNS O
, , O
such JJ O
as IN O
its PRP$ O
attack NN O
vector NN O
deployment NN O
infrastructure NN O
and CC O
deployment NN O
techniques NNS O
. . O

This DT O
newest JJS O
entry NN O
seems VBZ O
to TO O
indicate VB O
that IN O
these DT O
changes NNS O
won VBD O
’ JJ O
t NN O
be VB O
stopping VBG O
soon RB O
. . O

Being VBG O
aware JJ O
of IN O
this DT O
fact NN O
can MD O
help VB O
create VB O
defensive JJ O
strategies NNS O
, , O
as RB O
well RB O
as IN O
prepare NN O
for IN O
upcoming VBG O
attacks NNS O
. . O

In IN O
addition NN O
, , O
just RB O
as IN O
uncovering VBG O
new JJ O
characteristics NNS O
is VBZ O
important JJ O
, , O
finding JJ O
ones NNS O
we PRP O
’ VBP O
ve NNS O
also RB O
seen VBN O
in IN O
a DT O
different JJ O
malware NN O
family NN O
like IN O
FakeSpy NNP B-Malware
also RB O
provides VBZ O
valuable JJ O
insight NN O
. . O

Links NNS O
between IN O
XLoader NN B-Malware
and CC O
FakeSpy NNP B-Malware
can MD O
give VB O
clues NNS O
to TO O
the DT O
much JJ O
broader JJR O
inner JJ O
workings NNS O
of IN O
the DT O
threat NN O
actors NNS O
behind IN O
them PRP O
. . O

Perhaps RB O
more JJR O
information NN O
on IN O
XLoader NN B-Malware
will MD O
be VB O
known VBN O
in IN O
the DT O
future NN O
. . O

For IN O
now RB O
, , O
users NNS O
can MD O
make VB O
the DT O
best JJS O
of IN O
the DT O
knowledge NN O
they PRP O
have VBP O
now RB O
to TO O
significantly RB O
reduce VB O
the DT O
effectivity NN O
of IN O
such JJ O
malware NN O
. . O

Users NNS O
of IN O
iOS NN B-System
can MD O
remove VB O
the DT O
malicious JJ O
profile NN O
using VBG O
the DT O
Apple NNP B-Organization
Configurator NNP O
2 CD O
, , O
Apple NNP B-Organization
’ NNP O
s VBP O
official JJ O
iOS JJ B-System
helper NN O
app NN O
for IN O
managing VBG O
Apple NNP B-Organization
devices NNS O
. . O

Following VBG O
simple JJ O
best JJS O
practices NNS O
, , O
like IN O
strictly RB O
downloading VBG O
applications NNS O
or CC O
any DT O
files NNS O
from IN O
trusted VBN O
sources NNS O
and CC O
being VBG O
wary JJ O
of IN O
unsolicited JJ O
messages NNS O
, , O
can MD O
also RB O
prevent VB O
similar JJ O
attacks NNS O
from IN O
compromising VBG O
devices NNS O
. . O

Indicators NNS O
of IN O
Compromise NNP O
SHA256 NNP O
Package NNP O
App NNP O
label VBD O
332e68d865009d627343b89a5744843e3fde4ae870193f36b82980363439a425 CD B-Indicator
ufD.wykyx.vlhvh JJ B-Indicator
SEX NNP O
kr NN O
porn VBD O
403401aa71df1830d294b78de0e5e867ee3738568369c48ffafe1b15f3145588 CD B-Indicator
ufD.wyjyx.vahvh JJ B-Indicator
佐川急便 CD O
466dafa82a4460dcad722d2ad9b8ca332e9a896fc59f06e16ebe981ad3838a6b CD B-Indicator

com.dhp.ozqh NN B-Indicator
Facebook NNP B-Organization
5022495104c280286e65184e3164f3f248356d065ad76acef48ee2ce244ffdc8 CD B-Indicator
ufD.wyjyx.vahvh NN B-Indicator
Anshin NNP O
Scan NNP O
a0f3df39d20c4eaa410a61a527507dbc6b17c7f974f76e13181e98225bda0511 NN B-Indicator
com.aqyh.xolo NN B-Indicator
佐川急便 NNP O
cb412b9a26c1e51ece7a0e6f98f085e1c27aa0251172bf0a361eb5d1165307f7 NN B-Indicator

jp.co.sagawa.SagawaOfficialApp NN B-Indicator
佐川急便 NNP O
Malicious NNP O
URLs NNP O
: : O
hxxp NN B-Indicator
: : I-Indicator
//38 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
27 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
99 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
11/xvideo/ CD I-Indicator
hxxp NNS B-Indicator
: : I-Indicator
//apple-icloud JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
qwe-japan JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//apple-icloud JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
qwq-japan JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com/ NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//apple-icloud JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
zqo-japan JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com/ NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//files.spamo JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
jp/佐川急便.apk NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-qae JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-qaf JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-qau JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-qaw JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-wqe JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-wqo JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-wqp JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-wqq JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-wqu JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//mailsa-wqw JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//nttdocomo-qae JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//nttdocomo-qaq JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//nttdocomo-qaq JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com/aa NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//nttdocomo-qar JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//nttdocomo-qat JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//nttdocomo-qaw JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//sagawa-reg JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com/ NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//www JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
711231 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//www JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
759383 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//www JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
923525 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//www JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
923915 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//www JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
975685 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
Malicious NNP O
Twitter NNP B-Organization
accounts NNS O
: : O
https NN B-Indicator
: : I-Indicator
//twitter.com/lucky88755 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/lucky98745 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/lucky876543 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/luckyone1232 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/sadwqewqeqw JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/gyugyu87418490 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/fdgoer343 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/sdfghuio342 JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/asdqweqweqeqw JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//twitter.com/ukenivor3 NN I-Indicator

Malicious JJ O
Instagram NNP B-Organization
account NN O
: : O
https NN B-Indicator
: : I-Indicator
//www.instagram.com/freedomguidepeople1830/ RB I-Indicator
Malicious NNP O
Tumblr NNP B-Organization
accounts NNS O
: : O
https NN B-Indicator
: : I-Indicator
//mainsheetgyam.tumblr.com/ JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//hormonaljgrj.tumblr.com/ JJ I-Indicator
https NN B-Indicator
: : I-Indicator
//globalanab.tumblr.com/ NNP I-Indicator
C NNP O
& CC O
C NNP O
addresses VBZ O
: : O
104 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
160 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
191 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
190:8822 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
204 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
87:28833 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
204 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
87:28844 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
204 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
87:28855 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
122:28833 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
122:28844 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
122:28855 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
132:28833 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
132:28844 CD I-Indicator
61 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
230 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
132:28855 CD I-Indicator
GoldenCup NNP B-Malware
: : O
New NNP O
Cyber NNP O
Threat NNP O
Targeting NNP O
World NNP O
Cup NNP O
Fans NNPS O
As IN O
the DT O
World NNP O
Cup NNP O
launches NNS O
, , O
so RB O
does VBZ O
a DT O
new JJ O
threat NN O
Officials NNS O
from IN O
the DT O
Israeli NNP B-Organization
Defense NNP I-Organization
Force NNP I-Organization
recently RB O
uncovered VBD O
an DT O
Android NNP B-System
Spyware NNP O
campaign NN O
targeting VBG O
Israeli JJ O
soldiers NNS O
and CC O
orchestrated VBN O
by IN O
" NNP O
Hamas NNP B-Organization
. . O

'' '' O
The DT O
latest JJS O
samples NNS O
attributed VBD O
to TO O
this DT O
campaign NN O
were VBD O
discovered VBN O
by IN O
security NN O
researchers NNS O
from IN O
ClearSky NNP B-Organization
. . O

In IN O
our PRP$ O
research NN O
, , O
we PRP O
focus VBP O
on IN O
the DT O
most RBS O
recent JJ O
sample NN O
, , O
an DT O
application NN O
dubbed VBD O
as IN O
" NNP O
Golden NNP B-Malware
Cup NNP I-Malware
'' '' O
, , O
launched VBD O
just RB O
before IN O
the DT O
start NN O
of IN O
World NNP O
Cup NNP O
2018 CD O
. . O

Distribution NNP O
/ NNP O
Infection NNP O
When WRB O
this DT O
campaign NN O
started VBD O
at IN O
the DT O
start NN O
of IN O
2018 CD O
, , O
the DT O
malware NN O
( ( O
" JJ O
GlanceLove NNP B-Malware
'' '' O
, , O
" VBD O
WinkChat NNP B-Malware
'' '' O
) ) O
was VBD O
distributed VBN O
by IN O
the DT O
perpetrators NNS O
mainly RB O
via IN O
fake JJ O
Facebook NNP B-System
profiles NNS O
, , O
attempting VBG O
to TO O
seduce VB O
IDF NNP O
soldiers NNS O
to TO O
socialize VB O
on IN O
a DT O
different JJ O
platform NN O
( ( O
their PRP$ O
malware NN O
) ) O
. . O

As IN O
this DT O
approach NN O
was VBD O
not RB O
a DT O
great JJ O
success NN O
, , O
their PRP$ O
last JJ O
attempt NN O
was VBD O
to TO O
quickly RB O
create VB O
a DT O
World NNP O
Cup NNP O
app NN O
and CC O
this DT O
time NN O
distribute VB O
it PRP O
to TO O
Israeli NNP O
citizens NNS O
, , O
not RB O
just RB O
soldiers NNS O
. . O

The DT O
official JJ O
“ NNP O
Golden NNP B-Malware
Cup NNP I-Malware
” NNP O
Facebook NNP B-System
page NN O
. . O

The DT O
short JJ O
URL NNP O
redirects NNS O
to TO O
the DT O
application NN O
page NN O
at IN O
Google NNP B-System
Play NNP I-System
. . O

The DT O
official JJ O
“ NNP O
Golden NNP B-Malware
Cup NNP I-Malware
” NNP O
Facebook NNP B-System
page NN O
. . O

The DT O
short JJ O
URL NNP O
redirects NNS O
to TO O
the DT O
application NN O
page NN O
at IN O
Google NNP B-System
Play NNP I-System
. . O

We PRP O
assume VBP O
it PRP O
was VBD O
rushed VBN O
because RB O
, , O
unlike IN O
GlanceLove NNP B-Malware
, , O
it PRP O
lacked VBD O
any DT O
real JJ O
obfuscation NN O
. . O

Even RB O
the DT O
C NNP O
& CC O
C NNP O
server VBD O
side NN O
was VBD O
mostly RB O
exposed VBN O
with IN O
the DT O
file NN O
listing NN O
available JJ O
for IN O
everyone NN O
to TO O
traverse VB O
through IN O
it PRP O
. . O

It PRP O
contained VBD O
approximately RB O
8GB CD O
of IN O
stolen VBN O
data NNS O
. . O

A DT O
recent JJ O
whois NN O
of IN O
“ NNP O
goldncup.com NN B-Indicator
” NN O
. . O

Creation NN O
date NN O
is VBZ O
a DT O
week NN O
before IN O
the DT O
start NN O
of IN O
the DT O
tournament NN O
. . O

A DT O
recent JJ O
whois NN O
of IN O
“ NNP O
goldncup.com NN B-Indicator
” NN O
. . O

Creation NN O
date NN O
is VBZ O
a DT O
week NN O
before IN O
the DT O
start NN O
of IN O
the DT O
tournament NN O
. . O

How WRB O
it PRP O
Works VBZ O
In IN O
order NN O
to TO O
get VB O
into IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP O
, , O
the DT O
malware NN O
uses VBZ O
a DT O
phased JJ O
approach NN O
which WDT O
is VBZ O
quite PDT O
a DT O
common JJ O
practice NN O
for IN O
malware NN O
authors NNS O
these DT O
days NNS O
. . O

The DT O
original JJ O
app NN O
looks VBZ O
innocent JJ O
, , O
with IN O
most JJS O
of IN O
its PRP$ O
code NN O
aimed VBN O
at IN O
implementing VBG O
the DT O
real JJ O
features NNS O
that IN O
the DT O
app NN O
claims VBZ O
to TO O
provide VB O
. . O

In IN O
addition NN O
, , O
it PRP O
collects VBZ O
identifiers NNS O
and CC O
some DT O
data NNS O
from IN O
the DT O
device NN O
. . O

After IN O
getting VBG O
a DT O
command NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
, , O
the DT O
app NN O
is VBZ O
able JJ O
to TO O
download VB O
a DT O
malicious JJ O
payload NN O
in IN O
the DT O
form NN O
of IN O
a DT O
.dex NN O
file NN O
that WDT O
is VBZ O
being VBG O
dynamically RB O
loaded VBN O
adding VBG O
the DT O
additional JJ O
malicious JJ O
capabilities NNS O
. . O

In IN O
this DT O
way NN O
, , O
the DT O
malware NN O
authors NNS O
can MD O
submit VB O
their PRP$ O
app NN O
and CC O
add VB O
the DT O
malicious JJ O
capabilities NNS O
only RB O
after IN O
their PRP$ O
app NN O
is VBZ O
live JJ O
on IN O
the DT O
Play NNP B-System
Store NNP I-System
. . O

Communication NN O
with IN O
the DT O
C NNP O
& CC O
C NNP O
In IN O
order NN O
to TO O
communicate VB O
with IN O
its PRP$ O
C NNP O
& CC O
C NNP O
, , O
the DT O
app NN O
uses VBZ O
the DT O
MQTT NNP O
( ( O
Message NNP O
Queuing NNP O
Telemetry NNP O
Transport NNP O
) ) O
protocol NN O
, , O
which WDT O
is VBZ O
transported VBN O
over IN O
TCP NNP B-Indicator
port NN I-Indicator
1883 CD I-Indicator
. . O

Initiating VBG O
the DT O
MQTT NNP O
client NN O
. . O

Initiating VBG O
the DT O
MQTT NNP O
client NN O
. . O

Initiating VBG O
the DT O
MQTT NNP O
client NN O
. . O

The DT O
app NN O
connects VBZ O
to TO O
the DT O
MQTT NNP O
broker NN O
with IN O
hardcoded VBN O
username NN O
and CC O
password NN O
and CC O
a DT O
unique JJ O
device NN O
identifier NN O
generated VBN O
for IN O
each DT O
device NN O
. . O

The DT O
MQTT NNP O
connection NN O
to TO O
broker VB O
The DT O
MQTT NNP O
connection NN O
to TO O
broker VB O
The DT O
MQTT NNP O
communication NN O
is VBZ O
used VBN O
primarily RB O
to TO O
update VB O
the DT O
device NN O
state NN O
and CC O
get VB O
commands NNS O
from IN O
the DT O
C NNP O
& CC O
C NNP O
. . O

It PRP O
uses VBZ O
different JJ O
topics NNS O
that WDT O
include VBP O
the DT O
unique JJ O
device NN O
identifier NN O
, , O
which WDT O
side NN O
is VBZ O
sending VBG O
the DT O
message NN O
, , O
and CC O
whether IN O
it PRP O
is VBZ O
information NN O
message NN O
or CC O
command NN O
. . O

HTTP NNP O
Communication NNP O
In IN O
addition NN O
to TO O
the DT O
MQTT NNP O
communication NN O
, , O
the DT O
app NN O
also RB O
uses VBZ O
plain NN O
text JJ O
HTTP NNP O
communication NN O
in IN O
order NN O
to TO O
download VB O
the DT O
.dex NN O
file NN O
and CC O
upload NN O
collected VBN O
data NNS O
. . O

All DT O
of IN O
the DT O
files NNS O
that WDT O
are VBP O
being VBG O
uploaded JJ O
or CC O
downloaded VBN O
are VBP O
zip JJ O
files NNS O
encrypted VBN O
by IN O
AES NNP O
with IN O
ECB NNP O
mode NN O
. . O

The DT O
key NN O
for IN O
each DT O
file NN O
is VBZ O
generated VBN O
randomly RB O
and CC O
stored VBN O
in IN O
the DT O
encrypted JJ O
file NN O
with IN O
a DT O
fixed JJ O
offset NN O
. . O

In IN O
order NN O
to TO O
upload VB O
the DT O
file NN O
, , O
the DT O
app NN O
uses VBZ O
a DT O
basic JJ O
REST NNP O
communication NN O
with IN O
the DT O
server NN O
, , O
checking VBG O
if IN O
the DT O
file NN O
exists NNS O
and CC O
uploading VBG O
it PRP O
if IN O
it PRP O
isn VBZ O
’ JJ O
t NN O
. . O

The DT O
path NN O
that WDT O
is VBZ O
used VBN O
for IN O
the DT O
uploads NNS O
is VBZ O
: : O
http NN B-Indicator
: : I-Indicator
// NN I-Indicator
/apps/d/p/op.php VBZ I-Indicator
The DT O
communication NN O
looks VBZ O
like IN O
this DT O
: : O
First JJ O
Phase NNP O
The DT O
first JJ O
phase NN O
of IN O
the DT O
app NN O
’ NNP O
s VBZ O
attack NN O
flow NN O
collects VBZ O
device JJ O
information NN O
and CC O
a DT O
list NN O
of IN O
apps NN O
installed VBN O
on IN O
the DT O
device NN O
. . O

These DT O
are VBP O
then RB O
uploaded JJ O
to TO O
the DT O
C NNP O
& CC O
C NNP O
HTTP NNP O
server NN O
. . O

The DT O
collection NN O
of IN O
basic JJ O
device NN O
information NN O
. . O

The DT O
collection NN O
of IN O
basic JJ O
device NN O
information NN O
. . O

In IN O
addition NN O
, , O
at IN O
this DT O
stage NN O
the DT O
app NN O
can MD O
process VB O
one CD O
of IN O
these DT O
commands NNS O
: : O
• NN O
Collect NNP O
device NN O
info NN O
• NNP O
Install NNP O
app NN O
• NNP O
Is VBZ O
online JJ O
? . O

• JJ O
Change NNP O
server NN O
domain NN O
Out IN O
of IN O
these DT O
, , O
the DT O
most RBS O
interesting JJ O
command NN O
is VBZ O
the DT O
“ JJ O
install NN O
app NN O
” NNP O
command NN O
that WDT O
downloads VBZ O
an DT O
encrypted JJ O
zip NN O
file NN O
containing VBG O
the DT O
second JJ O
phase NN O
dex NN O
file NN O
, , O
unpacks NNS O
and CC O
loads VBZ O
it PRP O
. . O

Second JJ O
Phase NNP O
The DT O
second JJ O
phase NN O
dex NN O
file NN O
contains VBZ O
3 CD O
main JJ O
services NNS O
that WDT O
are VBP O
being VBG O
used VBN O
: : O
• JJ O
ConnManager NNP O
- : O
handles NNS O
connections NNS O
to TO O
the DT O
C NNP O
& CC O
C NNP O
• NNP O
ReceiverManager NNP O
- : O
waits NNS O
for IN O
incoming VBG O
calls NNS O
/ JJ O
app JJ O
installations NNS O
• VBP O
TaskManager NNP O
- : O
manages VBZ O
the DT O
data NNS O
collection NN O
tasks IN O
The DT O
C NNP O
& CC O
C NNP O
server NN O
address NN O
is VBZ O
different JJ O
than IN O
the DT O
one NN O
that WDT O
is VBZ O
used VBN O
by IN O
the DT O
first JJ O
phase NN O
, , O
so IN O
the DT O
app NN O
reconnects VBZ O
to TO O
the DT O
new JJ O
server NN O
as RB O
well RB O
as IN O
starts VBZ O
the DT O
periodic JJ O
data NNS O
collector NN O
tasks NNS O
. . O

By IN O
analyzing VBG O
the DT O
TaskManager NNP O
class NN O
we PRP O
can MD O
see VB O
the DT O
new JJ O
commands NNS O
that WDT O
are VBP O
supported VBN O
at IN O
this DT O
stage NN O
: : O
As IN O
can MD O
be VB O
seen VBN O
in IN O
the DT O
code NN O
snippet NN O
above IN O
, , O
there EX O
are VBP O
quite RB O
a DT O
lot NN O
of IN O
data NNS O
collection NN O
tasks NNS O
that WDT O
are VBP O
now RB O
available JJ O
: : O
Collect JJ O
device NN O
info NN O
Track NNP O
location NN O
Upload NNP O
contacts VBZ O
information NN O
Upload NNP O
sent NN O
and CC O
received VBD O
SMS NNP O
messages NNS O
Upload NNP O
images NNS O
Upload NNP O
video NN O
files NNS O
Send VBP O
recursive JJ O
dirlist NN O
of IN O
the DT O
external JJ O
storage NN O
Upload NNP O
specific JJ O
files NNS O
Record NNP O
audio NN O
using VBG O
the DT O
microphone NN O
Record NNP O
calls VBZ O
Use NNP O
the DT O
camera NN O
to TO O
capture VB O
bursts NNS O
of IN O
snapshots NNS O
Those DT O
tasks NNS O
can MD O
either VB O
run VB O
periodically RB O
, , O
on IN O
event NN O
( ( O
such JJ O
as IN O
incoming VBG O
call NN O
) ) O
or CC O
when WRB O
getting VBG O

a DT O
command NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

Mitigations NNS O
Stay VBP O
protected VBN O
from IN O
mobile JJ O
malware NN O
by IN O
taking VBG O
these DT O
precautions NNS O
: : O
Do NNP O
not RB O
download VB O
apps NN O
from IN O
unfamiliar JJ O
sites NNS O
Only RB O
install VBP O
apps RB O
from IN O
trusted VBN O
sources NNS O
Pay NNP O
close RB O
attention NN O
to TO O
the DT O
permissions NNS O
requested VBN O
by IN O
apps NN O
Install NNP O
a DT O
suitable JJ O
mobile JJ O
security NN O
app NN O
, , O
such JJ O
as IN O
SEP NNP O
Mobile NNP O
or CC O
Norton NNP O
, , O
to TO O
protect VB O
your PRP$ O
device NN O
and CC O
data NNS O
Keep NNP O
your PRP$ O
operating NN O
system NN O
up IN O
to TO O
date NN O
Make NNP O
frequent JJ O
backups NNS O
of IN O
important JJ O
data NNS O
Indicators NNS O
of IN O
Compromise NNP O
( ( O
IoCs NNP O
) ) O
Package NN O
names NNS O
: : O
anew.football.cup.world.com.worldcup NN B-Indicator
com.coder.glancelove VB B-Indicator
com.winkchat WP I-Indicator
APK NNP O
SHA2 NNP O
: : O
166f3a863bb2b66bda9c76dccf9529d5237f6394721f46635b053870eb2fcc5a CD B-Indicator

b45defca452a640b303288131eb64c485f442aae0682a3c56489d24d59439b47 NN B-Indicator
d9601735d674a9e55546fde0bffde235bc5f2546504b31799d874e8c31d5b6e9 VBZ B-Indicator
2ce54d93510126fca83031f9521e40cd8460ae564d3d927e17bd63fb4cb20edc CD B-Indicator
67b1a1e7b505ac510322b9d4f4fc1e8a569d6d644582b588faccfeeaa4922cb7 CD B-Indicator

1664cb343ee830fa94725fed143b119f7e2351307ed0ce04724b23469b9002f2 CD B-Indicator
Loaded NNP O
DEX NNP O
SHA2 NNP O
: : O
afaf446a337bf93301b1d72855ccdd76112595f6e4369d977bea6f9721edf37e JJ B-Indicator
Domain/IP NNP O
: : O
goldncup NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
glancelove NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
autoandroidup NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
website JJ I-Indicator
mobilestoreupdate NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
website NN I-Indicator
updatemobapp JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
website $ I-Indicator
107 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
175 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
144 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
26 CD I-Indicator
192 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
64 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] RB I-Indicator
114 CD I-Indicator
[ NNS I-Indicator
. . I-Indicator

] $ I-Indicator
147 CD I-Indicator
Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
: : O
Android NNP B-System
Trojan NNP O
targets VBZ O
security-seekers NNS O
A NNP O
malicious JJ O
, , O
counterfeit JJ O
version NN O
of IN O
a DT O
VPN NNP B-System
client NN O
for IN O
mobile JJ O
devices NNS O
targets NNS O
security-minded JJ O
victims NNS O
with IN O
a DT O
RAT NNP O
. . O

Written VBN O
by IN O
Jagadeesh NNP O
Chandraiah NNP O
JULY NNP O
23 CD O
, , O
2018 CD O
SophosLabs NNP B-Organization
has VBZ O
uncovered VBN O
a DT O
mobile JJ O
malware NN O
distribution NN O
campaign NN O
that WDT O
uses VBZ O
advertising VBG O
placement NN O
to TO O
distribute VB O
the DT O
Red NNP B-Malware
Alert NNP I-Malware
Trojan NNP I-Malware
, , O
linking VBG O
counterfeit NN O
branding NN O
of IN O
well-known JJ O
apps NN O
to TO O
Web NNP O
pages NNS O
that WDT O
deliver VBP O
an DT O
updated VBN O
, , O
2.0 CD O
version NN O
of IN O
this DT O
bank NN O
credential JJ O
thief NN O
. . O

The DT O
group NN O
distributing VBG O
this DT O
family NN O
of IN O
malware NN O
decorates VBZ O
it PRP O
in IN O
the DT O
branding NN O
and CC O
logos NN O
of IN O
well-known JJ O
social JJ O
media NNS O
or CC O
media NNS O
player NN O
apps NN O
, , O
system NN O
update JJ O
patches NNS O
, , O
or CC O
( ( O
in IN O
its PRP$ O
most RBS O
recent JJ O
campaign NN O
) ) O
VPN NNP B-System
client NN O
apps NN O
in IN O
an DT O
attempt NN O
to TO O
lure NN O
users NNS O
into IN O
downloading VBG O
, , O
installing NN O
, , O
and CC O
elevating VBG O
the DT O
privileges NNS O
of IN O
a DT O
Trojanized NNP O
app NN O
hosted VBD O
on IN O
a DT O
site NN O
not RB O
affiliated VBN O
with IN O
any DT O
reputable JJ O
app NN O
market NN O
or CC O
store NN O
. . O

Aside RB O
from IN O
the DT O
inescapable JJ O
irony NN O
of IN O
disguising VBG O
a DT O
security-reducing JJ O
Trojan NNP O
as IN O
an DT O
ostensibly RB O
security-enhancing JJ O
app NN O
, , O
and CC O
the DT O
righteous JJ O
affront NN O
to TO O
the DT O
whole JJ O
concept NN O
of IN O
a DT O
VPN NNP O
’ NNP O
s VBD O
purpose VB O
a DT O
Trojan NNP O
so RB O
disguised JJ O
inspires NNS O
, , O
this DT O
represents VBZ O
an DT O
escalation NN O
in IN O
the DT O
variety NN O
of IN O
app JJ O
types NNS O
targeted VBN O
by IN O
this DT O
campaign NN O
of IN O
bankbots NNS O
in IN O
disguise NN O
. . O

Red JJ B-Malware
Alert NNP I-Malware
Plays NNP O
Dress-Up NNP O
In IN O
the DT O
wild JJ O
, , O
we PRP O
found VBD O
Web NNP O
pages NNS O
designed VBN O
to TO O
( ( O
vaguely RB O
) ) O
resemble JJ O
legitimate JJ O
app NN O
market NN O
pages NNS O
, , O
hosting VBG O
files NNS O
for IN O
download NN O
that WDT O
have VBP O
been VBN O
disguised VBN O
as IN O
a DT O
legitimate JJ O
mobile JJ O
application NN O
of IN O
moderately RB O
broad JJ O
appeal NN O
, , O
such JJ O
as IN O
a DT O
media NNS O
player NN O
or CC O
social JJ O
media NNS O
app NN O
. . O

But CC O
the DT O
categories NNS O
targeted VBN O
by IN O
this DT O
group NN O
seem VBP O
to TO O
be VB O
broadening VBG O
with IN O
the DT O
inclusion NN O
of IN O
VPN NNP B-System
software NN O
. . O

The DT O
Web NNP O
page NN O
shown VBN O
here RB O
on IN O
the DT O
left NN O
is VBZ O
hosted VBN O
on IN O
a DT O
domain NN O
that WDT O
seems VBZ O
apt JJ O
: : O
free-vpn JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
download NN I-Indicator
. . O

Investigation NN O
of IN O
this DT O
domain NN O
led VBD O
to TO O
additional JJ O
domains NNS O
that WDT O
appear VBP O
to TO O
have VB O
been VBN O
registered VBN O
for IN O
use NN O
with IN O
the DT O
campaign NN O
, , O
but CC O
are VBP O
not RB O
in IN O
use NN O
yet RB O
. . O

( ( O
You PRP O
can MD O
find VB O
additional JJ O
IoCs NNP O
at IN O
the DT O
end NN O
of IN O
this DT O
article NN O
) ) O
As IN O
you PRP O
can MD O
see VB O
, , O
the DT O
Web NNP O
page NN O
uses VBZ O
a DT O
similar JJ O
colour NN O
scheme NN O
as IN O
, , O
and CC O
the DT O
icon NN O
design NN O
from IN O
, , O
a DT O
legitimate JJ O
VPN NNP O
application NN O
( ( O
VPN NNP O
Proxy NNP O
Master NNP O
) ) O
found VBD O
on IN O
the DT O
Google NNP B-System
Play NNP I-System
store NN I-System
. . O

The DT O
fake JJ O
doesn NN O
’ NNP O
t VBZ O
quite RB O
nail JJ O
the DT O
app NN O
name NN O
. . O

In IN O
addition NN O
to TO O
“ VB O
Free NNP B-System
VPN NNP I-System
Master NNP I-System
Android NNP I-System
, , O
” NNP O
we PRP O
’ VBP O
ve JJ O
observed VBN O
Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
Trojans NNPS O
in IN O
the DT O
wild JJ O
disguising VBG O
themselves PRP O
using VBG O
names NNS O
like IN O
: : O
Flash NNP B-System
Player NNP I-System
or CC O
Update NNP B-System
Flash NNP I-System
Player NNP I-System
Android NNP B-System
Update NNP I-System
or CC O
Android NNP B-System
Antivirus NNP I-System
Chrome NNP B-System
Update NNP I-System
or CC O
Google NNP B-System
Update NNP I-System
Update NNP B-System
Google NNP I-System
Market NNP I-System
WhatsApp NNP B-System
Viber NNP B-System
OneCoin NNP B-System
Wallet NNP B-System
Pornhub NNP O
Tactic NNP O
FlashLight NNP O
or CC O
PROFlashLight NNP O
Finanzonline NNP O
The DT O
vast JJ O
majority NN O
of IN O
in-the-wild JJ O
Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
samples NNS I-Malware
falsely RB O
present JJ O
themselves PRP O
as IN O
Adobe NNP B-System
Flash NNP I-System
player NN I-System
for IN O
Android NNP B-System
, , O
a DT O
utility NN O
that WDT O
Adobe NNP B-Organization
stopped VBD O
supporting VBG O
years NNS O
ago RB O
. . O

Our PRP$ O
logs NNS O
show VBP O
a DT O
number NN O
of IN O
simultaneous JJ B-Malware
Red NNP I-Malware
Alert NNP I-Malware
2.0 CD I-Malware
campaigns NNS I-Malware
in IN O
operation NN O
, , O
many JJ O
( ( O
but CC O
not RB O
all DT O
) ) O
hosted VBN O
on IN O
dynamic JJ O
DNS NNP O
domains NNS O
. . O

The DT O
Red NNP B-Malware
Alert NNP I-Malware
Payload NNP I-Malware
Once NNP O
installed VBD O
, , O
the DT O
malware NN O
requests VBZ O
Device NNP O
Administrator NNP O
privileges NNS O
. . O

If IN O
the DT O
malware NN O
obtains VBZ O
device JJ O
administrator NN O
rights NNS O
, , O
it PRP O
will MD O
be VB O
able JJ O
to TO O
lock VB O
the DT O
screen NN O
by IN O
itself PRP O
, , O
expire VB O
the DT O
password NN O
, , O
and CC O
resist NN O
being VBG O
uninstalled VBN O
through IN O
normal JJ O
methods NNS O
. . O

Device NNP O
admin RB O
request VBP O
from IN O
app NN O
that WDT O
says VBZ O
it PRP O
is VBZ O
WhatsApp NNP O
The DT O
app NN O
then RB O
stays VBZ O
in IN O
the DT O
background NN O
listening VBG O
to TO O
commands NNS O
from IN O
the DT O
cybercrooks NNS O
. . O

Within IN O
some DT O
of IN O
the DT O
first JJ O
of IN O
those DT O
commands NNS O
, , O
the DT O
bot NN O
typically RB O
receives VBZ O
a DT O
list NN O
of IN O
banks NNS O
it PRP O
will MD O
target VB O
. . O

The DT O
Trojan NNP O
works NNS O
by IN O
creating VBG O
an DT O
overlay NN O
whenever WRB O
the DT O
user NN O
launches VBZ O
the DT O
banking NN O
application NN O
. . O

Currently RB O
Running VBG O
Applications NNP O
Banking NNP O
Trojans NNPS O
that WDT O
rely VBP O
on IN O
the DT O
overlay NN O
mechanism NN O
to TO O
steal VB O
information NN O
need NN O
to TO O
know VB O
what WP O
application NN O
is VBZ O
in IN O
the DT O
foreground NN O
. . O

They PRP O
do VBP O
this DT O
not RB O
only RB O
to TO O
identify VB O
whether IN O
the DT O
use NN O
of IN O
a DT O
particular JJ O
app NN O
may MD O
permit VB O
them PRP O
to TO O
harvest VB O
another DT O
credential NN O
, , O
but CC O
also RB O
because IN O
each DT O
targeted JJ O
app NN O
needs NNS O
to TO O
have VB O
an DT O
overlay NN O
mapped VBD O
to TO O
its PRP$ O
design NN O
, , O
so IN O
the DT O
Trojan NNP O
can MD O
intercept VB O
and CC O
steal VB O
user JJR O
data NNS O
. . O

This DT O
quest NN O
to TO O
determine VB O
the DT O
currently RB O
running VBG O
application NN O
is VBZ O
a DT O
hallmark NN O
of IN O
overlay NN O
malware NN O
, , O
so IN O
we PRP O
thought VBD O
we PRP O
’ VBP O
d JJ O
take VB O
a DT O
closer JJR O
look NN O
at IN O
how WRB O
it PRP O
’ VBZ O
s JJ O
done VBN O
. . O

To TO O
prevent VB O
this DT O
, , O
Android NNP B-System
’ NNP O
s VBD O
engineers NNS O
regularly RB O
release VBP O
updates NNS O
that WDT O
contain VBP O
bug JJ O
fixes NNS O
designed VBN O
to TO O
prevent VB O
apps NN O
from IN O
getting VBG O
the DT O
list NN O
of IN O
currently RB O
running VBG O
apps RB O
without IN O
explicit JJ O
permission NN O
. . O

With IN O
every DT O
Android NNP B-System
update NN O
, , O
the DT O
malware NN O
authors NNS O
are VBP O
forced VBN O
to TO O
come VB O
up RP O
with IN O
new JJ O
tricks NNS O
. . O

This DT O
particular JJ O
case NN O
is VBZ O
not RB O
an DT O
exception NN O
. . O

The DT O
author NN O
( ( O
s JJ O
) ) O
of IN O
this DT O
malware JJ O
wrote VBD O
separate JJ O
subroutines NNS O
that WDT O
identify VBP O
the DT O
operating NN O
system NN O
version NN O
and CC O
fire VB O
off RP O
methods NNS O
to TO O
obtain VB O
a DT O
list NN O
of IN O
currently RB O
running VBG O
applications NNS O
known VBN O
to TO O
work VB O
on IN O
that DT O
particular JJ O
version NN O
of IN O
Android NNP B-System
. . O

First RB O
, , O
they PRP O
use VBP O
the DT O
built-in JJ O
toolbox NN O
commands NNS O
to TO O
determine VB O
what WP O
apps NN O
are VBP O
running VBG O
. . O

If IN O
that DT O
doesn VBZ O
’ JJ O
t NN O
work NN O
, , O
they PRP O
try VBP O
to TO O
use VB O
queryUsageStats NNS O
: : O
When WRB O
the DT O
malware NN O
invokes VBZ O
queryUsageStats NNS O
, , O
it PRP O
asks VBZ O
for IN O
the DT O
list NN O
of IN O
applications NNS O
that WDT O
ran VBD O
in IN O
the DT O
last JJ O
1 CD O
million CD O
milliseconds NNS O
( ( O
16 CD O
minutes NNS O
and CC O
40 CD O
seconds NNS O
) ) O
. . O

String VBG O
Resources NNS O
Used VBN O
to TO O
Store NNP O
App NNP O
Data NNP O
Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
stores NNS O
its PRP$ O
data NNS O
in IN O
an DT O
atypical JJ O
location NN O
( ( O
inside IN O
the DT O
Strings.xml NNP B-Indicator
file NN I-Indicator
embedded VBD O
in IN O
the DT O
app NN O
) ) O
to TO O
fetch VB O
its PRP$ O
critical JJ O
data NNS O
, , O
such JJ O
as IN O
the DT O
C2 NNP O
address NN O
. . O

The DT O
com.dsufabunfzs.dowiflubs JJ O
strings NNS O
in IN O
the DT O
screenshot JJ O
above IN O
refer NN O
to TO O
the DT O
internal JJ O
name NN O
this DT O
particular JJ O
malware NN O
was VBD O
given VBN O
, , O
which WDT O
in IN O
this DT O
case NN O
was VBD O
randomized VBN O
into IN O
alphabet NN O
salad NN O
. . O

It PRP O
’ VBZ O
s RB O
been VBN O
SophosLabs NNP O
’ NNP O
observation NN O
that WDT O
Red NNP B-Malware
Alert NNP I-Malware
Trojans NNP I-Malware
usually RB O
have VBP O
a DT O
randomized VBN O
internal JJ O
name NN O
like IN O
this DT O
. . O

The DT O
strings JJ O
section NN O
of IN O
the DT O
app NN O
contains VBZ O
embedded VBN O
command-and-control NN O
IP NNP O
addresses VBZ O
, , O
ports NNS O
, , O
and CC O
domain NN O
names NNS O
in IN O
plaintext NN O
. . O

It PRP O
is VBZ O
an DT O
invaluable JJ O
source NN O
of IN O
intelligence NN O
about IN O
a DT O
given VBN O
campaign NN O
.. VBZ O
The DT O
following JJ O
snippet NN O
shows VBZ O
the DT O
location NN O
within IN O
the DT O
Trojan NNP O
where WRB O
it PRP O
uses VBZ O
SQLite NNP O
database NN O
commands VBZ O
to TO O
store VB O
and CC O
recall VB O
command-and-control JJ O
addresses NNS O
: : O
Backdoor NNP O
Commands VBZ O
The DT O
Red NNP B-Malware
Alert NNP I-Malware
code NN I-Malware
also RB O
contains VBZ O
an DT O
embedded JJ O
list NN O
of IN O
commands NNS O
the DT O
botmaster NN O
can MD O
send VB O
to TO O
the DT O
bot NN O
. . O

The DT O
malware NN O
can MD O
execute VB O
a DT O
variety NN O
of IN O
arbitrary JJ O
commands NNS O
, , O
including VBG O
( ( O
for IN O
example NN O
) ) O
intercepting NN O
or CC O
sending VBG O
text JJ O
messages NNS O
without IN O
the DT O
user NN O
’ NNP O
s NN O
knowledge NN O
, , O
obtaining VBG O
a DT O
copy NN O
of IN O
the DT O
victim NN O
’ NNP O
s NN O
Address NNP B-System
Book NNP I-System
, , O
or CC O
call VB O
or CC O
text JJ O
message NN O
logs NNS O
, , O
or CC O
sending VBG O
phone NN O
network NN O
feature NN O
codes NNS O
( ( O
also RB O
known VBN O
as IN O
USSD NNP O
codes NNS O
) ) O
. . O

C2 NNP O
and CC O
Targeted NNP O
Banks NNP O
As IN O
described VBN O
earlier RBR O
, , O
the DT O
C2 NNP O
domain NN O
is VBZ O
kept VBN O
in IN O
the DT O
app NN O
’ NNP O
s JJ O
resources NNS O
. . O

During IN O
the DT O
app JJ O
execution NN O
, , O
the DT O
malware NN O
contacts VBZ O
C2 NNP O
domain NN O
for IN O
further JJ O
instructions NNS O
. . O

Most JJS O
of IN O
the DT O
network NN O
traffic NN O
we PRP O
’ VBP O
ve JJ O
observed VBN O
is VBZ O
HTTP NNP B-Indicator
. . O

The DT O
C2 NNP O
address NN O
, , O
as IN O
stored VBN O
in IN O
samples NNS O
we PRP O
’ VBP O
ve JJ O
seen VBN O
, , O
comprise VB O
both DT O
an DT O
IP NNP O
address NN O
and CC O
port NN O
number NN O
; : O
So NNP O
far RB O
, , O
all PDT O
the DT O
samples NNS O
we PRP O
’ VBP O
ve RB O
tested VBN O
attempted VBD O
to TO O
contact VB O
an DT O
IP NNP O
address NN O
on IN O
port NN B-Indicator
7878/tcp CD I-Indicator
. . O

If IN O
the DT O
main JJ O
C2 NNP O
domain NN O
is VBZ O
not RB O
responsive JJ O
, , O
the DT O
bot NN O
fetches VBZ O
a DT O
backup NN O
C2 NNP O
domain NN O
from IN O
a DT O
Twitter NNP B-Organization
account NN O
. . O

Static JJ O
analysis NN O
of IN O
the DT O
code NN O
reveals VBZ O
that IN O
the DT O
malware NN O
downloads VBZ O
the DT O
overlay NN O
template NN O
to TO O
use VB O
against IN O
any DT O
of IN O
the DT O
bank NN O
( ( O
s PRP O
) ) O
it PRP O
is VBZ O
targeting VBG O
. . O

The DT O
malware NN O
also RB O
sends VBZ O
regular JJ O
telemetry NN O
back RB O
to TO O
its PRP$ O
C2 NNP O
server NN O
about IN O
the DT O
infected JJ O
device NN O
in IN O
the DT O
form NN O
of IN O
an DT O
HTTP NNP B-Indicator
POST NNP O
to TO O
its PRP$ O
C2 NNP O
server NN O
. . O

It PRP O
uses VBZ O
the DT O
base NN O
Dalvik NNP O
User-Agent NNP O
string NN O
for IN O
the DT O
device NN O
it PRP O
’ VBZ O
s JJ O
running VBG O
on IN O
. . O

The DT O
content NN O
of IN O
the DT O
HTTP NNP B-Indicator
POST NNP O
data NN O
is VBZ O
telemetry JJ O
data NNS O
in IN O
a DT O
json NN O
format NN O
about IN O
the DT O
device NN O
the DT O
malware NN O
is VBZ O
running VBG O
on IN O
. . O

The DT O
list NN O
of IN O
banks NNS O
targeted VBN O
by IN O
Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
includes VBZ O
NatWest NNP O
, , O
Barclays NNP B-Organization
, , O
Westpac NNP O
, , O
and CC O
Citibank NNP O
. . O

Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
is VBZ O
a DT O
banking NN O
bot NN O
that WDT O
is VBZ O
currently RB O
very RB O
active JJ O
online NN O
, , O
and CC O
presents VBZ O
a DT O
risk NN O
to TO O
Android NNP O
devices NNS O
. . O

We PRP O
expect VBP O
to TO O
see VB O
more JJR O
diversification NN O
in IN O
the DT O
social JJ O
engineering NN O
lures VBZ O
this DT O
threat NN O
group NN O
employs VBZ O
as IN O
time NN O
goes VBZ O
on IN O
. . O

So RB O
far RB O
, , O
legitimate JJ O
app NN O
stores NNS O
appear VBP O
to TO O
be VB O
this DT O
malware NN O
’ VBZ O
s JJ O
Achilles NNP O
heel NN O
; : O
disabling VBG O
the DT O
installation NN O
of IN O
third-party JJ O
apps NN O
has VBZ O
been VBN O
an DT O
effective JJ O
prevention NN O
measure NN O
. . O

Stick NNP O
to TO O
Google NNP B-System
Play NNP I-System
and CC O
use VB O
VPN NNP O
software NN O
from IN O
reputable JJ O
vendors NNS O
. . O

Sophos NNP B-Organization
detects VBZ O
all PDT O
the DT O
samples NNS O
of IN O
this DT O
Trojan NNP O
family NN O
as IN O
Andr/Banker-GWC NNP O
and CC O
Andr/Spybot-A NNP O
. . O

In IN O
the DT O
wild JJ O
, , O
these DT O
are VBP O
only RB O
distributed VBN O
as IN O
a DT O
direct JJ O
download NN O
from IN O
unofficial JJ O
Web NNP O
pages NNS O
( ( O
“ JJ O
third-party NN O
” NNP O
app NN O
) ) O
and CC O
not RB O
through IN O
legitimate JJ O
app NN O
stores NNS O
. . O

Red NNP B-Malware
Alert NNP I-Malware
2.0 CD I-Malware
IoCs NNP O
list NN O
C2 NNP O
addresses VBZ O
103.239.30.126:7878 CD B-Indicator
146.185.241.29:7878 CD B-Indicator
146.185.241.42:7878 CD B-Indicator
185.126.200.3:7878 CD B-Indicator
185.126.200.12:7878 CD B-Indicator
185.126.200.15:7878 CD B-Indicator
185.126.200.18:7878 CD B-Indicator
185.165.28.15:7878 CD B-Indicator
185.243.243.241:7878 CD B-Indicator
185.243.243.244:7878 CD B-Indicator
185.243.243.245:7878 CD B-Indicator
Domains NNS O
Malware NNP O
source NN O
Web NNP O
hosts NNS O

on IN O
167.99.176.61 CD B-Indicator
: : O
free-androidvpn.date JJ B-Indicator
free-androidvpn.download JJ O
free-androidvpn.online JJ O
free-vpn.date JJ B-Indicator
free-vpn.download JJ O
free-vpn.online JJ O
Hashes NNP O
22fcfce096392f085218c3a78dd0fa4be9e67ed725bce42b965a27725f671cf CD O
55292a4dde8727faad1c40c914cf1be9dfdcf4e67b515aa593bcd8d86e824372 CD B-Indicator

be92a751e5abbcd24151b509dbb4feb98ea46f367a99d6f86ed4a7c162461e31 NN B-Indicator
5c4d666cef84abc2a1ffd3b1060ef28fa3c6c3bb4fad1fa26db99350b41bea4c CD B-Indicator
06081ab7faa729e33b9397a0e47548e75cbec3d43c50e6368e81d737552150a5 CD B-Indicator
753999cb19a4346042f973e30cf1158c44f2335ab65859d3bfa16bca4098e2ef CD B-Indicator

As IN O
a DT O
result NN O
of IN O
a DT O
lot NN O
of IN O
hard JJ O
work NN O
done VBN O
by IN O
our PRP$ O
security NN O
research NN O
teams NNS O
, , O
we PRP O
revealed VBD O
today NN O
a DT O
new JJ O
and CC O
alarming VBG O
malware NN O
campaign NN O
. . O

The DT O
attack NN O
campaign NN O
, , O
named VBN O
Gooligan NNP B-Malware
, , O
breached VBD O
the DT O
security NN O
of IN O
over IN O
one CD O
million CD O
Google NNP B-Organization
accounts NNS O
. . O

The DT O
number NN O
continues VBZ O
to TO O
rise VB O
at IN O
an DT O
additional JJ O
13,000 CD O
breached JJ O
devices NNS O
each DT O
day NN O
. . O

Our PRP$ O
research NN O
exposes VBZ O
how WRB O
the DT O
malware NN O
roots NNS O
infected VBD O
devices NNS O
and CC O
steals NNS O
authentication NN O
tokens VBZ O
that IN O
can MD O
be VB O
used VBN O
to TO O
access NN O
data NNS O
from IN O
Google NNP B-System
Play NNP I-System
, , O
Gmail NNP B-System
, , O
Google NNP B-System
Photos NNP I-System
, , O
Google NNP B-System
Docs NNP I-System
, , O
G NNP B-System
Suite NNP I-System
, , O
Google NNP B-System
Drive NNP I-System
, , O
and CC O
more JJR O
. . O

Gooligan NNP B-Malware
is VBZ O
a DT O
new JJ O
variant NN O
of IN O
the DT O
Android NNP O
malware NN O
campaign NN O
found VBN O
by IN O
our PRP$ O
researchers NNS O
in IN O
the DT O
SnapPea NNP B-Malware
app NN O
last JJ O
year NN O
. . O

Check NNP B-Organization
Point NNP I-Organization
reached VBD O
out RP O
to TO O
the DT O
Google NNP B-Organization
Security NNP I-Organization
team NN O
immediately RB O
with IN O
information NN O
on IN O
this DT O
campaign NN O
. . O

Our PRP$ O
researchers NNS O
are VBP O
working VBG O
closely RB O
with IN O
Google NNP B-Organization
to TO O
investigate VB O
the DT O
source NN O
of IN O
the DT O
Gooligan NNP B-Malware
campaign NN I-Malware
. . O

“ NN O
We PRP O
’ VBP O
re JJ O
appreciative NN O
of IN O
both DT O
Check NNP B-Organization
Point NNP I-Organization
’ NNP O
s VBD O
research NN O
and CC O
their PRP$ O
partnership NN O
as IN O
we PRP O
’ VBP O
ve JJ O
worked VBN O
together RB O
to TO O
understand VB O
these DT O
issues NNS O
, , O
” NNP O
said VBD O
Adrian JJ O
Ludwig NNP O
, , O
Google NNP B-Organization
’ NNP O
s VBD O
director NN O
of IN O
Android NNP B-System
security NN O
. . O

“ NN O
As IN O
part NN O
of IN O
our PRP$ O
ongoing VBG O
efforts NNS O
to TO O
protect VB O
users NNS O
from IN O
the DT O
Ghost NNP B-Malware
Push NNP I-Malware
family NN I-Malware
of IN O
malware NN O
, , O
we PRP O
’ VBP O
ve JJ O
taken VBN O
numerous JJ O
steps NNS O
to TO O
protect VB O
our PRP$ O
users NNS O
and CC O
improve VB O
the DT O
security NN O
of IN O
the DT O
Android NNP B-System
ecosystem NN O
overall. JJ O
” NN O
We PRP O
are VBP O
very RB O
encouraged VBN O
by IN O
the DT O
statement NN O
Google NNP B-Organization
shared VBD O
with IN O
us PRP O
addressing VBG O
the DT O
issue NN O
. . O

We PRP O
have VBP O
chosen VBN O
to TO O
join VB O
forces NNS O
to TO O
continue VB O
the DT O
investigation NN O
around IN O
Gooligan NNP B-Malware
. . O

Google NNP B-Organization
also RB O
stated VBD O
that IN O
they PRP O
are VBP O
taking VBG O
numerous JJ O
steps NNS O
including VBG O
proactively RB O
notifying VBG O
affected JJ O
accounts NNS O
, , O
revoking VBG O
affected VBN O
tokens NNS O
and CC O
deploying VBG O
SafetyNet JJ O
improvements NNS O
to TO O
protect VB O
users NNS O
from IN O
these DT O
apps NNS O
in IN O
the DT O
future NN O
. . O

Who WP O
is VBZ O
affected VBN O
? . O

Gooligan NNP B-Malware
potentially RB O
affects VBZ O
devices NNS O
on IN O
Android NNP B-System
4 CD I-System
( ( I-System
Jelly NNP I-System
Bean NNP I-System
, , I-System
KitKat NNP I-System
) ) I-System
and CC I-System
5 CD I-System
( ( I-System
Lollipop NNP I-System
) ) I-System
, , O
which WDT O
is VBZ O
over IN O
74 CD O
% NN O
of IN O
in-market JJ O
devices NNS O
today NN O
. . O

About RB O
57 CD O
% NN O
of IN O
these DT O
devices NNS O
are VBP O
located VBN O
in IN O
Asia NNP O
and CC O
about RB O
9 CD O
% NN O
are VBP O
in IN O
Europe NNP O
. . O

In IN O
our PRP$ O
research NN O
we PRP O
identified VBD O
tens NNS O
of IN O
fake NN O
applications NNS O
that WDT O
were VBD O
infected VBN O
with IN O
this DT O
malware NN O
. . O

If IN O
you PRP O
’ VBP O
ve RB O
downloaded JJ O
one CD O
of IN O
the DT O
apps NN O
listed VBN O
in IN O
Appendix NNP O
A NNP O
, , O
below IN O
, , O
you PRP O
might MD O
be VB O
infected VBN O
. . O

You PRP O
may MD O
review VB O
your PRP$ O
application NN O
list NN O
in IN O
“ JJ O
Settings NNP O
- : O
> NN O
Apps NNP O
” NNP O
, , O
if IN O
you PRP O
find VBP O
one CD O
of IN O
this DT O
applications NNS O
, , O
please VB O
consider VB O
downloading VBG O
an DT O
antivirus JJ O
product NN O
such JJ O
as IN O
Check NNP B-Organization
Point NNP I-Organization
ZoneAlarm NNP B-System
to TO O
check VB O
if IN O
you PRP O
are VBP O
indeed RB O
infected VBN O
. . O

We PRP O
have VBP O
noticed VBN O
that IN O
hundreds NNS O
of IN O
the DT O
email NN O
addresses NNS O
are VBP O
associated VBN O
with IN O
enterprise NN O
accounts NNS O
worldwide VBP O
. . O

How WRB O
do VB O
you PRP O
know VB O
if IN O
your PRP$ O
Google NNP B-Organization
account NN O
is VBZ O
breached VBN O
? . O

You PRP O
can MD O
check VB O
if IN O
your PRP$ O
account NN O
is VBZ O
compromised VBN O
by IN O
accessing VBG O
the DT O
following JJ O
web NN O
site NN O
that IN O
we PRP O
created VBD O
: : O
https NN B-Indicator
: : I-Indicator
//gooligan.checkpoint.com/ NN I-Indicator
. . O

If IN O
your PRP$ O
account NN O
has VBZ O
been VBN O
breached VBN O
, , O
the DT O
following JJ O
steps NNS O
are VBP O
required VBN O
: : O
A DT O
clean JJ O
installation NN O
of IN O
an DT O
operating NN O
system NN O
on IN O
your PRP$ O
mobile JJ O
device NN O
is VBZ O
required VBN O
( ( O
a DT O
process NN O
called VBN O
“ CD O
flashing VBG O
” NN O
) ) O
. . O

As IN O
this DT O
is VBZ O
a DT O
complex JJ O
process NN O
, , O
we PRP O
recommend VBP O
powering VBG O
off RP O
your PRP$ O
device NN O
and CC O
approaching VBG O
a DT O
certified JJ O
technician NN O
, , O
or CC O
your PRP$ O
mobile JJ O
service NN O
provider NN O
, , O
to TO O
request VB O
that IN O
your PRP$ O
device NN O
be VB O
“ VBN O
re-flashed. JJ O
” JJ O
Change NNP O
your PRP$ O
Google NNP B-Organization
account NN O
passwords NNS O
immediately RB O
after IN O
this DT O
process NN O
. . O

How WRB O
do VB O
Android NNP O
devices NNS O
become VBP O
infected VBN O
? . O

We PRP O
found VBD O
traces NNS O
of IN O
the DT O
Gooligan NNP B-Malware
malware NN O
code NN O
in IN O
dozens NNS O
of IN O
legitimate-looking JJ O
apps NN O
on IN O
third-party JJ O
Android NNP B-System
app NN O
stores NNS O
. . O

These DT O
stores NNS O
are VBP O
an DT O
attractive JJ O
alternative NN O
to TO O
Google NNP B-System
Play NNP I-System
because IN O
many JJ O
of IN O
their PRP$ O
apps NNS O
are VBP O
free JJ O
, , O
or CC O
offer VBP O
free JJ O
versions NNS O
of IN O
paid VBN O
apps NN O
. . O

However RB O
, , O
the DT O
security NN O
of IN O
these DT O
stores NNS O
and CC O
the DT O
apps NN O
they PRP O
sell VBP O
aren JJ O
’ NNP O
t NN O
always RB O
verified VBN O
. . O

Gooligan-infected JJ B-Malware
apps NN O
can MD O
also RB O
be VB O
installed VBN O
using VBG O
phishing VBG O
scams NNS O
where WRB O
attackers NNS O
broadcast VBP O
links NNS O
to TO O
infected VB O
apps NN O
to TO O
unsuspecting VBG O
users NNS O
via IN O
SMS NNP O
or CC O
other JJ O
messaging NN O
services NNS O
. . O

How WRB O
did VBD O
Gooligan NNP B-Malware
emerge VB O
? . O

Our PRP$ O
researchers NNS O
first RB O
encountered VBD O
Gooligan NNP B-Malware
’ NNP O
s NN O
code NN O
in IN O
the DT O
malicious JJ O
SnapPea NNP B-Malware
app NN O
last JJ O
year NN O
. . O

At IN O
the DT O
time NN O
this DT O
malware NN O
was VBD O
reported VBN O
by IN O
several JJ O
security NN O
vendors NNS O
, , O
and CC O
attributed VBD O
to TO O
different JJ O
malware JJ O
families NNS O
like IN O
Ghostpush NNP B-Malware
, , O
MonkeyTest NNP B-Malware
, , O
and CC O
Xinyinhe NNP B-Malware
. . O

By IN O
late JJ O
2015 CD O
, , O
the DT O
malware NN O
’ NNP O
s NN O
creators NNS O
had VBD O
gone VBN O
mostly RB O
silent JJ O
until IN O
the DT O
summer NN O
of IN O
2016 CD O
when WRB O
the DT O
malware NN O
reappeared VBN O
with IN O
a DT O
more RBR O
complex JJ O
architecture NN O
that WDT O
injects VBZ O
malicious JJ O
code NN O
into IN O
Android NNP B-System
system NN O
processes VBZ O
. . O

The DT O
change NN O
in IN O
the DT O
way NN O
the DT O
malware NN O
works VBZ O
today NN O
may MD O
be VB O
to TO O
help VB O
finance VB O
the DT O
campaign NN O
through IN O
fraudulent JJ O
ad NN O
activity NN O
. . O

The DT O
malware NN O
simulates VBZ O
clicks NNS O
on IN O
app JJ O
advertisements NNS O
provided VBN O
by IN O
legitimate JJ O
ad NN O
networks NNS O
and CC O
forces VBZ O
the DT O
app NN O
to TO O
install VB O
on IN O
a DT O
device NN O
. . O

An DT O
attacker NN O
is VBZ O
paid VBN O
by IN O
the DT O
network NN O
when WRB O
one NN O
of IN O
these DT O
apps NN O
is VBZ O
installed VBN O
successfully RB O
. . O

Logs NNS O
collected VBN O
by IN O
Check NNP B-Organization
Point NNP I-Organization
researchers NNS O
show VBP O
that IN O
every DT O
day NN O
Gooligan NNP B-Malware
installs VBZ O
at IN O
least JJS O
30,000 CD O
apps NNS O
fraudulently RB O
on IN O
breached JJ O
devices NNS O
or CC O
over IN O
2 CD O
million CD O
apps NN O
since IN O
the DT O
campaign NN O
began VBD O
. . O

How WRB O
does VBZ O
Gooligan NNP B-Malware
work VB O
? . O

The DT O
infection NN O
begins VBZ O
when WRB O
a DT O
user NN O
downloads NN O
and CC O
installs VBZ O
a DT O
Gooligan-infected JJ B-Malware
app NN O
on IN O
a DT O
vulnerable JJ O
Android NNP O
device NN O
. . O

Our PRP$ O
research NN O
team NN O
has VBZ O
found VBN O
infected VBN O
apps NNS O
on IN O
third-party JJ O
app NN O
stores NNS O
, , O
but CC O
they PRP O
could MD O
also RB O
be VB O
downloaded VBN O
by IN O
Android NNP B-System
users NNS O
directly RB O
by IN O
tapping VBG O
malicious JJ O
links NNS O
in IN O
phishing VBG O
attack NN O
messages NNS O
. . O

After IN O
an DT O
infected JJ O
app NN O
is VBZ O
installed VBN O
, , O
it PRP O
sends VBZ O
data NNS O
about IN O
the DT O
device NN O
to TO O
the DT O
campaign NN O
’ NNP O
s NN O
Command NNP O
and CC O
Control NNP O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server NN O
. . O

Gooligan NNP B-Malware
then RB O
downloads VBZ O
a DT O
rootkit NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
that WDT O
takes VBZ O
advantage NN O
of IN O
multiple JJ O
Android NNP B-System
4 CD I-System
and CC I-System
5 CD I-System
exploits NNS O
including VBG O
the DT O
well-known JJ O
VROOT NNP B-Vulnerability
( ( O
CVE-2013-6282 NNP B-Vulnerability
) ) O
and CC O
Towelroot NNP B-Vulnerability
( ( O
CVE-2014-3153 NNP B-Vulnerability
) ) O
. . O

These DT O
exploits NNS O
still RB O
plague VBP O
many JJ O
devices NNS O
today NN O
because IN O
security NN O
patches NNS O
that WDT O
fix VBP O
them PRP O
may MD O
not RB O
be VB O
available JJ O
for IN O
some DT O
versions NNS O
of IN O
Android NNP B-System
, , O
or CC O
the DT O
patches NNS O
were VBD O
never RB O
installed VBN O
by IN O
the DT O
user NN O
. . O

If IN O
rooting NN O
is VBZ O
successful JJ O
, , O
the DT O
attacker NN O
has VBZ O
full JJ O
control NN O
of IN O
the DT O
device NN O
and CC O
can MD O
execute VB O
privileged JJ O
commands NNS O
remotely RB O
. . O

After IN O
achieving VBG O
root JJ O
access NN O
, , O
Gooligan NNP B-Malware
downloads VBZ O
a DT O
new JJ O
, , O
malicious JJ O
module NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
and CC O
installs VBZ O
it PRP O
on IN O
the DT O
infected JJ O
device NN O
. . O

This DT O
module NN O
injects VBZ O
code NN O
into IN O
running VBG O
Google NNP B-System
Play NNP I-System
or CC O
GMS NNP B-System
( ( I-System
Google NNP I-System
Mobile NNP I-System
Services NNPS I-System
) ) I-System
to TO O
mimic VB O
user JJ O
behavior NN O
so RB O
Gooligan NNP B-Malware
can MD O
avoid VB O
detection NN O
, , O
a DT O
technique NN O
first RB O
seen VBN O
with IN O
the DT O
mobile JJ O
malware NN O
HummingBad NNP B-Malware
. . O

The DT O
module NN O
allows VBZ O
Gooligan NNP B-Malware
to TO O
: : O
Steal VB O
a DT O
user NN O
’ NN O
s NN O
Google NNP B-Organization
email NN O
account NN O
and CC O
authentication NN O
token VBN O
information NN O
Install NNP O
apps NN O
from IN O
Google NNP B-System
Play NNP I-System
and CC O
rate NN O
them PRP O
to TO O
raise VB O
their PRP$ O
reputation NN O
Install NNP O
adware NN O
to TO O
generate VB O
revenue NN O
Ad NNP O
servers NNS O
, , O
which WDT O
don VBP O
’ JJ O
t NN O
know VBP O
whether IN O
an DT O
app NN O
using VBG O
its PRP$ O
service NN O
is VBZ O
malicious JJ O
or CC O
not RB O
, , O
send VB O
Gooligan NNP B-Malware
the DT O
names NNS O
of IN O
the DT O
apps NN O
to TO O
download VB O
from IN O
Google NNP B-System
Play NNP I-System
. . O

After IN O
an DT O
app NN O
is VBZ O
installed VBN O
, , O
the DT O
ad NN O
service NN O
pays VBZ O
the DT O
attacker NN O
. . O

Then RB O
the DT O
malware NN O
leaves VBZ O
a DT O
positive JJ O
review NN O
and CC O
a DT O
high JJ O
rating NN O
on IN O
Google NNP B-System
Play NNP I-System
using VBG O
content NN O
it PRP O
receives VBZ O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

Our PRP$ O
research NN O
team NN O
was VBD O
able JJ O
to TO O
identify VB O
several JJ O
instances NNS O
of IN O
this DT O
activity NN O
by IN O
cross-referencing VBG O
data NNS O
from IN O
breached VBN O
devices NNS O
with IN O
Google NNP B-System
Play NNP I-System
app RB O
reviews VBZ O
. . O

This DT O
is VBZ O
another DT O
reminder NN O
of IN O
why WRB O
users NNS O
shouldn VBP O
’ JJ O
t NN O
rely RB O
on IN O
ratings NNS O
alone RB O
to TO O
decide VB O
whether IN O
to TO O
trust VB O
an DT O
app NN O
. . O

Similar JJ O
to TO O
HummingBad NNP B-Malware
, , O
the DT O
malware NN O
also RB O
fakes VBZ O
device JJ O
identification NN O
information NN O
, , O
such JJ O
as IN O
IMEI NNP O
and CC O
IMSI NNP O
, , O
to TO O
download VB O
an DT O
app JJ O
twice NN O
while IN O
seeming VBG O
like IN O
the DT O
installation NN O
is VBZ O
happening VBG O
on IN O
a DT O
different JJ O
device NN O
, , O
thereby RB O
doubling VBG O
the DT O
potential JJ O
revenue NN O
. . O

What WP O
are VBP O
Google NNP B-Organization
authorization NN O
tokens NNS O
? . O

A DT O
Google NNP B-Organization
authorization NN O
token NN O
is VBZ O
a DT O
way NN O
to TO O
access NN O
the DT O
Google NNP B-Organization
account NN O
and CC O
the DT O
related JJ O
services NNS O
of IN O
a DT O
user NN O
. . O

It PRP O
is VBZ O
issued VBN O
by IN O
Google NNP B-Organization
once RB O
a DT O
user NN O
successfully RB O
logged VBD O
into IN O
this DT O
account NN O
. . O

When WRB O
an DT O
authorization NN O
token NN O
is VBZ O
stolen VBN O
by IN O
a DT O
hacker NN O
, , O
they PRP O
can MD O
use VB O
this DT O
token NN O
to TO O
access NN O
all PDT O
the DT O
Google NNP B-Organization
services NNS O
related VBN O
to TO O
the DT O
user NN O
, , O
including VBG O
Google NNP B-System
Play NNP I-System
, , O
Gmail NNP B-System
, , O
Google NNP B-System
Docs NNP I-System
, , O
Google NNP B-System
Drive NNP I-System
, , O
and CC O
Google NNP B-System
Photos NNP I-System
. . O

While IN O
Google NNP B-Organization
implemented VBD O
multiple JJ O
mechanisms NNS O
, , O
like IN O
two-factor-authentication NN O
, , O
to TO O
prevent VB O
hackers NNS O
from IN O
compromising VBG O
Google NNP B-Organization
accounts NNS O
, , O
a DT O
stolen VBN O
authorization NN O
token NN O
bypasses VBZ O
this DT O
mechanism NN O
and CC O
allows VBZ O
hackers NNS O
the DT O
desired JJ O
access NN O
as IN O
the DT O
user NN O
is VBZ O
perceived VBN O
as IN O
already RB O
logged VBN O
in IN O
. . O

Conclusion NNP O
Gooligan NNP B-Malware
has VBZ O
breached VBN O
over IN O
a DT O
million CD O
Google NNP B-Organization
accounts NNS O
. . O

We PRP O
believe VBP O
that IN O
it PRP O
is VBZ O
the DT O
largest JJS O
Google NNP B-Malware
account NN O
breach NN O
to TO O
date NN O
, , O
and CC O
we PRP O
are VBP O
working VBG O
with IN O
Google NNP B-Organization
to TO O
continue VB O
the DT O
investigation NN O
. . O

We PRP O
encourage VBP O
Android JJ B-System
users NNS O
to TO O
validate VB O
whether IN O
their PRP$ O
accounts NNS O
have VBP O
been VBN O
breached VBN O
. . O

Hacking VBG B-Organization
Team NNP I-Organization
Spying VBG O
Tool NNP O
Listens NNP O
to TO O
Calls NNP O
By IN O
: : O
Trend NNP B-Organization
Micro NNP I-Organization
July NNP O
21 CD O
, , O
2015 CD O
Following VBG O
news NN O
that IN O
iOS JJ B-System
devices NNS O
are VBP O
at IN O
risk NN O
of IN O
spyware NN O
related VBN O
to TO O
the DT O
Hacking NNP B-Organization
Team NNP I-Organization
, , O
the DT O
saga NN O
continues VBZ O
into IN O
the DT O
Android NNP B-System
sphere NN O
. . O

We PRP O
found VBD O
that IN O
among IN O
the DT O
leaked JJ O
files NNS O
is VBZ O
the DT O
code NN O
for IN O
Hacking NNP O
Team NNP O
’ NNP O
s VBD O
open-source JJ O
malware NN O
suite JJ O
RCSAndroid NNP B-Malware
( ( O
Remote NNP B-Malware
Control NNP I-Malware
System NNP I-Malware
Android NNP I-Malware
) ) O
, , O
which WDT O
was VBD O
sold VBN O
by IN O
the DT O
company NN O
as IN O
a DT O
tool NN O
for IN O
monitoring VBG O
targets NNS O
. . O

( ( O
Researchers NNS O
have VBP O
been VBN O
aware JJ O
of IN O
this DT O
suite NN O
as RB O
early RB O
as IN O
2014 CD O
. . O

) ) O
The DT O
RCSAndroid NNP B-Malware
code NN O
can MD O
be VB O
considered VBN O
one CD O
of IN O
the DT O
most RBS O
professionally RB O
developed JJ O
and CC O
sophisticated JJ O
Android NNP B-System
malware NN O
ever RB O
exposed VBN O
. . O

The DT O
leak NN O
of IN O
its PRP$ O
code NN O
provides VBZ O
cybercriminals NNS O
with IN O
a DT O
new JJ O
weaponized VBN O
resource NN O
for IN O
enhancing VBG O
their PRP$ O
surveillance NN O
operations NNS O
. . O

Based VBN O
on IN O
the DT O
leaked JJ O
code NN O
, , O
the DT O
RCSAndroid NNP B-Malware
app NN O
can MD O
do VB O
the DT O
following VBG O
intrusive JJ O
routines NNS O
to TO O
spy VB O
on IN O
targets NNS O
: : O
Capture NNP O
screenshots VBZ O
using VBG O
the DT O
“ JJ O
screencap NN O
” NNP O
command NN O
and CC O
framebuffer NN O
direct JJ O
reading NN O
Monitor NNP O
clipboard NN O
content NN O
Collect NNP O
passwords NNS O
for IN O
Wi-Fi NNP O
networks NNS O
and CC O
online JJ O
acco NN O
; : O
.unts NNS O
, , O
including VBG O
Skype NNP B-System
, , O
Facebook NNP B-System
, , O
Twitter NNP B-System
, , O
Google NNP B-System
, , O
WhatsApp NNP B-System
, , O
Mail NNP B-System
, , O
and CC O
LinkedIn NNP B-System
Record NNP O
using VBG O
the DT O
microphone NN O
Collect NNP O
SMS NNP O
, , O
MMS NNP O
, , O
and CC O
Gmail NNP B-System
messages NNS O
Record NNP O
location NN O
Gather NNP O
device NN O
information NN O
Capture NNP O
photos NN O
using VBG O
the DT O
front NN O
and CC O
back RB O
cameras NNS O
Collect NNP O
contacts NNS O
and CC O
decode NN O

messages NNS O
from IN O
IM NNP O
accounts NNS O
, , O
including VBG O
Facebook NNP B-System
Messenger NNP I-System
, , O
WhatsApp NNP B-System
, , O
Skype NNP B-System
, , O
Viber NNP B-System
, , O
Line NNP B-System
, , O
WeChat NNP B-System
, , O
Hangouts NNP B-System
, , O
Telegram NNP B-System
, , O
and CC O
BlackBerry NNP B-System
Messenger NNP I-System
. . O

Capture NN O
real-time JJ O
voice NN O
calls NNS O
in IN O
any DT O
network NN O
or CC O
app NN O
by IN O
hooking VBG O
into IN O
the DT O
“ NNP O
mediaserver NN O
” NNP O
system NN O
service NN O
RCSAndroid NNP B-Malware
in IN O
the DT O
Wild NNP O
Our PRP$ O
analysis NN O
reveals VBZ O
that IN O
this DT O
RCSAndroid NNP B-Malware
( ( O
AndroidOS_RCSAgent.HRX NNP B-Indicator
) ) O
has VBZ O
been VBN O
in IN O
the DT O
wild NN O
since IN O
2012 CD O
. . O

Traces NNS O
of IN O
its PRP$ O
previous JJ O
uses NNS O
in IN O
the DT O
wild NN O
were VBD O
found VBN O
inside IN O
the DT O
configuration NN O
file NN O
: : O
It PRP O
was VBD O
configured VBN O
to TO O
use VB O
a DT O
Command-and-control NNP O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server NN O
in IN O
the DT O
United NNP O
States NNPS O
; : O
however RB O
, , O
the DT O
server NN O
was VBD O
bought VBN O
from IN O
a DT O
host NN O
service NN O
provider NN O
and CC O
is VBZ O
now RB O
unavailable JJ O
. . O

It PRP O
was VBD O
configured VBN O
to TO O
activate VB O
via IN O
SMS NNP O
sent VBD O
from IN O
a DT O
Czech NNP O
Republic NNP O
number NN O
. . O

Attackers NNS O
can MD O
send VB O
SMS NNP O
with IN O
certain JJ O
messages NNS O
to TO O
activate VB O
the DT O
agent NN O
and CC O
trigger NN O
corresponding VBG O
action NN O
. . O

This DT O
can MD O
also RB O
define VB O
what WP O
kind NN O
of IN O
evidences NNS O
to TO O
collect VB O
. . O

Based VBN O
on IN O
emails NNS O
leaked VBN O
in IN O
the DT O
dump NN O
, , O
a DT O
number NN O
of IN O
Czech JJ O
firms NNS O
appear VBP O
to TO O
be VB O
in IN O
business NN O
with IN O
the DT O
Hacking NNP O
team NN O
, , O
including VBG O
a DT O
major JJ O
IT NNP O
partner NN O
in IN O
the DT O
Olympic NNP O
Games NNPS O
. . O

Dropping VBG O
Cluster NNP O
Bombs NNP O
RCSAndroid NNP B-Malware
is VBZ O
a DT O
threat NN O
that WDT O
works VBZ O
like IN O
a DT O
cluster NN O
bomb NN O
in IN O
that DT O
it PRP O
deploys VBZ O
multiple JJ O
dangerous JJ O
exploits NNS O
and CC O
uses VBZ O
various JJ O
techniques NNS O
to TO O
easily RB O
infect VB O
Android NNP B-System
devices NNS O
. . O

While IN O
analyzing VBG O
the DT O
code NN O
, , O
we PRP O
found VBD O
that IN O
the DT O
whole JJ O
system NN O
consists VBZ O
of IN O
four CD O
critical JJ O
components NNS O
, , O
as IN O
follows VBZ O
: : O
penetration NN O
solutions NNS O
, , O
ways NNS O
to TO O
get VB O
inside IN O
the DT O
device NN O
, , O
either CC O
via IN O
SMS/email NNP O
or CC O
a DT O
legitimate JJ O
app NN O
low-level JJ O
native JJ O
code NN O
, , O
advanced VBD O
exploits NNS O
and CC O
spy NN O
tools NNS O
beyond IN O
Android NNP B-System
’ NNP O
s JJ O
security NN O
framework NN O
high-level NN O
Java NNP O
agent NN O
– VBD O
the DT O
app NN O
’ NNP O
s VBZ O
malicious JJ O
APK NNP O
command-and-control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
servers NNS O
, , O
used VBD O
to TO O
remotely RB O
send/receive JJ O
malicious JJ O
commands NNS O
Attackers NNS O
use VBP O
two CD O
methods NNS O
to TO O
get VB O
targets NNS O
to TO O
download VB O
RCSAndroid NNP B-Malware
. . O

The DT O
first JJ O
method NN O
is VBZ O
to TO O
send VB O
a DT O
specially RB O
crafted VBN O
URL NNP O
to TO O
the DT O
target NN O
via IN O
SMS NNP O
or CC O
email NN O
. . O

The DT O
URL NNP O
will MD O
trigger VB O
exploits NNS O
for IN O
arbitrary JJ B-Vulnerability
memory NN I-Vulnerability
read NN I-Vulnerability
( ( I-Vulnerability
CVE-2012-2825 NNP I-Vulnerability
) ) I-Vulnerability
and CC O
heap JJ B-Vulnerability
buffer NN I-Vulnerability
overflow IN I-Vulnerability
( ( I-Vulnerability
CVE-2012-2871 NNP I-Vulnerability
) ) I-Vulnerability
vulnerabilities NNS O
in IN O
the DT O
default NN O
browsers NNS O
of IN O
Android NNP B-System
versions NNS I-System
4.0 CD I-System
Ice NNP I-System
Cream NNP I-System
Sandwich NNP I-System
to TO O
4.3 CD B-System
Jelly NNP I-System
Bean NNP I-System
, , O
allowing VBG O
another DT O
local JJ O
privilege NN O
escalation NN O
exploit NN O
to TO O
execute VB O
. . O

When WRB O
root NN O
privilege NN O
is VBZ O
gained VBN O
, , O
a DT O
shell NN O
backdoor NN O
and CC O
malicious JJ O
RCSAndroid NNP B-Malware
agent NN O
APK NNP O
file NN O
will MD O
be VB O
installed VBN O
The DT O
second JJ O
method NN O
is VBZ O
to TO O
use VB O
a DT O
stealthy JJ O
backdoor NN O
app NNS O
such JJ O
as IN O
ANDROIDOS_HTBENEWS.A NNP B-Malware
, , O
which WDT O
was VBD O
designed VBN O
to TO O
bypass VB O
Google NNP B-System
Play NNP I-System
. . O

The DT O
role NN O
of IN O
ANDROIDOS_HTBENEWS.A NNP B-Malware
and CC O
the DT O
malicious JJ O
APK NNP O
mentioned VBD O
in IN O
the DT O
first JJ O
method NN O
is VBZ O
to TO O
exploit VB O
a DT O
local JJ B-Vulnerability
privilege NN I-Vulnerability
escalation NN I-Vulnerability
vulnerability NN I-Vulnerability
in IN O
Android NNP O
devices NNS O
. . O

Hacking VBG O
Team NN O
has VBZ O
been VBN O
known VBN O
to TO O
use VB O
both DT O
CVE-2014-3153 NNP B-Vulnerability
and CC O
CVE-2013-6282 NNP B-Vulnerability
in IN O
their PRP$ O
attacks NNS O
. . O

The DT O
said VBD O
exploits NNS O
will MD O
root VB O
the DT O
device NN O
and CC O
install VB O
a DT O
shell NN O
backdoor NN O
. . O

The DT O
shell NN O
backdoor NN O
then RB O
installs VBZ O
the DT O
RCSAndroid NNP B-Malware
agent NN O
. . O

This DT O
agent NN O
has VBZ O
two CD O
core NN O
modules NNS O
, , O
the DT O
Evidence NNP O
Collector NNP O
and CC O
the DT O
Event NNP O
Action NNP O
Trigger NNP O
. . O

The DT O
Evidence NNP O
Collector NNP O
module NN O
is VBZ O
responsible JJ O
for IN O
the DT O
spying NN O
routines NNS O
outlined VBN O
above IN O
. . O

One CD O
of IN O
its PRP$ O
most RBS O
notable JJ O
routines NNS O
is VBZ O
capturing VBG O
voice NN O
calls NNS O
in IN O
real JJ O
time NN O
by IN O
hooking VBG O
into IN O
the DT O
“ NNP O
mediaserver NN O
” NNP O
system NN O
service NN O
. . O

The DT O
basic JJ O
idea NN O
is VBZ O
to TO O
hook VB O
the DT O
voice NN O
call NN O
process NN O
in IN O
mediaserver NN O
. . O

Take VB O
voice NN O
call NN O
playback NN O
process NN O
for IN O
example NN O
. . O

The DT O
mediaserver NN O
will MD O
first VB O
builds VB O
a DT O
new JJ O
unique JJ O
track NN O
, , O
start NN O
to TO O
play VB O
the DT O
track NN O
, , O
loop JJ O
play VBP O
all DT O
audio JJ O
buffer NN O
, , O
then RB O
finally RB O
stop VB O
the DT O
playback NN O
. . O

The DT O
raw JJ O
wave NN O
audio NN O
buffer NN O
frame NN O
can MD O
be VB O
dumped VBN O
in IN O
the DT O
getNextBuffer NN O
( ( O
) ) O
function NN O
. . O

With IN O
the DT O
help NN O
of IN O
the DT O
open-source JJ O
Android NNP B-System
Dynamic NNP O
Binary NNP O
Instrumentation NNP O
Toolkit NNP O
and CC O
root NN O
privilege NN O
, , O
it PRP O
is VBZ O
possible JJ O
to TO O
intercept VB O
any DT O
function NN O
execution NN O
. . O

The DT O
Event NNP O
Action NNP O
Trigger NNP O
module NN O
triggers NNS O
malicious JJ O
actions NNS O
based VBN O
on IN O
certain JJ O
events NNS O
. . O

These DT O
events NNS O
can MD O
be VB O
based VBN O
on IN O
time NN O
, , O
charging VBG O
or CC O
battery NN O
status NN O
, , O
location NN O
, , O
connectivity NN O
, , O
running VBG O
apps NN O
, , O
focused VBD O
app NN O
, , O
SIM NNP O
card NN O
status NN O
, , O
SMS NNP O
received VBD O
with IN O
keywords NNS O
, , O
and CC O
screen JJ O
turning VBG O
on IN O
. . O

According VBG O
to TO O
the DT O
configuration NN O
pattern NN O
, , O
these DT O
actions NNS O
are VBP O
registered VBN O
to TO O
certain JJ O
events NNS O
: : O
Sync NNP O
configuration NN O
data NNS O
, , O
upgrade JJ O
modules NNS O
, , O
and CC O
download VB O
new JJ O
payload NN O
( ( O
This DT O
uses VBZ O
transport NN O
protocol NN O
ZProtocol NNP O
encrypted VBN O
by IN O
AES/CBC/PKCS5Padding VBG O
algorithm NN O
to TO O
communicate VB O
with IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

) ) O
Upload NN O
and CC O
purge NN O
collected VBD O
evidence NN O
Destroy NNP O
device NN O
by IN O
resetting VBG O
locking VBG O
password NN O
Execute NNP O
shell NN O
commands NNS O
Send VBP O
SMS NNP O
with IN O
defined JJ O
content NN O
or CC O
location NN O
Disable JJ O
network NN O
Disable NNP O
root NN O
Uninstall NNP O
bot NN O
To TO O
avoid VB O
detection NN O
and CC O
removal NN O
of IN O
the DT O
agent NN O
app NN O
in IN O
the DT O
device NN O
memory NN O
, , O
the DT O
RCSAndroid NNP B-Malware
suite NN O
also RB O
detects VBZ O
emulators NNS O
or CC O
sandboxes NNS O
, , O
obfuscates VBZ O
code NN O
using VBG O
DexGuard NNP B-System
, , O
uses VBZ O
ELF NNP O
string VBG O
obfuscator NN O
, , O
and CC O
adjusts VBZ O
the DT O
OOM NNP O
( ( O
out-of-memory JJ O
) ) O
value NN O
. . O

Interestingly RB O
, , O
one CD O
unused JJ O
feature NN O
of IN O
the DT O
app NN O
is VBZ O
its PRP$ O
ability NN O
to TO O
manipulate VB O
data NNS O
in IN O
the DT O
Android NNP B-System
package NN O
manager NN O
to TO O
add VB O
and CC O
remove VB O
permissions NNS O
and CC O
components NNS O
as RB O
well RB O
as IN O
hide VB O
the DT O
app JJ O
icon NN O
. . O

Recommendations NNS O
Popular NNP O
mobile NN O
platforms NNS O
like IN O
Android NNP B-System
are VBP O
common JJ O
targets NNS O
for IN O
organized VBN O
or CC O
commercialized VBN O
monitoring NN O
operations NNS O
. . O

Attackers NNS O
know VBP O
that IN O
rooting VBG O
devices NNS O
via IN O
malware NN O
exploits NNS O
is VBZ O
an DT O
effective JJ O
means NNS O
to TO O
control VB O
devices NNS O
and CC O
gather JJR O
information NN O
from IN O
them PRP O
. . O

In IN O
a DT O
root NN O
broken JJ O
device NN O
, , O
security NN O
is VBZ O
a DT O
fairy JJ O
tale NN O
. . O

Take NNP O
note NN O
of IN O
the DT O
following JJ O
best NN O
practices NNS O
to TO O
prevent VB O
this DT O
threat NN O
from IN O
getting VBG O
in IN O
your PRP$ O
device NN O
: : O
Disable JJ O
app JJ O
installations NNS O
from IN O
unknown JJ O
, , O
third-party JJ O
sources NNS O
. . O

Constantly RB O
update VB O
your PRP$ O
Android NNP B-System
devices NNS O
to TO O
the DT O
latest JJS O
version NN O
to TO O
help VB O
prevent VB O
exploits NNS O
, , O
especially RB O
in IN O
the DT O
case NN O
of IN O
RCSAndroid NNP B-Malware
which WDT O
can MD O
affect VB O
only RB O
up RB O
to TO O
version NN O
4.4.4 CD B-System
KitKat NNP I-System
. . O

Note NN O
, , O
however RB O
, , O
that IN O
based VBN O
on IN O
the DT O
leak JJ O
mail NN O
from IN O
a DT O
customer NN O
inquiry NN O
, , O
Hacking NNP B-Organization
Team NNP I-Organization
was VBD O
in IN O
the DT O
process NN O
of IN O
developing VBG O
exploits NNS O
for IN O
Android NNP B-System
5.0 CD I-System
Lollipop NNP I-System
. . O

Install VB O
a DT O
mobile JJ O
security NN O
solution NN O
to TO O
secure VB O
your PRP$ O
device NN O
from IN O
threats NNS O
. . O

The DT O
leaked JJ O
RCSAndroid NNP B-Malware
code NN I-Malware
is VBZ O
a DT O
commercial JJ O
weapon NN O
now RB O
in IN O
the DT O
wild NN O
. . O

Mobile JJ O
users NNS O
are VBP O
called VBN O
on IN O
to TO O
be VB O
on IN O
top NN O
of IN O
this DT O
news NN O
and CC O
be VB O
on IN O
guard NN O
for IN O
signs NNS O
of IN O
monitoring NN O
. . O

Some DT O
indicators NNS O
may MD O
come VB O
in IN O
the DT O
form NN O
of IN O
peculiar JJ O
behavior NN O
such JJ O
as IN O
unexpected JJ O
rebooting NN O
, , O
finding VBG O
unfamiliar JJ O
apps NN O
installed VBN O
, , O
or CC O
instant JJ O
messaging NN O
apps NN O
suddenly RB O
freezing VBG O
. . O

Should MD O
a DT O
device NN O
become NN O
infected JJ O
, , O
this DT O
backdoor NN O
can MD O
not RB O
be VB O
removed VBN O
without IN O
root NN O
privilege NN O
. . O

Users NNS O
may MD O
be VB O
required VBN O
the DT O
help NN O
of IN O
their PRP$ O
device NN O
manufacturer NN O
to TO O
get VB O
support NN O
for IN O
firmware NN O
flashing NN O
. . O

Trend NNP B-Organization
Micro NNP I-Organization
offers VBZ O
security NN O
for IN O
Android NNP B-System
mobile JJ O
devices NNS O
through IN O
Mobile NNP B-System
Security NNP I-System
for IN I-System
Android™ NNP I-System
to TO O
protect VB O
against IN O
these DT O
types NNS O
of IN O
attacks NNS O
. . O

Find VB O
out RP O
more RBR O
about IN O
the DT O
7 CD O
Android NNP B-System
Security NNP O
Hacks NNP O
You PRP O
Need VBP O
to TO O
Do VB O
Right RB O
Now RB O
to TO O
keep VB O
your PRP$ O
mobile JJ O
data NNS O
safe NNS O
. . O

Update NNP O
as IN O
of IN O
July NNP O
23 CD O
, , O
2015 CD O
1:00 CD O
AM NNP O
PDT NNP O
( ( O
UTC-7 NNP O
) ) O
We PRP O
have VBP O
added VBN O
a DT O
link NN O
to TO O
a DT O
previous JJ O
report NN O
discussing VBG O
this DT O
threat NN O
. . O

Timeline NN O
of IN O
posts NNS O
related VBN O
to TO O
the DT O
Hacking NNP O
Team NNP O
DATE NNP O
UPDATE NNP O
July NNP O
5 CD O
The DT O
Italian JJ O
company NN O
Hacking NNP B-Organization
Team NNP I-Organization
was VBD O
hacked VBN O
, , O
with IN O
more JJR O
than IN O
400GB CD O
of IN O
confidential JJ O
company NN O
data NNS O
made VBD O
available JJ O
to TO O
the DT O
public NN O
. . O

July NNP O
7 CD O
Three NNP O
exploits NNS O
– VBP O
two CD O
for IN O
Flash NNP B-System
Player NNP I-System
and CC O
one CD O
for IN O
the DT O
Windows NNP B-System
kernel—were NNP O
initially RB O
found VBD O
in IN O
the DT O
information NN O
dump NN O
. . O

One CD O
of IN O
these DT O
[ JJ O
CVE-2015-5119 NNP B-Vulnerability
] NNP O
was VBD O
a DT O
Flash NNP O
zero-day NN O
. . O

The DT O
Windows NNP B-Vulnerability
kernel NN I-Vulnerability
vulnerability NN I-Vulnerability
( ( O
CVE-2015-2387 NNP B-Vulnerability
) ) O
existed VBD O
in IN O
the DT O
open JJ O
type NN O
font NN O
manager NN O
module NN O
( ( O
ATMFD.dll NNP B-Indicator
) ) O
and CC O
can MD O
be VB O
exploited VBN O
to TO O
bypass VB O
the DT O
sandbox NN O
mitigation NN O
mechanism NN O
. . O

The DT O
Flash NNP B-System
zero-day NN O
exploit NN O
( ( O
CVE-2015-5119 NNP B-Vulnerability
) ) O
was VBD O
added VBN O
into IN O
the DT O
Angler NNP B-Malware
Exploit NNP I-Malware
Kit NNP I-Malware
and CC O
Nuclear NNP B-Malware
Exploit NNP I-Malware
Pack NNP I-Malware
. . O

It PRP O
was VBD O
also RB O
used VBN O
in IN O
limited JJ O
attacks NNS O
in IN O
Korea NNP O
and CC O
Japan NNP O
. . O

July NNP O
11 CD O
Two CD O
new JJ O
Flash NNP B-Vulnerability
zero-day NN I-Vulnerability
vulnerabilities NNS I-Vulnerability
, , O
CVE-2015-5122 NNP B-Vulnerability
and CC O
CVE-2015-5123 NNP B-Vulnerability
, , O
were VBD O
found VBN O
in IN O
the DT O
hacking NN O
team NN O
dump NN O
. . O

July NNP O
13 CD O
Further NNP O
analysis NN O
of IN O
the DT O
hacking NN O
team NN O
dump NN O
revealed VBD O
that IN O
the DT O
company NN O
used VBD O
UEFI NNP B-Malware
BIOS NNP I-Malware
rootkit NN I-Malware
to TO O
keep VB O
their PRP$ O
Remote NNP B-Malware
Control NNP I-Malware
System NNP I-Malware
( ( I-Malware
RCS NNP I-Malware
) ) I-Malware
agent NN O
installed VBN O
in IN O
their PRP$ O
targets NNS O
’ VBP O
systems NNS O
. . O

July NNP O
14 CD O
A NNP O
new JJ O
zero-day JJ B-Vulnerability
vulnerability NN I-Vulnerability
( ( O
CVE-2015-2425 NNP B-Vulnerability
) ) O
was VBD O
found VBN O
in IN O
Internet NNP B-System
Explorer NNP I-System
. . O

July NNP O
16 CD O
On IN O
the DT O
mobile JJ O
front NN O
, , O
a DT O
fake JJ O
news NN O
app NN O
designed VBN O
to TO O
bypass VB O
Google NNP B-System
Play NNP I-System
was VBD O
discovered VBN O
. . O

July NNP O
20 CD O
A NNP O
new JJ O
zero-day JJ B-Vulnerability
vulnerability NN I-Vulnerability
( ( O
CVE-2015-2426 NNP B-Vulnerability
) ) O
was VBD O
found VBN O
in IN O
Windows NNP B-System
, , O
which WDT O
Microsoft NNP B-Organization
fixed VBD O
in IN O
an DT O
out-of-band JJ O
patch NN O
. . O

July NNP O
21 CD O
Analysis NNP O
of IN O
the DT O
RCSAndroid NNP B-Malware
spying VBG O
tool NN O
revealed VBD O
that IN O
Hacking VBG O
Team NN O
can MD O
listen VB O
to TO O
calls NNS O
and CC O
roots NNS O
devices NNS O
to TO O
get VB O
in IN O
. . O

July NNP O
28 CD O
A NNP O
recent JJ O
campaign NN O
compromised VBD O
Taiwan NNP O
and CC O
Hong NNP O
Kong NNP O
sites VBZ O
to TO O
deliver VB O
Flash NNP B-System
exploits NNS O
related VBN O
to TO O
Hacking NNP B-Organization
Team NNP I-Organization
. . O

Android NNP B-System
users NNS O
warned VBD O
of IN O
malware JJ O
attack NN O
spreading VBG O
via IN O
SMS NNP O
FEB NNP O
16 CD O
, , O
2016 CD O
Security NNP O
researchers NNS O
are VBP O
warning VBG O
owners NNS O
of IN O
Android NNP B-System
smartphones NNS O
about IN O
a DT O
new JJ O
malware NN O
attack NN O
, , O
spreading VBG O
via IN O
SMS NNP O
text NN O
messages NNS O
. . O

As IN O
the DT O
team NN O
at IN O
Scandinavian JJ O
security NN O
group NN O
CSIS NNP B-Organization
describes VBZ O
, , O
malware NN O
known VBN O
as IN O
MazarBOT NNP B-Malware
is VBZ O
being VBG O
distributed VBN O
via IN O
SMS NNP O
in IN O
Denmark NNP O
and CC O
is VBZ O
likely JJ O
to TO O
also RB O
be VB O
encountered VBN O
in IN O
other JJ O
countries NNS O
. . O

Victims NNS O
’ VBP O
first JJ O
encounter NN O
with IN O
the DT O
malware NN O
reportedly RB O
comes VBZ O
via IN O
an DT O
unsolicited JJ O
text NN O
message NN O
that WDT O
their PRP$ O
Android NNP B-System
smartphone NN I-System
receives NNS O
. . O

The DT O
txt JJ O
message NN O
uses VBZ O
social JJ O
engineering NN O
to TO O
dupe VB O
unsuspecting JJ O
users NNS O
into IN O
clicking VBG O
on IN O
a DT O
link NN O
to TO O
a DT O
downloadable JJ O
Android NNP B-System
application NN O
. . O

CSIS NNP B-Organization
provided VBD O
a DT O
( ( O
sanitised VBN O
) ) O
version NN O
of IN O
a DT O
typical JJ O
message NN O
to TO O
warn VB O
users NNS O
what WP O
to TO O
look VB O
out RP O
for IN O
: : O
“ NN O
You PRP O
have VBP O
received VBN O
a DT O
multimedia JJ O
message NN O
from IN O
+ JJ O
[ JJ O
country NN O
code NN O
] NNP O
[ NNP O
sender NN O
number NN O
] NNP O
Follow NNP O
the DT O
link NN O
http NN B-Indicator
: : I-Indicator
//www.mmsforyou JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net/mms.apk NN I-Indicator
to TO O
view VB O
the DT O
message NN O
” NN O
Once IN O
the DT O
APK NNP O
package NN O
is VBZ O
downloaded VBN O
, , O
potential JJ O
victims NNS O
are VBP O
urged VBN O
to TO O
grant VB O
the DT O
malicious JJ O
app NN O
a DT O
wide JJ O
range NN O
of IN O
permissions NNS O
on IN O
their PRP$ O
Android JJ O
device NN O
: : O
App NNP O
permissions NNS O
SEND_SMS NNP O
RECEIVE_BOOT_COMPLETED NNP O
INTERNET NNP O
SYSTEM_ALERT_WINDOW NNP O
WRITE_SMS NNP O
ACCESS_NETWORK_STATE NNP O
WAKE_LOCK NNP O
GET_TASKS NNP O
CALL_PHONE NNP O
RECEIVE_SMS NNP O
READ_PHONE_STATE NNP O
READ_SMS NNP O
ERASE_PHONE NNP O
Once NNP O
installed VBD O
, , O
MazarBOT NNP B-Malware
downloads VBZ O
a DT O
copy NN O
of IN O

Tor NNP B-System
onto IN O
users NNS O
’ VBP O
Android NNP B-System
smartphones NNS O
and CC O
uses VBZ O
it PRP O
to TO O
connect VB O
anonymously RB O
to TO O
the DT O
net JJ O
before IN O
sending VBG O
a DT O
text JJ O
message NN O
containing VBG O
the DT O
victim NN O
’ NNP O
s NN O
location NN O
to TO O
an DT O
Iranian JJ O
mobile NN O
phone NN O
number NN O
. . O

With IN O
the DT O
malware NN O
now RB O
in IN O
place NN O
, , O
a DT O
number NN O
of IN O
actions NNS O
can MD O
be VB O
performed VBN O
, , O
including VBG O
allowing VBG O
attackers NNS O
to TO O
secretly RB O
monitor VB O
and CC O
control VB O
smartphones NNS O
via IN O
a DT O
backdoor NN O
, , O
send VB O
messages NNS O
to TO O
premium-rate JJ O
numbers NNS O
, , O
and CC O
intercept VB O
two-factor JJ O
authentication NN O
codes NNS O
sent VBN O
by IN O
online NN O
banking NN O
apps NN O
and CC O
the DT O
like JJ O
. . O

In IN O
fact NN O
, , O
with IN O
full JJ O
access NN O
to TO O
the DT O
compromised VBN O
Android NNP B-System
smartphone NN I-System
, , O
the DT O
opportunities NNS O
for IN O
criminals NNS O
to TO O
wreak VB O
havoc NN O
are VBP O
significant JJ O
– NNS O
such JJ O
as IN O
erasing VBG O
infected JJ O
phones NNS O
or CC O
launching VBG O
man-in-the-middle JJ O
( ( O
MITM NNP O
) ) O
attacks NNS O
. . O

In IN O
its PRP$ O
analysis NN O
, , O
CSIS NNP B-Organization
notes VBZ O
that IN O
MazarBOT NNP B-Malware
was VBD O
reported VBN O
by IN O
Recorded NNP B-Organization
Future NNP I-Organization
last JJ O
November NNP O
as IN O
being VBG O
actively RB O
sold VBN O
in IN O
Russian JJ O
underground NN O
forums NNS O
and CC O
intriguingly RB O
, , O
the DT O
malware NN O
will MD O
not RB O
activate VB O
on IN O
Android NNP B-System
devices NNS O
configured VBD O
with IN O
Russian JJ O
language NN O
settings NNS O
. . O

This DT O
, , O
in IN O
itself PRP O
, , O
does VBZ O
not RB O
prove VB O
that IN O
the DT O
perpetrators NNS O
of IN O
the DT O
malware NN O
campaign NN O
are VBP O
based VBN O
in IN O
Russia NNP O
, , O
but CC O
it PRP O
certainly RB O
sounds VBZ O
as IN O
if IN O
that DT O
is VBZ O
a DT O
strong JJ O
possibility NN O
. . O

Malware NNP O
authors NNS O
in IN O
the DT O
past NN O
have VBP O
often RB O
coded VBN O
a DT O
“ JJ O
safety NN O
net NN O
” NN O
into IN O
their PRP$ O
malware NN O
to TO O
prevent VB O
them PRP O
from IN O
accidentally RB O
infecting VBG O
their PRP$ O
own JJ O
computers NNS O
and CC O
devices NNS O
. . O

For IN O
more JJR O
detailed JJ O
information NN O
about IN O
the DT O
threat NN O
, , O
check VB O
out RP O
the DT O
blog NN O
post NN O
from IN O
CSIS NNP B-Organization
. . O

And CC O
, , O
of IN O
course NN O
, , O
remember VB O
to TO O
always RB O
be VB O
wary JJ O
of IN O
unsolicited JJ O
, , O
unusual JJ O
text NN O
messages NNS O
and CC O
installing VBG O
apps NN O
from IN O
third-party JJ O
sources NNS O
on IN O
your PRP$ O
Android NNP B-System
smartphone NN I-System
. . O

Coronavirus NNP B-System
Update NNP I-System
App NNP I-System
Leads NNP O
to TO O
Project NNP B-Malware
Spy NNP I-Malware
Android NNP B-System
and CC O
iOS JJ B-System
Spyware NNP O
We PRP O
discovered VBD O
a DT O
cyberespionage NN O
campaign NN O
we PRP O
have VBP O
named VBN O
Project NNP B-Malware
Spy NNP I-Malware
infecting VBG O
Android NNP B-System
and CC O
iOS JJ B-System
devices NNS O
with IN O
spyware NN O
by IN O
using VBG O
the DT O
coronavirus NN O
disease NN O
( ( O
Covid-19 NNP O
) ) O
as IN O
a DT O
lure NN O
. . O

By IN O
: : O
Tony NNP O
Bao NNP O
, , O
Junzhi NNP O
Lu NNP O
April NNP O
14 CD O
, , O
2020 CD O
We PRP O
discovered VBD O
a DT O
potential JJ O
cyberespionage NN O
campaign NN O
, , O
which WDT O
we PRP O
have VBP O
named VBN O
Project NNP B-Malware
Spy NNP I-Malware
, , O
that WDT O
infects VBZ O
Android NNP B-System
and CC O
iOS JJ B-System
devices NNS O
with IN O
spyware NN O
( ( O
detected VBN O
by IN O
Trend NNP B-Organization
Micro NNP I-Organization
as IN O
AndroidOS_ProjectSpy.HRX NNP B-Indicator
and CC O
IOS_ProjectSpy.A NNP B-Indicator
, , O
respectively RB O
) ) O
. . O

Project NN B-Malware
Spy NNP I-Malware
uses VBZ O
the DT O
ongoing JJ O
coronavirus NN O
pandemic NN O
as IN O
a DT O
lure NN O
, , O
posing VBG O
as IN O
an DT O
app NN O
called VBN O
Coronavirus NNP O
Updates NNP O
. . O

We PRP O
also RB O
found VBD O
similarities NNS O
in IN O
two CD O
older JJR O
samples NNS O
disguised VBN O
as IN O
a DT O
Google NNP B-Organization
service NN O
and CC O
, , O
subsequently RB O
, , O
as IN O
a DT O
music NN O
app NN O
after IN O
further JJ O
investigation NN O
. . O

However RB O
, , O
we PRP O
have VBP O
noted VBN O
a DT O
significantly RB O
small JJ O
number NN O
of IN O
downloads NNS O
of IN O
the DT O
app NN O
in IN O
Pakistan NNP O
, , O
India NNP O
, , O
Afghanistan NNP O
, , O
Bangladesh NNP O
, , O
Iran NNP O
, , O
Saudi NNP O
Arabia NNP O
, , O
Austria NNP O
, , O
Romania NNP O
, , O
Grenada NNP O
, , O
and CC O
Russia NNP O
. . O

Project NNP B-Malware
Spy NNP I-Malware
routine NN O
At IN O
the DT O
end NN O
of IN O
March NNP O
2020 CD O
, , O
we PRP O
came VBD O
across IN O
an DT O
app NN O
masquerading NN O
as IN O
a DT O
coronavirus NN O
update JJ O
app NN O
, , O
which WDT O
we PRP O
named VBD O
Project NNP B-Malware
Spy NNP I-Malware
based VBN O
on IN O
the DT O
login JJ O
page NN O
of IN O
its PRP$ O
backend NN O
server NN O
. . O

This DT O
app NN O
carries VBZ O
a DT O
number NN O
of IN O
the DT O
capabilities NNS O
: : O
Upload NNP O
GSM NNP B-System
, , O
WhatsApp NNP B-System
, , O
Telegram NNP B-System
, , O
Facebook NNP B-System
, , O
and CC O
Threema NNP B-System
messages NNS O
Upload NNP O
voice NN O
notes NNS O
, , O
contacts NNS O
stored VBD O
, , O
accounts NNS O
, , O
call VB O
logs NNS O
, , O
location NN O
information NN O
, , O
and CC O
images NNS O
Upload VBP O
the DT O
expanded JJ O
list NN O
of IN O
collected JJ O
device NN O
information NN O
( ( O
e.g. NN O
, , O
IMEI NNP O
, , O
product NN O
, , O
board NN O
, , O
manufacturer NN O
, , O
tag NN O
, , O
host NN O
, , O
Android NNP B-System
version NN O
, , O
application NN O
version NN O
, , O
name NN O
, , O
model NN O
brand NN O
, , O
user NN O
, , O
serial JJ O
, , O
hardware NN O
, , O
bootloader NN O
, , O
and CC O
device NN O
ID NNP O
) ) O
Upload NNP O
SIM NNP O
information NN O
( ( O
e.g. NN O

, , O
IMSI NNP O
, , O
operator NN O
code NN O
, , O
country NN O
, , O
MCC-mobile JJ O
country NN O
, , O
SIM NNP O
serial NN O
, , O
operator NN O
name NN O
, , O
and CC O
mobile JJ O
number NN O
) ) O
Upload NNP O
wifi NN O
information NN O
( ( O
e.g. NN O
, , O
SSID NNP O
, , O
wifi VBD O
speed NN O
, , O
and CC O
MAC NNP O
address NN O
) ) O
Upload VBZ O
other JJ O
information NN O
( ( O
e.g. NN O
, , O
display NN O
, , O
date NN O
, , O
time NN O
, , O
fingerprint NN O
, , O
created VBN O
at IN O
, , O
and CC O
updated VBD O
at IN O
) ) O
The DT O
app NN O
is VBZ O
capable JJ O
of IN O
stealing VBG O
messages NNS O
from IN O
popular JJ O
messaging VBG O
apps NN O
by IN O
abusing VBG O
the DT O
notification NN O
permissions NNS O
to TO O
read VB O
the DT O
notification NN O
content NN O
and CC O
saving VBG O
it PRP O
to TO O
the DT O
database NN O
. . O

It PRP O
requests VBZ O
permission NN O
to TO O
access NN O
the DT O
additional JJ O
storage NN O
. . O

Project NNP B-Malware
Spy NNP I-Malware
’ NNP O
s VBZ O
earlier JJR O
versions NNS O
Searching VBG O
for IN O
the DT O
domain NN O
in IN O
our PRP$ O
sample NN O
database NN O
, , O
we PRP O
found VBD O
that IN O
the DT O
coronavirus NN O
update JJ O
app NN O
appears VBZ O
to TO O
be VB O
the DT O
latest JJS O
version NN O
of IN O
another DT O
sample NN O
that IN O
we PRP O
detected VBD O
in IN O
May NNP O
2019 CD O
. . O

The DT O
first JJ O
version NN O
of IN O
Project NNP B-Malware
Spy NNP I-Malware
( ( O
detected VBN O
by IN O
Trend NNP B-Organization
Micro NNP I-Organization
as IN O
AndroidOS_SpyAgent.HRXB NNP B-Indicator
) ) O
had VBD O
the DT O
following JJ O
capabilities NNS O
: : O
Collect NNP O
device NN O
and CC O
system NN O
information NN O
( ( O
i.e. NN O
, , O
IMEI NNP O
, , O
device NN O
ID NNP O
, , O
manufacturer NN O
, , O
model NN O
and CC O
phone NN O
number NN O
) ) O
, , O
location NN O
information NN O
, , O
contacts NNS O
stored VBD O
, , O
and CC O
call VB O
logs NNS O
Collect NNP O
and CC O
send VB O
SMS NNP O
Take NNP O
pictures VBZ O
via IN O
the DT O
camera NN O
Upload NNP O
recorded VBD O
MP4 NNP O
files NNS O
Monitor NNP O
calls VBZ O
Searching VBG O
further RB O
, , O
we PRP O
also RB O
found VBD O
another DT O
sample NN O
that WDT O
could MD O
be VB O
the DT O
second JJ O
version NN O
of IN O
Project NNP O
Spy NNP O
. . O

This DT O
version NN O
appeared VBD O
as IN O
Wabi NNP O
Music NNP O
, , O
and CC O
copied VBD O
a DT O
popular JJ O
video-sharing JJ O
social JJ O
networking NN O
service NN O
as IN O
its PRP$ O
backend NN O
login NN O
page NN O
. . O

In IN O
this DT O
second JJ O
version NN O
, , O
the DT O
developer NN O
’ NNP O
s NN O
name NN O
listed VBN O
was VBD O
“ JJ O
concipit1248 NN O
” NN O
in IN O
Google NNP B-System
Play NNP I-System
, , O
and CC O
may MD O
have VB O
been VBN O
active JJ O
between IN O
May NNP O
2019 CD O
to TO O
February NNP O
2020 CD O
. . O

This DT O
app NN O
appears VBZ O
to TO O
have VB O
become VBN O
unavailable JJ O
on IN O
Google NNP B-System
Play NNP I-System
in IN O
March NNP O
2020 CD O
. . O

The DT O
second JJ O
Project NNP B-Malware
Spy NNP I-Malware
version NN O
has VBZ O
similar JJ O
capabilities NNS O
to TO O
the DT O
first JJ O
version NN O
, , O
with IN O
the DT O
addition NN O
of IN O
the DT O
following NN O
: : O
Stealing VBG O
notification NN O
messages NNS O
sent VBD O
from IN O
WhatsApp NNP B-System
, , O
Facebook NNP B-System
, , O
and CC O
Telegram NNP B-System
Abandoning NNP O
the DT O
FTP NNP O
mode NN O
of IN O
uploading VBG O
the DT O
recorded JJ O
images NNS O
Aside RB O
from IN O
changing VBG O
the DT O
app JJ O
’ NNP O
s NN O
supposed VBD O
function NN O
and CC O
look NN O
, , O
the DT O
second JJ O
and CC O
third JJ O
versions NNS O
’ VBP O
codes NNS O
had VBD O
little JJ O
differences NNS O
. . O

Potentially RB O
malicious JJ O
iOS JJ B-System
connection NN O
Using VBG O
the DT O
codes NNS O
and CC O
“ NNP O
Concipit1248 NNP O
” NNP O
to TO O
check VB O
for IN O
more JJR O
versions NNS O
, , O
we PRP O
found VBD O
two CD O
other JJ O
apps NN O
in IN O
the DT O
App NNP B-System
Store NNP I-System
. . O

Further JJ O
analysis NN O
of IN O
the DT O
iOS NN O
app NN O
“ NNP O
Concipit1248 NNP O
” NNP O
showed VBD O
that IN O
the DT O
server NN O
used VBN O
, , O
spy JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
cashnow NN I-Indicator
[ NNP I-Indicator
. . I-Indicator

] NN I-Indicator
ee NN I-Indicator
, , O
is VBZ O
the DT O
same JJ O
one CD O
used VBN O
in IN O
the DT O
Android NNP B-System
version NN O
of IN O
Project NNP B-System
Spy NNP I-System
. . O

However RB O
, , O
although IN O
the DT O
“ NNP O
Concipit1248 NNP O
” NNP O
app RB O
requested VBD O
permissions NNS O
to TO O
open VB O
the DT O
device NN O
camera NN O
and CC O
read JJ O
photos NNS O
, , O
the DT O
code NN O
only RB O
can MD O
upload VB O
a DT O
self-contained JJ O
PNG NNP O
file NN O
to TO O
a DT O
remote JJ O
sever NN O
. . O

This DT O
may MD O
imply VB O
the DT O
“ NNP O
Concipit1248 NNP O
” NNP O
app NN O
is VBZ O
still RB O
incubating VBG O
. . O

The DT O
other JJ O
iOS NN B-System
app NNS O
“ VBP O
Concipit NNP O
Shop NNP O
” NN O
from IN O
the DT O
same JJ O
developer NN O
appeared VBD O
normal JJ O
and CC O
was VBD O
last JJ O
updated JJ O
on IN O
November NNP O
2019 CD O
. . O

Apple NNP B-Organization
has VBZ O
confirmed VBN O
that IN O
the DT O
iOS NN B-System
apps NN O
are VBP O
not RB O
functioning VBG O
based VBN O
on IN O
analysis NN O
of IN O
the DT O
codes NNS O
, , O
and CC O
stated VBD O
that IN O
the DT O
sandbox NN O
is VBZ O
able JJ O
to TO O
detect VB O
and CC O
block VB O
these DT O
malicious JJ O
behaviors NNS O
. . O

Conclusion NN O
The DT O
“ NNP O
Corona NNP O
Updates NNP O
” NNP O
app NN O
had VBD O
relatively RB O
low JJ O
downloads NNS O
in IN O
Pakistan NNP O
, , O
India NNP O
, , O
Afghanistan NNP O
, , O
Bangladesh NNP O
, , O
Iran NNP O
, , O
Saudi NNP O
Arabia NNP O
, , O
Austria NNP O
, , O
Romania NNP O
, , O
Grenada NNP O
, , O
and CC O
Russia NNP O
. . O

Perhaps RB O
the DT O
app NN O
’ NNP O
s NN O
false JJ O
capabilities NNS O
also RB O
fueled VBD O
the DT O
low JJ O
number NN O
of IN O
downloads NNS O
. . O

It PRP O
also RB O
appears VBZ O
the DT O
apps NN O
may MD O
still RB O
be VB O
in IN O
development NN O
or CC O
incubation NN O
, , O
maybe RB O
waiting VBG O
for IN O
a DT O
“ JJ O
right JJ O
time NN O
” NN O
to TO O
inject VB O
the DT O
malicious JJ O
codes NNS O
. . O

It PRP O
’ VBZ O
s NN O
also RB O
possible JJ O
that IN O
the DT O
apps NN O
are VBP O
being VBG O
used VBN O
to TO O
test VB O
other JJ O
possible JJ O
techniques NNS O
. . O

A DT O
possible JJ O
indication NN O
for IN O
timing NN O
might MD O
be VB O
when WRB O
the DT O
app NN O
reaches VBZ O
a DT O
specific JJ O
number NN O
of IN O
downloads NNS O
or CC O
infected JJ O
devices NNS O
. . O

The DT O
coding NN O
style NN O
suggests VBZ O
that IN O
the DT O
cybercriminals NNS O
behind IN O
this DT O
campaign NN O
are VBP O
amateurs NNS O
. . O

The DT O
incomplete JJ O
iOS NN B-System
codes NNS O
used VBN O
in IN O
this DT O
campaign NN O
may MD O
have VB O
been VBN O
bought VBN O
while IN O
other JJ O
capabilities NNS O
appear VBP O
to TO O
have VB O
been VBN O
added VBN O
. . O

This DT O
may MD O
also RB O
explain VB O
the DT O
timing NN O
in IN O
between IN O
the DT O
apps NN O
becoming VBG O
fully RB O
functional JJ O
and CC O
“ JJ O
incubation. NN O
” NN O
As IN O
this DT O
is VBZ O
a DT O
group NN O
we PRP O
have VBP O
not RB O
observed VBN O
before RB O
, , O
we PRP O
will MD O
continue VB O
monitoring VBG O
this DT O
campaign NN O
for IN O
further JJ O
developments NNS O
. . O

Users NNS O
are VBP O
cautioned VBN O
to TO O
research NN O
and CC O
check VB O
reviews NNS O
before IN O
they PRP O
download VBP O
apps NNS O
. . O

Observe NNP O
and CC O
look NN O
at IN O
the DT O
app NN O
’ NNP O
s NN O
display NN O
and CC O
text NN O
, , O
stated VBN O
functions NNS O
, , O
reviews NNS O
from IN O
other JJ O
users NNS O
, , O
and CC O
requested VBD O
permissions NNS O
before IN O
downloading NN O
. . O

Make NNP O
sure NN O
that IN O
all DT O
other JJ O
apps NN O
installed VBN O
and CC O
the DT O
device NN O
operating VBG O
systems NNS O
are VBP O
updated VBN O
to TO O
the DT O
latest JJS O
version NN O
. . O

Indicators NNS O
of IN O
Compromise NNP O
( ( O
IoCs NNP O
) ) O
SHA256 NNP O
Detection NNP O
e394e53e53cd9047d6cff184ac333ef7698a34b777ae3aac82c2c669ef661dfe FW B-Indicator
AndroidOS_SpyAgent.HRXB NNP B-Indicator
e8d4713e43241ab09d40c2ae8814302f77de76650ccf3e7db83b3ac8ad41f9fa VBP B-Indicator
AndroidOS_ProjectSpy.HRX NNP O
29b0d86ae68d83f9578c3f36041df943195bc55a7f3f1d45a9c23f145d75af9d CD B-Indicator

AndroidOS_ProjectSpy.HRX $ O
3a15e7b8f4e35e006329811a6a2bf291d449884a120332f24c7e3ca58d0fbbdb CD B-Indicator
IOS_ProjectSpy.A NNP B-Indicator
URLs NNP O
cashnow VBP B-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
ee JJ I-Indicator
Backend NNP O
server NN B-Indicator
ftp NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
XXXX NNP I-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
Backend NNP O
server NN B-Indicator
spy NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
cashnow NN I-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
ee JJ I-Indicator
Backend NNP O
server NN B-Indicator
xyz NNP I-Indicator
[ NNP I-Indicator
. . I-Indicator

] NN I-Indicator
cashnow NN I-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
ee JJ I-Indicator
Backend NNP O
server NN O
October NNP O
8 CD O
, , O
2020 CD O
Sophisticated VBD O
new JJ O
Android NNP B-System
malware NN O
marks VBZ O
the DT O
latest JJS O
evolution NN O
of IN O
mobile JJ O
ransomware NN O
Attackers NNS O
are VBP O
persistent JJ O
and CC O
motivated VBD O
to TO O
continuously RB O
evolve VB O
– NNP O
and CC O
no DT O
platform NN O
is VBZ O
immune JJ O
. . O

That DT O
is VBZ O
why WRB O
Microsoft NNP B-Organization
has VBZ O
been VBN O
working VBG O
to TO O
extend VB O
its PRP$ O
industry-leading JJ O
endpoint NN O
protection NN O
capabilities NNS O
beyond IN O
Windows NNP B-System
. . O

The DT O
addition NN O
of IN O
mobile JJ O
threat NN O
defense NN O
into IN O
these DT O
capabilities NNS O
means VBZ O
that IN O
Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
( ( O
previously RB O
Microsoft NNP B-System
Defender NNP I-System
Advanced NNP I-System
Threat NNP I-System
Protection NNP I-System
) ) O
now RB O
delivers VBZ O
protection NN O
on IN O
all DT O
major JJ O
platforms NNS O
. . O

Microsoft NNP B-Organization
’ NNP O
s NN O
mobile NN O
threat NN O
defense NN O
capabilities NNS O
further RBR O
enrich RB O
the DT O
visibility NN O
that IN O
organizations NNS O
have VBP O
on IN O
threats NNS O
in IN O
their PRP$ O
networks NNS O
, , O
as RB O
well RB O
as IN O
provide NN O
more JJR O
tools NNS O
to TO O
detect VB O
and CC O
respond VB O
to TO O
threats VB O
across IN O
domains NNS O
and CC O
across IN O
platforms NNS O
. . O

Like IN O
all DT O
of IN O
Microsoft NNP B-Organization
’ NNP O
s JJ O
security NN O
solutions NNS O
, , O
these DT O
new JJ O
capabilities NNS O
are VBP O
likewise RB O
backed VBN O
by IN O
a DT O
global JJ O
network NN O
of IN O
threat NN O
researchers NNS O
and CC O
security NN O
experts NNS O
whose WP$ O
deep JJ O
understanding NN O
of IN O
the DT O
threat NN O
landscape NN O
guide IN O
the DT O
continuous JJ O
innovation NN O
of IN O
security NN O
features NNS O
and CC O
ensure VB O
that IN O
customers NNS O
are VBP O
protected VBN O
from IN O
ever-evolving JJ O
threats NNS O
. . O

For IN O
example NN O
, , O
we PRP O
found VBD O
a DT O
piece NN O
of IN O
a DT O
particularly RB O
sophisticated JJ O
Android NNP B-System
ransomware NN O
with IN O
novel JJ O
techniques NNS O
and CC O
behavior NN O
, , O
exemplifying VBG O
the DT O
rapid JJ O
evolution NN O
of IN O
mobile JJ O
threats NNS O
that IN O
we PRP O
have VBP O
also RB O
observed VBN O
on IN O
other JJ O
platforms NNS O
. . O

The DT O
mobile JJ O
ransomware NN O
, , O
detected VBN O
by IN O
Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
as IN O
AndroidOS/MalLocker.B NNP B-Indicator
, , O
is VBZ O
the DT O
latest JJS O
variant NN O
of IN O
a DT O
ransomware JJ O
family NN O
that WDT O
’ VBZ O
s RB O
been VBN O
in IN O
the DT O
wild NN O
for IN O
a DT O
while NN O
but CC O
has VBZ O
been VBN O
evolving VBG O
non-stop JJ O
. . O

This DT O
ransomware NN O
family NN O
is VBZ O
known VBN O
for IN O
being VBG O
hosted VBN O
on IN O
arbitrary JJ O
websites NNS O
and CC O
circulated VBN O
on IN O
online NN O
forums NNS O
using VBG O
various JJ O
social JJ O
engineering NN O
lures NNS O
, , O
including VBG O
masquerading VBG O
as IN O
popular JJ O
apps NN O
, , O
cracked VBN O
games NNS O
, , O
or CC O
video NN O
players NNS O
. . O

The DT O
new JJ O
variant NN O
caught VBD O
our PRP$ O
attention NN O
because IN O
it PRP O
’ NNP O
s VBD O
an DT O
advanced JJ O
malware NN O
with IN O
unmistakable JJ O
malicious JJ O
characteristic NN O
and CC O
behavior NN O
and CC O
yet RB O
manages NNS O
to TO O
evade VB O
many JJ O
available JJ O
protections NNS O
, , O
registering VBG O
a DT O
low JJ O
detection NN O
rate NN O
against IN O
security NN O
solutions NNS O
. . O

As IN O
with IN O
most JJS O
Android NNP B-System
ransomware NN O
, , O
this DT O
new JJ O
threat NN O
doesn NN O
’ NNP O
t VBZ O
actually RB O
block JJ O
access NN O
to TO O
files NNS O
by IN O
encrypting VBG O
them PRP O
. . O

Instead RB O
, , O
it PRP O
blocks VBZ O
access NN O
to TO O
devices NNS O
by IN O
displaying VBG O
a DT O
screen NN O
that WDT O
appears VBZ O
over IN O
every DT O
other JJ O
window NN O
, , O
such JJ O
that IN O
the DT O
user NN O
can MD O
’ VB O
t NNS O
do VBP O
anything NN O
else RB O
. . O

The DT O
said VBD O
screen NN O
is VBZ O
the DT O
ransom JJ O
note NN O
, , O
which WDT O
contains VBZ O
threats NNS O
and CC O
instructions NNS O
to TO O
pay VB O
the DT O
ransom NN O
. . O

What WP O
’ VBD O
s JJ O
innovative JJ O
about IN O
this DT O
ransomware NN O
is VBZ O
how WRB O
it PRP O
displays VBZ O
its PRP$ O
ransom JJ O
note NN O
. . O

In IN O
this DT O
blog NN O
, , O
we PRP O
’ VBP O
ll JJ O
detail NN O
the DT O
innovative JJ O
ways NNS O
in IN O
which WDT O
this DT O
ransomware NN O
surfaces VBZ O
its PRP$ O
ransom JJ O
note NN O
using VBG O
Android NNP B-System
features VBZ O
we PRP O
haven VBP O
’ JJ O
t NN O
seen VBN O
leveraged VBN O
by IN O
malware NN O
before RB O
, , O
as RB O
well RB O
as IN O
incorporating VBG O
an DT O
open-source JJ O
machine NN O
learning NN O
module NN O
designed VBN O
for IN O
context-aware JJ O
cropping NN O
of IN O
its PRP$ O
ransom JJ O
note NN O
. . O

New NNP O
scheme NN O
, , O
same JJ O
goal NN O
In IN O
the DT O
past NN O
, , O
Android NNP B-System
ransomware NN O
used VBD O
a DT O
special JJ O
permission NN O
called VBN O
“ NNP O
SYSTEM_ALERT_WINDOW NNP O
” NNP O
to TO O
display VB O
their PRP$ O
ransom JJ O
note NN O
. . O

Apps NN O
that WDT O
have VBP O
this DT O
permission NN O
can MD O
draw VB O
a DT O
window NN O
that WDT O
belongs VBZ O
to TO O
the DT O
system NN O
group NN O
and CC O
can MD O
’ VB O
t RB O
be VB O
dismissed VBN O
. . O

No DT O
matter NN O
what WP O
button NN O
is VBZ O
pressed VBN O
, , O
the DT O
window NN O
stays VBZ O
on IN O
top NN O
of IN O
all DT O
other JJ O
windows NNS O
. . O

The DT O
notification NN O
was VBD O
intended VBN O
to TO O
be VB O
used VBN O
for IN O
system NN O
alerts NNS O
or CC O
errors NNS O
, , O
but CC O
Android NNP B-System
threats NNS O
misused VBD O
it PRP O
to TO O
force VB O
the DT O
attacker-controlled JJ O
UI NNP O
to TO O
fully RB O
occupy VB O
the DT O
screen NN O
, , O
blocking VBG O
access NN O
to TO O
the DT O
device NN O
. . O

Attackers NNS O
create VBP O
this DT O
scenario NN O
to TO O
persuade VB O
users NNS O
to TO O
pay VB O
the DT O
ransom NN O
so IN O
they PRP O
can MD O
gain VB O
back RB O
access NN O
to TO O
the DT O
device NN O
. . O

To TO O
catch VB O
these DT O
threats NNS O
, , O
security NN O
solutions NNS O
used VBD O
heuristics NNS O
that WDT O
focused VBD O
on IN O
detecting VBG O
this DT O
behavior NN O
. . O

Google NNP B-Organization
later RB O
implemented VBD O
platform-level JJ O
changes NNS O
that WDT O
practically RB O
eliminated VBD O
this DT O
attack NN O
surface NN O
. . O

These DT O
changes NNS O
include VBP O
: : O
Removing VBG O
the DT O
SYSTEM_ALERT_WINDOW NNP O
error NN O
and CC O
alert NN O
window NN O
types NNS O
, , O
and CC O
introducing VBG O
a DT O
few JJ O
other JJ O
types NNS O
as IN O
replacement NN O
Elevating VBG O
the DT O
permission NN O
status NN O
of IN O
SYSTEM_ALERT_WINDOW NNP O
to TO O
special JJ O
permission NN O
by IN O
putting VBG O
it PRP O
into IN O
the DT O
“ NNP O
above IN O
dangerous JJ O
” NNP O
category NN O
, , O
which WDT O
means VBZ O
that IN O
users NNS O
have VBP O
to TO O
go VB O
through IN O
many JJ O
screens NNS O
to TO O
approve VB O
apps NN O
that WDT O
ask VBZ O
for IN O
permission NN O
, , O
instead RB O
of IN O
just RB O
one CD O
click NN O
Introducing VBG O
an DT O
overlay NN O
kill NN O
switch VB O
on IN O
Android NNP B-System
8.0 CD I-System
and CC O
later RB O
that IN O
users NNS O
can MD O
activate VB O
anytime RB O
to TO O
deactivate VB O
a DT O
system NN O
alert JJ O
window NN O
To TO O
adapt VB O
, , O
Android NNP B-System
malware NN O
evolved VBD O
to TO O
misusing VBG O

other JJ O
features NNS O
, , O
but CC O
these DT O
aren NNS O
’ VBP O
t NN O
as IN O
effective JJ O
. . O

For IN O
example NN O
, , O
some DT O
strains NNS O
of IN O
ransomware NN O
abuse NN O
accessibility NN O
features NNS O
, , O
a DT O
method NN O
that WDT O
could MD O
easily RB O
alarm VB O
users NNS O
because IN O
accessibility NN O
is VBZ O
a DT O
special JJ O
permission NN O
that WDT O
requires VBZ O
users NNS O
to TO O
go VB O
through IN O
several JJ O
screens NNS O
and CC O
accept VB O
a DT O
warning NN O
that IN O
the DT O
app NN O
will MD O
be VB O
able JJ O
to TO O
monitor VB O
activity NN O
via IN O
accessibility NN O
services NNS O
. . O

Other JJ O
ransomware NN O
families NNS O
use VBP O
infinite JJ O
loops NNS O
of IN O
drawing VBG O
non-system JJ O
windows NNS B-System
, , O
but CC O
in IN O
between IN O
drawing VBG O
and CC O
redrawing VBG O
, , O
it PRP O
’ VBZ O
s RBR O
possible JJ O
for IN O
users NNS O
to TO O
go VB O
to TO O
settings NNS O
and CC O
uninstall VB O
the DT O
offending NN O
app NN O
. . O

The DT O
new JJ O
Android NNP B-Malware
ransomware NN O
variant NN O
overcomes VBZ O
these DT O
barriers NNS O
by IN O
evolving VBG O
further RB O
than IN O
any DT O
Android NNP B-Malware
malware NN O
we PRP O
’ VBP O
ve JJ O
seen VBN O
before IN O
. . O

To TO O
surface VB O
its PRP$ O
ransom JJ O
note NN O
, , O
it PRP O
uses VBZ O
a DT O
series NN O
of IN O
techniques NNS O
that WDT O
take VBP O
advantage NN O
of IN O
the DT O
following JJ O
components NNS O
on IN O
Android NNP B-System
: : O
The DT O
“ NNP O
call NN O
” NNP O
notification NN O
, , O
among IN O
several JJ O
categories NNS O
of IN O
notifications NNS O
that WDT O
Android NNP B-System
supports NNS O
, , O
which WDT O
requires VBZ O
immediate JJ O
user JJ O
attention NN O
. . O

The DT O
“ JJ O
onUserLeaveHint NN O
( ( O
) ) O
” VBP O
callback JJ O
method NN O
of IN O
the DT O
Android NNP B-System
Activity NNP I-System
( ( O
i.e. NN O
, , O
the DT O
typical JJ O
GUI NNP O
screen NN O
the DT O
user NN O
sees NNS O
) ) O
is VBZ O
called VBN O
as IN O
part NN O
of IN O
the DT O
activity NN O
lifecycle NN O
when WRB O
the DT O
activity NN O
is VBZ O
about IN O
to TO O
go VB O
into IN O
the DT O
background NN O
as IN O
a DT O
result NN O
of IN O
user NN O
choice NN O
, , O
for IN O
example NN O
, , O
when WRB O
the DT O
user NN O
presses VBZ O
the DT O
Home NNP O
key NN O
. . O

The DT O
malware NN O
connects VBZ O
the DT O
dots NNS O
and CC O
uses VBZ O
these DT O
two CD O
components NNS O
to TO O
create VB O
a DT O
special JJ O
type NN O
of IN O
notification NN O
that IN O
triggers VBZ O
the DT O
ransom NN O
screen NN O
via IN O
the DT O
callback NN O
. . O

As IN O
the DT O
code NN O
snippet NN O
shows NNS O
, , O
the DT O
malware NN O
creates VBZ O
a DT O
notification NN O
builder NN O
and CC O
then RB O
does VBZ O
the DT O
following NN O
: : O
setCategory NN O
( ( O
“ JJ O
call NN O
” NN O
) ) O
– VBZ O
This DT O
means VBZ O
that IN O
the DT O
notification NN O
is VBZ O
built VBN O
as IN O
a DT O
very RB O
important JJ O
notification NN O
that WDT O
needs VBZ O
special JJ O
privilege NN O
. . O

setFullScreenIntent NN O
( ( O
) ) O
– VBP O
This DT O
API NNP O
wires VBZ O
the DT O
notification NN O
to TO O
a DT O
GUI NNP O
so IN O
that IN O
it PRP O
pops VBZ O
up RP O
when WRB O
the DT O
user NN O
taps VBZ O
on IN O
it PRP O
. . O

At IN O
this DT O
stage NN O
, , O
half PDT O
the DT O
job NN O
is VBZ O
done VBN O
for IN O
the DT O
malware NN O
. . O

However RB O
, , O
the DT O
malware NN O
wouldn NN O
’ NNP O
t NN O
want VBP O
to TO O
depend VB O
on IN O
user JJ O
interaction NN O
to TO O
trigger VB O
the DT O
ransomware NN O
screen NN O
, , O
so RB O
, , O
it PRP O
adds VBZ O
another DT O
functionality NN O
of IN O
Android NNP B-System
callback NN O
: : O
As IN O
the DT O
code NN O
snippet NN O
shows NNS O
, , O
the DT O
malware NN O
overrides VBZ O
the DT O
onUserLeaveHint NN O
( ( O
) ) O
callback NN O
function NN O
of IN O
Activity NNP O
class NN O
. . O

The DT O
function NN O
onUserLeaveHint NN O
( ( O
) ) O
is VBZ O
called VBN O
whenever WRB O
the DT O
malware NN O
screen NN O
is VBZ O
pushed VBN O
to TO O
background VB O
, , O
causing VBG O
the DT O
in-call JJ O
Activity NN O
to TO O
be VB O
automatically RB O
brought VBN O
to TO O
the DT O
foreground NN O
. . O

Recall NN O
that IN O
the DT O
malware NN O
hooked VBD O
the DT O
RansomActivity NNP O
intent NN O
with IN O
the DT O
notification NN O
that WDT O
was VBD O
created VBN O
as IN O
a DT O
“ NN O
call NN O
” NNP O
type NN O
notification NN O
. . O

This DT O
creates VBZ O
a DT O
chain NN O
of IN O
events NNS O
that WDT O
triggers VBZ O
the DT O
automatic JJ O
pop-up NN O
of IN O
the DT O
ransomware NN O
screen NN O
without IN O
doing VBG O
infinite JJ O
redraw NN O
or CC O
posing NN O
as IN O
system NN O
window NN O
. . O

Machine NN O
learning VBG O
module NN O
indicates VBZ O
continuous JJ O
evolution NN O
As IN O
mentioned VBN O
, , O
this DT O
ransomware NN O
is VBZ O
the DT O
latest JJS O
variant NN O
of IN O
a DT O
malware JJ O
family NN O
that WDT O
has VBZ O
undergone JJ O
several JJ O
stages NNS O
of IN O
evolution NN O
. . O

The DT O
knowledge NN O
graph NN O
below IN O
shows VBZ O
the DT O
various JJ O
techniques NNS O
this DT O
ransomware NN O
family NN O
has VBZ O
been VBN O
seen VBN O
using VBG O
, , O
including VBG O
abusing VBG O
the DT O
system NN O
alert JJ O
window NN O
, , O
abusing VBG O
accessibility NN O
features NNS O
, , O
and CC O
, , O
more RBR O
recently RB O
, , O
abusing VBG O
notification NN O
services NNS O
. . O

This DT O
ransomware JJ O
family NN O
’ NNP O
s NN O
long RB O
history NN O
tells NNS O
us PRP O
that IN O
its PRP$ O
evolution NN O
is VBZ O
far RB O
from IN O
over IN O
. . O

We PRP O
expect VBP O
it PRP O
to TO O
churn VB O
out RP O
new JJ O
variants NNS O
with IN O
even RB O
more RBR O
sophisticated JJ O
techniques NNS O
. . O

In IN O
fact NN O
, , O
recent JJ O
variants NNS O
contain VBP O
code NN O
forked VBN O
from IN O
an DT O
open-source JJ O
machine NN O
learning NN O
module NN O
used VBN O
by IN O
developers NNS O
to TO O
automatically RB O
resize VB O
and CC O
crop NN O
images NNS O
based VBN O
on IN O
screen JJ O
size NN O
, , O
a DT O
valuable JJ O
function NN O
given VBN O
the DT O
variety NN O
of IN O
Android NNP B-System
devices NNS O
. . O

The DT O
frozen JJ O
TinyML NNP B-System
model NN O
is VBZ O
useful JJ O
for IN O
making VBG O
sure JJ O
images NNS O
fit VBP O
the DT O
screen NN O
without IN O
distortion NN O
. . O

In IN O
the DT O
case NN O
of IN O
this DT O
ransomware NN O
, , O
using VBG O
the DT O
model NN O
would MD O
ensure VB O
that IN O
its PRP$ O
ransom NN O
note—typically RB O
fake JJ O
police NN O
notice NN O
or CC O
explicit NN O
images NNS O
supposedly RB O
found VBD O
on IN O
the DT O
device—would NN O
appear VB O
less JJR O
contrived JJ O
and CC O
more RBR O
believable JJ O
, , O
increasing VBG O
the DT O
chances NNS O
of IN O
the DT O
user NN O
paying VBG O
for IN O
the DT O
ransom NN O
. . O

The DT O
library NN O
that WDT O
uses VBZ O
tinyML NN B-System
is VBZ O
not RB O
yet RB O
wired VBN O
to TO O
the DT O
malware NN O
’ NNP O
s NN O
functionalities NNS O
, , O
but CC O
its PRP$ O
presence NN O
in IN O
the DT O
malware NN O
code NN O
indicates VBZ O
the DT O
intention NN O
to TO O
do VB O
so RB O
in IN O
future JJ O
variants NNS O
. . O

We PRP O
will MD O
continue VB O
to TO O
monitor VB O
this DT O
ransomware NN O
family NN O
to TO O
ensure VB O
customers NNS O
are VBP O
protected VBN O
and CC O
to TO O
share NN O
our PRP$ O
findings NNS O
and CC O
insights NNS O
to TO O
the DT O
community NN O
for IN O
broad JJ O
protection NN O
against IN O
these DT O
evolving VBG O
mobile NN O
threats NNS O
. . O

Protecting VBG O
organizations NNS O
from IN O
threats NNS O
across IN O
domains NNS O
and CC O
platforms NNS O
Mobile NNP O
threats NNS O
continue VBP O
to TO O
rapidly RB O
evolve VB O
, , O
with IN O
attackers NNS O
continuously RB O
attempting VBG O
to TO O
sidestep VB O
technological JJ O
barriers NNS O
and CC O
creatively RB O
find VB O
ways NNS O
to TO O
accomplish VB O
their PRP$ O
goal NN O
, , O
whether IN O
financial JJ O
gain NN O
or CC O
finding VBG O
an DT O
entry NN O
point NN O
to TO O
broader VB O
network NN O
compromise NN O
. . O

This DT O
new JJ O
mobile JJ O
ransomware NN O
variant NN O
is VBZ O
an DT O
important JJ O
discovery NN O
because IN O
the DT O
malware NN O
exhibits VBZ O
behaviors NNS O
that WDT O
have VBP O
not RB O
been VBN O
seen VBN O
before IN O
and CC O
could MD O
open VB O
doors NNS O
for IN O
other JJ O
malware NN O
to TO O
follow VB O
. . O

It PRP O
reinforces VBZ O
the DT O
need NN O
for IN O
comprehensive JJ O
defense NN O
powered VBN O
by IN O
broad JJ O
visibility NN O
into IN O
attack NN O
surfaces NNS O
as RB O
well RB O
as IN O
domain NN O
experts NNS O
who WP O
track VBP O
the DT O
threat NN O
landscape NN O
and CC O
uncover JJ O
notable JJ O
threats NNS O
that WDT O
might MD O
be VB O
hiding VBG O
amidst JJ O
massive JJ O
threat NN O
data NNS O
and CC O
signals NNS O
. . O

Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
on IN O
Android NNP B-System
, , O
now RB O
generally RB O
available JJ O
, , O
extends VBZ O
Microsoft NNP B-Organization
’ NNP O
s VBD O
industry-leading JJ O
endpoint NN O
protection NN O
to TO O
Android NNP B-System
. . O

It PRP O
detects VBZ O
this DT O
ransomware NN O
( ( O
AndroidOS/MalLocker.B NNP B-Indicator
) ) O
, , O
as RB O
well RB O
as IN O
other JJ O
malicious JJ O
apps NNS O
and CC O
files NNS O
using VBG O
cloud-based JJ O
protection NN O
powered VBN O
by IN O
deep JJ O
learning NN O
and CC O
heuristics NNS O
, , O
in IN O
addition NN O
to TO O
content-based JJ O
detection NN O
. . O

It PRP O
also RB O
protects VBZ O
users NNS O
and CC O
organizations NNS O
from IN O
other JJ O
mobile JJ O
threats NNS O
, , O
such JJ O
as IN O
mobile JJ O
phishing NN O
, , O
unsafe JJ O
network NN O
connections NNS O
, , O
and CC O
unauthorized JJ O
access NN O
to TO O
sensitive VB O
data NNS O
. . O

Learn NNP O
more RBR O
about IN O
our PRP$ O
mobile JJ O
threat NN O
defense NN O
capabilities NNS O
in IN O
Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
on IN O
Android NNP B-System
. . O

Malware NNP O
, , O
phishing NN O
, , O
and CC O
other JJ O
threats NNS O
detected VBN O
by IN O
Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
are VBP O
reported VBN O
to TO O
the DT O
Microsoft NNP B-Organization
Defender NNP I-Organization
Security NNP I-Organization
Center NNP I-Organization
, , O
allowing VBG O
SecOps NNP O
to TO O
investigate VB O
mobile JJ O
threats NNS O
along IN O
with IN O
endpoint NN O
signals NNS O
from IN O
Windows NNP B-System
and CC O
other JJ O
platforms NNS O
using VBG O
Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
’ NNP O
s VBD O
rich JJ O
set NN O
of IN O
tools NNS O
for IN O
detection NN O
, , O
investigation NN O
, , O
and CC O
response NN O
. . O

Threat NNP O
data NNS O
from IN O
endpoints NNS O
are VBP O
combined VBN O
with IN O
signals NNS O
from IN O
email NN O
and CC O
data NNS O
, , O
identities NNS O
, , O
and CC O
apps NN O
in IN O
Microsoft NNP B-System
365 CD I-System
Defender NNP I-System
( ( O
previously RB O
Microsoft NNP B-System
Threat NNP I-System
Protection NNP I-System
) ) O
, , O
which WDT O
orchestrates VBZ O
detection NN O
, , O
prevention NN O
, , O
investigation NN O
, , O
and CC O
response NN O
across IN O
domains NNS O
, , O
providing VBG O
coordinated VBN O
defense NN O
. . O

Microsoft NNP B-System
Defender NNP I-System
for IN O
Endpoint NNP O
on IN O
Android NNP B-System
further JJ O
enriches NNS O
organizations NNS O
’ VBP O
visibility NN O
into IN O
malicious JJ O
activity NN O
, , O
empowering VBG O
them PRP O
to TO O
comprehensively RB O
prevent VB O
, , O
detect VB O
, , O
and CC O
respond NN O
to TO O
against IN O
attack NN O
sprawl NN O
and CC O
cross-domain JJ O
incidents NNS O
. . O

Technical JJ O
analysis NN O
Obfuscation NNP O
On IN O
top NN O
of IN O
recreating VBG O
ransomware JJ O
behavior NN O
in IN O
ways NNS O
we PRP O
haven VBP O
’ JJ O
t NN O
seen VBN O
before IN O
, , O
the DT O
Android NNP B-System
malware NN O
variant JJ O
uses VBZ O
a DT O
new JJ O
obfuscation NN O
technique NN O
unique NN O
to TO O
the DT O
Android NNP B-System
platform NN O
. . O

One CD O
of IN O
the DT O
tell-tale JJ O
signs NNS O
of IN O
an DT O
obfuscated JJ O
malware NN O
is VBZ O
the DT O
absence NN O
of IN O
code NN O
that WDT O
defines VBZ O
the DT O
classes NNS O
declared VBN O
in IN O
the DT O
manifest JJS O
file NN O
. . O

The DT O
classes.dex NN O
has VBZ O
implementation NN O
for IN O
only RB O
two CD O
classes NNS O
: : O
The DT O
main JJ O
application NN O
class NN O
gCHotRrgEruDv NN O
, , O
which WDT O
is VBZ O
involved VBN O
when WRB O
the DT O
application NN O
opens VBZ O
A DT O
helper JJ O
class NN O
that WDT O
has VBZ O
definition NN O
for IN O
custom NN O
encryption NN O
and CC O
decryption NN O
This DT O
means VBZ O
that IN O
there EX O
’ NNP O
s VBD O
no DT O
code NN O
corresponding VBG O
to TO O
the DT O
services NNS O
declared VBN O
in IN O
the DT O
manifest JJS O
file NN O
: : O
Main NN O
Activity NNP O
, , O
Broadcast NNP O
Receivers NNP O
, , O
and CC O
Background NNP O
. . O

How WRB O
does VBZ O
the DT O
malware NN O
work NN O
without IN O
code NN O
for IN O
these DT O
key JJ O
components NNS O
? . O

As IN O
is VBZ O
characteristic JJ O
for IN O
obfuscated JJ O
threats NNS O
, , O
the DT O
malware NN O
has VBZ O
encrypted VBN O
binary JJ O
code NN O
stored VBN O
in IN O
the DT O
Assets NNPS O
folder NN O
: : O
When WRB O
the DT O
malware NN O
runs VBZ O
for IN O
the DT O
first JJ O
time NN O
, , O
the DT O
static JJ O
block NN O
of IN O
the DT O
main JJ O
class NN O
is VBZ O
run VBN O
. . O

The DT O
code NN O
is VBZ O
heavily RB O
obfuscated VBN O
and CC O
made VBN O
unreadable JJ O
through IN O
name NN O
mangling NN O
and CC O
use NN O
of IN O
meaningless NN O
variable JJ O
names NNS O
: : O
Decryption NN O
with IN O
a DT O
twist NN O
The DT O
malware NN O
uses VBZ O
an DT O
interesting JJ O
decryption NN O
routine NN O
: : O
the DT O
string NN O
values NNS O
passed VBN O
to TO O
the DT O
decryption NN O
function NN O
do VBP O
not RB O
correspond VB O
to TO O
the DT O
decrypted VBN O
value NN O
, , O
they PRP O
correspond VBP O
to TO O
junk NN O
code NN O
to TO O
simply RB O
hinder VB O
analysis NN O
. . O

On IN O
Android NNP B-System
, , O
an DT O
Intent NN O
is VBZ O
a DT O
software NN O
mechanism NN O
that WDT O
allows VBZ O
users NNS O
to TO O
coordinate VB O
the DT O
functions NNS O
of IN O
different JJ O
Activities NNS O
to TO O
achieve VB O
a DT O
task NN O
. . O

It PRP O
’ VBZ O
s VBZ O
a DT O
messaging NN O
object NN O
that WDT O
can MD O
be VB O
used VBN O
to TO O
request VB O
an DT O
action NN O
from IN O
another DT O
app JJ O
component NN O
. . O

The DT O
Intent NNP O
object NN O
carries VBZ O
a DT O
string NN O
value NN O
as IN O
“ JJ O
action NN O
” NNP O
parameter NN O
. . O

The DT O
malware NN O
creates VBZ O
an DT O
Intent NNP O
inside IN O
the DT O
decryption NN O
function NN O
using VBG O
the DT O
string VBG O
value NN O
passed VBN O
as IN O
the DT O
name NN O
for IN O
the DT O
Intent NNP O
. . O

It PRP O
then RB O
decrypts VBZ O
a DT O
hardcoded VBN O
encrypted VBN O
value NN O
and CC O
sets VBZ O
the DT O
“ JJ O
action NN O
” NNP O
parameter NN O
of IN O
the DT O
Intent NNP O
using VBG O
the DT O
setAction NN O
API NNP O
. . O

Once RB O
this DT O
Intent NN O
object NN O
is VBZ O
generated VBN O
with IN O
the DT O
action NN O
value NN O
pointing VBG O
to TO O
the DT O
decrypted VBN O
content NN O
, , O
the DT O
decryption NN O
function NN O
returns VBZ O
the DT O
Intent NNP O
object NN O
to TO O
the DT O
callee NN O
. . O

The DT O
callee NN O
then RB O
invokes VBZ O
the DT O
getAction NN O
method NN O
to TO O
get VB O
the DT O
decrypted JJ O
content NN O
. . O

Payload NNP O
deployment NN O
Once RB O
the DT O
static JJ O
block NN O
execution NN O
is VBZ O
complete JJ O
, , O
the DT O
Android NNP B-System
Lifecycle NNP I-System
callback NN O
transfers VBZ O
the DT O
control NN O
to TO O
the DT O
OnCreate NNP O
method NN O
of IN O
the DT O
main JJ O
class NN O
. . O

Malware NNP O
code NN O
showing VBG O
onCreate JJ O
method JJ O
Figure NN O
9. CD O
onCreate NN O
method NN O
of IN O
the DT O
main JJ O
class NN O
decrypting VBG O
the DT O
payload NN O
Next NNP O
, , O
the DT O
malware-defined JJ O
function NN O
decryptAssetToDex NN O
( ( O
a DT O
meaningful NN O
name NN O
we PRP O
assigned VBD O
during IN O
analysis NN O
) ) O
receives VBZ O
the DT O
string NN O
“ NNP O
CuffGmrQRT NNP B-Indicator
” NNP O
as IN O
the DT O
first JJ O
argument NN O
, , O
which WDT O
is VBZ O
the DT O
name NN O
of IN O
the DT O
encrypted VBN O
file NN O
stored VBN O
in IN O
the DT O
Assets NNPS O
folder NN O
. . O

Malware NNP O
code NN O
showing VBG O
decryption NN O
of IN O
assets NNS O
Figure NNP O
10 CD O
. . O

Decrypting VBG O
the DT O
assets NNS O
After IN O
being VBG O
decrypted VBN O
, , O
the DT O
asset NN O
turns VBZ O
into IN O
the DT O
.dex NN O
file NN O
. . O

This DT O
is VBZ O
a DT O
notable JJ O
behavior NN O
that WDT O
is VBZ O
characteristic JJ O
of IN O
this DT O
ransomware JJ O
family NN O
. . O

Comparison NNP O
of IN O
code NN O
of IN O
Asset NNP O
file NN O
before IN O
and CC O
after IN O
decryption NN O
Figure NN O
11 CD O
. . O

Asset NNP O
file NN O
before IN O
and CC O
after IN O
decryption NN O
Once IN O
the DT O
encrypted JJ O
executable NN O
is VBZ O
decrypted VBN O
and CC O
dropped VBN O
in IN O
the DT O
storage NN O
, , O
the DT O
malware NN O
has VBZ O
the DT O
definitions NNS O
for IN O
all PDT O
the DT O
components NNS O
it PRP O
declared VBD O
in IN O
the DT O
manifest JJS O
file NN O
. . O

It PRP O
then RB O
starts VBZ O
the DT O
final JJ O
detonator NN O
function NN O
to TO O
load VB O
the DT O
dropped JJ O
.dex NN O
file NN O
into IN O
memory NN O
and CC O
triggers VBZ O
the DT O
main JJ O
payload NN O
. . O

Malware NNP O
code NN O
showing VBG O
loading NN O
of IN O
decrypted JJ O
dex NN O
file NN O
Figure NN O
12 CD O
. . O

Loading VBG O
the DT O
decrypted JJ O
.dex NN O
file NN O
into IN O
memory NN O
and CC O
triggering VBG O
the DT O
main JJ O
payload NN O
Main NNP O
payload NN O
When WRB O
the DT O
main JJ O
payload NN O
is VBZ O
loaded VBN O
into IN O
memory NN O
, , O
the DT O
initial JJ O
detonator NN O
hands NNS O
over IN O
the DT O
control NN O
to TO O
the DT O
main JJ O
payload NN O
by IN O
invoking VBG O
the DT O
method NN O
XoqF NNP O
( ( O
which WDT O
we PRP O
renamed VBD O
to TO O
triggerInfection NN O
during IN O
analysis NN O
) ) O
from IN O
the DT O
gvmthHtyN NN O
class NN O
( ( O
renamed VBN O
to TO O
PayloadEntry NNP O
) ) O
. . O

Malware NNP O
code NN O
showing VBG O
handover NN O
from IN O
initial JJ O
module NN O
to TO O
main JJ O
payload NN O
Figure NNP O
13 CD O
. . O

Handover NN O
from IN O
initial JJ O
module NN O
to TO O
the DT O
main JJ O
payload NN O
As IN O
mentioned VBN O
, , O
the DT O
initial JJ O
handover NN O
component NN O
called VBN O
triggerInfection NN O
with IN O
an DT O
instance NN O
of IN O
appObj NN O
and CC O
a DT O
method NN O
that WDT O
returns VBZ O
the DT O
value NN O
for IN O
the DT O
variable JJ O
config NN O
. . O

Malware NNP O
code NN O
showing VBG O
definition NN O
of IN O
populateConfigMap JJ O
Figure NNP O
14 CD O
. . O

Definition NN O
of IN O
populateConfigMap NN O
, , O
which WDT O
loads VBZ O
the DT O
map NN O
with IN O
values NNS O
Correlating VBG O
the DT O
last JJ O
two CD O
steps NNS O
, , O
one CD O
can MD O
observe VB O
that IN O
the DT O
malware NN O
payload NN O
receives VBZ O
the DT O
configuration NN O
for IN O
the DT O
following JJ O
properties NNS O
: : O
number NN O
– IN O
The DT O
default NN O
number NN O
to TO O
be VB O
send VBN O
to TO O
the DT O
server NN O
( ( O
in IN O
case NN O
the DT O
number NN O
is VBZ O
not RB O
available JJ O
from IN O
the DT O
device NN O
) ) O
api NN O
– VBD O
The DT O
API NNP O
key JJ O
url JJ O
– IN O
The DT O
URL NNP O
to TO O
be VB O
used VBN O
in IN O
WebView NNP O
to TO O
display VB O
on IN O
the DT O
ransom NN O
note VBP O
The DT O
malware NN O
saves VBZ O
this DT O
configuration NN O
to TO O
the DT O
shared VBN O
preferences NNS O
of IN O
the DT O
app NN O
data NNS O
and CC O
then RB O
it PRP O
sets VBZ O
up RP O
all PDT O
the DT O
Broadcast NNP O
Receivers NNP O
. . O

This DT O
action NN O
registers VBZ O
code JJ O
components NNS O
to TO O
get VB O
notified VBN O
when WRB O
certain JJ O
system NN O
events NNS O
happen VB O
. . O

This DT O
is VBZ O
done VBN O
in IN O
the DT O
function NN O
initComponents NNS O
. . O

Malware NNP O
code NN O
showing VBG O
initializing VBG O
broadcast JJ O
receiver NN O
Figure NNP O
15 CD O
. . O

Initializing VBG O
the DT O
BroadcastReceiver NNP O
against IN O
system NN O
events NNS O
From IN O
this DT O
point NN O
on IN O
, , O
the DT O
malware NN O
execution NN O
is VBZ O
driven VBN O
by IN O
callback NN O
functions NNS O
that WDT O
are VBP O
triggered VBN O
on IN O
system NN O
events NNS O
like IN O
connectivity NN O
change NN O
, , O
unlocking VBG O
the DT O
phone NN O
, , O
elapsed VBD O
time NN O
interval NN O
, , O
and CC O
others NNS O
. . O

Lookout NN B-Organization
researchers NNS O
have VBP O
identified VBN O
a DT O
new JJ O
, , O
highly RB O
targeted VBN O
surveillanceware JJ O
family NN O
known VBN O
as IN O
Desert NNP B-Malware
Scorpion NNP I-Malware
in IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
. . O

Lookout NNP B-Organization
notified VBD O
Google NNP B-Organization
of IN O
the DT O
finding NN O
and CC O
Google NNP B-Organization
removed VBD O
the DT O
app NN O
immediately RB O
while IN O
also RB O
taking VBG O
action NN O
on IN O
it PRP O
in IN O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
. . O

The DT O
app NN O
ties VBZ O
together RB O
two CD O
malware NN O
families NNS O
- : O
Desert NNP B-Malware
Scorpion NNP I-Malware
and CC O
another DT O
targeted VBN O
surveillanceware NN O
family NN O
named VBN O
FrozenCell NNP B-Malware
- : O
that IN O
we PRP O
believe VBP O
are VBP O
being VBG O
developed VBN O
by IN O
a DT O
single JJ O
, , O
evolving VBG O
surveillanceware NN O
actor NN O
called VBD O
APT-C-23 NNP B-Malware
targeting VBG O
individuals NNS O
in IN O
the DT O
Middle NNP O
East NNP O
. . O

We PRP O
've VBP O
seen VBN O
this DT O
actor NN O
rely RB O
heavily RB O
on IN O
phishing VBG O
campaigns NNS O
to TO O
trick VB O
victims NNS O
into IN O
downloading VBG O
their PRP$ O
malicious JJ O
apps NN O
, , O
specifically RB O
on IN O
Facebook NNP B-System
. . O

Even RB O
sophisticated JJ O
actors NNS O
are VBP O
using VBG O
lower JJR O
cost NN O
, , O
less RBR O
technologically RB O
impressive JJ O
means NNS O
like IN O
phishing VBG O
to TO O
spread VB O
their PRP$ O
malware NN O
because IN O
it PRP O
's VBZ O
cheap JJ O
and CC O
very RB O
effective JJ O
, , O
especially RB O
on IN O
mobile JJ O
devices NNS O
where WRB O
there EX O
are VBP O
more JJR O
ways NNS O
to TO O
interact VB O
with IN O
a DT O
victim NN O
( ( O
messaging VBG O
apps RB O
, , O
social JJ O
media NNS O
apps NN O
, , O
etc FW O
. . O

) ) O
, , O
and CC O
less RBR O
screen JJ O
real JJ O
estate NN O
for IN O
victims NNS O
to TO O
identify VB O
potential JJ O
indicators NNS O
of IN O
a DT O
threat NN O
. . O

Lookout IN B-Organization
customers NNS O
are VBP O
protected VBN O
against IN O
this DT O
threat NN O
and CC O
additionally RB O
we PRP O
have VBP O
included VBN O
a DT O
list NN O
of IN O
IOCs NNP O
at IN O
the DT O
end NN O
of IN O
this DT O
report NN O
. . O

The DT O
potential JJ O
actor NN O
and CC O
who WP O
they PRP O
target VBP O
Our PRP$ O
current JJ O
analysis NN O
strongly RB O
suggests VBZ O
Desert NNP B-Malware
Scorpion NNP I-Malware
is VBZ O
being VBG O
deployed VBN O
in IN O
targeted JJ O
attacks NNS O
against IN O
Middle NNP O
Eastern NNP O
individuals NNS O
of IN O
interest NN O
specifically RB O
those DT O
in IN O
Palestine NNP O
and CC O
has VBZ O
also RB O
been VBN O
highlighted VBN O
by IN O
other JJ O
researchers NNS O
. . O

We PRP O
have VBP O
been VBN O
able JJ O
to TO O
tie VB O
the DT O
malware NN O
to TO O
a DT O
long-running JJ O
Facebook NNP B-Organization
profile NN O
that IN O
we PRP O
observed VBD O
promoting VBG O
the DT O
first JJ O
stage NN O
of IN O
this DT O
family NN O
, , O
a DT O
malicious JJ O
chat NN O
application NN O
called VBN O
Dardesh NNP B-Malware
via IN O
links NNS O
to TO O
Google NNP B-System
Play NNP I-System
. . O

The DT O
Lookout NNP B-Organization
Threat NNP I-Organization
Intelligence NNP I-Organization
team NN O
identified VBD O
that IN O
this DT O
same JJ O
Facebook NNP B-Organization
profile NN O
has VBZ O
also RB O
posted VBN O
Google NNP B-System
Drive NNP I-System
links NNS O
to TO O
Android NNP B-System
malware NN O
belonging VBG O
to TO O
the DT O
FrozenCell NNP B-Malware
family NN O
attributed VBD O
to TO O
APT-C-27 NNP B-Indicator
. . O

These DT O
factors NNS O
, , O
in IN O
combination NN O
with IN O
the DT O
fact NN O
that IN O
the DT O
command NN O
and CC O
control NN O
infrastructure NN O
used VBN O
by IN O
Frozen NNP B-Malware
Cell NNP I-Malware
and CC O
Desert NNP B-Malware
Scorpion NNP I-Malware
resides VBZ O
in IN O
similar JJ O
IP NNP O
blocks NNS O
, , O
supports VBZ O
the DT O
theory NN O
that IN O
the DT O
same JJ O
actor NN O
is VBZ O
responsible JJ O
for IN O
operating NN O
, , O
if IN O
not RB O
developing VBG O
, , O
both DT O
families NNS O
. . O

What WP O
it PRP O
does VBZ O
The DT O
surveillance NN O
functionality NN O
of IN O
Desert NNP B-Malware
Scorpion NNP I-Malware
resides VBZ O
in IN O
a DT O
second JJ O
stage NN O
payload NN O
that WDT O
can MD O
only RB O
be VB O
downloaded VBN O
if IN O
the DT O
victim NN O
has VBZ O
downloaded VBN O
, , O
installed VBN O
, , O
and CC O
interacted VBN O
with IN O
the DT O
first-stage NN O
chat DT O
application NN O
. . O

The DT O
chat NN O
application NN O
acts VBZ O
as IN O
a DT O
dropper NN O
for IN O
this DT O
second-stage JJ O
payload NN O
app NN O
. . O

At IN O
the DT O
time NN O
of IN O
writing VBG O
Lookout NNP B-Organization
has VBZ O
observed VBN O
two CD O
updates NNS O
to TO O
the DT O
Dardesh NNP B-Malware
application NN O
, , O
the DT O
first JJ O
on IN O
February NNP O
26 CD O
and CC O
the DT O
second JJ O
on IN O
March NNP O
28 CD O
. . O

The DT O
malicious JJ O
capabilities NNS O
observed VBN O
in IN O
the DT O
second JJ O
stage NN O
include VBP O
the DT O
following JJ O
: : O
Upload JJ O
attacker-specified JJ O
files NNS O
to TO O
C2 NNP O
servers NNS O
Get NNP O
list NN O
of IN O
installed JJ O
applications NNS O
Get VBP O
device JJ O
metadata NNS O
Inspect NNP O
itself PRP O
to TO O
get VB O
a DT O
list NN O
of IN O
launchable JJ O
activities NNS O
Retrieves VBZ O
PDF NNP O
, , O
txt NN O
, , O
doc NN O
, , O
xls NNP O
, , O
xlsx NNP O
, , O
ppt NN O
, , O
pptx NN O
files NNS O
found VBN O
on IN O
external JJ O
storage NN O
Send NNP O
SMS NNP O
Retrieve NNP O
text NN O
messages NNS O
Track NNP O
device NN O
location NN O
Handle NNP O
limited VBD O
attacker NN O
commands NNS O
via IN O
out IN O
of IN O
band NN O
text NN O
messages NNS O
Record NNP O
surrounding VBG O
audio JJ O
Record NNP O
calls VBZ O
Record NNP O
video NN O
Retrieve NNP O
account NN O
information NN O
such JJ O
as IN O
email NN O
addresses NNS O
Retrieve NNP O
contacts VBZ O
Removes NNP O
copies NNS O
of IN O
itself PRP O
if IN O

any DT O
additional JJ O
APKs NNP O
are VBP O
downloaded VBN O
to TO O
external JJ O
storage NN O
. . O

Call VB O
an DT O
attacker-specified JJ O
number NN O
Uninstall NNP O
apps RB O
Check NNP O
if IN O
a DT O
device NN O
is VBZ O
rooted VBN O
Hide NNP O
its PRP$ O
icon NN O
Retrieve NNP O
list NN O
of IN O
files NNS O
on IN O
external JJ O
storage NN O
If IN O
running VBG O
on IN O
a DT O
Huawei NNP O
device NN O
it PRP O
will MD O
attempt VB O
to TO O
add VB O
itself PRP O
to TO O
the DT O
protected JJ O
list NN O
of IN O
apps NN O
able JJ O
to TO O
run VB O
with IN O
the DT O
screen NN O
off RP O
Encrypts NNP O
some DT O
exfiltrated VBD O
data NNS O
Desert NNP B-Malware
Scorpion NNP I-Malware
's POS O
second JJ O
stage NN O
masquerades NNS O
as IN O
a DT O
generic JJ O
" NN O
settings NNS O
'' '' O
application NN O
. . O

Curiously RB O
, , O
several JJ O
of IN O
these DT O
have VBP O
included VBN O
the DT O
world NN O
" NN O
Fateh NNP O
'' '' O
in IN O
their PRP$ O
package NN O
name NN O
, , O
which WDT O
may MD O
be VB O
referring VBG O
to TO O
the DT O
Fatah NNP B-Organization
political JJ O
party NN O
. . O

Such JJ O
references NNS O
would MD O
be VB O
in IN O
line NN O
with IN O
FrozenCell NNP B-Malware
's POS O
phishing VBG O
tactics NNS O
in IN O
which WDT O
they PRP O
used VBD O
file NN O
names NNS O
to TO O
lure VB O
people NNS O
associated VBN O
with IN O
the DT O
political JJ O
party NN O
to TO O
open VB O
malicious JJ O
documents NNS O
. . O

Desert NNP B-Malware
Scorpion NNP I-Malware
's POS O
second JJ O
stage NN O
is VBZ O
capable JJ O
of IN O
installing VBG O
another DT O
non-malicious JJ O
application NN O
( ( O
included VBN O
in IN O
the DT O
second JJ O
stage NN O
) ) O
which WDT O
is VBZ O
highly RB O
specific JJ O
to TO O
the DT O
Fatah NNP B-Organization
political JJ O
party NN O
and CC O
supports VBZ O
the DT O
targeting VBG O
theory NN O
. . O

The DT O
Lookout NNP B-Organization
Threat NNP I-Organization
Intelligence NNP I-Organization
team NN O
is VBZ O
increasingly RB O
seeing VBG O
the DT O
same JJ O
tradecraft NN O
, , O
tactics NNS O
, , O
and CC O
procedures NNS O
that IN O
APT-C-23 NNP B-Malware
favors NNS O
being VBG O
used VBN O
by IN O
other JJ O
actors NNS O
. . O

The DT O
approach NN O
of IN O
separating VBG O
malicious JJ O
functionality NN O
out IN O
into IN O
separate JJ O
stages NNS O
that WDT O
are VBP O
later RB O
downloaded VBN O
during IN O
execution NN O
and CC O
not RB O
present JJ O
in IN O
the DT O
initial JJ O
app NN O
published VBN O
to TO O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
, , O
combined VBN O
with IN O
social JJ O
engineering NN O
delivered VBN O
via IN O
social JJ O
media NNS O
platforms NNS O
like IN O
Facebook NNP B-Organization
, , O
requires VBZ O
minimal JJ O
investment NN O
in IN O
comparison NN O
to TO O
premium VB O
tooling VBG O
like IN O
Pegasus NNP B-Malware
or CC O
FinFisher NNP B-Malware
. . O

As IN O
we PRP O
've VBP O
seen VBN O
with IN O
actors NNS O
like IN O
Dark NNP B-Malware
Caracal NNP I-Malware
, , O
this DT O
low JJ O
cost NN O
, , O
low JJ O
sophistication NN O
approach NN O
that WDT O
relies VBZ O
heavily RB O
upon JJ O
social JJ O
engineering NN O
has VBZ O
still RB O
been VBN O
shown VBN O
to TO O
be VB O
highly RB O
successful JJ O
for IN O
those DT O
operating NN O
such JJ O
campaigns NNS O
. . O

Given VBN O
previous JJ O
operational JJ O
security NN O
errors NNS O
from IN O
this DT O
actor NN O
in IN O
the DT O
past NN O
which WDT O
resulted VBD O
in IN O
exfiltrated JJ O
content NN O
being VBG O
publicly RB O
accessible JJ O
Lookout NNP B-Organization
Threat NNP I-Organization
Intelligence NNP I-Organization
is VBZ O
continuing VBG O
to TO O
map VB O
out RP O
infrastructure NN O
and CC O
closely RB O
monitor VB O
their PRP$ O
continued JJ O
evolution NN O
. . O

Virulent NNP B-Malware
Android NNP B-System
malware NN O
returns NNS O
, , O
gets VBZ O
> $ O
2 CD O
million CD O
downloads NNS O
on IN O
Google NNP B-System
Play NNP I-System
HummingWhale NNP B-Malware
is VBZ O
back RB O
with IN O
new JJ O
tricks NNS O
, , O
including VBG O
a DT O
way NN O
to TO O
gin VB O
user JJ O
ratings NNS O
. . O

DAN NNP O
GOODIN NNP O
- : O
1/23/2017 CD O
, , O
4:39 CD O
PM NNP O
A NNP O
virulent JJ B-Malware
family NN O
of IN O
malware NN O
that WDT O
infected VBD O
more JJR O
than IN O
10 CD O
million CD O
Android NNP B-System
devices NNS O
last JJ O
year NN O
has VBZ O
made VBN O
a DT O
comeback NN O
, , O
this DT O
time NN O
hiding VBG O
inside RB O
Google NNP B-System
Play NNP I-System
apps VBP O
that WDT O
have VBP O
been VBN O
downloaded VBN O
by IN O
as RB O
many JJ O
as IN O
12 CD O
million CD O
unsuspecting JJ O
users NNS O
. . O

HummingWhale NNP B-Malware
, , O
as IN O
the DT O
professionally RB O
developed VBN O
malware NN O
has VBZ O
been VBN O
dubbed VBN O
, , O
is VBZ O
a DT O
variant NN O
of IN O
HummingBad NNP B-Malware
, , O
the DT O
name NN O
given VBN O
to TO O
a DT O
family NN O
of IN O
malicious JJ O
apps NN O
researchers NNS O
documented VBD O
in IN O
July NNP O
invading VBG O
non-Google JJ O
app NN O
markets NNS O
. . O

HummingBad NNP B-Malware
attempted VBD O
to TO O
override VB O
security NN O
protections NNS O
by IN O
exploiting VBG O
unpatched JJ B-Vulnerability
vulnerabilities NNS I-Vulnerability
that WDT O
gave VBD O
the DT O
malware NN O
root NN O
privileges NNS O
in IN O
older JJR O
versions NNS O
of IN O
Android NNP B-System
. . O

Before IN O
Google NNP B-Organization
shut VBD O
it PRP O
down RP O
, , O
it PRP O
installed VBD O
more JJR O
than IN O
50,000 CD O
fraudulent JJ O
apps NNS O
each DT O
day NN O
, , O
displayed VBD O
20 CD O
million CD O
malicious JJ O
advertisements NNS O
, , O
and CC O
generated VBD O
more JJR O
than IN O
$ $ O
300,000 CD O
per IN O
month NN O
in IN O
revenue NN O
. . O

Of IN O
the DT O
10 CD O
million CD O
people NNS O
who WP O
downloaded VBD O
HummingBad-contaminated NNP B-Malware
apps NN O
, , O
an DT O
estimated JJ O
286,000 CD O
of IN O
them PRP O
were VBD O
located VBN O
in IN O
the DT O
US NNP O
. . O

HummingWhale NNP B-Malware
, , O
by IN O
contrast NN O
, , O
managed VBD O
to TO O
sneak VB O
its PRP$ O
way NN O
into IN O
about IN O
20 CD O
Google NNP B-System
Play NNP I-System
apps VBZ O
that WDT O
were VBD O
downloaded VBN O
from IN O
2 CD O
million CD O
to TO O
12 CD O
million CD O
times NNS O
, , O
according VBG O
to TO O
researchers NNS O
from IN O
Check NNP B-Organization
Point NNP I-Organization
, , O
the DT O
security NN O
company NN O
that WDT O
has VBZ O
been VBN O
closely RB O
following VBG O
the DT O
malware JJ O
family NN O
for IN O
almost RB O
a DT O
year NN O
. . O

Rather RB O
than IN O
rooting VBG O
devices NNS O
, , O
the DT O
latest JJS O
variant NN O
includes VBZ O
new JJ O
virtual JJ O
machine NN O
techniques NNS O
that WDT O
allow VBP O
the DT O
malware NN O
to TO O
perform VB O
ad NN O
fraud NN O
better RBR O
than IN O
ever RB O
, , O
company NN O
researchers NNS O
said VBD O
in IN O
a DT O
blog NN O
post NN O
published VBN O
Monday NNP O
. . O

" JJ O
Users NNS O
must MD O
realize VB O
that IN O
they PRP O
can MD O
no RB O
longer RB O
trust VB O
in IN O
installing VBG O
only RB O
apps RB O
with IN O
a DT O
high JJ O
reputation NN O
from IN O
official JJ O
app NN O
stores NNS O
as IN O
their PRP$ O
sole NN O
defense NN O
, , O
'' '' O
the DT O
researchers NNS O
wrote VBD O
in IN O
an DT O
e-mail JJ O
to TO O
Ars NNP B-Organization
. . O

" NN O
This DT O
malware NN O
employs VBZ O
several JJ O
tactics NNS O
to TO O
keep VB O
its PRP$ O
activity NN O
hidden NN O
, , O
meaning VBG O
users NNS O
might MD O
be VB O
unaware JJ O
of IN O
its PRP$ O
existence NN O
on IN O
their PRP$ O
device NN O
. . O

'' '' O
As IN O
was VBD O
the DT O
case NN O
with IN O
HummingBad NNP B-Malware
, , O
the DT O
purpose NN O
of IN O
HummingWhale NNP B-Malware
is VBZ O
to TO O
generate VB O
revenue NN O
by IN O
displaying VBG O
fraudulent JJ O
ads NNS O
and CC O
automatically RB O
installing JJ O
apps NN O
. . O

When WRB O
users NNS O
try VBP O
to TO O
close VB O
the DT O
ads NNS O
, , O
the DT O
new JJ O
functionality NN O
causes VBZ O
already RB O
downloaded VBN O
apps NN O
to TO O
run VB O
in IN O
a DT O
virtual JJ O
machine NN O
. . O

That DT O
creates VBZ O
a DT O
fake JJ O
ID NNP O
that WDT O
allows VBZ O
the DT O
perpetrators NNS O
to TO O
generate VB O
referral JJ O
revenues NNS O
. . O

Use NNP O
of IN O
the DT O
virtual JJ O
machine NN O
brings VBZ O
many JJ O
technical JJ O
benefits NNS O
to TO O
the DT O
operators NNS O
, , O
chief NN O
among IN O
them PRP O
allowing VBG O
the DT O
malware NN O
to TO O
install VB O
apps NN O
without IN O
requiring VBG O
users NNS O
to TO O
approve VB O
a DT O
list NN O
of IN O
elevated JJ O
permissions NNS O
. . O

Advertisement NNP O
The DT O
VM NNP O
also RB O
disguises VBZ O
the DT O
malicious JJ O
activity NN O
, , O
making VBG O
it PRP O
easier JJR O
for IN O
the DT O
apps NN O
to TO O
infiltrate VB O
Google NNP B-System
Play NNP I-System
. . O

It PRP O
has VBZ O
the DT O
added JJ O
benefit NN O
of IN O
installing VBG O
a DT O
nearly RB O
unlimited JJ O
number NN O
of IN O
fraudulent JJ O
apps NN O
without IN O
overloading VBG O
the DT O
infected JJ O
device NN O
. . O

Until IN O
now RB O
, , O
Android NNP B-System
malware NN O
that WDT O
wanted VBD O
advanced JJ O
capabilities NNS O
typically RB O
had VBD O
to TO O
trick VB O
users NNS O
into IN O
approving VBG O
sometimes RB O
scary-sounding JJ O
permissions NNS O
or CC O
exploit VB O
rooting VBG O
vulnerabilities NNS O
. . O

Ginning VBG O
the DT O
ratings NNS O
FURTHER NNP O
READING VBD O
1 CD O
million CD O
Google NNP B-Organization
accounts NNS O
compromised VBN O
by IN O
Android NNP B-System
malware NN O
called VBN O
Gooligan NNP B-Malware
To TO O
implement VB O
the DT O
VM NNP O
feature NN O
, , O
the DT O
malicious JJ O
APK NNP O
installation NN O
dropper NN O
used VBN O
by IN O
HummingWhale NNP B-Malware
uses NNS O
DroidPlugin NNP B-Malware
, , O
an DT O
extension NN O
originally RB O
developed VBN O
by IN O
developers NNS O
from IN O
China-based JJ O
company NN O
Qihoo NNP B-Organization
360 CD I-Organization
, , O
Check NNP B-Organization
Point NNP I-Organization
said VBD O
. . O

HummingWhale NNP B-Malware
has VBZ O
also RB O
been VBN O
observed VBN O
hiding VBG O
the DT O
original JJ O
malicious JJ O
app NN O
once IN O
it PRP O
's VBZ O
installed VBN O
and CC O
trying VBG O
to TO O
improve VB O
its PRP$ O
Google NNP B-System
Play NNP I-System
reputation NN O
by IN O
automatically RB O
generating VBG O
posts NNS O
disguised VBD O
as IN O
positive JJ O
user NN O
comments NNS O
and CC O
ratings NNS O
. . O

Gooligan NNP B-Malware
, , O
a DT O
family NN O
of IN O
Android NNP B-System
malware NN O
that WDT O
came VBD O
to TO O
light NN O
in IN O
November NNP O
after IN O
it PRP O
compromised VBD O
more JJR O
than IN O
1 CD O
million CD O
Google NNP B-Organization
accounts NNS O
, , O
contained VBD O
similar JJ O
abilities NNS O
to TO O
tamper VB O
with IN O
Google NNP B-System
Play NNP I-System
ratings NNS O
. . O

People NNS O
who WP O
want VBP O
to TO O
know VB O
if IN O
their PRP$ O
Android NNP B-System
devices NNS O
are VBP O
infected VBN O
can MD O
download VB O
the DT O
Check NNP B-Organization
Point NNP I-Organization
app NN O
here RB O
. . O

A DT O
separate JJ O
app NN O
from IN O
Check NNP B-Organization
Point NNP I-Organization
competitor NN O
Lookout NNP B-Organization
also RB O
detects VBZ O
the DT O
threat NN O
as IN O
a DT O
variant NN O
of IN O
the DT O
Shedun NNP B-Malware
malware NN O
family NN O
. . O

More RBR O
technically RB O
inclined JJ O
people NNS O
can MD O
detect VB O
infections NNS O
by IN O
seeing VBG O
if IN O
a DT O
device NN O
connects VBZ O
to TO O
a DT O
control NN O
server NN O
located VBN O
at IN O
app.blinkingcamera.com NN B-Indicator
. . O

Package NN O
names NNS O
for IN O
infected JJ O
apps NN O
typically RB O
contain VBP O
a DT O
common JJ O
naming NN O
structure NN O
that WDT O
includes VBZ O
com.XXXXXXXXX.camera NN B-Indicator
, , O
for IN O
example NN O
com.bird.sky.whale.camera NN B-Indicator
( ( O
app JJ O
name NN O
: : O
Whale NNP B-System
Camera NNP I-System
) ) O
, , O
com.color.rainbow.camera NN B-Indicator
( ( O
Rainbow NNP B-System
Camera NNP I-System
) ) O
, , O
and CC O
com.fishing.when.orangecamera NN B-Indicator
( ( O
Orange NNP B-System
Camera NNP I-System
) ) O
. . O

Google NNP B-Organization
officials NNS O
removed VBD O
the DT O
malicious JJ O
apps NN O
from IN O
the DT O
Play NNP B-System
market NN I-System
after IN O
receiving VBG O
a DT O
private JJ O
report NN O
of IN O
their PRP$ O
existence NN O
. . O

A DT O
company NN O
representative NN O
declined VBD O
to TO O
comment VB O
for IN O
this DT O
post NN O
. . O

BusyGasper NNP B-Malware
– VBZ O
the DT O
unfriendly JJ O
spy JJ O
29 CD O
AUG NNP O
2018 CD O
In IN O
early JJ O
2018 CD O
our PRP$ O
mobile JJ O
intruder-detection NN O
technology NN O
was VBD O
triggered VBN O
by IN O
a DT O
suspicious JJ O
Android NNP B-System
sample NN O
that WDT O
, , O
as IN O
it PRP O
turned VBD O
out RP O
, , O
belonged VBD O
to TO O
an DT O
unknown JJ O
spyware NN O
family NN O
. . O

Further JJ O
investigation NN O
showed VBD O
that IN O
the DT O
malware NN O
, , O
which WDT O
we PRP O
named VBD O
BusyGasper NNP B-Malware
, , O
is VBZ O
not RB O
all PDT O
that IN O
sophisticated JJ O
, , O
but CC O
demonstrates VBZ O
some DT O
unusual JJ O
features NNS O
for IN O
this DT O
type NN O
of IN O
threat NN O
. . O

From IN O
a DT O
technical JJ O
point NN O
of IN O
view NN O
, , O
the DT O
sample NN O
is VBZ O
a DT O
unique JJ O
spy NN O
implant NN O
with IN O
stand-out JJ O
features NNS O
such JJ O
as IN O
device NN O
sensors NNS O
listeners NNS O
, , O
including VBG O
motion NN O
detectors NNS O
that WDT O
have VBP O
been VBN O
implemented VBN O
with IN O
a DT O
degree NN O
of IN O
originality NN O
. . O

It PRP O
has VBZ O
an DT O
incredibly RB O
wide-ranging NN O
protocol NN O
– NN O
about IN O
100 CD O
commands NNS O
– JJ O
and CC O
an DT O
ability NN O
to TO O
bypass VB O
the DT O
Doze NNP O
battery NN O
saver NN O
. . O

As IN O
a DT O
modern JJ O
Android NNP O
spyware NN O
it PRP O
is VBZ O
also RB O
capable JJ O
of IN O
exfiltrating VBG O
data NNS O
from IN O
messaging VBG O
applications NNS O
( ( O
WhatsApp NNP B-System
, , O
Viber NNP B-System
, , O
Facebook NNP B-System
) ) O
. . O

Moreover RB O
, , O
BusyGasper NNP B-Malware
boasts VBZ O
some DT O
keylogging NN O
tools NNS O
– VBP O
the DT O
malware NN O
processes VBZ O
every DT O
user NN O
tap NN O
, , O
gathering VBG O
its PRP$ O
coordinates NNS O
and CC O
calculating VBG O
characters NNS O
by IN O
matching VBG O
given VBN O
values NNS O
with IN O
hardcoded JJ O
ones NNS O
. . O

The DT O
sample NN O
has VBZ O
a DT O
multicomponent NN O
structure NN O
and CC O
can MD O
download VB O
a DT O
payload NN O
or CC O
updates NNS O
from IN O
its PRP$ O
C NNP O
& CC O
C NNP O
server NN O
, , O
which WDT O
happens VBZ O
to TO O
be VB O
an DT O
FTP NNP O
server NN O
belonging NN O
to TO O
the DT O
free JJ O
Russian JJ O
web NN O
hosting VBG O
service NN O
Ucoz NNP O
. . O

It PRP O
is VBZ O
noteworthy JJ O
that IN O
BusyGasper NNP B-Malware
supports VBZ O
the DT O
IRC NNP O
protocol NN O
which WDT O
is VBZ O
rarely RB O
seen VBN O
among IN O
Android NNP B-System
malware NN O
. . O

In IN O
addition NN O
, , O
the DT O
malware NN O
can MD O
log VB O
in IN O
to TO O
the DT O
attacker NN O
’ NNP O
s NN O
email NN O
inbox NN O
, , O
parse NN O
emails NNS O
in IN O
a DT O
special JJ O
folder NN O
for IN O
commands NNS O
and CC O
save VB O
any DT O
payloads NNS O
to TO O
a DT O
device NN O
from IN O
email JJ O
attachments NNS O
. . O

This DT O
particular JJ O
operation NN O
has VBZ O
been VBN O
active JJ O
since IN O
approximately RB O
May NNP O
2016 CD O
up IN O
to TO O
the DT O
present JJ O
time NN O
. . O

Infection NNP O
vector NN O
and CC O
victims NNS O
While IN O
looking VBG O
for IN O
the DT O
infection NN O
vector NN O
, , O
we PRP O
found VBD O
no DT O
evidence NN O
of IN O
spear JJ O
phishing NN O
or CC O
any DT O
of IN O
the DT O
other JJ O
common JJ O
vectors NNS O
. . O

But CC O
some DT O
clues NNS O
, , O
such JJ O
as IN O
the DT O
existence NN O
of IN O
a DT O
hidden JJ O
menu NN O
for IN O
operator NN O
control NN O
, , O
point NN O
to TO O
a DT O
manual JJ O
installation NN O
method NN O
– VBD O
the DT O
attackers NNS O
used VBD O
physical JJ O
access NN O
to TO O
a DT O
victim NN O
’ NN O
s JJ O
device NN O
to TO O
install VB O
the DT O
malware NN O
. . O

This DT O
would MD O
explain VB O
the DT O
number NN O
of IN O
victims NNS O
– IN O
there EX O
are VBP O
less JJR O
than IN O
10 CD O
of IN O
them PRP O
and CC O
according VBG O
to TO O
our PRP$ O
detection NN O
statistics NNS O
, , O
they PRP O
are VBP O
all DT O
located VBN O
in IN O
the DT O
Russia NNP O
. . O

Intrigued VBN O
, , O
we PRP O
continued VBD O
our PRP$ O
search NN O
and CC O
found VBD O
more JJR O
interesting JJ O
clues NNS O
that WDT O
could MD O
reveal VB O
some DT O
detailed JJ O
information NN O
about IN O
the DT O
owners NNS O
of IN O
the DT O
infected JJ O
devices NNS O
. . O

Several JJ O
TXT NNP O
files NNS O
with IN O
commands NNS O
on IN O
the DT O
attacker NN O
’ NNP O
s NN O
FTP NNP O
server NN O
contain VBP O
a DT O
victim NN O
identifier NN O
in IN O
the DT O
names NNS O
that WDT O
was VBD O
probably RB O
added VBN O
by IN O
the DT O
criminals NNS O
: : O
CMDS10114-Sun1.txt JJ B-Indicator
CMDS10134-Ju_ASUS.txt JJ B-Indicator
CMDS10134-Tad.txt JJ B-Indicator
CMDS10166-Jana.txt JJ B-Indicator
CMDS10187-Sun2.txt JJ B-Indicator
CMDS10194-SlavaAl.txt NNP B-Indicator
CMDS10209-Nikusha.txt NNP B-Indicator
Some DT O
of IN O
them PRP O
sound VBP O
like IN O
Russian JJ O
names NNS O
: : O
Jana NNP O
, , O
SlavaAl NNP O
, , O
Nikusha NNP O
. . O

As IN O
we PRP O
know VBP O
from IN O
the DT O
FTP NNP O
dump NN O
analysis NN O
, , O
there EX O
was VBD O
a DT O
firmware JJ O
component NN O
from IN O
ASUS NNP B-Organization
firmware NN O
, , O
indicating VBG O
the DT O
attacker NN O
’ NNP O
s NN O
interest NN O
in IN O
ASUS NNP B-Organization
devices NNS O
, , O
which WDT O
explains VBZ O
the DT O
victim NN O
file NN O
name NN O
that WDT O
mentions NNS O
“ VBP O
ASUS NNP O
” NNP O
. . O

Information NN O
gathered VBN O
from IN O
the DT O
email NN O
account NN O
provides VBZ O
a DT O
lot NN O
of IN O
the DT O
victims NNS O
’ VBP O
personal JJ O
data NNS O
, , O
including VBG O
messages NNS O
from IN O
IM NNP O
applications NNS O
. . O

Gathered VBN O
file NN O
Type NNP O
Description NNP O
lock NN O
Text NNP O
Implant NNP O
log NN O
ldata NN O
sqlite3 NN O
Location NNP O
data NNS O
based VBN O
on IN O
network NN O
( ( O
cell_id NN O
) ) O
gdata NN O
sqlite3 NN O
Location NNP O
data NNS O
based VBN O
on IN O
GPS NNP O
coordinates NNS O
sdata VBP B-Indicator
sqlite3 JJ I-Indicator
SMS NNP O
messages NNS O
f.db VBP B-Indicator
sqlite3 JJ I-Indicator
Facebook NNP B-System
messages NNS O
v.db VBP B-Indicator
sqlite3 JJ I-Indicator
Viber NNP B-System
messages NNS O
w.db VBP B-Indicator
sqlite3 JJ I-Indicator
WhatsApp NNP B-System
messages NNS O
Among IN O
the DT O
other JJ O
data NNS O
gathered VBN O
were VBD O
SMS NNP O
banking NN O
messages NNS O
that WDT O
revealed VBD O
an DT O
account NN O
with IN O
a DT O
balance NN O
of IN O
more JJR O
than IN O
US NNP O
$ $ O
10,000.But CD O
as RB O
far RB O
as IN O
we PRP O
know VBP O
, , O
the DT O
attacker NN O
behind IN O
this DT O
campaign NN O
is VBZ O
not RB O
interested JJ O
in IN O
stealing VBG O
the DT O
victims NNS O
’ VBP O
money NN O

. . O

We PRP O
found VBD O
no DT O
similarities NNS O
to TO O
commercial JJ O
spyware NN O
products NNS O
or CC O
to TO O
other JJ O
known VBN O
spyware JJ O
variants NNS O
, , O
which WDT O
suggests VBZ O
BusyGasper NNP B-Malware
is VBZ O
self-developed JJ O
and CC O
used VBN O
by IN O
a DT O
single JJ O
threat NN O
actor NN O
. . O

At IN O
the DT O
same JJ O
time NN O
, , O
the DT O
lack NN O
of IN O
encryption NN O
, , O
use NN O
of IN O
a DT O
public JJ O
FTP NNP O
server NN O
and CC O
the DT O
low JJ O
opsec NN O
level NN O
could MD O
indicate VB O
that IN O
less JJR O
skilled JJ O
attackers NNS O
are VBP O
behind IN O
the DT O
malware NN O
. . O

Technical NNP O
details NNS O
Here RB O
is VBZ O
the DT O
meta NN O
information NN O
for IN O
the DT O
observed JJ O
samples NNS O
, , O
certificates NNS O
and CC O
hardcoded VBD O
version NN O
stamps NNS O
: : O
Certificate NNP O
MD5 NNP O
Module NNP O
Version NNP O
Serial NNP O
Number NNP O
: : O
0x76607c02 CD B-Indicator
Issuer NN O
: : O
CN=Ron NNP O
Validity NNP O
: : O
from IN O
= NNP O
Tue NNP O
Aug NNP O
30 CD O
13:01:30 CD O
MSK NN O
2016 CD O
to TO O
= VB O
Sat NNP O
Aug NNP O
24 CD O
13:01:30 CD O
MSK NNP O
2041 CD O
Subject NNP O
: : O
CN=Ron NNP O
9e005144ea1a583531f86663a5f14607 CD B-Indicator
1 CD O
– NN O
18abe28730c53de6d9e4786c7765c3d8 CD B-Indicator
2 CD O
2.0 CD O

Serial JJ O
Number NNP O
: : O
0x6a0d1fec CD B-Indicator
Issuer NN O
: : O
CN=Sun JJ O
Validity NN O
: : O
from IN O
= NNP O
Mon NNP O
May NNP O
16 CD O
17:42:40 CD O
MSK NN O
2016 CD O
to TO O
= VB O
Fri NNP O
May NNP O
10 CD O
17:42:40 CD O
MSK NNP O
2041 CD O
Subject NNP O
: : O
CN=Sun NNP O
9ffc350ef94ef840728564846f2802b0 CD B-Indicator
2 CD O
v2.51sun NN O
6c246bbb40b7c6e75c60a55c0da9e2f2 CD B-Indicator
2 CD O
v2.96s NN O
7c8a12e56e3e03938788b26b84b80bd6 CD B-Indicator
2 CD O
v3.09s NN O

bde7847487125084f9e03f2b6b05adc3 NN B-Indicator
2 CD O
v3.12s NN O
2560942bb50ee6e6f55afc495d238a12 CD B-Indicator
2 CD O
v3.18s NN O
It PRP O
’ VBZ O
s JJ O
interesting VBG O
that IN O
the DT O
issuer NN O
“ NNP O
Sun NNP O
” NN O
matches VBZ O
the DT O
“ NNP O
Sun1 NNP O
” NNP O
and CC O
“ NNP O
Sun2 NNP O
” NNP O
identifiers NNS O
of IN O
infected JJ O
devices NNS O
from IN O
the DT O
FTP NNP O
server NN O
, , O
suggesting VBG O
they PRP O
may MD O
be VB O
test JJ O
devices NNS O
. . O

The DT O
analyzed JJ O
implant NN O
has VBZ O
a DT O
complex JJ O
structure NN O
, , O
and CC O
for IN O
now RB O
we PRP O
have VBP O
observed VBN O
two CD O
modules NNS O
. . O

First NNP O
( ( O
start NN O
) ) O
module NN O
The DT O
first JJ O
module NN O
, , O
which WDT O
was VBD O
installed VBN O
on IN O
the DT O
targeted JJ O
device NN O
, , O
could MD O
be VB O
controlled VBN O
over IN O
the DT O
IRC NNP O
protocol NN O
and CC O
enable JJ O
deployment NN O
of IN O
other JJ O
components NNS O
by IN O
downloading VBG O
a DT O
payload NN O
from IN O
the DT O
FTP NNP O
server NN O
: : O
@ JJ O
install NN O
command NN O
As IN O
can MD O
be VB O
seen VBN O
from IN O
the DT O
screenshot NN O
above IN O
, , O
a DT O
new JJ O
component NN O
was VBD O
copied VBN O
in IN O
the DT O
system NN O
path NN O
, , O
though IN O
that DT O
sort NN O
of IN O
operation NN O
is VBZ O
impossible JJ O
without IN O
root NN O
privileges NNS O
. . O

At IN O
the DT O
time NN O
of IN O
writing VBG O
we PRP O
had VBD O
no DT O
evidence NN O
of IN O
an DT O
exploit NN O
being VBG O
used VBN O
to TO O
obtain VB O
root JJ O
privileges NNS O
, , O
though IN O
it PRP O
is VBZ O
possible JJ O
that IN O
the DT O
attackers NNS O
used VBD O
some DT O
unseen JJ O
component NN O
to TO O
implement VB O
this DT O
feature NN O
. . O

Here RB O
is VBZ O
a DT O
full JJ O
list NN O
of IN O
possible JJ O
commands NNS O
that WDT O
can MD O
be VB O
executed VBN O
by IN O
the DT O
first JJ O
module NN O
: : O
Command NNP O
name NN O
Description NNP O
@ NNP O
stop VB O
Stop NNP O
IRC NNP O
@ NNP O
quit NN O
System.exit NNP B-Indicator
( ( I-Indicator
0 CD I-Indicator
) ) I-Indicator
@ FW O
start JJ O
Start NNP O
IRC NNP O
@ NNP O
server NN O
Set NNP O
IRC NNP O
server NN O
( ( O
default NN O
value NN O
is VBZ O
“ JJ O
irc.freenode.net JJ B-Indicator
” NN O
) ) O
, , O
port NN O
is VBZ O
always RB O
6667 CD O
@ JJ O
boss NN O
Set NNP O
IRC NNP O
command NN O
and CC O
control NN O
nickname NN O
( ( O
default NN O
value NN O
is VBZ O
“ JJ O
ISeency NNP O
” NNP O
) ) O
@ VBP O
nick JJ O
Set NNP O
IRC NNP O
client NN O
nickname NN O
@ NNP O
screen JJ O
Report NNP O
every DT O
time NN O
when WRB O
screen NN O
is VBZ O
on IN O
( ( O
enable/disable JJ O
) ) O
@ VBP O
root NN O
Use NNP O
root NN O
features NNS O
( ( O
enable/disable JJ O
) ) O
@ FW O
timer NN O
Set NNP O

period NN O
of IN O
IRCService NNP O
start VBP O
@ NNP O
hide NN O
Hide NNP O
implant JJ O
icon NN O
@ NNP O
unhide JJ O
Unhide NNP O
implant NN O
icon NN O
@ NNP O
run VB O
Execute NNP O
specified VBN O
shell NN O
@ NNP O
broadcast NN O
Send NNP O
command NN O
to TO O
the DT O
second JJ O
module NN O
@ NNP O
echo VBZ O
Write NNP O
specified JJ O
message NN O
to TO O
log VB O
@ NNP O
install VB O
Download NNP O
and CC O
copy NN O
specified VBN O
component NN O
to TO O
the DT O
system NN O
path VBZ O
The DT O
implant JJ O
uses VBZ O
a DT O
complex JJ O
intent-based JJ O
communication NN O
mechanism NN O
between IN O
its PRP$ O
components NNS O
to TO O
broadcast VB O
commands NNS O
: : O
Approximate NNP O
graph NN O
of IN O
relationships NNS O
between IN O
BusyGasper NNP O
components NNS O
Second NNP O
( ( O
main JJ O
) ) O
module NN O
This DT O
module NN O
writes VBZ O
a DT O
log NN O
of IN O
the DT O
command NN O
execution NN O
history NN O
to TO O
the DT O
file NN O
named VBN O
“ NNP O
lock NN O
” NNP O
, , O
which WDT O
is VBZ O
later RB O
exfiltrated VBN O

. . O

Below NNP O
is VBZ O
a DT O
fragment NN O
of IN O
such JJ O
a DT O
log NN O
: : O
Log NN O
with IN O
specified JJ O
command NN O
Log NNP O
files NNS O
can MD O
be VB O
uploaded VBN O
to TO O
the DT O
FTP NNP O
server NN O
and CC O
sent VBD O
to TO O
the DT O
attacker NN O
’ NNP O
s NN O
email NN O
inbox NN O
. . O

It PRP O
’ VBZ O
s RB O
even RB O
possible JJ O
to TO O
send VB O
log NN O
messages NNS O
via IN O
SMS NNP O
to TO O
the DT O
attacker NN O
’ NNP O
s VBZ O
number NN O
. . O

As IN O
the DT O
screenshot NN O
above IN O
shows NNS O
, , O
the DT O
malware NN O
has VBZ O
its PRP$ O
own JJ O
command NN O
syntax NN O
that WDT O
represents VBZ O
a DT O
combination NN O
of IN O
characters NNS O
while IN O
the DT O
“ NNP O
# # O
” NNP O
symbol NN O
is VBZ O
a DT O
delimiter NN O
. . O

A DT O
full JJ O
list NN O
of IN O
all DT O
possible JJ O
commands NNS O
with IN O
descriptions NNS O
can MD O
be VB O
found VBN O
in IN O
Appendix NNP O
II NNP O
below IN O
. . O

The DT O
malware NN O
has VBZ O
all PDT O
the DT O
popular JJ O
capabilities NNS O
of IN O
modern JJ O
spyware NN O
. . O

Below NNP O
is VBZ O
a DT O
description NN O
of IN O
the DT O
most RBS O
noteworthy JJ O
: : O
The DT O
implant NN O
is VBZ O
able JJ O
to TO O
spy VB O
on IN O
all DT O
available JJ O
device NN O
sensors NNS O
and CC O
to TO O
log VB O
registered JJ O
events NNS O
. . O

Moreover RB O
, , O
there EX O
is VBZ O
a DT O
special JJ O
handler NN O
for IN O
the DT O
accelerometer NN O
that WDT O
is VBZ O
able JJ O
to TO O
calculate VB O
and CC O
log VB O
the DT O
device NN O
’ NNP O
s VBD O
speed NN O
: : O
This DT O
feature NN O
is VBZ O
used VBN O
in IN O
particular JJ O
by IN O
the DT O
command NN O
“ NNP O
tk0 NN O
” NN O
that WDT O
mutes VBZ O
the DT O
device NN O
, , O
disables VBZ O
keyguard RB O
, , O
turns VBZ O
off IN O
the DT O
brightness NN O
, , O
uses VBZ O
wakelock NN O
and CC O
listens VBZ O
to TO O
device VB O
sensors NNS O
. . O

This DT O
allows VBZ O
it PRP O
to TO O
silently RB O
execute VB O
any DT O
backdoor JJ O
activity NN O
without IN O
the DT O
user NN O
knowing NN O
that IN O
the DT O
device NN O
is VBZ O
in IN O
an DT O
active JJ O
state NN O
. . O

As RB O
soon RB O
as IN O
the DT O
user NN O
picks VBZ O
up RP O
the DT O
device NN O
, , O
the DT O
implant NN O
will MD O
detect VB O
a DT O
motion NN O
event NN O
and CC O
execute VB O
the DT O
“ NNP O
tk1 NN O
” NN O
and CC O
“ NNP O
input VBP O
keyevent JJ O
3 CD O
” JJ O
commands NNS O
. . O

“ JJ O
tk1 NN O
” NNP O
will MD O
disable VB O
all PDT O
the DT O
effects NNS O
of IN O
the DT O
“ NNP O
tk0 NN O
” NNP O
command NN O
, , O
while IN O
“ JJ O
input NN O
keyevent VBD O
3 CD O
” NN O
is VBZ O
the DT O
shell NN O
command NN O
that WDT O
simulates VBZ O
the DT O
pressing NN O
of IN O
the DT O
‘ NNP O
home NN O
’ NNP O
button NN O
so RB O
all PDT O
the DT O
current JJ O
activities NNS O
will MD O
be VB O
minimized VBN O
and CC O
the DT O
user NN O
won VBD O
’ NNP O
t NN O
suspect NN O
anything NN O
. . O

Location NN O
services NNS O
to TO O
enable VB O
( ( O
GPS/network NNP O
) ) O
tracking NN O
: : O
The DT O
email NN O
command NN O
and CC O
control NN O
protocol NN O
. . O

The DT O
implant NN O
can MD O
log VB O
in IN O
to TO O
the DT O
attackers NNS O
email VBP O
inbox NN O
, , O
parse NN O
emails NNS O
for IN O
commands NNS O
in IN O
a DT O
special JJ O
“ NN O
Cmd NNP O
” NNP O
folder NN O
and CC O
save VB O
any DT O
payloads NNS O
to TO O
a DT O
device NN O
from IN O
email JJ O
attachments NNS O
. . O

Accessing VBG O
the DT O
“ NN O
Cmd NNP O
” NNP O
folder NN O
in IN O
the DT O
attacker NN O
’ NNP O
s NN O
email NN O
box NN O
Moreover RB O
, , O
it PRP O
can MD O
send VB O
a DT O
specified VBN O
file NN O
or CC O
all PDT O
the DT O
gathered VBN O
data NN O
from IN O
the DT O
victim NN O
device NN O
via IN O
email NN O
. . O

Emergency NNP O
SMS NNP O
commands NNS O
. . O

If IN O
an DT O
incoming NN O
SMS NNP O
contains VBZ O
one CD O
of IN O
the DT O
following JJ O
magic JJ O
strings NNS O
: : O
” VB O
2736428734″ CD B-Indicator
or CC O
” VB O
7238742800″ CD B-Indicator
the DT O
malware NN O
will MD O
execute VB O
multiple JJ O
initial JJ O
commands NNS O
: : O
Keylogger NNP O
implementation NN O
Keylogging NNP O
is VBZ O
implemented VBN O
in IN O
an DT O
original JJ O
manner NN O
. . O

Immediately RB O
after IN O
activation NN O
, , O
the DT O
malware NN O
creates VBZ O
a DT O
textView NN O
element NN O
in IN O
a DT O
new JJ O
window NN O
with IN O
the DT O
following VBG O
layout NN O
parameters NNS O
: : O
All PDT O
these DT O
parameters NNS O
ensure VB O
the DT O
element NN O
is VBZ O
hidden VBN O
from IN O
the DT O
user NN O
. . O

Then RB O
it PRP O
adds VBZ O
onTouchListener JJR O
to TO O
this DT O
textView NN O
and CC O
is VBZ O
able JJ O
to TO O
process VB O
every DT O
user NN O
tap NN O
. . O

Interestingly RB O
, , O
there EX O
is VBZ O
an DT O
allowlist NN O
of IN O
tapped JJ O
activities NNS O
: : O
ui.ConversationActivity NN O
ui.ConversationListActivity NN O
SemcInCallScreen NNP O
Quadrapop NNP O
SocialPhonebookActivity NNP O
The DT O
listener NN O
can MD O
operate VB O
with IN O
only RB O
coordinates NNS O
, , O
so IN O
it PRP O
calculates VBZ O
pressed JJ O
characters NNS O
by IN O
matching VBG O
given VBN O
values NNS O
with IN O
hardcoded JJ O
ones NNS O
: : O
Additionally RB O
, , O
if IN O
there EX O
is VBZ O
a DT O
predefined JJ O
command NN O
, , O
the DT O
keylogger NN O
can MD O
make VB O
a DT O
screenshot NN O
of IN O
the DT O
tapped JJ O
display NN O
area NN O
: : O
Manual JJ O
access NN O
and CC O
operator NN O
menu NN O
There EX O
is VBZ O
a DT O
hidden JJ O
menu NN O
( ( O
Activity NNP O
) ) O
for IN O
controlling VBG O
implant JJ O
features NNS O
that WDT O

looks NNS O
like IN O
it PRP O
was VBD O
created VBN O
for IN O
manual JJ O
operator NN O
control NN O
. . O

To TO O
activate VB O
this DT O
menu NN O
the DT O
operator NN O
needs VBZ O
to TO O
call VB O
the DT O
hardcoded JJ O
number NN O
“ JJ O
9909 CD O
” NN O
from IN O
the DT O
infected JJ O
device NN O
: : O
A DT O
hidden JJ O
menu NN O
then RB O
instantly RB O
appears VBZ O
on IN O
the DT O
device NN O
display NN O
: : O
The DT O
operator NN O
can MD O
use VB O
this DT O
interface NN O
to TO O
type VB O
any DT O
command NN O
for IN O
execution NN O
. . O

It PRP O
also RB O
shows VBZ O
a DT O
current JJ O
malware NN O
log NN O
. . O

Infrastructure NN O
FTP NNP O
server VBZ O
The DT O
attackers NNS O
used VBD O
ftp NN B-Indicator
: : I-Indicator
//213.174.157 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
151/ CD I-Indicator
as IN O
a DT O
command NN O
and CC O
control NN O
server NN O
. . O

The DT O
IP NNP O
belongs NNS O
to TO O
the DT O
free JJ O
Russian JJ O
web NN O
hosting VBG O
service NN O
Ucoz NNP O
. . O

Files NNS O
Description NNP O
CMDS NNP O
* NNP O
.txt NNP O
Text NNP O
files VBZ O
with IN O
commands NNS O
to TO O
execute VB O
supersu.apk JJ B-Indicator
SuperSU NNP O
( ( O
eu.chainfire.supersu NN B-Indicator
, , O
https NN B-Indicator
: : I-Indicator
//play.google.com/store/apps/details NNS I-Indicator
? . I-Indicator

id=eu.chainfire.supersu NN I-Indicator
) ) O
tool NN O
246.us CD B-Indicator
us.x JJ B-Indicator
SuperSU NNP O
ELF NNP O
binaries VBZ O
supersu.cfg VBP B-Indicator
supersu.cfg.ju JJ B-Indicator
supersu.cfg.old JJ B-Indicator
SuperSU NNP O
configs NN O
with IN O
spyware NN O
implant JJ O
mention NN O
bb.txt NN B-Indicator
BusyBox NNP O
v1.26.2 NN O
ELF NNP O
file NN O
bdata.xml NN B-Indicator
Config NNP O
file NN O
for IN O
excluding VBG O
malware JJ O
components NNS O
from IN O
Android NNP B-System
battery NN O
saver NN O
feature NN O
Doze NNP O
bdatas.apk NN B-Indicator
Main NNP O
implant NN O
module NN O
com.android.network.irc.apk JJ B-Indicator
Start NNP O
implant NN O
module NN O
MobileManagerService.apk NNP B-Indicator
ASUS NNP B-Organization
firmware NN O
system NN O
component NN O
( ( O
clean JJ O
) ) O
mobilemanager.apk NN B-Indicator

Corrupted VBN O
archive JJ O
privapp.txt NN B-Indicator
Looks NNP O
like IN O
a DT O
list NN O
of IN O
system NN O
applications NNS O
( ( O
including VBG O
spyware NN O
components NNS O
) ) O
from IN O
the DT O
infected JJ O
device NN O
run-as.x JJ B-Indicator
run-as.y JJ B-Indicator
Run-as JJ O
tool NN O
ELF NNP O
file NN O
SuperSU NNP O
config NN O
fragment NN O
for IN O
implant JJ O
components NNS O
and CC O
the DT O
busybox NN O
tool NN O
supersu.cfg NN B-Indicator
: : O
This DT O
config NN O
allows VBZ O
the DT O
implant NN O
to TO O
use VB O
all DT O
root NN O
features VBZ O
silently RB O
. . O

Content NN O
of IN O
bdata.xml NN O
file NN O
: : O
It PRP O
can MD O
be VB O
added VBN O
to TO O
the DT O
/system/etc/sysconfig/ JJ B-Indicator
path NN O
to TO O
allowlist VB O
specified JJ O
implant JJ O
components NNS O
from IN O
the DT O
battery NN O
saving VBG O
system NN O
. . O

Email NNP O
account NN O
A NNP O
Gmail NNP B-System
account NN O
with IN O
password NN O
is VBZ O
mentioned VBN O
in IN O
the DT O
sample NN O
’ NNP O
s NN O
code NN O
: : O
It PRP O
contains VBZ O
the DT O
victim NN O
’ NNP O
s NN O
exfiltrated VBD O
data NNS O
and CC O
“ NNP O
cmd VBP O
” NNP O
directory NN O
with IN O
commands NNS O
for IN O
victim NN O
devices NNS O
. . O

10 CD O
million CD O
Android NNP B-System
phones NNS O
infected VBN O
by IN O
all-powerful JJ O
auto-rooting JJ O
apps NN O
First NNP O
detected VBD O
in IN O
November NNP O
, , O
Shedun/HummingBad NNP B-Malware
infections NNS O
are VBP O
surging VBG O
. . O

7/7/2016 CD O
, , O
1:50 CD O
PM NNP O
Security NNP O
experts NNS O
have VBP O
documented VBN O
a DT O
disturbing VBG O
spike NN O
in IN O
a DT O
particularly RB O
virulent JJ O
family NN O
of IN O
Android NNP B-System
malware NN O
, , O
with IN O
more JJR O
than IN O
10 CD O
million CD O
handsets NNS O
infected JJ O
and CC O
more JJR O
than IN O
286,000 CD O
of IN O
them PRP O
in IN O
the DT O
US NNP O
. . O

FURTHER JJ O
READING NNP O
New NNP O
type NN O
of IN O
auto-rooting JJ O
Android NNP B-System
adware NN O
is VBZ O
nearly RB O
impossible JJ O
to TO O
remove VB O
Researchers NNS O
from IN O
security NN O
firm NN O
Check NNP B-Organization
Point NNP I-Organization
Software NNP I-Organization
said VBD O
the DT O
malware NN O
installs VBZ O
more JJR O
than IN O
50,000 CD O
fraudulent JJ O
apps NNS O
each DT O
day NN O
, , O
displays VBZ O
20 CD O
million CD O
malicious JJ O
advertisements NNS O
, , O
and CC O
generates VBZ O
more JJR O
than IN O
$ $ O
300,000 CD O
per IN O
month NN O
in IN O
revenue NN O
. . O

The DT O
success NN O
is VBZ O
largely RB O
the DT O
result NN O
of IN O
the DT O
malware NN O
's POS O
ability NN O
to TO O
silently RB O
root VB O
a DT O
large JJ O
percentage NN O
of IN O
the DT O
phones NNS O
it PRP O
infects VBZ O
by IN O
exploiting VBG O
vulnerabilities NNS B-Vulnerability
that WDT I-Vulnerability
remain VBP I-Vulnerability
unfixed JJ I-Vulnerability
in IN I-Vulnerability
older JJR I-Vulnerability
versions NNS I-Vulnerability
of IN I-Vulnerability
Android NNP I-Vulnerability
. . O

The DT O
Check NNP B-Organization
Point NNP I-Organization
researchers NNS O
have VBP O
dubbed VBN O
the DT O
malware NN O
family NN O
" NNP O
HummingBad NNP B-Malware
, , O
'' '' O
but CC O
researchers NNS O
from IN O
mobile JJ O
security NN O
company NN O
Lookout NNP B-Organization
say VBP O
HummingBad NNP B-Malware
is VBZ O
in IN O
fact NN O
Shedun NNP B-Malware
, , O
a DT O
family NN O
of IN O
auto-rooting JJ O
malware NN O
that WDT O
came VBD O
to TO O
light JJ O
last JJ O
November NNP O
and CC O
had VBD O
already RB O
infected VBN O
a DT O
large JJ O
number NN O
of IN O
devices NNS O
. . O

Update NNP O
Jul NNP O
11 CD O
2016 CD O
8:32 CD O
: : O
On IN O
Monday NNP O
, , O
a DT O
Checkpoint NNP B-Organization
representative NN O
disputed VBD O
Lookout NNP B-Organization
's POS O
contention NN O
and CC O
pointed VBD O
to TO O
this DT O
blog NN O
post NN O
from IN O
security NN O
firm NN O
Eleven NNP B-Organization
Paths NNP I-Organization
as IN O
support NN O
. . O

The DT O
blog NN O
post NN O
said VBD O
HummingBad NNP B-Malware
" NNP O
uses VBZ O
a DT O
completely RB O
different JJ O
infrastructure NN O
with IN O
little JJ O
in IN O
common JJ O
'' '' O
with IN O
Shedun NNP I-Malware
. . O

In IN O
an DT O
e-mail NN O
, , O
a DT O
Lookout NNP B-Organization
representative NN O
stood NN O
by IN O
its PRP$ O
analysis NN O
and CC O
said VBD O
company NN O
researchers NNS O
planned VBD O
to TO O
publish VB O
an DT O
in-depth JJ O
response NN O
in IN O
the DT O
coming JJ O
days NNS O
. . O

For IN O
the DT O
past JJ O
five CD O
months NNS O
, , O
Check NNP B-Organization
Point NNP I-Organization
researchers NNS O
have VBP O
quietly RB O
observed VBN O
the DT O
China-based JJ O
advertising NN O
company NN O
behind IN O
HummingBad NNP B-Malware
in IN O
several JJ O
ways NNS O
, , O
including VBG O
by IN O
infiltrating VBG O
the DT O
command NN O
and CC O
control NN O
servers NNS O
it PRP O
uses VBZ O
. . O

The DT O
researchers NNS O
say VBP O
the DT O
malware NN O
uses VBZ O
the DT O
unusually RB O
tight JJ O
control NN O
it PRP O
gains NNS O
over IN O
infected JJ O
devices NNS O
to TO O
create VB O
windfall JJ O
profits NNS O
and CC O
steadily RB O
increase VB O
its PRP$ O
numbers NNS O
. . O

HummingBad NN B-Malware
does VBZ O
this DT O
by IN O
silently RB O
installing VBG O
promoted VBN O
apps NN O
on IN O
infected JJ O
phones NNS O
, , O
defrauding VBG O
legitimate JJ O
mobile JJ O
advertisers NNS O
, , O
and CC O
creating VBG O
fraudulent JJ O
statistics NNS O
inside IN O
the DT O
official JJ O
Google NNP B-System
Play NNP I-System
Store NNP I-System
. . O

" NN O
Accessing VBG O
these DT O
devices NNS O
and CC O
their PRP$ O
sensitive JJ O
data NNS O
creates VBZ O
a DT O
new JJ O
and CC O
steady JJ O
stream NN O
of IN O
revenue NN O
for IN O
cybercriminals NNS O
, , O
'' '' O
Check NNP I-Organization
Point NNP I-Organization
researchers NNS O
wrote VBD O
in IN O
a DT O
recently RB O
published VBN O
report NN O
. . O

" NNS O
Emboldened VBN O
by IN O
financial JJ O
and CC O
technological JJ O
independence NN O
, , O
their PRP$ O
skillsets NNS O
will MD O
advance–putting VBG O
end NN O
users NNS O
, , O
enterprises NNS O
, , O
and CC O
government NN O
agencies NNS O
at IN O
risk NN O
. . O

'' '' O
The DT O
report NN O
said VBD O
HummingBad NNP B-Malware
apps NN O
are VBP O
developed VBN O
by IN O
Yingmob NNP B-Organization
, , O
a DT O
Chinese JJ O
mobile JJ O
ad NN O
server NN O
company NN O
that IN O
other JJ O
researchers NNS O
claim VBP O
is VBZ O
behind IN O
the DT O
Yinspector NNP B-Malware
iOS NN B-System
malware NN O
. . O

HummingBad NNP B-Malware
sends VBZ O
notifications NNS O
to TO O
Umeng NNP O
, , O
a DT O
tracking NN O
and CC O
analytics NNS O
service NN O
attackers NNS O
use VBP O
to TO O
manage VB O
their PRP$ O
campaign NN O
. . O

Check NNP B-Organization
Point NNP I-Organization
analyzed VBD O
Yingmob NNP B-Organization
’ NNP O
s VBD O
Umeng NNP O
account NN O
to TO O
gain VB O
further JJ O
insights NNS O
into IN O
the DT O
HummingBad NNP B-Malware
campaign NN O
and CC O
found VBD O
that IN O
beyond IN O
the DT O
10 CD O
million CD O
devices NNS O
under IN O
the DT O
control NN O
of IN O
malicious JJ O
apps NN O
, , O
Yingmob NNP B-Organization
has VBZ O
non-malicious JJ O
apps NN O
installed VBN O
on IN O
another DT O
75 CD O
million CD O
or CC O
so RB O
devices NNS O
. . O

The DT O
researchers NNS O
wrote VBD O
: : O
While IN O
profit NN O
is VBZ O
powerful JJ O
motivation NN O
for IN O
any DT O
attacker NN O
, , O
Yingmob NNP B-Organization
’ NNP O
s JJ O
apparent JJ O
self-sufficiency NN O
and CC O
organizational JJ O
structure NN O
make VBP O
it PRP O
well-positioned JJ O
to TO O
expand VB O
into IN O
new JJ O
business NN O
ventures NNS O
, , O
including VBG O
productizing VBG O
the DT O
access NN O
to TO O
the DT O
85 CD O
million CD O
Android NNP B-System
devices NNS O
it PRP O
controls VBZ O
. . O

This DT O
alone NN O
would MD O
attract VB O
a DT O
whole JJ O
new JJ O
audience–and NN O
a DT O
new JJ O
stream NN O
of IN O
revenue–for JJ O
Yingmob NNP B-Organization
. . O

Quick NNP O
, , O
easy JJ O
access NN O
to TO O
sensitive VB O
data NNS O
on IN O
mobile JJ O
devices NNS O
connected VBN O
to TO O
enterprises NNS O
and CC O
government NN O
agencies NNS O
around IN O
the DT O
globe NN O
is VBZ O
extremely RB O
attractive JJ O
to TO O
cybercriminals NNS O
and CC O
hacktivists NNS O
. . O

Drive-by NNP O
downloads NNS O
and CC O
multiple JJ O
rooting VBG O
exploits VBZ O
The DT O
malware NN O
uses VBZ O
a DT O
variety NN O
of IN O
methods NNS O
to TO O
infect VB O
devices NNS O
. . O

One CD O
involves VBZ O
drive-by JJ O
downloads NNS O
, , O
possibly RB O
on IN O
booby-trapped JJ O
porn NN O
sites NNS O
. . O

The DT O
attacks NNS O
use VBP O
multiple JJ O
exploits NNS O
in IN O
an DT O
attempt NN O
to TO O
gain VB O
root JJ O
access NN O
on IN O
a DT O
device NN O
. . O

When WRB O
rooting VBG O
fails NNS O
, , O
a DT O
second JJ O
component NN O
delivers NNS O
a DT O
fake NN O
system NN O
update JJ O
notification NN O
in IN O
hopes NNS O
of IN O
tricking VBG O
users NNS O
into IN O
granting VBG O
HummingBad NNP B-Malware
system-level JJ O
permissions NNS O
. . O

Whether NNP O
or CC O
not RB O
rooting VBG O
succeeds VBZ O
, , O
HummingBad NNP B-Malware
downloads VBZ O
a DT O
large JJ O
number NN O
of IN O
apps NN O
. . O

In IN O
some DT O
cases NNS O
, , O
malicious JJ O
components NNS O
are VBP O
dynamically RB O
downloaded VBN O
onto IN O
a DT O
device NN O
after IN O
an DT O
infected JJ O
app NN O
is VBZ O
installed VBN O
. . O

From IN O
there RB O
, , O
infected VBD O
phones NNS O
display NN O
illegitimate VBP O
ads NNS O
and CC O
install VB O
fraudulent JJ O
apps NN O
after IN O
certain JJ O
events NNS O
, , O
such JJ O
as IN O
rebooting NN O
, , O
the DT O
screen NN O
turning VBG O
on IN O
or CC O
off RP O
, , O
a DT O
detection NN O
that IN O
the DT O
user NN O
is VBZ O
present JJ O
, , O
or CC O
a DT O
change NN O
in IN O
Internet NNP O
connectivity NN O
. . O

HummingBad NNP B-Malware
also RB O
has VBZ O
the DT O
ability NN O
to TO O
inject VB O
code NN O
into IN O
Google NNP B-System
Play NNP I-System
to TO O
tamper VB O
with IN O
its PRP$ O
ratings NNS O
and CC O
statistics NNS O
. . O

It PRP O
does VBZ O
this DT O
by IN O
using VBG O
infected JJ O
devices NNS O
to TO O
imitate VB O
clicks NNS O
on IN O
the DT O
install NN O
, , O
buy VB O
, , O
and CC O
accept JJ O
buttons NNS O
. . O

Many JJ O
of IN O
the DT O
10 CD O
million CD O
infected VBN O
phones NNS O
are VBP O
running VBG O
old JJ O
versions NNS O
of IN O
Android NNP B-System
and CC O
reside VB O
in IN O
China NNP O
( ( O
1.6 CD O
million CD O
) ) O
and CC O
India NNP O
( ( O
1.35 CD O
million CD O
) ) O
. . O

Still RB O
, , O
US-based JJ O
infected VBN O
phones NNS O
total JJ O
almost RB O
287,000 CD O
. . O

The DT O
most RBS O
widely RB O
infected JJ O
major JJ O
Android NNP B-System
versions NNS O
are VBP O
KitKat NNP B-System
with IN O
50 CD O
percent NN O
, , O
followed VBN O
by IN O
Jelly NNP B-System
Bean NNP I-System
with IN O
40 CD O
percent NN O
. . O

Lollipop NNP B-System
has VBZ O
7 CD O
percent NN O
, , O
Ice NNP B-System
Cream NNP I-System
Sandwich NNP I-System
has VBZ O
2 CD O
percent NN O
, , O
and CC O
Marshmallow NNP B-System
has VBZ O
1 CD O
percent NN O
. . O

It PRP O
's VBZ O
often RB O
hard JJ O
for IN O
average JJ O
users NNS O
to TO O
know VB O
if IN O
their PRP$ O
phones NNS O
have VBP O
been VBN O
rooted VBN O
, , O
and CC O
Shedun NNP B-Malware
apps RB O
often RB O
wait VBP O
some DT O
period NN O
of IN O
time NN O
before IN O
displaying VBG O
obtrusive JJ O
ads NNS O
or CC O
installing VBG O
apps NN O
. . O

The DT O
best JJS O
bet NN O
for IN O
Readers NNS O
who WP O
want VBP O
to TO O
make VB O
sure JJ O
their PRP$ O
phone NN O
is VBZ O
n't RB O
infected VBN O
is VBZ O
to TO O
scan VB O
their PRP$ O
phones NNS O
using VBG O
the DT O
free JJ O
version NN O
of IN O
the DT O
Lookout NNP B-Organization
Security NNP O
and CC O
Antivirus NNP O
app NN O
. . O

Android NNP B-System
malware NN O
has VBZ O
drastically RB O
lower JJR O
rates NNS O
of IN O
success NN O
when WRB O
app JJ O
installations NNS O
outside IN O
of IN O
Google NNP B-System
Play NNP I-System
are VBP O
barred VBN O
. . O

Readers NNS O
should MD O
carefully RB O
think VB O
through IN O
the DT O
risks NNS O
before IN O
changing VBG O
this DT O
default NN O
setting NN O
. . O

Top JJ O
20 CD O
countries NNS O
targeted VBN O
by IN O
Hummingbad/Shedun NNP B-Malware
. . O

Enlarge NNP O
/ NNP O
Top NNP O
20 CD O
countries NNS O
targeted VBN O
by IN O
Hummingbad/Shedun NNP B-Malware
. . O

Check NNP B-Organization
Point NNP I-Organization
Software NNP I-Organization
Hummingbad/Shedun NNP B-Malware
infections NNS O
by IN O
Android NNP B-System
version NN O
. . O

Enlarge NNP O
/ NNP O
Hummingbad/Shedun NNP B-Malware
infections NNS O
by IN O
Android NNP B-System
version NN O
. . O

Check NNP B-Organization
Point NNP I-Organization
Software NNP I-Organization
So NNP O
far RB O
, , O
HummingBad NNP B-Malware
has VBZ O
been VBN O
observed VBN O
using VBG O
its PRP$ O
highly RB O
privileged VBN O
status NN O
only RB O
to TO O
engage VB O
in IN O
click NN O
fraud NN O
, , O
display VB O
pop-up JJ O
ads NNS O
, , O
tamper IN O
with IN O
Google NNP B-System
Play NNP I-System
, , O
and CC O
install VB O
additional JJ O
apps NN O
that WDT O
do VBP O
more JJR O
of IN O
the DT O
same JJ O
. . O

But CC O
there EX O
's VBZ O
little JJ O
stopping VBG O
it PRP O
from IN O
doing VBG O
much JJ O
worse JJR O
. . O

That DT O
's VBZ O
because IN O
the DT O
malware JJ O
roots NNS O
most JJS O
of IN O
the DT O
phones NNS O
it PRP O
infects VBZ O
, , O
a DT O
process NN O
that WDT O
subverts VBZ O
key JJ O
security NN O
mechanisms NN O
built VBN O
into IN O
Android NNP B-System
. . O

Under IN O
a DT O
model NN O
known VBN O
as IN O
sandboxing NN O
, , O
most JJS O
Android NNP B-System
apps NN O
are VBP O
n't RB O
permitted VBN O
to TO O
access NN O
passwords NNS O
or CC O
other JJ O
data NNS O
available JJ O
to TO O
most JJS O
other JJ O
apps NN O
. . O

System NN O
applications NNS O
with IN O
root NN O
, , O
by IN O
contrast NN O
, , O
have VBP O
super-user JJ O
permissions NNS O
that WDT O
allow VBP O
them PRP O
to TO O
break VB O
out IN O
of IN O
such JJ O
sandboxes NNS O
. . O

From IN O
there RB O
, , O
root-level JJ O
apps NN O
can MD O
read VB O
or CC O
modify VB O
data NNS O
and CC O
resources NNS O
that WDT O
would MD O
be VB O
off-limits JJ O
to TO O
normal JJ O
apps NN O
. . O

As IN O
Lookout NNP B-Organization
first RB O
reported VBD O
more JJR O
than IN O
eight CD O
months NNS O
ago RB O
, , O
the DT O
problem NN O
with IN O
Shedun/HummingBad NNP B-Malware
and CC O
similar JJ O
malicious JJ O
app NN O
families NNS O
that WDT O
silently RB O
exploit VBP O
Android NNP B-Vulnerability
rooting VBG I-Vulnerability
vulnerabilities NNS I-Vulnerability
is VBZ O
that IN O
the DT O
infections NNS O
can MD O
survive VB O
normal JJ O
factory JJ O
resets NNS O
. . O

Lookout NNP B-Organization
said VBD O
in IN O
its PRP$ O
own JJ O
blog NN O
post NN O
published VBN O
Wednesday NNP O
that IN O
its PRP$ O
threat NN O
detection NN O
network NN O
has VBZ O
recently RB O
observed VBN O
a DT O
surge NN O
of IN O
Shedun NNP B-Malware
attacks NNS O
, , O
indicating VBG O
the DT O
scourge NN O
wo MD O
n't RB O
be VB O
going VBG O
away RB O
any DT O
time NN O
soon RB O
. . O

An DT O
investigation NN O
of IN O
Chrysaor NNP B-Malware
Malware NNP O
on IN O
Android NNP B-System
03 CD O
April NNP O
2017 CD O
Google NNP B-Organization
is VBZ O
constantly RB O
working VBG O
to TO O
improve VB O
our PRP$ O
systems NNS O
that IN O
protect VBP O
users NNS O
from IN O
Potentially NNP O
Harmful NNP O
Applications NNP O
( ( O
PHAs NNP O
) ) O
. . O

Usually RB O
, , O
PHA NNP O
authors NNS O
attempt VBP O
to TO O
install VB O
their PRP$ O
harmful JJ O
apps NN O
on IN O
as IN O
many JJ O
devices NNS O
as IN O
possible JJ O
. . O

However RB O
, , O
a DT O
few JJ O
PHA NNP O
authors NNS O
spend VBP O
substantial JJ O
effort NN O
, , O
time NN O
, , O
and CC O
money NN O
to TO O
create VB O
and CC O
install VB O
their PRP$ O
harmful JJ O
app NN O
on IN O
one CD O
or CC O
a DT O
very RB O
small JJ O
number NN O
of IN O
devices NNS O
. . O

This DT O
is VBZ O
known VBN O
as IN O
a DT O
targeted JJ O
attack NN O
. . O

In IN O
this DT O
blog NN O
post NN O
, , O
we PRP O
describe VBP O
Chrysaor NNP B-Malware
, , O
a DT O
newly RB O
discovered VBN O
family NN O
of IN O
spyware NN O
that WDT O
was VBD O
used VBN O
in IN O
a DT O
targeted JJ O
attack NN O
on IN O
a DT O
small JJ O
number NN O
of IN O
Android NNP B-System
devices NNS O
, , O
and CC O
how WRB O
investigations NNS O
like IN O
this DT O
help NN O
Google NNP B-Organization
protect NN O
Android NNP B-System
users NNS O
from IN O
a DT O
variety NN O
of IN O
threats NNS O
. . O

What WP O
is VBZ O
Chrysaor NNP B-Malware
? . O

Chrysaor NNP B-Malware
is VBZ O
spyware JJ O
believed VBN O
to TO O
be VB O
created VBN O
by IN O
NSO NNP B-Organization
Group NNP I-Organization
Technologies NNPS I-Organization
, , O
specializing VBG O
in IN O
the DT O
creation NN O
and CC O
sale NN O
of IN O
software NN O
and CC O
infrastructure NN O
for IN O
targeted JJ O
attacks NNS O
. . O

Chrysaor NNP B-Malware
is VBZ O
believed VBN O
to TO O
be VB O
related VBN O
to TO O
the DT O
Pegasus NNP B-Malware
spyware NN O
that WDT O
was VBD O
first RB O
identified VBN O
on IN O
iOS NN B-System
and CC O
analyzed VBN O
by IN O
Citizen NNP B-Organization
Lab NNP I-Organization
and CC O
Lookout NNP B-Organization
. . O

Late RB O
last JJ O
year NN O
, , O
after IN O
receiving VBG O
a DT O
list NN O
of IN O
suspicious JJ O
package NN O
names NNS O
from IN O
Lookout NNP B-Organization
, , O
we PRP O
discovered VBD O
that IN O
a DT O
few JJ O
dozen NN O
Android NNP B-System
devices NNS O
may MD O
have VB O
installed VBN O
an DT O
application NN O
related VBN O
to TO O
Pegasus NNP B-Malware
, , O
which WDT O
we PRP O
named VBD O
Chrysaor NNP B-Malware
. . O

Although IN O
the DT O
applications NNS O
were VBD O
never RB O
available JJ O
in IN O
Google NNP B-System
Play NNP I-System
, , O
we PRP O
immediately RB O
identified VBD O
the DT O
scope NN O
of IN O
the DT O
problem NN O
by IN O
using VBG O
Verify NNP B-System
Apps NNP I-System
. . O

We PRP O
gathered VBD O
information NN O
from IN O
affected JJ O
devices NNS O
, , O
and CC O
concurrently RB O
, , O
attempted VBD O
to TO O
acquire VB O
Chrysaor NNP B-Malware
apps NN O
to TO O
better JJR O
understand VB O
its PRP$ O
impact NN O
on IN O
users NNS O
. . O

We PRP O
've VBP O
contacted VBN O
the DT O
potentially RB O
affected JJ O
users NNS O
, , O
disabled VBD O
the DT O
applications NNS O
on IN O
affected JJ O
devices NNS O
, , O
and CC O
implemented VBD O
changes NNS O
in IN O
Verify NNP B-System
Apps NNP I-System
to TO O
protect VB O
all DT O
users NNS O
. . O

What WP O
is VBZ O
the DT O
scope NN O
of IN O
Chrysaor NNP B-Malware
? . O

Chrysaor NNP B-Malware
was VBD O
never RB O
available JJ O
in IN O
Google NNP B-System
Play NNP I-System
and CC O
had VBD O
a DT O
very RB O
low JJ O
volume NN O
of IN O
installs NNS O
outside IN O
of IN O
Google NNP B-System
Play NNP I-System
. . O

Among IN O
the DT O
over $ O
1.4 CD O
billion CD O
devices NNS O
protected VBN O
by IN O
Verify NNP B-System
Apps NNP I-System
, , O
we PRP O
observed VBD O
fewer JJR O
than IN O
3 CD O
dozen NN O
installs NNS O
of IN O
Chrysaor NNP B-Malware
on IN O
victim NN O
devices NNS O
. . O

These DT O
devices NNS O
were VBD O
located VBN O
in IN O
the DT O
following JJ O
countries NNS O
: : O
How NN O
we PRP O
protect VBP O
you PRP O
To TO O
protect VB O
Android NNP B-System
devices NNS O
and CC O
users NNS O
, , O
Google NNP B-System
Play NNP I-System
provides VBZ O
a DT O
complete JJ O
set NN O
of IN O
security NN O
services NNS O
that WDT O
update JJ O
outside IN O
of IN O
platform NN O
releases NNS O
. . O

Users NNS O
do VBP O
n't RB O
have VB O
to TO O
install VB O
any DT O
additional JJ O
security NN O
services NNS O
to TO O
keep VB O
their PRP$ O
devices NNS O
safe VBP O
. . O

In IN O
2016 CD O
, , O
these DT O
services NNS O
protected VBD O
over IN O
1.4 CD O
billion CD O
devices NNS O
, , O
making VBG O
Google NNP B-Organization
one CD O
of IN O
the DT O
largest JJS O
providers NNS O
of IN O
on-device JJ O
security NN O
services NNS O
in IN O
the DT O
world NN O
: : O
Identify NNP O
PHAs NNP O
using VBG O
people NNS O
, , O
systems NNS O
in IN O
the DT O
cloud NN O
, , O
and CC O
data NNS O
sent VBD O
to TO O
us PRP O
from IN O
devices NNS O
Warn NNP O
users NNS O
about IN O
or CC O
blocking VBG O
users NNS O
from IN O
installing VBG O
PHAs NNP O
Continually NNP O
scan JJ O
devices NNS O
for IN O
PHAs NNP O
and CC O
other JJ O
harmful JJ O
threats NNS O
Additionally RB O
, , O
we PRP O
are VBP O
providing VBG O
detailed JJ O
technical JJ O
information NN O
to TO O
help VB O
the DT O
security NN O
industry NN O
in IN O
our PRP$ O
collective JJ O
work NN O
against IN O
PHAs NNP O
. . O

What WP O
do VBP O
I PRP O
need VB O
to TO O
do VB O
? . O

It PRP O
is VBZ O
extremely RB O
unlikely JJ O
you PRP O
or CC O
someone NN O
you PRP O
know VBP O
was VBD O
affected VBN O
by IN O
Chrysaor NNP B-Malware
malware NN O
. . O

Through IN O
our PRP$ O
investigation NN O
, , O
we PRP O
identified VBD O
less JJR O
than IN O
3 CD O
dozen NN O
devices NNS O
affected VBN O
by IN O
Chrysaor NNP B-Malware
, , O
we PRP O
have VBP O
disabled VBN O
Chrysaor NNP B-Malware
on IN O
those DT O
devices NNS O
, , O
and CC O
we PRP O
have VBP O
notified VBN O
users NNS O
of IN O
all DT O
known VBN O
affected JJ O
devices NNS O
. . O

Additionally RB O
, , O
the DT O
improvements NNS O
we PRP O
made VBD O
to TO O
our PRP$ O
protections NNS O
have VBP O
been VBN O
enabled VBN O
for IN O
all DT O
users NNS O
of IN O
our PRP$ O
security NN O
services NNS O
. . O

To TO O
ensure VB O
you PRP O
are VBP O
fully RB O
protected VBN O
against IN O
PHAs NNP O
and CC O
other JJ O
threats NNS O
, , O
we PRP O
recommend VBP O
these DT O
5 CD O
basic JJ O
steps NNS O
: : O
Install NNP O
apps VBZ O
only RB O
from IN O
reputable JJ O
sources NNS O
: : O
Install NNP O
apps VBP O
from IN O
a DT O
reputable JJ O
source NN O
, , O
such JJ O
as IN O
Google NNP B-System
Play NNP I-System
. . O

No DT O
Chrysaor NNP B-Malware
apps NN O
were VBD O
on IN O
Google NNP B-System
Play NNP I-System
. . O

Enable VB O
a DT O
secure NN O
lock NN O
screen NN O
: : O
Pick VB O
a DT O
PIN NNP O
, , O
pattern NN O
, , O
or CC O
password NN O
that WDT O
is VBZ O
easy JJ O
for IN O
you PRP O
to TO O
remember VB O
and CC O
hard VB O
for IN O
others NNS O
to TO O
guess VB O
. . O

Update VB O
your PRP$ O
device NN O
: : O
Keep VB O
your PRP$ O
device NN O
up-to-date JJ O
with IN O
the DT O
latest JJS O
security NN O
patches NNS O
. . O

Verify NNP O
Apps NNP O
: : O
Ensure NN O
Verify NNP O
Apps NNP O
is VBZ O
enabled VBN O
. . O

Locate VB O
your PRP$ O
device NN O
: : O
Practice NNP O
finding VBG O
your PRP$ O
device NN O
with IN O
Android NNP B-System
Device NNP I-System
Manager NNP I-System
because IN O
you PRP O
are VBP O
far RB O
more RBR O
likely JJ O
to TO O
lose VB O
your PRP$ O
device NN O
than IN O
install VB O
a DT O
PHA NNP O
. . O

How WRB O
does VBZ O
Chrysaor NNP B-Malware
work VB O
? . O

To TO O
install VB O
Chrysaor NNP B-Malware
, , O
we PRP O
believe VBP O
an DT O
attacker NN O
coaxed VBD O
specifically RB O
targeted JJ O
individuals NNS O
to TO O
download VB O
the DT O
malicious JJ O
software NN O
onto IN O
their PRP$ O
device NN O
. . O

Once RB O
Chrysaor NNP B-Malware
is VBZ O
installed VBN O
, , O
a DT O
remote JJ O
operator NN O
is VBZ O
able JJ O
to TO O
surveil VB O
the DT O
victim NN O
's POS O
activities NNS O
on IN O
the DT O
device NN O
and CC O
within IN O
the DT O
vicinity NN O
, , O
leveraging VBG O
microphone NN O
, , O
camera NN O
, , O
data NNS O
collection NN O
, , O
and CC O
logging VBG O
and CC O
tracking VBG O
application NN O
activities NNS O
on IN O
communication NN O
apps NNS O
such JJ O
as IN O
phone NN O
and CC O
SMS NNP O
. . O

One CD O
representative JJ O
sample NN O
Chrysaor NNP B-Malware
app VBZ O
that IN O
we PRP O
analyzed VBD O
was VBD O
tailored VBN O
to TO O
devices NNS O
running VBG O
Jellybean NNP B-System
( ( I-System
4.3 CD I-System
) ) I-System
or CC O
earlier JJR O
. . O

The DT O
following NN O
is VBZ O
a DT O
review NN O
of IN O
scope NN O
and CC O
impact NN O
of IN O
the DT O
Chrysaor NNP B-Malware
app NN O
named VBN O
com.network.android NN B-Indicator
tailored VBN O
for IN O
a DT O
Samsung NNP B-Organization
device NN O
target NN O
, , O
with IN O
SHA256 NNP O
digest NN O
: : O
ade8bef0ac29fa363fc9afd958af0074478aef650adeb0318517b48bd996d5d5Upon NN B-Indicator
installation NN O
, , O
the DT O
app JJ O
uses NNS O
known VBN O
framaroot JJ O
exploits NNS O
to TO O
escalate VB O
privileges NNS O
and CC O
break VB O
Android NNP B-System
's POS O
application NN O
sandbox NN O
. . O

If IN O
the DT O
targeted JJ O
device NN O
is VBZ O
not RB O
vulnerable JJ O
to TO O
these DT O
exploits NNS O
, , O
then RB O
the DT O
app NN O
attempts NNS O
to TO O
use VB O
a DT O
superuser NN O
binary JJ O
pre-positioned JJ O
at IN O
/system/csk NN B-Indicator
to TO O
elevate VB O
privileges NNS O
. . O

After IN O
escalating VBG O
privileges NNS O
, , O
the DT O
app NN O
immediately RB O
protects VBZ O
itself PRP O
and CC O
starts VBZ O
to TO O
collect VB O
data NNS O
, , O
by IN O
: : O
Installing VBG O
itself PRP O
on IN O
the DT O
/system NN O
partition NN O
to TO O
persist VB O
across IN O
factory NN O
resets NNS O
Removing VBG O
Samsung NNP B-Organization
's POS O
system NN O
update JJ O
app NN O
( ( O
com.sec.android.fotaclient NN B-Indicator
) ) O
and CC O
disabling VBG O
auto-updates NNS O
to TO O
maintain VB O
persistence NN O
( ( O
sets NNS O
Settings.System.SOFTWARE_UPDATE_AUTO_UPDATE NNP B-Indicator
to TO I-Indicator
0 CD I-Indicator
) ) O
Deleting VBG O
WAP NNP O
push NN O
messages NNS O
and CC O
changing VBG O
WAP NNP O
message NN O
settings NNS O
, , O
possibly RB O
for IN O
anti-forensic JJ O
purpose NN O
. . O

Starting VBG O
content JJ O
observers NNS O
and CC O
the DT O
main JJ O
task NN O
loop NN O
to TO O
receive VB O
remote JJ O
commands NNS O
and CC O
exfiltrate VB O
data NNS O
The DT O
app NN O
uses VBZ O
six CD O
techniques NNS O
to TO O
collect VB O
user JJ O
data NNS O
: : O
Repeated VBN O
commands NNS O
: : O
use NN O
alarms NNS O
to TO O
periodically RB O
repeat VB O
actions NNS O
on IN O
the DT O
device NN O
to TO O
expose VB O
data NNS O
, , O
including VBG O
gathering VBG O
location NN O
data NNS O
. . O

Data NNS O
collectors NNS O
: : O
dump VB O
all DT O
existing VBG O
content NN O
on IN O
the DT O
device NN O
into IN O
a DT O
queue NN O
. . O

Data NNP O
collectors NNS O
are VBP O
used VBN O
in IN O
conjunction NN O
with IN O
repeated JJ O
commands NNS O
to TO O
collect VB O
user JJ O
data NNS O
including VBG O
, , O
SMS NNP O
settings NNS O
, , O
SMS NNP O
messages NNS O
, , O
Call NNP O
logs VBZ O
, , O
Browser NNP O
History NNP O
, , O
Calendar NNP O
, , O
Contacts NNP O
, , O
Emails NNP O
, , O
and CC O
messages NNS O
from IN O
selected VBN O
messaging NN O
apps NN O
, , O
including VBG O
WhatsApp NNP B-System
, , O
Twitter NNP B-System
, , O
Facebook NNP B-System
, , O
Kakoa NNP B-System
, , O
Viber NNP B-System
, , O
and CC O
Skype NNP B-System
by IN O
making VBG O
/data/data JJ O
directories NNS O
of IN O
the DT O
apps JJ O
world NN O
readable NN O
. . O

Content JJ O
observers NNS O
: : O
use NN O
Android NNP B-System
's POS O
ContentObserver NNP O
framework NN O
to TO O
gather VB O
changes NNS O
in IN O
SMS NNP B-System
, , O
Calendar NNP B-System
, , O
Contacts NNP B-System
, , O
Cell NNP B-System
info NN I-System
, , O
Email NNP B-System
, , O
WhatsApp NNP B-System
, , O
Facebook NNP B-System
, , O
Twitter NNP B-System
, , O
Kakao NNP B-System
, , O
Viber NNP B-System
, , O
and CC O
Skype NNP B-System
. . O

Screenshots NNS O
: : O
captures NNS O
an DT O
image NN O
of IN O
the DT O
current JJ O
screen NN O
via IN O
the DT O
raw JJ O
frame NN O
buffer NN O
. . O

Keylogging VBG O
: : O
record NN O
input NN O
events NNS O
by IN O
hooking VBG O
IPCThreadState NNP O
: : O
:Transact NN O
from IN O
/system/lib/libbinder.so NNP B-Indicator
, , O
and CC O
intercepting VBG O
android NN B-Indicator
: : I-Indicator
:parcel NN I-Indicator
with IN O
the DT O
interface NN O
com.android.internal.view.IInputContext NN B-Indicator
. . O

RoomTap NN O
: : O
silently RB O
answers VBZ O
a DT O
telephone NN O
call NN O
and CC O
stays NNS O
connected VBN O
in IN O
the DT O
background NN O
, , O
allowing VBG O
the DT O
caller NN O
to TO O
hear VB O
conversations NNS O
within IN O
the DT O
range NN O
of IN O
the DT O
phone NN O
's POS O
microphone NN O
. . O

If IN O
the DT O
user NN O
unlocks VBZ O
their PRP$ O
device NN O
, , O
they PRP O
will MD O
see VB O
a DT O
black JJ O
screen NN O
while IN O
the DT O
app JJ O
drops VBZ O
the DT O
call NN O
, , O
resets VBZ O
call JJ O
settings NNS O
and CC O
prepares NNS O
for IN O
the DT O
user NN O
to TO O
interact VB O
with IN O
the DT O
device NN O
normally RB O
. . O

Finally RB O
, , O
the DT O
app NN O
can MD O
remove VB O
itself PRP O
through IN O
three CD O
ways NNS O
: : O
Via VB O
a DT O
command NN O
from IN O
the DT O
server NN O
Autoremove NNP O
if IN O
the DT O
device NN O
has VBZ O
not RB O
been VBN O
able JJ O
to TO O
check VB O
in IN O
to TO O
the DT O
server NN O
after IN O
60 CD O
days NNS O
Via NNP O
an DT O
antidote NN O
file NN O
. . O

If IN O
/sdcard/MemosForNotes NNS B-Indicator
was VBD O
present JJ O
on IN O
the DT O
device NN O
, , O
the DT O
Chrysaor NNP B-Malware
app NN O
removes VBZ O
itself PRP O
from IN O
the DT O
device NN O
. . O

Samples NNS O
uploaded VBD O
to TO O
VirusTotal NNP B-Organization
To TO O
encourage VB O
further JJ O
research NN O
in IN O
the DT O
security NN O
community NN O
, , O
we PRP O
’ VBP O
ve RB O
uploaded JJ O
these DT O
sample JJ O
Chrysaor NNP B-Malware
apps NN O
to TO O
Virus NNP B-Organization
Total NNP I-Organization
. . O

Package NN O
Name NNP O
SHA256 NNP O
digest JJS O
SHA1 NNP O
certificate NN O
com.network.android NN B-Indicator
ade8bef0ac29fa363fc9afd958af0074478aef650adeb0318517b48bd996d5d5 VBZ B-Indicator
44f6d1caa257799e57f0ecaf4e2e216178f4cb3d CD B-Indicator
com.network.android NN B-Indicator
3474625e63d0893fc8f83034e835472d95195254e1e4bdf99153b7c74eb44d86 CD B-Indicator
516f8f516cc0fd8db53785a48c0a86554f75c3ba CD B-Indicator

Additional JJ O
digests NNS O
with IN O
links NNS O
to TO O
Chrysaor NNP B-Malware
As IN O
a DT O
result NN O
of IN O
our PRP$ O
investigation NN O
we PRP O
have VBP O
identified VBN O
these DT O
additional JJ O
Chrysaor-related JJ B-Malware
apps NN O
. . O

Package NN O
Name NNP O
SHA256 NNP O
digest JJS O
SHA1 NNP O
certificate NN O
com.network.android VBD B-Indicator
98ca5f94638768e7b58889bb5df4584bf5b6af56b188da48c10a02648791b30c CD B-Indicator
516f8f516cc0fd8db53785a48c0a86554f75c3ba CD B-Indicator
com.network.android NN B-Indicator
5353212b70aa096d918e4eb6b49eb5ad8f59d9bec02d089e88802c01e707c3a1 CD B-Indicator

44f6d1caa257799e57f0ecaf4e2e216178f4cb3d CD B-Indicator
com.binary.sms.receiver NN B-Indicator
9fae5d148b89001555132c896879652fe1ca633d35271db34622248e048c78ae CD B-Indicator
7771af1ad3a3d9c0b4d9b55260bb47c2692722cf CD B-Indicator
com.android.copy NN B-Indicator
e384694d3d17cd88ec3a66c740c6398e07b8ee401320ca61e26bdf96c20485b4 NN B-Indicator

7771af1ad3a3d9c0b4d9b55260bb47c2692722cf CD B-Indicator
com.android.copy NN B-Indicator
12e085ab85db887438655feebd249127d813e31df766f8c7b009f9519916e389 CD B-Indicator
7771af1ad3a3d9c0b4d9b55260bb47c2692722cf CD B-Indicator
com.android.copy NN B-Indicator
6348104f8ef22eba5ac8ee737b192887629de987badbb1642e347d0dd01420f8 CD B-Indicator

31a8633c2cd67ae965524d0b2192e9f14d04d016 CD B-Indicator
FinFisher NNP B-Malware
exposed VBD O
: : O
A DT O
researcher NN O
’ NN O
s JJ O
tale NN O
of IN O
defeating VBG O
traps NNS O
, , O
tricks NNS O
, , O
and CC O
complex JJ O
virtual JJ O
machines NNS O
March NNP O
1 CD O
, , O
2018 CD O
Office NNP B-System
365 CD I-System
Advanced NNP I-System
Threat NNP I-System
Protection NNP I-System
( ( O
Office NNP B-System
365 CD I-System
ATP NNP I-System
) ) O
blocked VBD O
many JJ O
notable JJ O
zero-day JJ O
exploits NNS O
in IN O
2017 CD O
. . O

In IN O
our PRP$ O
analysis NN O
, , O
one CD O
activity NN O
group NN O
stood VBD O
out RP O
: : O
NEODYMIUM NN B-Malware
. . O

This DT O
threat NN O
actor NN O
is VBZ O
remarkable JJ O
for IN O
two CD O
reasons NNS O
: : O
Its PRP$ O
access NN O
to TO O
sophisticated JJ O
zero-day JJ O
exploits NNS O
for IN O
Microsoft NNP B-Organization
and CC O
Adobe NNP B-Organization
software NN O
Its PRP$ O
use NN O
of IN O
an DT O
advanced JJ O
piece NN O
of IN O
government-grade JJ O
surveillance NN O
spyware NN O
FinFisher NNP B-Malware
, , O
also RB O
known VBN O
as IN O
FinSpy NNP B-Malware
and CC O
detected VBN O
by IN O
Microsoft NNP B-Organization
security NN O
products NNS O
as IN O
Wingbird NNP B-Malware
FinFisher NNP B-Malware
is VBZ O
such JJ O
a DT O
complex JJ O
piece NN O
of IN O
malware NN O
that IN O
, , O
like IN O
other JJ O
researchers NNS O
, , O
we PRP O
had VBD O
to TO O
devise VB O
special JJ O
methods NNS O
to TO O
crack VB O
it PRP O
. . O

We PRP O
needed VBD O
to TO O
do VB O
this DT O
to TO O
understand VB O
the DT O
techniques NNS O
FinFisher NNP B-Malware
uses VBZ O
to TO O
compromise VB O
and CC O
persist VB O
on IN O
a DT O
machine NN O
, , O
and CC O
to TO O
validate VB O
the DT O
effectiveness NN O
of IN O
Office NNP B-System
365 CD I-System
ATP NNP I-System
detonation NN O
sandbox NN O
, , O
Windows NNP B-System
Defender NNP I-System
Advanced NNP I-System
Threat NNP I-System
Protection NNP I-System
( ( O
Windows NNP B-System
Defender NNP I-System
ATP NNP I-System
) ) O
generic JJ O
detections NNS O
, , O
and CC O
other JJ O
Microsoft NNP B-Organization
security NN O
solutions NNS O
. . O

This DT O
task NN O
proved VBD O
to TO O
be VB O
nontrivial JJ O
. . O

FinFisher NNP B-Malware
is VBZ O
not RB O
afraid JJ O
of IN O
using VBG O
all DT O
kinds NNS O
of IN O
tricks NNS O
, , O
ranging VBG O
from IN O
junk NN O
instructions NNS O
and CC O
“ NNP O
spaghetti VBP O
code NN O
” NN O
to TO O
multiple JJ O
layers NNS O
of IN O
virtual JJ O
machines NNS O
and CC O
several JJ O
known VBN O
and CC O
lesser-known JJ O
anti-debug NN O
and CC O
defensive JJ O
measures NNS O
. . O

Security NN O
analysts NNS O
are VBP O
typically RB O
equipped VBN O
with IN O
the DT O
tools NNS O
to TO O
defeat VB O
a DT O
good JJ O
number NN O
of IN O
similar JJ O
tricks NNS O
during IN O
malware JJ O
investigations NNS O
. . O

However RB O
, , O
FinFisher NNP B-Malware
is VBZ O
in IN O
a DT O
different JJ O
category NN O
of IN O
malware NN O
for IN O
the DT O
level NN O
of IN O
its PRP$ O
anti-analysis NN O
protection NN O
. . O

It PRP O
’ VBZ O
s VBZ O
a DT O
complicated JJ O
puzzle NN O
that WDT O
can MD O
be VB O
solved VBN O
by IN O
skilled JJ O
reverse NN O
engineers NNS O
only RB O
with IN O
good JJ O
amount NN O
of IN O
time NN O
, , O
code NN O
, , O
automation NN O
, , O
and CC O
creativity NN O
. . O

The DT O
intricate JJ O
anti-analysis NN O
methods NNS O
reveal VB O
how WRB O
much JJ O
effort NN O
the DT O
FinFisher NNP B-Malware
authors NNS O
exerted VBD O
to TO O
keep VB O
the DT O
malware NN O
hidden NN O
and CC O
difficult JJ O
to TO O
analyze VB O
. . O

This DT O
exercise NN O
revealed VBD O
tons NNS O
of IN O
information NN O
about IN O
techniques NNS O
used VBN O
by IN O
FinFisher NNP B-Malware
that IN O
we PRP O
used VBD O
to TO O
make VB O
Office NNP B-System
365 CD I-System
ATP NNP I-System
more RBR O
resistant JJ O
to TO O
sandbox VB O
detection NN O
and CC O
Windows NNP B-System
Defender NNP I-System
ATP NNP I-System
to TO O
catch VB O
similar JJ O
techniques NNS O
and CC O
generic JJ O
behaviors NNS O
. . O

Using VBG O
intelligence NN O
from IN O
our PRP$ O
in-depth JJ O
investigation NN O
, , O
Windows NNP B-System
Defender NNP I-System
ATP NNP I-System
can MD O
raise VB O
alerts NNS O
for IN O
malicious JJ O
behavior NN O
employed VBN O
by IN O
FinFisher NNP B-Malware
( ( O
such JJ O
as IN O
memory NN O
injection NN O
in IN O
persistence NN O
) ) O
in IN O
different JJ O
stages NNS O
of IN O
the DT O
attack NN O
kill NN O
chain NN O
. . O

Machine NN O
learning NN O
in IN O
Windows NNP B-System
Defender NNP I-System
ATP NNP I-System
further RB O
flags RB O
suspicious JJ O
behaviors NNS O
observed VBD O
related JJ O
to TO O
the DT O
manipulation NN O
of IN O
legitimate JJ O
Windows NNP B-System
binaries NNS O
. . O

Figure NN O
1 CD O
. . O

Generic NNP O
Windows NNP B-System
Defender NNP I-System
ATP NNP I-System
detections NNS O
trigger NN O
alerts NNS O
on IN O
FinFisher NNP B-Malware
behavior NN O
While IN O
our PRP$ O
analysis NN O
has VBZ O
allowed VBN O
us PRP O
to TO O
immediately RB O
protect VB O
our PRP$ O
customers NNS O
, , O
we PRP O
’ VBP O
d NNS O
like IN O
to TO O
share NN O
our PRP$ O
insights NNS O
and CC O
add VB O
to TO O
the DT O
growing VBG O
number NN O
of IN O
published VBN O
analyses NNS O
by IN O
other JJ O
talented JJ O
researchers NNS O
( ( O
listed VBN O
below IN O
this DT O
blog NN O
post NN O
) ) O
. . O

We PRP O
hope VBP O
that IN O
this DT O
blog NN O
post NN O
helps VBZ O
other JJ O
researchers NNS O
to TO O
understand VB O
and CC O
analyze VB O
FinFisher NNP B-Malware
samples NNS O
and CC O
that IN O
this DT O
industry-wide JJ O
information-sharing JJ O
translate NN O
to TO O
the DT O
protection NN O
of IN O
as IN O
many JJ O
customers NNS O
as IN O
possible JJ O
. . O

Spaghetti NNP O
and CC O
junk NN O
codes NNS O
make VBP O
common JJ O
analyst NN O
tools NNS O
ineffective VBP O
In IN O
analyzing VBG O
FinFisher NNP B-Malware
, , O
the DT O
first JJ O
obfuscation NN O
problem NN O
that WDT O
requires VBZ O
a DT O
solution NN O
is VBZ O
the DT O
removal NN O
of IN O
junk NN O
instructions NNS O
and CC O
“ NNP O
spaghetti VBP O
code NN O
” NN O
, , O
which WDT O
is VBZ O
a DT O
technique NN O
that WDT O
aims VBZ O
to TO O
confuse VB O
disassembly RB O
programs NNS O
. . O

Spaghetti NNP O
code NN O
makes VBZ O
the DT O
program NN O
flow NN O
hard RB O
to TO O
read VB O
by IN O
adding VBG O
continuous JJ O
code NN O
jumps NNS O
, , O
hence RB O
the DT O
name NN O
. . O

An DT O
example NN O
of IN O
FinFisher NNP B-Malware
’ NNP O
s VBD O
spaghetti JJ O
code NN O
is VBZ O
shown VBN O
below IN O
. . O

Figure NN O
2 CD O
. . O

The DT O
spaghetti NNS O
code NN O
in IN O
FinFisher NNP B-Malware
dropper NN O
This DT O
problem NN O
is VBZ O
not RB O
novel JJ O
, , O
and CC O
in IN O
common JJ O
situations NNS O
there EX O
are VBP O
known VBN O
reversing VBG O
plugins NNS O
that WDT O
may MD O
help VB O
for IN O
this DT O
task NN O
. . O

In IN O
the DT O
case NN O
of IN O
FinFisher NNP B-Malware
, , O
however RB O
, , O
we PRP O
could MD O
not RB O
find VB O
a DT O
good JJ O
existing VBG O
interactive JJ O
disassembler NN O
( ( O
IDA NNP O
) ) O
plugin VBP O
that WDT O
can MD O
normalize VB O
the DT O
code NN O
flow NN O
. . O

So IN O
we PRP O
decided VBD O
to TO O
write VB O
our PRP$ O
own JJ O
plugin NN O
code NN O
using VBG O
IDA NNP O
Python NNP B-System
. . O

Armed VBN O
with IN O
this DT O
code NN O
, , O
we PRP O
removed VBD O
this DT O
first JJ O
layer NN O
of IN O
anti-analysis NN O
protection NN O
. . O

Removing VBG O
the DT O
junk NN O
instructions NNS O
revealed VBD O
a DT O
readable JJ O
block NN O
of IN O
code NN O
. . O

This DT O
code NN O
starts VBZ O
by IN O
allocating VBG O
two CD O
chunks NNS O
of IN O
memory NN O
: : O
a DT O
global JJ O
1 CD O
MB NNP O
buffer NN O
and CC O
one CD O
64 CD O
KB NNP O
buffer NN O
per IN O
thread NN O
. . O

The DT O
big JJ O
first JJ O
buffer NN O
is VBZ O
used VBN O
as IN O
index NN O
for IN O
multiple JJ O
concurrent JJ O
threads NNS O
. . O

A DT O
big JJ O
chunk NN O
of IN O
data NNS O
is VBZ O
extracted VBN O
from IN O
the DT O
portable JJ O
executable JJ O
( ( O
PE NNP O
) ) O
file NN O
itself PRP O
and CC O
decrypted VBD O
two CD O
times NNS O
using VBG O
a DT O
custom NN O
XOR NNP O
algorithm NN O
. . O

We PRP O
determined VBD O
that IN O
this DT O
chunk NN O
of IN O
data NN O
contains NNS O
an DT O
array NN O
of IN O
opcode NN O
instructions NNS O
ready JJ O
to TO O
be VB O
interpreted VBN O
by IN O
a DT O
custom JJ O
virtual JJ O
machine NN O
program NN O
( ( O
from IN O
this DT O
point NN O
on IN O
referenced VBN O
generically RB O
as IN O
“ JJ O
VM NNP O
” NNP O
) ) O
implemented VBN O
by IN O
FinFisher NNP B-Malware
authors NNS O
. . O

Figure NN O
3 CD O
. . O

The DT O
stages NNS O
of IN O
the DT O
FinFisher NNP B-Malware
multi-layered JJ O
protection NN O
mechanisms NNS O
Stage NNP O
0 CD O
: : O
Dropper NN O
with IN O
custom JJ O
virtual JJ O
machine NN O
The DT O
main JJ O
dropper NN O
implements VBZ O
the DT O
VM NNP O
dispatcher NN O
loop NN O
and CC O
can MD O
use VB O
32 CD O
different JJ O
opcodes NNS O
handlers NNS O
. . O

Th $ O
64KB CD O
buffer NN O
is VBZ O
used VBN O
as IN O
a DT O
VM NNP O
descriptor NN O
data NNS O
structure NN O
to TO O
store VB O
data NNS O
and CC O
the DT O
just-in-time NN O
( ( O
JIT NNP O
) ) O
generated VBD O
code NN O
to TO O
run VB O
. . O

The DT O
VM NNP O
dispatcher NN O
loop NN O
routine JJ O
ends VBZ O
with IN O
a DT O
JMP NNP O
to TO O
another DT O
routine NN O
. . O

In IN O
total JJ O
, , O
there EX O
are VBP O
32 CD O
different JJ O
routines NNS O
, , O
each DT O
of IN O
them PRP O
implementing VBG O
a DT O
different JJ O
opcode NN O
and CC O
some DT O
basic JJ O
functionality NN O
that IN O
the DT O
malware JJ O
program NN O
may MD O
execute VB O
. . O

Figure NN O
4 CD O
. . O

A DT O
snapshot NN B-Malware
of IN O
the DT O
code NN O
that WDT O
processes VBZ O
each DT O
VM NNP O
opcode NN O
and CC O
the DT O
associate JJ O
interpreter NN O
The DT O
presence NN O
of IN O
a DT O
VM NNP O
and CC O
virtualized VBN O
instruction NN O
blocks NNS O
can MD O
be VB O
described VBN O
in IN O
simpler NN O
terms NNS O
: : O
Essentially RB O
, , O
the DT O
creators NNS O
of IN O
FinFisher NNP B-Malware
interposed VBD O
a DT O
layer NN O
of IN O
dynamic JJ O
code NN O
translation NN O
( ( O
the DT O
virtual JJ O
machine NN O
) ) O
that WDT O
makes VBZ O
analysis NN O
using VBG O
regular JJ O
tools NNS O
practically RB O
impossible JJ O
. . O

Static JJ O
analysis NN O
tools NNS O
like IN O
IDA NNP O
may MD O
not RB O
be VB O
useful JJ O
in IN O
analyzing VBG O
custom NN O
code NN O
that WDT O
is VBZ O
interpreted VBN O
and CC O
executed VBN O
through IN O
a DT O
VM NNP O
and CC O
a DT O
new JJ O
set NN O
of IN O
instructions NNS O
. . O

On IN O
the DT O
other JJ O
hand NN O
, , O
dynamic JJ O
analysis NN O
tools NNS O
( ( O
like IN O
debuggers NNS O
or CC O
sandbox NN O
) ) O
face VBP O
the DT O
anti-debug JJ O
and CC O
anti-analysis JJ O
tricks NNS O
hidden VBN O
in IN O
the DT O
virtualized JJ O
code NN O
itself PRP O
that WDT O
detects VBZ O
sandbox JJ O
environments NNS O
and CC O
alters NNS O
the DT O
behavior NN O
of IN O
the DT O
malware NN O
. . O

At IN O
this DT O
stage NN O
, , O
the DT O
analysis NN O
can MD O
only RB O
continue VB O
by IN O
manually RB O
investigating VBG O
the DT O
individual JJ O
code NN O
blocks NNS O
and CC O
opcode NN O
handlers NNS O
, , O
which WDT O
are VBP O
highly RB O
obfuscated VBN O
( ( O
also RB O
using VBG O
spaghetti NNS O
code NN O
) ) O
. . O

Reusing VBG O
our PRP$ O
deobfuscation NN O
tool NN O
and CC O
some DT O
other JJ O
tricks NNS O
, , O
we PRP O
have VBP O
been VBN O
able JJ O
to TO O
reverse VB O
and CC O
analyze VB O
these DT O
opcodes NNS O
and CC O
map VB O
them PRP O
to TO O
a DT O
finite JJ O
list NN O
that WDT O
can MD O
be VB O
used VBN O
later RB O
to TO O
automate VB O
the DT O
analysis NN O
process NN O
with IN O
some DT O
scripting NN O
. . O

The DT O
opcode NN O
instructions NNS O
generated VBN O
by IN O
this DT O
custom NN O
VM NNP O
are VBP O
divided VBN O
into IN O
different JJ O
categories NNS O
: : O
Logical NNP O
opcodes NNS O
, , O
which WDT O
implement VBP O
bit-logic NN O
operators NNS O
( ( O
OR NNP O
, , O
AND NNP O
, , O
NOT NNP O
, , O
XOR NNP O
) ) O
and CC O
mathematical JJ O
operators NNS O
Conditional NNP O
branching NN O
opcodes NNS O
, , O
which WDT O
implement VBP O
a DT O
code NN O
branch NN O
based VBN O
on IN O
conditions NNS O
( ( O
equals NNS O
to TO O
JC NNP O
, , O
JE NNP O
, , O
JZ NNP O
, , O
other JJ O
similar JJ O
branching VBG O
opcodes NNS O
) ) O
Load/Store NNP O
opcodes NNS O
, , O
which WDT O
write VBP O
to TO O
or CC O
read VB O
from IN O
particular JJ O
addresses NNS O
of IN O
the DT O
virtual JJ O
address NN O
space NN O
of IN O
the DT O
process NN O
Specialized NNP O
opcodes VBZ O
for IN O
various JJ O
purposes NNS O
, , O

like IN O
execute JJ O
specialized JJ O
machine NN O
instruction NN O
that WDT O
are VBP O
not RB O
virtualized VBN O
We PRP O
are VBP O
publishing VBG O
below IN O
the DT O
( ( O
hopefully RB O
) ) O
complete JJ O
list NN O
of IN O
opcodes NNS O
used VBN O
by IN O
FinFisher NNP B-Malware
VM NNP O
that IN O
we PRP O
found VBD O
during IN O
our PRP$ O
analysis NN O
and CC O
integrated VBN O
into IN O
our PRP$ O
de-virtualization JJ O
script NN O
: : O
INDEX NNP O
MNEMONIC NNP O
DESCRIPTION NNP O
0x0 CD O
EXEC NNP O
Execute NNP O
machine NN O
code NN O
0x1 CD O
JG NNP O
Jump NNP O
if IN O
greater/Jump NN O
if IN O
not RB O
less RBR O
or CC O
equal JJ O
0x2 CD O
WRITE NNP O
Write NNP O
a DT O
value NN O
into IN O
the DT O
dereferenced JJ O
internal JJ O
VM NNP O
value NN O
( ( O
treated VBN O
as IN O
a DT O
pointer NN O
) ) O
0x3 CD O
JNO NNP O
Jump NNP O
if IN O
not RB O
overflow JJ O
0x4 CD O
JLE NNP O
Jump NNP O

if IN O
less JJR O
or CC O
equal JJ O
( ( O
signed VBN O
) ) O
0x5 CD O
MOV NNP O
Move NNP O
the DT O
value NN O
of IN O
a DT O
register NN O
into IN O
the DT O
VM NNP O
descriptor NN O
( ( O
same JJ O
as IN O
opcode JJ O
0x1F CD O
) ) O
0x6 CD O
JO NNP O
Jump NNP O
if IN O
overflow JJ O
0x7 CD O
PUSH NNP O
Push NNP O
the DT O
internal JJ O
VM NNP O
value NN O
to TO O
the DT O
stack NN O
0x8 CD O
ZERO NNP O
Reset NNP O
the DT O
internal JJ O
VM NNP O
value NN O
to TO O
0 CD O
( ( O
zero NN O
) ) O
0x9 CD O
JP NNP O
Jump NNP O
if IN O
parity NN O
even RB O
0xA CD O
WRITE NNP O
Write NNP O
into IN O
an DT O
address NN O
0xB CD O
ADD NNP O
Add NNP O
the DT O
value NN O
of IN O
a DT O
register NN O
to TO O
the DT O
internal JJ O
VM NNP O
value NN O
0xC CD O
JNS NNP O
Jump NNP O
if IN O
not RB O
signed VBN O
0xD CD O
JL NNP O
Jump NNP O
if IN O
less JJR O
( ( O
signed VBN O
) ) O
0xE CD O

EXEC NNP O
Execute NNP O
machine NN O
code NN O
and CC O
branch NN O
0xF CD O
JBE NNP O
Jump NNP O
if IN O
below IN O
or CC O
equal JJ O
or CC O
Jump NNP O
if IN O
not RB O
above IN O
0x10 CD O
SHL NNP O
Shift NNP O
left VBD O
the DT O
internal JJ O
value NN O
the DT O
number NN O
of IN O
times NNS O
specified VBN O
into IN O
the DT O
opcodes NNS O
0x11 CD O
JA NNP O
Jump NNP O
if IN O
above/Jump NN O
if IN O
not RB O
below IN O
or CC O
equal JJ O
0x12 CD O
MOV NNP O
Move NNP O
the DT O
internal JJ O
VM NNP O
value NN O
into IN O
a DT O
register NN O
0x13 CD O
JZ NNP O
JMP NNP O
if IN O
zero CD O
0x14 CD O
ADD NNP O
Add NNP O
an DT O
immediate JJ O
value NN O
to TO O
the DT O
internal JJ O
Vm NNP O
descriptor NN O
0x15 CD O
JB NNP O
Jump NNP O
if IN O
below IN O
( ( O
unsigned JJ O
) ) O
0x16 CD O
JS NNP O
Jump NNP O
if IN O
signed VBN O
0x17 CD O
EXEC NNP O
Execute NNP O

machine NN O
code NN O
( ( O
same JJ O
as IN O
opcode JJ O
0x0 CD O
) ) O
0x18 CD O
JGE NNP O
Jump NNP O
if IN O
greater JJR O
or CC O
equal/Jump VB O
if IN O
not RB O
less JJR O
0x19 CD O
DEREF NNP O
Write NNP O
a DT O
register NN O
value NN O
into IN O
a DT O
dereferenced JJ O
pointer NN O
0x1A CD O
JMP NNP O
Special NNP O
obfuscated VBD O
“ NNP O
Jump NNP O
if IN O
below IN O
” NNP O
opcode VBD O
0x1B CD O
* NNP O
Resolve NNP O
a DT O
pointer NN O
0x1C CD O
LOAD NNP O
Load NNP O
a DT O
value NN O
into IN O
the DT O
internal JJ O
VM NNP O
descriptor NN O
0x1D CD O
JNE NNP O
Jump NNP O
if IN O
not RB O
equal/Jump VB O
if IN O
not RB O
zero CD O
0x1E CD O
CALL NNP O
Call NNP O
an DT O
external JJ O
function NN O
or CC O
a DT O
function NN O
located VBN O
in IN O
the DT O
dropper NN O
0x1F CD O
MOV NNP O

Move IN O
the DT O
value NN O
of IN O
a DT O
register NN O
into IN O
the DT O
VM NNP O
descriptor NN O
0x20 CD O
JNB NNP O
Jump NNP O
if IN O
not RB O
below/Jump VB O
if IN O
above IN O
or CC O
equal/Jump VB O
if IN O
not RB O
carry VB O
0x21 CD O
JNP NNP O
Jump NNP O
if IN O
not RB O
parity/Jump VB O
if IN O
parity NN O
odd VBP O
Each DT O
virtual JJ O
instruction NN O
is VBZ O
stored VBN O
in IN O
a DT O
special JJ O
data NN O
structure NN O
that WDT O
contains VBZ O
all PDT O
the DT O
information NN O
needed VBD O
to TO O
be VB O
properly RB O
read VBN O
and CC O
executed VBN O
by IN O
the DT O
VM NNP O
. . O

This DT O
data NN O
structure NN O
is VBZ O
24 CD O
bytes NNS O
and CC O
is VBZ O
composed VBN O
of IN O
some DT O
fixed VBN O
fields NNS O
and CC O
a DT O
variable JJ O
portion NN O
that WDT O
depends VBZ O
on IN O
the DT O
opcode NN O
. . O

Before IN O
interpreting VBG O
the DT O
opcode NN O
, , O
the DT O
VM NNP O
decrypts VBZ O
the DT O
opcode NN O
’ NNP O
s NN O
content NN O
( ( O
through IN O
a DT O
simple JJ O
XOR NNP O
algorithm NN O
) ) O
, , O
which WDT O
it PRP O
then RB O
relocates VBZ O
( ( O
if IN O
needed VBN O
) ) O
, , O
using VBG O
the DT O
relocation NN O
fields NNS O
. . O

Here RB O
is VBZ O
an DT O
approximate JJ O
diagram NN O
of IN O
the DT O
opcode NN O
data NNS O
structure NN O
: : O
Figure NN O
5 CD O
. . O

A DT O
graphical JJ O
representation NN O
of IN O
the DT O
data NN O
structure NN O
used VBN O
to TO O
store VB O
each DT O
VM NNP O
opcode VBD O
The DT O
VM NNP O
handler NN O
is VBZ O
completely RB O
able JJ O
to TO O
generate VB O
different JJ O
code NN O
blocks NNS O
and CC O
deal NN O
with IN O
relocated JJ O
code NN O
due JJ O
to TO O
address VB O
space NN O
layout IN O
randomization NN O
( ( O
ASLR NNP O
) ) O
. . O

It PRP O
is VBZ O
also RB O
able JJ O
to TO O
move VB O
code NN O
execution NN O
into IN O
different JJ O
locations NNS O
if IN O
needed VBN O
. . O

For IN O
instance NN O
, , O
in IN O
the DT O
case NN O
of IN O
the DT O
“ NNP O
Execute NNP O
” NNP O
opcode NN O
( ( O
0x17 CD O
) ) O
, , O
the DT O
32-bit JJ O
code NN O
to TO O
run VB O
is VBZ O
stored VBN O
entirely RB O
into IN O
the DT O
variable JJ O
section NN O
with IN O
the DT O
value NN O
at IN O
offset $ O
5 CD O
specifying VBG O
the DT O
number NN O
of IN O
bytes NNS O
to TO O
be VB O
copied VBN O
and CC O
executed VBN O
. . O

Otherwise RB O
, , O
in IN O
the DT O
case NN O
of IN O
conditional JJ O
opcodes NNS O
, , O
the DT O
variable JJ O
part NN O
can MD O
contain VB O
the DT O
next JJ O
JIT NNP O
packet NN O
ID NNP O
or CC O
the DT O
next JJ O
relative JJ O
virtual JJ O
address NN O
( ( O
RVA NNP O
) ) O
where WRB O
code JJ O
execution NN O
should MD O
continue VB O
. . O

Of IN O
course NN O
, , O
not RB O
all PDT O
the DT O
opcodes NNS O
are VBP O
can MD O
be VB O
easily RB O
read VBN O
and CC O
understood JJ O
due JJ O
to TO O
additional JJ O
steps NNS O
that IN O
the DT O
authors NNS O
have VBP O
taken VBN O
to TO O
make VB O
analysis NN O
extremely RB O
complicated VBN O
. . O

For IN O
example NN O
, , O
this DT O
is VBZ O
how WRB O
opcode JJ O
0x1A CD O
is VBZ O
implemented VBN O
: : O
The DT O
opcode NN O
should MD O
represent VB O
a DT O
JB NNP O
( ( O
Jump NNP O
if IN O
below IN O
) ) O
function NN O
, , O
but CC O
it PRP O
’ VBZ O
s NN O
implemented VBN O
through IN O
set VBN O
carry NN O
( ( O
STC NNP O
) ) O
instruction NN O
followed VBN O
by IN O
a DT O
JMP NNP O
into IN O
the DT O
dispatcher NN O
code NN O
that WDT O
will MD O
verify VB O
the DT O
carry NN O
flag JJ O
condition NN O
set VBN O
by IN O
STC NNP O
. . O

Figure NN O
6 CD O
. . O

One CD O
of IN O
the DT O
obfuscation NN O
tricks NNS O
included VBN O
by IN O
the DT O
malware NN O
authors NNS O
in IN O
a DT O
VM NNP O
opcode NN O
dispatcher RB O
Even RB O
armed VBN O
with IN O
the DT O
knowledge NN O
we PRP O
have VBP O
described VBN O
so RB O
far RB O
, , O
it PRP O
still RB O
took VBD O
us PRP O
many JJ O
hours NNS O
to TO O
write VB O
a DT O
full-fledged JJ O
opcode NN O
interpreter NN O
that WDT O
’ VBZ O
s RB O
able JJ O
to TO O
reconstruct VB O
the DT O
real JJ O
code NN O
executed VBN O
by IN O
FinFisher NNP B-Malware
. . O

Stage NN O
1 CD O
: : O
Loader NN O
malware NN O
keeps VBZ O
sandbox NN O
and CC O
debuggers NNS O
away RP O
The DT O
first JJ O
stage NN O
of IN O
FinFisher NNP B-Malware
running VBG O
through IN O
this DT O
complicated VBN O
virtual JJ O
machine NN O
is VBZ O
a DT O
loader NN O
malware NN O
designed VBN O
to TO O
probe VB O
the DT O
system NN O
and CC O
determine VB O
whether IN O
it PRP O
’ NNP O
s VBD O
running VBG O
in IN O
a DT O
sandbox NN O
environment NN O
( ( O
typical JJ O
for IN O
cloud-based JJ O
detonation NN O
solution NN O
like IN O
Office NNP B-System
365 CD I-System
ATP NNP I-System
) ) O
. . O

The DT O
loader NN O
first RB O
dynamically RB O
rebuilds VB O
a DT O
simple JJ O
import NN O
address NN O
table NN O
( ( O
IAT NNP O
) ) O
, , O
resolving VBG O
all PDT O
the DT O
API NNP O
needed VBD O
from IN O
Kernel32 NNP O
and CC O
NtDll NNP O
libraries NNS O
. . O

It PRP O
then RB O
continues VBZ O
executing VBG O
in IN O
a DT O
spawned JJ O
new JJ O
thread NN O
that IN O
checks VBZ O
if IN O
there EX O
are VBP O
additional JJ O
undesired JJ O
modules NNS O
inside IN O
its PRP$ O
own JJ O
virtual JJ O
address NN O
space NN O
( ( O
for IN O
example NN O
, , O
modules NNS O
injected VBN O
by IN O
certain JJ O
security NN O
solutions NNS O
) ) O
. . O

It PRP O
eventually RB O
kills VBZ O
all DT O
threads NNS O
that WDT O
belong VBP O
to TO O
these DT O
undesired JJ O
modules NNS O
( ( O
using VBG O
ZwQueryInformationThread NNP O
native JJ O
API NNP O
with IN O
ThreadQuerySetWin32StartAddress NNP O
information NN O
class NN O
) ) O
. . O

The DT O
first JJ O
anti-sandbox JJ O
technique NN O
is VBZ O
the DT O
loader NN O
checking VBG O
the DT O
code NN O
segment NN O
. . O

If IN O
it PRP O
’ VBZ O
s VBZ O
not RB O
0x1B CD O
( ( O
for IN O
32-bit JJ O
systems NNS O
) ) O
or CC O
0x23 CD O
( ( O
for IN O
32-bit JJ O
system NN O
under IN O
Wow64 NNP O
) ) O
, , O
the DT O
loader NN O
exits NNS O
. . O

Next RB O
, , O
the DT O
dropper NN O
checks VBZ O
its PRP$ O
own JJ O
parent NN O
process NN O
for IN O
indications NNS O
that IN O
it PRP O
is VBZ O
running VBG O
in IN O
a DT O
sandbox JJ O
setup NN O
. . O

It PRP O
calculates VBZ O
the DT O
MD5 NNP O
hash NN O
of IN O
the DT O
lower-case JJ O
process NN O
image NN O
name NN O
and CC O
terminates NNS O
if IN O
one CD O
of IN O
the DT O
following JJ O
conditions NNS O
are VBP O
met VBN O
: : O
The DT O
MD5 NNP O
hash NN O
of IN O
the DT O
parent NN O
process NN O
image NN O
name NN O
is VBZ O
either DT O
D0C4DBFA1F3962AED583F6FCE666F8BC NNP B-Indicator
or CC O
3CE30F5FED4C67053379518EACFCF879 CD B-Indicator
The DT O
parent NN O
process NN O
’ NNP O
s CC O
full JJ O
image NN O
path NN O
is VBZ O
equal JJ O
to TO O
its PRP$ O
own JJ O
process NN O
path NN O
If IN O
these DT O
initial JJ O
checks NNS O
are VBP O
passed VBN O
, , O
the DT O
loader NN O
builds VBZ O
a DT O
complete JJ O
IAT NNP O
by IN O
reading VBG O
four CD O
imported JJ O
libraries NNS O
from IN O
disk NN O
( ( O
ntdll.dll JJ B-Indicator

, , O
kernel32.dll NN B-Indicator
, , O
advapi32.dll NN B-Indicator
, , O
and CC O
version.dll NN B-Indicator
) ) O
and CC O
remapping VBG O
them PRP O
in IN O
memory NN O
. . O

This DT O
technique NN O
makes VBZ O
use NN O
of IN O
debuggers NNS O
and CC O
software NN O
breakpoints NNS O
useless JJ O
. . O

During IN O
this DT O
stage NN O
, , O
the DT O
loader NN O
may MD O
also RB O
call VB O
a DT O
certain JJ O
API NNP O
using VBG O
native JJ O
system NN O
calls VBZ O
, , O
which WDT O
is VBZ O
another DT O
way NN O
to TO O
bypass VB O
breakpoints NNS O
on IN O
API NNP O
and CC O
security NN O
solutions NNS O
using VBG O
hooks NNS O
. . O

Figure NN O
7 CD O
. . O

FinFisher NNP B-Malware
loader NN O
calling VBG O
native JJ O
Windows NNP B-System
API NNP O
to TO O
perform VB O
anti-debugging JJ O
tricks NNS O
At IN O
this DT O
point NN O
, , O
the DT O
fun NN O
in IN O
analysis NN O
is VBZ O
not RB O
over IN O
. . O

A DT O
lot NN O
of IN O
additional JJ O
anti-sandbox JJ O
checks NNS O
are VBP O
performed VBN O
in IN O
this DT O
exact JJ O
order NN O
: : O
Check VB O
that IN O
the DT O
malware NN O
is VBZ O
not RB O
executed VBN O
under IN O
the DT O
root NN O
folder NN O
of IN O
a DT O
drive NN O
Check NN O
that IN O
the DT O
malware NN O
file NN O
is VBZ O
readable JJ O
from IN O
an DT O
external JJ O
source NN O
Check NNP O
that IN O
the DT O
hash NN O
of IN O
base JJ O
path NN O
is VBZ O
not RB O
3D6D62AF1A7C8053DBC8E110A530C679 CD B-Indicator
Check NNP O
that IN O
the DT O
full JJ O
malware NN O
path NN O
contains VBZ O
only RB O
human JJ O
readable JJ O
characters NNS O
( ( O
“ JJ O
a-z NN O
” NN O
, , O
“ JJ O
A-Z NNP O
” NNP O
, , O
and CC O
“ JJ O
0-9 JJ O
” NN O
) ) O
Check NNP O
that IN O
no DT O
node NN O
in IN O
the DT O
full JJ O
path NN O
contains VBZ O
the DT O
MD5 NNP O
string NN O
of IN O
the DT O
malware NN O

file NN O
Fingerprint NNP O
the DT O
system NN O
and CC O
check VB O
the DT O
following JJ O
registry NN O
values NNS O
: : O
HKLM\SOFTWARE\Microsoft\Cryptography\MachineGuid NNP B-Indicator
should MD O
not RB O
be VB O
“ JJ O
6ba1d002-21ed-4dbe-afb5-08cf8b81ca32 JJ B-Indicator
” NN O
HKLM\SOFTWARE\Microsoft\Windows NNP B-Indicator
NT\CurrentVersion\DigitalProductId NNP I-Indicator
should MD O
not RB O
be VB O
“ JJ O
55274-649-6478953-23109 JJ B-Indicator
” NN O
, , O
“ JJ O
A22-00001 NNP B-Indicator
” NNP O
, , O
or CC O
“ $ O
47220 CD B-Indicator
” JJ O
HARDWARE\Description\System\SystemBiosDate NNP B-Indicator
should MD O
not RB O
contain VB O
“ JJ O
01/02/03 CD O
” NN O

Check VB O
that IN O
the DT O
mutex NN O
WininetStartupMutex0 NNP O
does VBZ O
not RB O
already RB O
exist VB O
Check NNP O
that IN O
no DT O
DLL NNP O
whose WP$ O
base NN O
name NN O
has VBZ O
hash VBN O
value NN O
of IN O
0xC9CEF3E4 CD B-Indicator
is VBZ O
mapped VBN O
into IN O
the DT O
malware NN O
address JJ O
space NN O
The DT O
hashes NNS O
in IN O
these DT O
checks NNS O
are VBP O
most RBS O
likely JJ O
correspond NN O
to TO O
sandbox VB O
or CC O
security NN O
products NNS O
that IN O
the DT O
FinFisher NNP B-Malware
authors NNS O
want VBP O
to TO O
avoid VB O
. . O

Next RB O
, , O
the DT O
loader NN O
checks VBZ O
that IN O
it PRP O
’ VBZ O
s JJ O
not RB O
running VBG O
in IN O
a DT O
virtualized JJ O
environment NN O
( ( O
VMWare NNP B-System
or CC O
Hyper-V NNP B-System
) ) O
or CC O
under IN O
a DT O
debugger NN O
. . O

For IN O
the DT O
hardware NN O
virtualization NN O
check NN O
, , O
the DT O
loader NN O
obtains VBZ O
the DT O
hardware NN O
device NN O
list NN O
and CC O
checks NNS O
if IN O
the DT O
MD5 NNP O
of IN O
the DT O
vendor NN O
ID NNP O
is VBZ O
equal JJ O
to TO O
a DT O
predefined JJ O
list NN O
. . O

In IN O
our PRP$ O
tests NNS O
, , O
the DT O
malware NN O
sample NN O
was VBD O
able JJ O
to TO O
easily RB O
detect VB O
both DT O
VMWare NNP B-System
and CC O
Hyper-V NNP B-System
environments NNS O
through IN O
the DT O
detection NN O
of IN O
the DT O
virtualized JJ O
peripherals NNS O
( ( O
for IN O
example NN O
, , O
Vmware NNP B-Organization
has VBZ O
VEN_15AD VBN O
as IN O
vendor NN O
ID NNP O
, , O
HyperV NNP O
has VBZ O
VMBus VBN O
as IN O
bus NN O
name NN O
) ) O
. . O

Office RB B-System
365 CD I-System
ATP NNP I-System
sandbox NN O
employs VBZ O
special JJ O
mechanisms NNS O
to TO O
avoid VB O
being VBG O
detected VBN O
by IN O
similar JJ O
checks NNS O
. . O

The DT O
loader NN O
’ NNP O
s VBD O
anti-debugger JJ O
code NN O
is VBZ O
based VBN O
on IN O
the DT O
following JJ O
three CD O
methods NNS O
: : O
The DT O
first JJ O
call NN O
aims VBZ O
to TO O
destroy VB O
the DT O
debugger NN O
connection NN O
: : O
NOTE NN O
: : O
This DT O
call NN O
completely RB O
stops VBZ O
the DT O
execution NN O
of IN O
WinDbg NNP O
and CC O
other JJ O
debuggers NNS O
The DT O
second JJ O
call NN O
tries NNS O
to TO O
detect VB O
the DT O
presence NN O
of IN O
a DT O
debugger NN O
: : O
The DT O
final JJ O
call NN O
tries NNS O
to TO O
destroy VB O
the DT O
possibility NN O
of IN O
adding VBG O
software NN O
breakpoint NN O
: : O
Finally RB O
, , O
if IN O
the DT O
loader NN O
is VBZ O
happy JJ O
with IN O
all PDT O
the DT O
checks NNS O
done VBN O
so RB O
far RB O
, , O
based VBN O
on IN O
the DT O
victim NN O
operating NN O
system NN O
( ( O
32 CD O
or CC O
64-bit JJ O
) ) O
it PRP O
proceeds VBZ O
to TO O
decrypt VB O
a DT O
set NN O
of IN O
fake JJ O
bitmap JJ O
resources NNS O
( ( O
stage NN O
2 CD O

) ) O
embedded VBD O
in IN O
the DT O
executable JJ O
and CC O
prepares VBZ O
the DT O
execution NN O
of IN O
a DT O
new JJ O
layer NN O
of IN O
VM NNP O
decoding NN O
. . O

Each DT O
bitmap NN O
resource NN O
is VBZ O
extracted VBN O
, , O
stripped VBN O
of IN O
the DT O
first JJ O
0x428 CD O
bytes NNS O
( ( O
BMP NNP O
headers NNS O
and CC O
garbage NN O
data NNS O
) ) O
, , O
and CC O
combined VBD O
into IN O
one CD O
file NN O
. . O

The DT O
block NN O
is VBZ O
decrypted VBN O
using VBG O
a DT O
customized JJ O
algorithm NN O
that WDT O
uses VBZ O
a DT O
key JJ O
derived VBN O
from IN O
the DT O
original JJ O
malware NN O
dropper IN O
’ NNP O
s VBD O
TimeDateStamp NNP O
field NN O
multiplied VBN O
by IN O
5 CD O
. . O

Figure NN O
8 CD O
. . O

The DT O
fake NN O
bitmap NN O
image NN O
embedded VBD O
as IN O
resource NN O
The DT O
32-bit JJ O
stage NN O
2 CD O
malware NN O
uses VBZ O
a DT O
customized JJ O
loading NN O
mechanism NN O
( ( O
i.e. FW O
, , O
the DT O
PE NNP O
file NN O
has VBZ O
a DT O
scrambled VBN O
IAT NNP O
and CC O
relocation NN O
table NN O
) ) O
and CC O
exports NNS O
only RB O
one CD O
function NN O
. . O

For IN O
the DT O
64-bit JJ O
stage NN O
2 CD O
malware NN O
, , O
the DT O
code NN O
execution NN O
is VBZ O
transferred VBN O
from IN O
the DT O
loader NN O
using VBG O
a DT O
well-known JJ O
technique NN O
called VBN O
Heaven NNP O
’ NNP O
s NN O
Gate NNP O
. . O

In IN O
the DT O
next JJ O
sections NNS O
, , O
for IN O
simplicity NN O
, , O
we PRP O
will MD O
continue VB O
the DT O
analysis NN O
only RB O
on IN O
the DT O
64-bit JJ O
payload NN O
. . O

Figure NN O
9 CD O
. . O

Heaven NNP O
’ NNP O
s NN O
gate NN O
is VBZ O
still RB O
in IN O
use NN O
in IN O
2017 CD O
Stage NN O
2 CD O
: : O
A DT O
second JJ O
multi-platform JJ O
virtual JJ O
machine NN O
The DT O
64-bit JJ O
stage NN O
2 CD O
malware NN O
implements NNS O
another DT O
loader NN O
combined VBN O
with IN O
another DT O
virtual JJ O
machine NN O
. . O

The DT O
architecture NN O
is VBZ O
quite RB O
similar JJ O
to TO O
the DT O
one CD O
described VBD O
previously RB O
, , O
but CC O
the DT O
opcodes NNS O
are VBP O
slightly RB O
different JJ O
. . O

After IN O
reversing VBG O
these DT O
opcodes NNS O
, , O
we PRP O
were VBD O
able JJ O
to TO O
update VB O
our PRP$ O
interpreter NN O
script NN O
to TO O
support VB O
both DT O
32-bit JJ O
and CC O
64-bit JJ O
virtual JJ O
machines NNS O
used VBN O
by IN O
FinFisher NNP B-Malware
. . O

INDEX NNP O
MNEMONIC NNP O
DESCRIPTION NNP O
0x0 CD O
JMP NNP O
Special NNP O
obfuscated VBD O
conditional JJ O
Jump NNP O
( ( O
always RB O
taken VBN O
or CC O
always RB O
ignored VBN O
) ) O
0x1 CD O
JMP NNP O
Jump NNP O
to TO O
a DT O
function NN O
( ( O
same JJ O
as IN O
opcode JJ O
0x10 CD O
) ) O
0x2 CD O
CALL NNP O
Call NNP O
to TO O
the DT O
function NN O
pointed VBN O
by IN O
the DT O
internal JJ O
VM NNP O
value NN O
0x3 CD O
CALL NNP O
Optimized NNP O
CALL NNP O
function NN O
( ( O
like IN O
the DT O
0x1E CD O
opcode NN O
of IN O
the DT O
32-bit JJ O
VM NNP O
) ) O
0x4 CD O
EXEC NNP O
Execute NNP O
code NN O
and CC O
move NN O
to TO O
the DT O
next JJ O
packet NN O
0x5 CD O
JMP NNP O
Jump NNP O
to TO O
an DT O
internal JJ O
function NN O
0x6 CD O
NOP NNP O
No NNP O
operation NN O
, , O
move NN O
to TO O
the DT O

next JJ O
packet NN O
0x7 CD O
CALL NNP O
Call NNP O
an DT O
imported VBN O
API NNP O
( ( O
whose WP$ O
address NN O
is VBZ O
stored VBN O
in IN O
the DT O
internal JJ O
VM NNP O
value NN O
) ) O
0x8 CD O
LOAD NNP O
Load NNP O
a DT O
value NN O
into IN O
the DT O
VM NNP O
descriptor NN O
structure NN O
* VBZ O
0x9 CD O
STORE NNP O
Store NNP O
the DT O
internal JJ O
VM NNP O
value NN O
inside IN O
a DT O
register NN O
0xA CD O
WRITE NNP O
Resolve NNP O
a DT O
pointer NN O
and CC O
store VB O
the DT O
value NN O
of IN O
a DT O
register NN O
in IN O
its PRP$ O
content NN O
0xB CD O
READ NNP O
Move NNP O
the DT O
value NN O
pointed VBN O
by IN O
the DT O
VM NNP O
internal JJ O
value NN O
into IN O
a DT O
register NN O
0xC CD O
LOAD NNP O
Load NNP O
a DT O
value NN O
into IN O
the DT O
VM NNP O
descriptor NN O
structure NN O
( ( O
not RB O
optimized VBN O
) ) O
0xD CD O
CMP NNP O
Compare NNP O
the DT O
value NN O
pointed VBN O
by IN O
the DT O
internal JJ O
VM NNP O
descriptor NN O

with IN O
a DT O
register NN O
0xE CD O
CMP NNP O
Compare NNP O
the DT O
value NN O
pointed VBN O
by IN O
the DT O
internal JJ O
VM NNP O
descriptor NN O
with IN O
an DT O
immediate JJ O
value NN O
0xF CD O
XCHG NNP O
Exchange NNP O
the DT O
value NN O
pointed VBN O
by IN O
the DT O
internal JJ O
VM NNP O
descriptor NN O
with IN O
a DT O
register NN O
0x10 CD O
SHL NNP O
Jump NNP O
to TO O
a DT O
function NN O
( ( O
same JJ O
as IN O
opcode JJ O
0x1 CD O
) ) O
This DT O
additional JJ O
virtual JJ O
machine NN O
performs VBZ O
the DT O
same JJ O
duties NNS O
as IN O
the DT O
one CD O
already RB O
described VBN O
but CC O
in IN O
a DT O
64-bit JJ O
environment NN O
. . O

It PRP O
extracts VBZ O
and CC O
decrypts VBZ O
the DT O
stage NN O
3 CD O
malware NN O
, , O
which WDT O
is VBZ O
stored VBN O
in IN O
encrypted JJ O
resources NNS O
such JJ O
as IN O
fake JJ O
dialog NN O
boxes NNS O
. . O

The DT O
extraction NN O
method NN O
is VBZ O
the DT O
same JJ O
, , O
but CC O
the DT O
encryption NN O
algorithm NN O
( ( O
also RB O
XOR NNP O
) ) O
is VBZ O
much JJ O
simpler NN O
. . O

The DT O
new JJ O
payload NN O
is VBZ O
decrypted VBN O
, , O
remapped VBD O
, , O
and CC O
executed VBN O
in IN O
memory NN O
, , O
and CC O
represents VBZ O
the DT O
installation NN O
and CC O
persistence NN O
stage NN O
of IN O
the DT O
malware NN O
. . O

Stage NN O
3 CD O
: : O
Installer NN O
that WDT O
takes VBZ O
DLL NNP O
side-loading NN O
to TO O
a DT O
new JJ O
level NN O
Stage NN O
3 CD O
represents VBZ O
the DT O
setup NN O
program NN O
for IN O
FinFisher NNP B-Malware
. . O

It PRP O
is VBZ O
the DT O
first JJ O
plain NN O
stage NN O
that WDT O
does VBZ O
not RB O
employ VB O
a DT O
VM NNP O
or CC O
obfuscation NN O
. . O

The DT O
code NN O
supports VBZ O
two CD O
different JJ O
installation NN O
methods NNS O
: : O
setup NN O
in IN O
a DT O
UAC-enforced JJ B-System
environment NN I-System
( ( O
with IN O
limited JJ O
privileges NNS O
) ) O
, , O
or CC O
an DT O
installation NN O
with IN O
full-administrative JJ O
privileges NNS O
enabled VBN O
( ( O
in IN O
cases NNS O
where WRB O
the DT O
malware NN O
gains NNS O
the DT O
ability NN O
to TO O
run VB O
with IN O
elevated JJ O
permissions NNS O
) ) O
. . O

We PRP O
were VBD O
a DT O
bit NN O
disappointed JJ O
that IN O
we PRP O
did VBD O
not RB O
see VB O
traces NNS O
of IN O
a DT O
true JJ O
privilege NN B-Vulnerability
escalation NN I-Vulnerability
exploit NN I-Vulnerability
after IN O
all PDT O
this DT O
deobfuscation NN O
work NN O
, , O
but CC O
it PRP O
seems VBZ O
these DT O
FinFisher NNP B-Malware
samples NNS O
were VBD O
designed VBN O
to TO O
work VB O
just RB O
using VBG O
UAC NNP O
bypasses NNS O
. . O

The DT O
setup NN O
code NN O
receives VBZ O
an DT O
installation NN O
command NN O
from IN O
the DT O
previous JJ O
stage NN O
. . O

In IN O
our PRP$ O
test NN O
, , O
this DT O
command NN O
was VBD O
the DT O
value NN O
3 CD O
. . O

The DT O
malware NN O
creates VBZ O
a DT O
global JJ O
event NN O
named VBN O
0x0A7F1FFAB12BB2 CD B-Indicator
and CC O
drops VB O
some DT O
files NNS O
under IN O
a DT O
folder NN O
located VBN O
in IN O
C NNP B-Indicator
: : I-Indicator
\ProgramData NN I-Indicator
or CC O
in IN O
the DT O
user JJ O
application NN O
data NNS O
folder NN O
. . O

The DT O
name NN O
of IN O
the DT O
folder NN O
and CC O
the DT O
malware NN O
configuration NN O
are VBP O
read VBN O
from IN O
a DT O
customized JJ O
configuration NN O
file NN O
stored VBN O
in IN O
the DT O
resource NN O
section NN O
of IN O
the DT O
setup NN O
program NN O
. . O

Here RB O
the DT O
list NN O
of IN O
the DT O
files NNS O
potentially RB O
dropped VBD O
during IN O
the DT O
installation NN O
stage NN O
: : O
FILE NNP O
NAME NNP O
STAGE NNP O
DESCRIPTION NNP O
d3d9.dll VBZ B-Indicator
Stage NNP O
4 CD O
Malware NNP O
loader NN O
used VBN O
for IN O
UAC NNP O
environments NNS O
with IN O
limited JJ O
privileges NNS O
; : O
also RB O
protected VBN O
by IN O
VM NNP O
obfuscation NN O
aepic.dll NN B-Indicator
, , O
sspisrv.dll NN B-Indicator
, , O
userenv.dll JJ B-Indicator
Stage NNP O
4 CD O
Malware NNP O
loader NN O
used VBN O
in IN O
presence NN O
of IN O
administrative JJ O
privileges NNS O
; : O
executed VBN O
from IN O
( ( O
and CC O
injected VBN O
into IN O
) ) O
a DT O
fake JJ O
service NN O
; : O
also RB O
protected VBN O
by IN O
VM NNP O
obfuscation NN O
msvcr90.dll NN B-Indicator
Stage NNP O
5 CD O
Malware NNP O
payload NN O
injected VBD O
into IN O

the DT O
explorer.exe NN B-Indicator
or CC O
winlogon.exe JJ B-Indicator
process NN O
; : O
also RB O
protected VBN O
by IN O
VM NNP O
obfuscation NN O
.cab NNP O
Config NNP O
Main NNP O
configuration NN O
file NN O
; : O
encrypted VBN O
setup.cab NN B-Indicator
Unknown NNP O
Last JJ O
section NN O
of IN O
the DT O
setup NN O
executable JJ O
; : O
content NN O
still RB O
unknown JJ O
.7z NNP O
Plugin NNP O
Malware NNP O
plugin NN O
used VBN O
to TO O
spy VB O
the DT O
victim NN O
network NN O
communications NNS O
wsecedit.rar VBP B-Indicator
Stage NNP O
6 CD O
Main NNP O
malware NN O
executable JJ O
After IN O
writing VBG O
some DT O
of IN O
these DT O
files NNS O
, , O
the DT O
malware NN O
decides VBZ O
which WDT O
kind NN O
of IN O
installation NN O
to TO O
perform VB O
based VBN O
on IN O
the DT O
current JJ O
privilege NN O
provided VBN O
by IN O
the DT O
hosting NN O
process NN O
( ( O
for IN O
example NN O
, , O
if IN O
a DT O
Microsoft NNP B-System
Office NNP I-System
process NN O
was VBD O
used VBN O
as IN O
exploit JJ O
vector NN O
) ) O
: : O
Installation NN O
process NN O
under IN O

UAC NN O
When WRB O
running VBG O
under IN O
a DT O
limited JJ O
UAC NNP O
account NN O
, , O
the DT O
installer NN O
extracts VBZ O
d3d9.dll JJ B-Indicator
and CC O
creates VBZ O
a DT O
persistence NN O
key NN O
under IN O
HKCU\Software\Microsoft\Windows\Run NNP B-Indicator
. . O

The DT O
malware NN O
sets VBZ O
a DT O
registry NN O
value NN O
( ( O
whose WP$ O
name NN O
is VBZ O
read VBN O
from IN O
the DT O
configuration NN O
file NN O
) ) O
to TO O
“ VB O
C NNP B-Indicator
: : I-Indicator
\Windows\system32\rundll32.exe JJ I-Indicator
c NN B-Indicator
: : I-Indicator
\ProgramData\AuditApp\d3d9.dll NN I-Indicator
, , I-Indicator
Control_Run NNP B-Indicator
” NNP O
. . O

Before IN O
doing VBG O
this DT O
, , O
the DT O
malware NN O
makes VBZ O
a DT O
screenshot NN O
of IN O
the DT O
screen NN O
and CC O
displays VBZ O
it PRP O
on IN O
top NN O
of IN O
all DT O
other JJ O
windows NNS B-System
for IN O
few JJ O
seconds NNS O
. . O

This DT O
indicates VBZ O
that IN O
the DT O
authors NNS O
are VBP O
trying VBG O
to TO O
hide VB O
some DT O
messages NNS O
showed VBN O
by IN O
the DT O
system NN O
during IN O
the DT O
setup NN O
process NN O
. . O

When WRB O
loaded VBN O
with IN O
startup NN O
command NN O
2 CD O
, , O
the DT O
installer NN O
can MD O
copy VB O
the DT O
original JJ O
explorer.exe NN B-Indicator
file NN I-Indicator
inside IN O
its PRP$ O
current JJ O
running NN O
directory NN O
and CC O
rename NN O
d3d9.dll NN B-Indicator
to TO O
uxtheme.dll VB B-Indicator
. . O

In IN O
this DT O
case NN O
the DT O
persistence NN O
is VBZ O
achieved VBN O
by IN O
loading VBG O
the DT O
original JJ O
explorer.exe NN B-Indicator
from IN O
its PRP$ O
startup NN O
location NN O
and CC O
, , O
using VBG O
DLL NNP O
side-loading NN O
, , O
passing VBG O
the DT O
execution NN O
control NN O
to TO O
the DT O
stage NN O
4 CD O
malware NN O
( ( O
discussed VBN O
in IN O
next JJ O
section NN O
) ) O
. . O

Finally RB O
, , O
the DT O
malware NN O
spawns VBZ O
a DT O
thread NN O
that WDT O
has VBZ O
the DT O
goal NN O
to TO O
load VB O
, , O
remap VB O
, , O
and CC O
relocate VB O
the DT O
stage NN O
5 CD O
malware NN O
. . O

In IN O
this DT O
context NN O
, , O
there EX O
is VBZ O
indeed RB O
no DT O
need NN O
to TO O
execute VB O
the DT O
stage NN O
4 CD O
malware NN O
. . O

The DT O
msvcr90.dll NN B-Indicator
file NN I-Indicator
is VBZ O
opened VBN O
, , O
read VB O
, , O
and CC O
decrypted VBD O
, , O
and CC O
the DT O
code NN O
execution NN O
control NN O
is VBZ O
transferred VBN O
to TO O
the DT O
RunDll NNP O
exported VBD O
routine NN O
. . O

In IN O
the DT O
case NN O
of IN O
32-bit JJ O
systems NNS O
, , O
the DT O
malware NN O
may MD O
attempt VB O
a DT O
known VBN O
UAC NNP O
bypass NN O
by IN O
launching VBG O
printui.exe NN B-Indicator
system NN O
process NN O
and CC O
using VBG O
token JJ O
manipulation NN O
with IN O
NtFilterToken NNP O
as IN O
described VBN O
in IN O
this DT O
blog NN O
post NN O
. . O

Installation NNP O
process NN O
with IN O
administrative JJ O
privilege NN O
This DT O
installation NN O
method NN O
is VBZ O
more RBR O
interesting JJ O
because IN O
it PRP O
reveals VBZ O
how WRB O
the DT O
malware NN O
tries VBZ O
to TO O
achieve VB O
stealthier JJR O
persistence NN O
on IN O
the DT O
machine NN O
. . O

The DT O
method NN O
is VBZ O
a DT O
well-known JJ O
trick NN O
used VBN O
by IN O
penetration NN O
testers NNS O
that WDT O
was VBD O
automated VBN O
and CC O
generalized VBN O
by IN O
FinFisher NNP B-Malware
The DT O
procedure NN O
starts VBZ O
by IN O
enumerating VBG O
the DT O
KnownDlls NNP O
object JJ O
directory NN O
and CC O
then RB O
scanning VBG O
for IN O
section NN O
objects NNS O
of IN O
the DT O
cached JJ O
system NN O
DLLs NNP O
. . O

Next RB O
, , O
the DT O
malware NN O
enumerates VBZ O
all DT O
.exe JJ O
programs NNS O
in IN O
the DT O
% NN O
System NNP O
% NN O
folder NN O
and CC O
looks VBZ O
for IN O
an DT O
original JJ O
signed JJ O
Windows NNP B-System
binary NN O
that WDT O
imports VBZ O
from IN O
at IN O
least JJS O
one CD O
KnownDll NNP O
and CC O
from IN O
a DT O
library NN O
that WDT O
is VBZ O
not RB O
in IN O
the DT O
KnownDll NNP O
directory NN O
. . O

When WRB O
a DT O
suitable JJ O
.exe NN O
file NN O
candidate NN O
is VBZ O
found VBN O
, , O
it PRP O
is VBZ O
copied VBN O
into IN O
the DT O
malware NN O
installation NN O
folder NN O
( ( O
for IN O
example NN O
, , O
C NNP B-Indicator
: : I-Indicator
\ProgramData NN I-Indicator
) ) O
. . O

At IN O
this DT O
point NN O
the DT O
malware NN O
extracts NNS O
and CC O
decrypts VBZ O
a DT O
stub JJ O
DLL NNP O
from IN O
its PRP$ O
own JJ O
resources NNS O
( ( O
ID NNP O
101 CD O
) ) O
. . O

It PRP O
then RB O
calls VBZ O
a DT O
routine NN O
that WDT O
adds VBZ O
a DT O
code NN O
section NN O
to TO O
a DT O
target NN O
module NN O
. . O

This DT O
section NN O
will MD O
contain VB O
a DT O
fake JJ O
export NN O
table NN O
mimicking VBG O
the DT O
same JJ O
export NN O
table NN O
of IN O
the DT O
original JJ O
system NN O
DLL NNP O
chosen NN O
. . O

At IN O
the DT O
time NN O
of IN O
writing NN O
, , O
the DT O
dropper NN O
supports VBZ O
aepic.dll NN B-Indicator
, , O
sspisrv.dll NN B-Indicator
, , O
ftllib.dll NN B-Indicator
, , O
and CC O
userenv.dll JJ B-Indicator
to TO O
host VB O
the DT O
malicious JJ O
FinFisher NNP B-Malware
payload NN O
. . O

Finally RB O
, , O
a DT O
new JJ O
Windows NNP B-System
service NN O
is VBZ O
created VBN O
with IN O
the DT O
service NN O
path NN O
pointing VBG O
to TO O
the DT O
candidate NN O
.exe NN O
located VBN O
in IN O
this DT O
new JJ O
directory NN O
together RB O
with IN O
the DT O
freshly RB O
created VBN O
, , O
benign-looking JJ O
DLL NNP O
. . O

In IN O
this DT O
way NN O
, , O
when WRB O
the DT O
service NN O
runs VBZ O
during IN O
boot NN O
, , O
the DT O
original JJ O
Windows NNP B-System
executable NN O
is VBZ O
executed VBN O
from IN O
a DT O
different JJ O
location NN O
and CC O
it PRP O
will MD O
automatically RB O
load VB O
and CC O
map VB O
the DT O
malicious JJ O
DLL NNP O
inside IN O
its PRP$ O
address JJ O
space NN O
, , O
instead RB O
of IN O
using VBG O
the DT O
genuine JJ O
system NN O
library NN O
. . O

This DT O
routine NN O
is VBZ O
a DT O
form NN O
of IN O
generic JJ O
and CC O
variable JJ O
generator NN O
of IN O
DLL NNP O
side-loading JJ O
combinations NNS O
. . O

Figure NN O
10 CD O
. . O

Windows NNS B-System
Defender NNP I-System
ATP NNP I-System
timeline NN O
can MD O
pinpoint VB O
the DT O
service NN O
DLL NNP O
side-loading JJ O
trick NN O
( ( O
in IN O
this DT O
example NN O
, , O
using VBG O
fltlib.dll NN B-Indicator
) ) O
. . O

In IN O
the DT O
past JJ O
, , O
we PRP O
have VBP O
seen VBN O
other JJ O
activity NN O
groups NNS O
like IN O
LEAD NNP O
employ VBP O
a DT O
similar JJ O
attacker NN O
technique NN O
named VBN O
“ JJ O
proxy-library JJ O
” NN O
to TO O
achieve VB O
persistence NN O
, , O
but CC O
not RB O
with IN O
this DT O
professionalism NN O
. . O

The DT O
said VBD O
technique NN O
brings VBZ O
the DT O
advantage NN O
of IN O
avoiding VBG O
auto-start JJ O
extensibility NN O
points NNS O
( ( O
ASEP NNP O
) ) O
scanners NNS O
and CC O
programs NNS O
that WDT O
checks NNS O
for IN O
binaries NNS O
installed VBN O
as IN O
service NN O
( ( O
for IN O
the DT O
latter NN O
, , O
the DT O
service NN O
chosen VBN O
by IN O
FinFisher NNP B-Malware
will MD O
show VB O
up RP O
as IN O
a DT O
clean JJ O
Windows NNP B-System
signed VBD O
binary NN O
) ) O
. . O

The DT O
malware NN O
cleans VBZ O
the DT O
system NN O
event NN O
logs NNS O
using VBG O
OpenEventLog/ClearEventLog NNP O
APIs NNP O
, , O
and CC O
then RB O
terminates VBZ O
the DT O
setup JJ O
procedure NN O
with IN O
a DT O
call NN O
to TO O
StartService NNP O
to TO O
run VB O
the DT O
stage NN O
4 CD O
malware NN O
. . O

Figure NN O
11 CD O
. . O

The DT O
DLL NNP O
side-loaded JJ O
stage NN O
4 CD O
malware NN O
mimicking VBG O
a DT O
real JJ O
export NN O
table NN O
to TO O
avoid VB O
detection NN O
Stage NNP O
4 CD O
: : O
The DT O
memory NN O
loader NN O
– NNP O
Fun NNP O
injection NN O
with IN O
GDI NNP O
function NN O
hijacking VBG O
Depending VBG O
on IN O
how WRB O
stage JJ O
4 CD O
was VBD O
launched VBN O
, , O
two CD O
different JJ O
things NNS O
may MD O
happen VB O
: : O
In IN O
the DT O
low-integrity NN O
case NN O
( ( O
under IN O
UAC NNP O
) ) O
the DT O
installer NN O
simply RB O
injects VBZ O
the DT O
stage NN O
5 CD O
malware NN O
into IN O
the DT O
bogus JJ O
explorer.exe NN B-Indicator
process NN O
started VBD O
earlier RBR O
and CC O
terminates NNS O
In IN O
the DT O
high-integrity NN O
case NN O
( ( O
with IN O
administrative JJ O
privileges NNS O
or CC O
after IN O
UAC NNP O
bypass NN O
) ) O
, , O
the DT O
code NN O
searches NNS O
for IN O
the DT O
process NN O
hosting VBG O
the DT O
Plug NN O
and CC O
Play NNP O
service NN O
( ( O
usually RB O
svchost.exe VBP B-Indicator

) ) O
loaded VBD O
in IN O
memory NN O
and CC O
injects VBZ O
itself PRP O
into IN O
it PRP O
For IN O
the DT O
second JJ O
scenario NN O
, , O
the DT O
injection NN O
process NN O
works VBZ O
like IN O
this DT O
: : O
The DT O
malware NN O
opens VBZ O
the DT O
target NN O
service NN O
process NN O
. . O

It PRP O
allocates VBZ O
and CC O
fills VBZ O
four CD O
chunks NNS O
of IN O
memory NN O
inside IN O
the DT O
service NN O
process NN O
. . O

One CD O
chunk NN O
contains VBZ O
the DT O
entire JJ O
malware NN O
DLL NNP O
code NN O
( ( O
without IN O
PE NNP O
headers NNS O
) ) O
. . O

Another DT O
chunk NN O
is VBZ O
used VBN O
to TO O
copy VB O
a DT O
basic JJ O
Ntdll NNP O
and CC O
Kernel32 NNP O
import NN O
address NN O
table NN O
. . O

Two CD O
chunks NNS O
are VBP O
filled VBN O
with IN O
an DT O
asynchronous JJ O
procedure NN O
call NN O
( ( O
APC NNP O
) ) O
routine VBP O
code NN O
and CC O
a DT O
stub NN O
. . O

It PRP O
opens VBZ O
the DT O
service NN O
thread NN O
of IN O
the DT O
service NN O
process NN O
and CC O
uses VBZ O
the DT O
ZwQueueApcThread NNP B-Indicator
native JJ O
API NNP O
to TO O
inject VB O
an DT O
APC NNP O
. . O

The DT O
APC NNP O
routine NN O
creates VBZ O
a DT O
thread NN O
in IN O
the DT O
context NN O
of IN O
the DT O
svchost.exe NN B-Indicator
process NN O
that WDT O
will MD O
map VB O
and CC O
execute VB O
the DT O
stage NN O
5 CD O
malware NN O
into IN O
the DT O
winlogon.exe JJ B-Indicator
process NN O
. . O

The DT O
injection NN O
method NN O
used VBN O
for IN O
winlogon.exe NN B-Indicator
is VBZ O
also RB O
interesting JJ O
and CC O
quite JJ O
unusual JJ O
. . O

We PRP O
believe VBP O
that IN O
this DT O
method NN O
is VBZ O
engineered VBN O
to TO O
avoid VB O
trivial JJ O
detection NN O
of IN O
process NN O
injection NN O
using VBG O
the DT O
well-detected JJ O
CreateRemoteThread NNP B-Indicator
or CC O
ZwQueueApcThread NNP B-Indicator
API NNP O
. . O

The DT O
malware NN O
takes VBZ O
these DT O
steps NNS O
: : O
Check VB O
if IN O
the DT O
system NN O
master NN O
boot NN O
record NN O
( ( O
MBR NNP O
) ) O
contains VBZ O
an DT O
infection NN O
marker NN O
( ( O
0xD289C989C089 CD B-Indicator
8-bytes NNS O
value NN O
at IN O
offset $ O
0x2C CD O
) ) O
, , O
and CC O
, , O
if IN O
so RB O
, , O
terminate VB O
itself PRP O
Check NNP O
again RB O
if IN O
the DT O
process NN O
is VBZ O
attached VBN O
to TO O
a DT O
debugger NN O
( ( O
using VBG O
the DT O
techniques NNS O
described VBD O
previously RB O
) ) O
Read NNP O
, , O
decrypt NN O
, , O
and CC O
map VBZ O
the DT O
stage NN O
5 CD O
malware NN O
( ( O
written VBN O
in IN O
the DT O
previous JJ O
stage NN O
in IN O
msvcr90.dll NN B-Indicator
) ) O
Open NNP O
winlogon.exe NN B-Indicator
process NN O
Load NNP O
user32.dll NN B-Indicator
system NN O
library JJ O
and CC O
read VBD O
the DT O
KernelCallbackTable NNP B-Indicator

pointer NN O
from IN O
its PRP$ O
own JJ O
process NN O
environment NN O
block NN O
( ( O
PEB NNP O
) ) O
( ( O
Note NN O
: : O
The DT O
KernelCallbackTable NNP O
points NNS O
to TO O
an DT O
array NN O
of IN O
graphic JJ O
functions NNS O
used VBN O
by IN O
Win32 NNP O
kernel NNP O
subsystem NN O
module NN O
win32k.sys NN B-Indicator
as IN O
call-back NN O
into IN O
user-mode JJ O
. . O

) ) O
Calculate VB O
the DT O
difference NN O
between IN O
this DT O
pointer NN O
and CC O
the DT O
User32 NNP O
base NN O
address NN O
. . O

Copy VB O
the DT O
stage NN O
5 CD O
DLL NNP O
into IN O
winlogon.exe JJ B-Indicator
Allocate NNP O
a DT O
chunk NN O
of IN O
memory NN O
in IN O
winlogon.exe JJ B-Indicator
process NN O
and CC O
copy VBP O
the DT O
same JJ O
APC NNP O
routine NN O
seen VBN O
previously RB O
Read NNP O
and CC O
save VB O
the DT O
original JJ O
pointer NN O
of IN O
the DT O
__fnDWORD NNP O
internal JJ O
User32 NNP O
routine NN O
( ( O
located VBN O
at IN O
offset VBN O
+0x10 NN O
of IN O
the DT O
KernelCallbackTable NNP O
) ) O
and CC O
replace VB O
this DT O
pointer NN O
with IN O
the DT O
address NN O
of IN O
the DT O
APC NNP O
stub NN O
routine NN O
After IN O
this DT O
function NN O
pointer NN O
hijacking NN O
, , O
when WRB O
winlogon.exe NN B-Indicator
makes VBZ O
any DT O
graphical JJ O
call NN O
( ( O
GDI NNP O
) ) O
, , O
the DT O
malicious JJ O
code NN O
can MD O
execute VB O
without IN O
using VBG O
CreateRemoteThread NNP O
or CC O

similar JJ O
triggers NNS O
that WDT O
are VBP O
easily RB O
detectable JJ O
. . O

After IN O
execution NN O
it PRP O
takes VBZ O
care NN O
of IN O
restoring VBG O
the DT O
original JJ O
KernelCallbackTable NNP O
. . O

Stage NN O
5 CD O
: : O
The DT O
final JJ O
loader NN O
takes VBZ O
control VB O
The DT O
stage NN O
5 CD O
malware NN O
is VBZ O
needed VBN O
only RB O
to TO O
provide VB O
one CD O
more JJR O
layer NN O
of IN O
obfuscation NN O
, , O
through IN O
the DT O
VM NNP O
, , O
of IN O
the DT O
final JJ O
malware NN O
payload NN O
and CC O
to TO O
set VB O
up RP O
a DT O
special JJ O
Structured NNP O
Exception NNP O
Hander NNP O
routine NN O
, , O
which WDT O
is VBZ O
inserted VBN O
as IN O
Wow64PrepareForException NNP O
in IN O
Ntdll NNP O
. . O

This DT O
special JJ O
exception NN O
handler NN O
is VBZ O
needed VBN O
to TO O
manage VB O
some DT O
memory NN O
buffers NNS O
protection NN O
and CC O
special JJ O
exceptions NNS O
that WDT O
are VBP O
used VBN O
to TO O
provide VB O
more JJR O
stealthy JJ O
execution NN O
. . O

After IN O
the DT O
VM NNP O
code NN O
has VBZ O
checked VBN O
again RB O
the DT O
user NN O
environment NN O
, , O
it PRP O
proceeds VBZ O
to TO O
extract VB O
and CC O
execute VB O
the DT O
final JJ O
un-obfuscated JJ O
payload NN O
sample NN O
directly RB O
into IN O
winlogon.exe NN B-Indicator
( ( O
alternatively RB O
, , O
into IN O
explorer.exe NN B-Indicator
) ) O
process NN O
. . O

After IN O
the DT O
payload NN O
is VBZ O
extracted VBN O
, , O
decrypted VBN O
, , O
and CC O
mapped VBD O
in IN O
the DT O
process NN O
memory NN O
, , O
the DT O
malware NN O
calls VBZ O
the DT O
new JJ O
DLL NNP O
entry NN O
point NN O
, , O
and CC O
then RB O
the DT O
RunDll NNP O
exported VBD O
function NN O
. . O

The DT O
latter JJ O
implements NNS O
the DT O
entire JJ O
spyware NN O
program NN O
. . O

Stage NN O
6 CD O
: : O
The DT O
payload NN O
is VBZ O
a DT O
modular JJ O
spyware NN O
framework NN O
for IN O
further JJ O
analysis NN O
Our PRP$ O
journey NN O
to TO O
deobfuscating VBG O
FinFisher NNP B-Malware
has VBZ O
allowed VBN O
us PRP O
to TO O
uncover VB O
the DT O
complex JJ O
anti-analysis NN O
techniques NNS O
used VBN O
by IN O
this DT O
malware NN O
, , O
as RB O
well RB O
as IN O
to TO O
use VB O
this DT O
intel NN O
to TO O
protect VB O
our PRP$ O
customers NNS O
, , O
which WDT O
is VBZ O
our PRP$ O
top JJ O
priority NN O
. . O

Analysis NN O
of IN O
the DT O
additional JJ O
spyware NN O
modules NNS O
is VBZ O
future JJ O
work NN O
. . O

It PRP O
is VBZ O
evident JJ O
that IN O
the DT O
ultimate JJ O
goal NN O
of IN O
this DT O
program NN O
is VBZ O
to TO O
steal VB O
information NN O
. . O

The DT O
malware NN O
architecture NN O
is VBZ O
modular JJ O
, , O
which WDT O
means VBZ O
that IN O
it PRP O
can MD O
execute VB O
plugins NNS O
. . O

The DT O
plugins NNS O
are VBP O
stored VBN O
in IN O
its PRP$ O
resource NN O
section NN O
and CC O
can MD O
be VB O
protected VBN O
by IN O
the DT O
same JJ O
VM NNP O
. . O

The DT O
sample NN O
we PRP O
analyzed VBD O
in IN O
October NNP O
, , O
for IN O
example NN O
, , O
contains VBZ O
a DT O
plugin NN O
that WDT O
is VBZ O
able JJ O
to TO O
spy VB O
on IN O
internet NN O
connections NNS O
, , O
and CC O
can MD O
even RB O
divert VB O
some DT O
SSL NNP O
connections NNS O
and CC O
steal VB O
data NNS O
from IN O
encrypted VBN O
traffic NN O
. . O

Some DT O
FinFisher NNP B-Malware
variants NNS O
incorporate VBP O
an DT O
MBR NNP B-Indicator
rootkit NN I-Indicator
, , O
the DT O
exact JJ O
purpose NN O
of IN O
which WDT O
is VBZ O
not RB O
clear JJ O
. . O

Quite NNP O
possibly RB O
, , O
this DT O
routine JJ O
targets NNS O
older VBP O
platforms NNS O
like IN O
Windows NNP B-System
7 CD I-System
and CC O
machines NNS O
not RB O
taking VBG O
advantage NN O
of IN O
hardware NN O
protections NNS O
like IN O
UEFI NNP O
and CC O
SecureBoot NNP O
, , O
available JJ O
on IN O
Windows NNP B-System
10 CD I-System
. . O

Describing VBG O
this DT O
additional JJ O
piece NN O
of IN O
code NN O
in IN O
detail NN O
is VBZ O
outside IN O
the DT O
scope NN B-System
of IN O
this DT O
analysis NN O
and CC O
may MD O
require VB O
a DT O
new JJ O
dedicated VBN O
blog NN O
post NN O
. . O

Defense NNP O
against IN O
FinFisher NNP B-Malware
Exposing NNP O
as IN O
much JJ O
of IN O
FinFisher NNP B-Malware
’ NNP O
s NN O
riddles NNS O
as IN O
possible JJ O
during IN O
this DT O
painstaking NN O
analysis NN O
has VBZ O
allowed VBN O
us PRP O
to TO O
ensure VB O
our PRP$ O
customers NNS O
are VBP O
protected VBN O
against IN O
this DT O
advanced JJ O
piece NN O
of IN O
malware NN O
. . O

Windows NNS B-System
10 CD I-System
S NNP O
devices NNS O
are VBP O
naturally RB O
protected VBN O
against IN O
FinFisher NNP B-Malware
and CC O
other JJ O
threats NNS O
thanks NNS O
to TO O
the DT O
strong JJ O
code NN O
integrity NN O
policies NNS O
that IN O
don VBP O
’ JJ O
t NN O
allow VBP O
unknown JJ O
unsigned JJ O
binaries NNS O
to TO O
run VB O
( ( O
thus RB O
stopping VBG O
FinFisher NNP B-Malware
’ NNP O
s VBD O
PE NNP O
installer NN O
) ) O
or CC O
loaded VBN O
( ( O
blocking VBG O
FinFisher NNP B-Malware
’ NNP O
s VBD O
DLL NNP O
persistence NN O
) ) O
. . O

On IN O
Windows NNP B-System
10 CD I-System
, , O
similar JJ O
code NN O
integrity NN O
policies NNS O
can MD O
be VB O
configured VBN O
using VBG O
Windows NNP B-System
Defender NNP I-System
Application NNP I-System
Control NNP I-System
. . O

Office RB B-System
365 CD I-System
Advanced NNP I-System
Threat NNP I-System
Protection NNP I-System
secures VBZ O
mailboxes NNS O
from IN O
email JJ O
campaigns NNS O
that WDT O
use VBP O
zero-day JJ B-Vulnerability
exploits NNS I-Vulnerability
to TO O
deliver VB O
threats NNS O
like IN O
FinFisher NNP B-Malware
. . O

Office RB B-System
365 CD I-System
ATP NNP I-System
blocks NNS O
unsafe JJ O
attachments NNS O
, , O
malicious JJ O
links NNS O
, , O
and CC O
linked-to JJ O
files NNS O
using VBG O
time-of-click JJ O
protection NN O
. . O

Using VBG O
intel NN O
from IN O
this DT O
research NN O
, , O
we PRP O
have VBP O
made VBN O
Office NNP B-System
365 CD I-System
ATP NNP I-System
more RBR O
resistant JJ O
to TO O
FinFisher NNP B-Malware
’ NNP O
s VBD O
anti-sandbox JJ O
checks NNS O
. . O

Generic JJ O
detections NNS O
, , O
advanced VBD O
behavioral JJ O
analytics NNS O
, , O
and CC O
machine NN O
learning NN O
technologies NNS O
in IN O
Windows NNP B-System
Defender NNP I-System
Advanced NNP I-System
Threat NNP I-System
Protection NNP I-System
detect VB O
FinFisher NNP B-Malware
’ NNP O
s VBP O
malicious JJ O
behavior NN O
throughout IN O
the DT O
attack NN O
kill NN O
chain NN O
and CC O
alert JJ O
SecOps NNP O
personnel NNS O
. . O

Windows NNS B-System
Defender NNP I-System
ATP NNP I-System
also RB O
integrates VBZ O
with IN O
the DT O
Windows NNP B-System
protection NN O
stack NN O
so IN O
that DT O
protections NNS O
from IN O
Windows NNP B-System
Defender NNP I-System
AV NNP I-System
and CC O
Windows NNP B-System
Defender NNP I-System
Exploit NNP I-System
Guard NNP I-System
are VBP O
reported VBN O
in IN O
Windows NNP B-System
Defender NNP I-System
ATP NNP I-System
portal NN O
, , O
enabling VBG O
SecOps NNP O
personnel NNS O
to TO O
centrally RB O
manage VB O
security NN O
, , O
and CC O
as RB O
well RB O
as IN O
promptly RB O
investigate JJ O
and CC O
respond NN O
to TO O
hostile JJ O
activity NN O
in IN O
the DT O
network NN O
. . O

We PRP O
hope VBP O
that IN O
this DT O
writeup NN O
of IN O
our PRP$ O
journey NN O
through IN O
all PDT O
the DT O
multiple JJ O
layers NNS O
of IN O
protection NN O
, , O
obfuscation NN O
, , O
and CC O
anti-analysis NN O
techniques NNS O
of IN O
FinFisher NNP B-Malware
will MD O
be VB O
useful JJ O
to TO O
other JJ O
researchers NNS O
studying VBG O
this DT O
malware NN O
. . O

We PRP O
believe VBP O
that IN O
an DT O
industry-wide JJ O
collaboration NN O
and CC O
information-sharing NN O
is VBZ O
important JJ O
in IN O
defending VBG O
customers NNS O
against IN O
this DT O
complex JJ O
piece NN O
of IN O
malware NN O
. . O

TUESDAY NNP O
, , O
APRIL NNP O
9 CD O
, , O
2019 CD O
Gustuff NNP B-Malware
banking NN O
botnet NN O
targets NNS O
Australia NNP O
EXECUTIVE NNP O
SUMMARY NNP O
Cisco NNP B-Organization
Talos NNP I-Organization
has VBZ O
uncovered VBN O
a DT O
new JJ O
Android-based JJ B-System
campaign NN O
targeting VBG O
Australian JJ O
financial JJ O
institutions NNS O
. . O

As IN O
the DT O
investigation NN O
progressed VBD O
, , O
Talos NNP B-Organization
came VBD O
to TO O
understand VB O
that IN O
this DT O
campaign NN O
was VBD O
associated VBN O
with IN O
the DT O
" NN O
ChristinaMorrow NNP O
'' '' O
text NN O
message NN O
spam JJ O
scam NN O
previously RB O
spotted VBN O
in IN O
Australia NNP O
. . O

Although IN O
this DT O
malware NN O
's POS O
credential-harvest JJ O
mechanism NN O
is VBZ O
not RB O
particularly RB O
sophisticated JJ O
, , O
it PRP O
does VBZ O
have VB O
an DT O
advanced JJ O
self-preservation NN O
mechanism NN O
. . O

Even RB O
though IN O
this DT O
is VBZ O
not RB O
a DT O
traditional JJ O
remote JJ O
access NN O
tool NN O
( ( O
RAT NNP O
) ) O
, , O
this DT O
campaign NN O
seems VBZ O
to TO O
target VB O
mainly RB O
private JJ O
users NNS O
. . O

Aside RB O
from IN O
the DT O
credential JJ O
stealing NN O
, , O
this DT O
malware NN O
also RB O
includes VBZ O
features NNS O
like IN O
the DT O
theft NN O
of IN O
users NNS O
' POS O
contact NN O
list NN O
, , O
collecting VBG O
phone NN O
numbers NNS O
associated VBN O
names NNS O
, , O
and CC O
files NNS O
and CC O
photos NNS O
on IN O
the DT O
device NN O
. . O

But CC O
that DT O
does VBZ O
n't RB O
mean VB O
companies NNS O
and CC O
organizations NNS O
are VBP O
out IN O
of IN O
the DT O
woods NNS O
. . O

They PRP O
should MD O
still RB O
be VB O
on IN O
the DT O
lookout NN O
for IN O
these DT O
kinds NNS O
of IN O
trojans NNS O
, , O
as IN O
the DT O
attackers NNS O
could MD O
target VB O
corporate JJ O
accounts NNS O
that WDT O
contain VBP O
large JJ O
amounts NNS O
of IN O
money NN O
. . O

The DT O
information NN O
collected VBN O
by IN O
the DT O
malware NN O
and CC O
the DT O
control NN O
over IN O
the DT O
victim NN O
's POS O
mobile JJ O
device NN O
allows VBZ O
their PRP$ O
operators NNS O
to TO O
perform VB O
more RBR O
complex JJ O
social JJ O
engineering NN O
attacks NNS O
. . O

A DT O
motivated JJ O
attacker NN O
can MD O
use VB O
this DT O
trojan NN O
to TO O
harvest VB O
usernames NNS O
and CC O
passwords NNS O
and CC O
then RB O
reuse VB O
them PRP O
to TO O
login VB O
into IN O
the DT O
organization NN O
's POS O
system NN O
where WRB O
the DT O
victim NN O
works VBZ O
. . O

This DT O
is VBZ O
a DT O
good JJ O
example NN O
where WRB O
two-factor NN O
authentication NN O
based VBN O
on IN O
SMS NNP O
would MD O
fail VB O
since IN O
the DT O
attacker NN O
can MD O
read VB O
the DT O
SMS NNP O
. . O

Corporations NNS O
can MD O
protect VB O
themselves PRP O
from IN O
these DT O
side-channel JJ O
attacks NNS O
by IN O
deploying VBG O
client-based JJ O
two-factor JJ O
authentication NN O
, , O
such JJ O
as IN O
Duo NNP B-System
Security NNP I-System
. . O

One CD O
of IN O
the DT O
most RBS O
impressive JJ O
features NNS O
of IN O
this DT O
malware NN O
is VBZ O
its PRP$ O
resilience NN O
. . O

If IN O
the DT O
command NN O
and CC O
control NN O
( ( O
C2 NNP O
) ) O
server NN O
is VBZ O
taken VBN O
down RB O
, , O
the DT O
malicious JJ O
operator NN O
can MD O
still RB O
recover VB O
the DT O
malware NN O
control NN O
by IN O
sending VBG O
SMS NNP O
messages NNS O
directly RB O
to TO O
the DT O
infected JJ O
devices NNS O
. . O

This DT O
makes VBZ O
the DT O
taking VBG O
down RP O
and CC O
recovery NN O
of IN O
the DT O
network NN O
much JJ O
harder NN O
and CC O
poses VBZ O
a DT O
considerable JJ O
challenge NN O
for IN O
defenders NNS O
. . O

THE DT O
CAMPAIGN NNP O
The DT O
malware NN O
's POS O
primary JJ O
infection NN O
vector NN O
is VBZ O
SMS NNP O
. . O

Just RB O
like IN O
the DT O
old-school JJ O
mail NN O
worms NNS O
that WDT O
used VBD O
the DT O
victim NN O
's POS O
address NN B-System
book NN I-System
to TO O
select VB O
the DT O
next JJ O
victims NNS O
, , O
this DT O
banking NN O
trojan NN O
's POS O
activation NN O
cycle NN O
includes VBZ O
the DT O
exfiltration NN O
of IN O
the DT O
victim NN O
's POS O
address JJ O
book NN O
. . O

The DT O
trojan NN O
will MD O
receive VB O
instructions NNS O
from IN O
the DT O
C2 NNP O
to TO O
spread VB O
. . O

Spread JJ O
command NN O
from IN O
C2 NNP O
The DT O
victim NN O
receives VBZ O
the DT O
command NN O
sendSMSMass NN O
. . O

Usually RB O
, , O
this DT O
message NN O
targets VBZ O
four CD O
or CC O
five CD O
people NNS O
at IN O
a DT O
time NN O
. . O

The DT O
body NN O
contains VBZ O
a DT O
message NN O
and CC O
URL NNP O
. . O

Again RB O
, , O
the DT O
concept NN O
is VBZ O
that IN O
new JJ O
victims NNS O
are VBP O
more RBR O
likely JJ O
to TO O
install VB O
the DT O
malware NN O
if IN O
the DT O
SMS NNP O
comes VBZ O
from IN O
someone NN O
they PRP O
know VBP O
. . O

When WRB O
a DT O
victim NN O
tries VBZ O
to TO O
access NN O
the DT O
URL NNP O
in IN O
the DT O
SMS NNP O
body NN O
, , O
the DT O
C2 NNP O
will MD O
check VB O
if IN O
the DT O
mobile JJ O
device NN O
meets VBZ O
the DT O
criteria NNS O
to TO O
receive VB O
the DT O
malware NN O
( ( O
see VB O
infrastructure NN O
section NN O
) ) O
. . O

If IN O
the DT O
device NN O
does VBZ O
not RB O
meet VB O
the DT O
criteria NNS O
, , O
it PRP O
wo MD O
n't RB O
receive VB O
any DT O
data NNS O
, , O
otherwise RB O
, , O
it PRP O
will MD O
be VB O
redirected VBN O
to TO O
a DT O
second JJ O
server NN O
to TO O
receive VB O
a DT O
copy NN O
of IN O
the DT O
malware NN O
to TO O
install VB O
on IN O
their PRP$ O
device NN O
. . O

The DT O
domain NN O
on IN O
this DT O
campaign NN O
was VBD O
registered VBN O
on IN O
Jan. NNP O
19 CD O
, , O
2019 CD O
. . O

However RB O
, , O
Talos NNP B-Organization
has VBZ O
identified VBN O
that IN O
was VBD O
used VBN O
at IN O
least JJS O
since IN O
November NNP O
2018 CD O
. . O

During IN O
the DT O
investigation NN O
, , O
Talos NNP B-Organization
was VBD O
also RB O
able JJ O
to TO O
determine VB O
that IN O
the DT O
same JJ O
infrastructure NN O
has VBZ O
been VBN O
used VBN O
to TO O
deploy VB O
similar JJ O
campaigns NNS O
using VBG O
different JJ O
versions NNS O
of IN O
the DT O
malware NN O
. . O

Distribution NN O
of IN O
victims NNS O
. . O

Talos NNP B-Organization
assess NN O
with IN O
high JJ O
confidence NN O
that IN O
this DT O
campaign NN O
is VBZ O
targeting VBG O
Australian JJ O
financial JJ O
institutions NNS O
based VBN O
on IN O
several JJ O
factors NNS O
. . O

Our PRP$ O
Umbrella NN O
telemetry NN O
shows VBZ O
that IN O
the DT O
majority NN O
of IN O
the DT O
request NN O
comes VBZ O
from IN O
Australia NNP O
and CC O
the DT O
majority NN O
of IN O
the DT O
phone NN O
numbers NNS O
infected VBN O
have VBP O
the DT O
international JJ O
indicative NN O
for IN O
Australia NNP O
. . O

Finally RB O
, , O
the DT O
specific JJ O
overlays NNS O
are VBP O
designed VBN O
for IN O
Australian JJ O
financial JJ O
institutions NNS O
, , O
and CC O
Australia NNP O
is VBZ O
one CD O
of IN O
the DT O
geographic JJ O
regions NNS O
that WDT O
is VBZ O
accepted VBN O
by IN O
the DT O
C2 NNP O
. . O

DNS NNP O
queries NNS O
distribution NN O
over IN O
time NN O
The DT O
campaign NN O
does VBZ O
n't RB O
seem VB O
to TO O
be VB O
growing VBG O
at IN O
a DT O
fast JJ O
pace NN O
. . O

Our PRP$ O
data NN O
shows NNS O
, , O
on IN O
average NN O
, , O
about IN O
three CD O
requests NNS O
per IN O
hour NN O
to TO O
the DT O
drop NN O
host NN O
. . O

This DT O
request NN O
is VBZ O
only RB O
made VBN O
upon IN O
installation NN O
, , O
but CC O
there EX O
is VBZ O
no DT O
guarantee NN O
that IN O
it PRP O
will MD O
be VB O
installed VBN O
. . O

This DT O
data NN O
, , O
when WRB O
analyzed VBN O
with IN O
the DT O
number NN O
of IN O
commands NNS O
to TO O
send VB O
SMSs NNP O
that IN O
Talos NNP O
received VBD O
during IN O
the DT O
investigation NN O
, , O
lead VBP O
us PRP O
to TO O
conclude VB O
that IN O
the DT O
malicious JJ O
operator NN O
is VBZ O
aggressively RB O
spreading VBG O
the DT O
malware NN O
, , O
but CC O
that DT O
does VBZ O
n't RB O
seem VB O
to TO O
result VB O
in IN O
the DT O
same JJ O
number NN O
of IN O
new JJ O
infections NNS O
. . O

Examples NNS O
of IN O
the DT O
overlays NNS O
available JJ O
to TO O
the DT O
malware NN O
Above NNP O
, , O
you PRP O
can MD O
see VB O
examples NNS O
of IN O
the DT O
injections NNS O
that WDT O
distributed VBD O
to TO O
the DT O
malware NN O
as IN O
part NN O
of IN O
this DT O
specific JJ O
campaign NN O
. . O

While IN O
doing VBG O
our PRP$ O
investigation NN O
we PRP O
were VBD O
able JJ O
to TO O
identify VB O
other JJ O
malware NN O
packages NNS O
with IN O
different JJ O
names NNS O
. . O

Some DT O
of IN O
these DT O
might MD O
have VB O
been VBN O
used VBN O
on IN O
old JJ O
campaigns NNS O
or CC O
were VBD O
already RB O
prepared VBN O
for IN O
new JJ O
campaigns NNS O
. . O

MALWARE NNP O
TECHNICAL NNP O
DETAILS NNP O
During IN O
our PRP$ O
investigation NN O
, , O
researchers NNS O
uncovered VBD O
a DT O
malware NN O
known VBN O
as IN O
" NN O
Gustuff. NNP B-Malware
'' '' O
. . O

Given VBN O
the DT O
lack NN O
of IN O
indicators NNS O
of IN O
compromise NN O
, , O
we PRP O
decided VBD O
to TO O
check VB O
to TO O
see VB O
if IN O
this DT O
was VBD O
the DT O
same JJ O
malware NN O
we PRP O
had VBD O
been VBN O
researching VBG O
. . O

Our PRP$ O
Threat NN O
Intelligence NNP O
and CC O
Interdiction NNP O
team NN O
found VBD O
the DT O
Gustuff NNP B-Malware
malware NN O
being VBG O
advertised VBN O
in IN O
the DT O
Exploit.in NNP B-Indicator
forum NN O
as IN O
a DT O
botnet NN O
for IN O
rent NN O
. . O

The DT O
seller NN O
, , O
known VBN O
as IN O
" NN O
bestoffer NN O
, , O
'' '' O
was VBD O
, , O
at IN O
some DT O
point NN O
, , O
expelled VBN O
from IN O
the DT O
forum NN O
. . O

Gustuff NNP B-Malware
advertising NN O
screenshot VBD O
The DT O
companies NNS O
advertised VBN O
in IN O
the DT O
image NN O
above IN O
were VBD O
from IN O
Australia NNP O
, , O
which WDT O
matches VBZ O
up RP O
with IN O
the DT O
campaign NN O
we PRP O
researched VBD O
. . O

The DT O
screenshots NNS O
provided VBN O
by IN O
the DT O
author NN O
align NN O
with IN O
the DT O
advertised JJ O
features NNS O
and CC O
the DT O
features NNS O
that IN O
we PRP O
discovered VBD O
while IN O
doing VBG O
our PRP$ O
analysis NN O
. . O

Admin NNP O
panel NN O
The DT O
administration NN O
panel NN O
shows VBZ O
the DT O
application NN O
configuration NN O
, , O
which WDT O
matches VBZ O
the DT O
commands NNS O
from IN O
the DT O
C2 NNP O
. . O

Country NN O
selection VBD O
The DT O
administration NN O
console NN O
screenshots NNS O
also RB O
show VBP O
the DT O
ability NN O
to TO O
filter VB O
the DT O
results NNS O
by IN O
country NN O
. . O

In IN O
this DT O
case NN O
, , O
" FW O
AU NNP O
'' '' O
is VBZ I-Organization
the DT O
code NN O
shown VBN O
, , O
which WDT O
is VBZ O
Australia NNP O
. . O

Based VBN O
on IN O
this DT O
information NN O
, , O
Talos NNP B-Organization
assesses VBZ O
with IN O
high JJ O
confidence NN O
that IN O
the DT O
malware NN O
is VBZ O
the DT O
same JJ O
and CC O
this DT O
is VBZ O
, , O
in IN O
fact NN O
, , O
the DT O
Gustuff NNP B-Malware
malware NN O
. . O

Design NN O
In IN O
the DT O
manifest JJS O
, , O
the DT O
malware NN O
requests VBZ O
a DT O
large JJ O
number NN O
of IN O
permissions NNS O
. . O

However RB O
, , O
it PRP O
does VBZ O
n't RB O
request VB O
permissions NNS O
like IN O
BIND_ADMIN NNP O
. . O

To TO O
perform VB O
some DT O
of IN O
its PRP$ O
activities NNS O
, , O
the DT O
malware NN O
does VBZ O
not RB O
need VB O
high JJ O
privileges NNS O
inside IN O
the DT O
device NN O
, , O
as IN O
we PRP O
will MD O
explain VB O
ahead RB O
. . O

Permissions NNS O
in IN O
the DT O
manifest JJS O
This DT O
malware NN O
is VBZ O
designed VBN O
to TO O
avoid VB O
detection NN O
and CC O
analysis NN O
. . O

It PRP O
has VBZ O
several JJ O
protections NNS O
in IN O
place NN O
, , O
both DT O
in IN O
the DT O
C2 NNP O
and CC O
the DT O
malware NN O
's POS O
code NN O
. . O

The DT O
code NN O
is VBZ O
not RB O
only RB O
obfuscated VBN O
but CC O
also RB O
packed VBD O
. . O

The DT O
packer NN O
, , O
besides IN O
making VBG O
the DT O
static JJ O
analysis NN O
more RBR O
complex JJ O
, , O
will MD O
break VB O
the DT O
standard JJ O
debugger NN O
. . O

Manifest JJS O
activity NN O
declaration NN O
Class NNP O
list NN O
inside IN O
the DT O
dex NN O
file VBD O
The DT O
main JJ O
malware NN O
classes NNS O
are VBP O
packed VBN O
, , O
to TO O
a DT O
point NN O
where WRB O
the DT O
class NN O
defined VBN O
in IN O
the DT O
manifest NN O
has VBZ O
a DT O
handler NN O
for IN O
the DT O
MAIN NNP O
category NN O
that WDT O
does VBZ O
not RB O
exist VB O
in IN O
the DT O
DEX NNP O
file NN O
. . O

Error NN O
when WRB O
trying VBG O
to TO O
debug VB O
the DT O
malware NN O
using VBG O
the DT O
Android NNP B-System
Studio NNP I-System
IDE NNP I-System
. . O

One CD O
of IN O
the DT O
side NN O
effects NNS O
of IN O
this DT O
packer NN O
is VBZ O
the DT O
inability NN O
of IN O
Android NNP B-System
Studio NNP I-System
IDE NNP I-System
to TO O
debug VB O
the DT O
code NN O
. . O

This DT O
happens VBZ O
because IN O
the DT O
IDE NNP O
executes VBZ O
the DT O
code NN O
from IN O
the DT O
Android NNP B-System
debug NN I-System
bridge NN I-System
( ( O
ADB NNP O
) ) O
by IN O
calling VBG O
the DT O
activity NN O
declared VBN O
in IN O
the DT O
manifest NN O
by IN O
name NN O
. . O

Since IN O
the DT O
class NN O
does VBZ O
not RB O
exist VB O
at IN O
startup NN O
, , O
the DT O
application NN O
does VBZ O
not RB O
run VB O
on IN O
the DT O
debugger NN O
. . O

Although IN O
Talos NNP B-Malware
analyzed VBD O
the DT O
unpacked JJ O
version NN O
of IN O
the DT O
code NN O
, , O
the DT O
packer NN O
analysis NN O
is VBZ O
beyond IN O
the DT O
scope NN O
of IN O
this DT O
post NN O
. . O

Check NNP O
code NN O
for IN O
emulators NNS O
As IN O
part NN O
of IN O
its PRP$ O
defense NN O
, , O
the DT O
malware NN O
payload NN O
first JJ O
checks NNS O
for IN O
emulators NNS O
to TO O
prevent VB O
analysis NN O
on IN O
sandboxes NNS O
. . O

It PRP O
checks VBZ O
for IN O
different JJ O
kinds NNS O
of IN O
emulators NNS O
, , O
including VBG O
QEMU NNP B-System
, , O
Genymotion NNP B-System
, , O
BlueStacks NNP B-System
and CC O
Bignox NNP B-System
. . O

If IN O
the DT O
malware NN O
determines VBZ O
that DT O
is VBZ O
not RB O
running VBG O
on IN O
an DT O
emulator NN O
, , O
it PRP O
then RB O
performs VBZ O
additional JJ O
checks NNS O
to TO O
ensure VB O
that IN O
it PRP O
wo MD O
n't RB O
be VB O
detected VBN O
. . O

Code NN O
to TO O
check VB O
the DT O
existence NN O
of IN O
SafetyNet NNP O
Google NNP B-System
API NNP I-System
It PRP O
also RB O
checks VBZ O
if IN O
the DT O
Android NNP B-System
SafetyNet NNP O
is VBZ O
active JJ O
and CC O
reporting VBG O
back RB O
to TO O
the DT O
C2 NNP O
. . O

This DT O
helps VBZ O
the DT O
C2 NNP O
define VB O
what WP O
actions NNS O
it PRP O
can MD O
do VB O
before IN O
being VBG O
detected VBN O
on IN O
the DT O
mobile JJ O
device NN O
. . O

List NN O
of IN O
anti-virus JJ O
packages NNS O
that WDT O
are VBP O
checked VBN O
The DT O
payload NN O
goes VBZ O
a DT O
long JJ O
way NN O
to TO O
protect VB O
itself PRP O
and CC O
checks NNS O
for IN O
anti-virus JJ O
software NN O
installed VBN O
on IN O
the DT O
mobile JJ O
device NN O
. . O

The DT O
trojan NN O
uses VBZ O
the DT O
Android NNP B-System
Accessibility NNP I-System
API NNP O
to TO O
intercept VB O
all DT O
interactions NNS O
between IN O
the DT O
user NN O
and CC O
the DT O
mobile JJ O
device NN O
. . O

The DT O
Android NNP B-System
developer NN O
documentation NN O
describes VBZ O
the DT O
accessibility NN O
event NN O
class NN O
as IN O
a DT O
class NN O
that WDT O
" VBZ O
represents VBZ O
accessibility NN O
events NNS O
that WDT O
are VBP O
seen VBN O
by IN O
the DT O
system NN O
when WRB O
something NN O
notable JJ O
happens NNS O
in IN O
the DT O
user JJ O
interface NN O
. . O

For IN O
example NN O
, , O
when WRB O
a DT O
button NN O
is VBZ O
clicked VBN O
, , O
a DT O
view NN O
is VBZ O
focused VBN O
, , O
etc FW O
. . O

'' '' O
For IN O
each DT O
interaction NN O
, , O
the DT O
malware NN O
will MD O
check VB O
if IN O
the DT O
generator NN O
is VBZ O
a DT O
package NN O
that WDT O
belongs VBZ O
to TO O
the DT O
anti-virus JJ O
list NN O
, , O
the DT O
malware NN O
will MD O
abuse VB O
another DT O
feature NN O
of IN O
the DT O
Accessibility NNP B-System
API NNP I-System
. . O

There EX O
is VBZ O
a DT O
function NN O
called VBN O
" JJ O
performGlobalAction NN O
'' '' O
with IN O
the DT O
description NN O
below IN O
. . O

Android NNP B-System
documentation NN O
describes VBZ O
that DT O
function NN O
as IN O
" NN O
a DT O
global JJ O
action NN O
. . O

Such JJ O
an DT O
action NN O
can MD O
be VB O
performed VBN O
at IN O
any DT O
moment NN O
, , O
regardless RB O
of IN O
the DT O
current JJ O
application NN O
or CC O
user JJ O
location NN O
in IN O
that DT O
application NN O
. . O

For IN O
example NN O
, , O
going VBG O
back RB O
, , O
going VBG O
home NN O
, , O
opening VBG O
recents NNS O
, , O
etc FW O
. . O

'' '' O
The DT O
trojan NN O
calls VBZ O
this DT O
function NN O
with IN O
the DT O
action NN O
GLOBAL_ACTION_BACK NNP O
, , O
which WDT O
equals VBZ O
the DT O
pressing NN O
of IN O
the DT O
back JJ O
button NN O
on IN O
the DT O
device NN O
, , O
thus RB O
canceling VBG O
the DT O
opening NN O
of IN O
the DT O
anti-virus JJ O
application NN O
. . O

The DT O
same JJ O
event NN O
interception NN O
is VBZ O
used VBN O
to TO O
place VB O
the DT O
webview NN O
overlay NN O
when WRB O
the DT O
user NN O
tries VBZ O
to TO O
access NN O
the DT O
targeted JJ O
applications NNS O
, , O
allowing VBG O
it PRP O
to TO O
display VB O
its PRP$ O
overlay NN O
, , O
thus RB O
intercepting VBG O
the DT O
credentials NNS O
. . O

The DT O
beaconing VBG O
only RB O
starts VBZ O
after IN O
the DT O
application NN O
is VBZ O
installed VBN O
and CC O
removed VBN O
from IN O
the DT O
running VBG O
tasks NNS O
. . O

Beaconing VBG O
information NN O
The DT O
ID NNP O
is VBZ O
generated VBN O
for IN O
each DT O
installation NN O
of IN O
the DT O
malware NN O
, , O
while IN O
the DT O
token NN O
remains VBZ O
unique JJ O
. . O

Some DT O
of IN O
the DT O
checks NNS O
performed VBD O
previously RB O
are VBP O
immediately RB O
sent VBN O
to TO O
the DT O
C2 NNP O
, , O
like IN O
the DT O
safetyNet NN O
, , O
admin NN O
and CC O
defaultSMSApp NN O
. . O

The DT O
beaconing NN O
is VBZ O
sent VBN O
to TO O
the DT O
URL NNP O
http NN B-Indicator
: : I-Indicator
// JJ I-Indicator
/api/v2/get.php NN I-Indicator
with IN O
an DT O
interval NN O
of IN O
60 CD O
seconds NNS O
. . O

Answer NN O
from IN O
the DT O
C2 NNP O
The DT O
C2 NNP O
will MD O
check VB O
the DT O
country NN O
field NN O
, , O
if IN O
it PRP O
's VBZ O
empty JJ O
or CC O
if IN O
the DT O
country NN O
is VBZ O
not RB O
targeted VBN O
, , O
it PRP O
will MD O
reply VB O
with IN O
a DT O
" NN O
Unauthorized NNP O
'' '' O
answer NN O
. . O

Otherwise RB O
, , O
it PRP O
will MD O
return VB O
a DT O
JSON NNP O
encoded VBD O
" NNP O
OK NNP O
, , O
'' '' O
and CC O
if IN O
that DT O
is VBZ O
the DT O
case NN O
, , O
the DT O
command NN O
to TO O
be VB O
executed VBN O
. . O

List NN O
of IN O
available JJ O
commands NNS O
The DT O
command NN O
names NNS O
are VBP O
self-explanatory JJ O
. . O

The DT O
command NN O
will MD O
be VB O
issued VBN O
as IN O
an DT O
answer NN O
to TO O
the DT O
beaconing NN O
, , O
and CC O
the DT O
result NN O
will MD O
be VB O
returned VBN O
to TO O
the DT O
URL NNP O
http NN B-Indicator
: : I-Indicator
// JJ I-Indicator
/api/v2/set_state.php JJ I-Indicator
Example NNP O
of IN O
the DT O
command NN O
" NN O
changeServer NN O
'' '' O
The DT O
commands NNS O
are VBP O
issued VBN O
in IN O
a DT O
JSON NNP O
format NN O
, , O
and CC O
the DT O
obfuscation NN O
is VBZ O
part NN O
of IN O
the DT O
malware NN O
code NN O
and CC O
not RB O
added VBN O
by IN O
the DT O
packer NN O
. . O

It PRP O
is VBZ O
a DT O
custom JJ O
obfuscation NN O
partly RB O
based VBN O
on IN O
base85 NN B-Indicator
encoding NN I-Indicator
, , O
which WDT O
is VBZ O
in IN O
itself PRP O
unusual JJ O
, , O
in IN O
malware NN O
. . O

Base85 NNP B-Indicator
encoding NN I-Indicator
is VBZ O
usually RB O
used VBN O
on IN O
pdf NN O
and CC O
postscript NN O
documentsThe NN O
configuration NN O
of IN O
the DT O
malware NN O
is VBZ O
stored VBN O
in IN O
custom NN O
preferences NNS O
files NNS O
, , O
using VBG O
the DT O
same JJ O
obfuscation NN O
scheme NN O
. . O

Activation NNP O
cycle NN O
As IN O
we PRP O
have VBP O
explained VBN O
above IN O
, , O
the DT O
malware NN O
has VBZ O
several JJ O
defence NN O
mechanisms NNS O
. . O

Beside IN O
the DT O
obfuscation NN O
and CC O
the DT O
environment NN O
checks NNS O
, , O
the DT O
malware NN O
also RB O
has VBZ O
some DT O
interesting JJ O
anti-sandbox JJ O
mechanisms NNS O
. . O

After IN O
installation NN O
, , O
the DT O
user NN O
needs VBZ O
to TO O
run VB O
the DT O
application NN O
. . O

The DT O
user NN O
needs VBZ O
to TO O
press VB O
the DT O
" NN O
close JJ O
'' '' O
button NN O
to TO O
finish VB O
the DT O
installation NN O
. . O

However RB O
, , O
this DT O
wo MD O
n't RB O
close VB O
the DT O
application NN O
, , O
it PRP O
will MD O
send VB O
it PRP O
to TO O
the DT O
background NN O
, , O
instead RB O
. . O

While IN O
the DT O
application NN O
is VBZ O
in IN O
the DT O
background NN O
, , O
although IN O
the DT O
service NN O
is VBZ O
already RB O
running VBG O
, , O
the DT O
beaconing NN O
will MD O
not RB O
start VB O
. . O

The DT O
beaconing NN O
will MD O
only RB O
start VB O
after IN O
the DT O
application NN O
is VBZ O
removed VBN O
from IN O
the DT O
background NN O
, , O
ultimately RB O
stopping VBG O
it PRP O
. . O

This DT O
will MD O
be VB O
the DT O
trigger NN O
for IN O
the DT O
service NN O
to TO O
start VB O
the DT O
beaconing NN O
. . O

As IN O
mentioned VBN O
previously RB O
, , O
the DT O
beaconing NN O
is VBZ O
done VBN O
every DT O
60 CD O
seconds NNS O
. . O

However RB O
, , O
no DT O
command NN O
is VBZ O
received VBN O
from IN O
the DT O
C2 NNP O
until IN O
the DT O
inactiveTime JJ O
field NN O
( ( O
see VB O
beaconing VBG O
information NN O
image NN O
above NN O
) ) O
has VBZ O
at IN O
least JJS O
the DT O
value NN O
of IN O
2000000 CD O
. . O

This DT O
time NN O
resets VBZ O
every DT O
time NN O
the DT O
user NN O
performs VBZ O
some DT O
activity NN O
. . O

After IN O
the DT O
checks NNS O
, , O
the DT O
malware NN O
becomes VBZ O
active JJ O
, , O
but CC O
first RB O
, , O
it PRP O
goes VBZ O
through IN O
seven CD O
steps NNS O
, , O
each DT O
one CD O
calling VBG O
a DT O
different JJ O
command NN O
: : O
uploadPhoneNumbers NNS O
: : O
Exfiltrates NNS O
all DT O
phone NN O
numbers NNS O
that WDT O
are VBP O
in IN O
the DT O
contact NN O
list NN O
. . O

Aside RB O
from IN O
the DT O
natural JJ O
value NN O
of IN O
phone NN O
numbers NNS O
associated VBN O
with IN O
the DT O
names NNS O
of IN O
their PRP$ O
owners NNS O
. . O

Using VBG O
the DT O
SMS NNP O
has VBZ O
an DT O
initial JJ O
infection NN O
vector NN O
is VBZ O
another DT O
possibility NN O
for IN O
the DT O
exfiltration NN O
. . O

One CD O
of IN O
the DT O
purposes NNS O
of IN O
the DT O
exfiltration NN O
of IN O
the DT O
contact NN O
list NN O
is VBZ O
to TO O
use VB O
them PRP O
to TO O
attack VB O
other JJ O
victims NNS O
using VBG O
SMS NNP O
as IN O
an DT O
initial JJ O
vector NN O
. . O

checkApps NN O
: : O
Asks VBZ O
the DT O
malware NN O
to TO O
see VB O
if IN O
the DT O
packages NNS O
sent VBD O
as IN O
parameters NNS O
are VBP O
installed VBN O
. . O

The DT O
malware NN O
contains VBZ O
a DT O
list NN O
of IN O
209 CD O
packages NNS O
hardcoded VBN O
in IN O
its PRP$ O
source NN O
code NN O
. . O

However RB O
, , O
the DT O
C2 NNP O
can MD O
send VB O
an DT O
updated JJ O
list NN O
. . O

List NN O
of IN O
packages NNS O
received VBN O
from IN O
the DT O
C2 NNP O
adminNumber NN O
: : O
Setup NN O
of IN O
the DT O
admin NN O
phone NN O
number NN O
. . O

In IN O
our PRP$ O
case NN O
, , O
the DT O
administrator NN O
phone NN O
number NN O
belongs NNS O
to TO O
a DT O
mobile JJ O
network NN O
in IN O
Australia NNP O
. . O

Phone NNP O
number NN O
for IN O
administration NN O
changeServer NN O
: : O
At IN O
this DT O
point NN O
, , O
the DT O
malware NN O
changes VBZ O
the DT O
C2 NNP O
to TO O
a DT O
new JJ O
host NN O
, , O
even RB O
though IN O
the DT O
API NNP O
and CC O
communication NN O
protocol NN O
continues VBZ O
to TO O
be VB O
the DT O
same JJ O
. . O

Change NNP O
server RB O
request VBP O
The DT O
URL NNP O
's POS O
for IN O
the DT O
new JJ O
server NN O
is VBZ O
obfuscated VBN O
, , O
preventing VBG O
easy JJ O
network NN O
identification NN O
. . O

changeActivity NN O
: : O
This DT O
command NN O
will MD O
set VB O
up RP O
the DT O
webview NN O
to TO O
overlay VB O
any DT O
of IN O
the DT O
target NN O
activities NNS O
. . O

changeActivity NN O
command VBP O
The DT O
webview NN O
injects NNS O
are VBP O
not RB O
hosted VBN O
on IN O
the DT O
C2 NNP O
, , O
they PRP O
are VBP O
hosted VBN O
on IN O
a DT O
completely RB O
different JJ O
server NN O
. . O

params NNS O
: : O
This DT O
command NN O
allows VBZ O
the DT O
malicious JJ O
operator NN O
to TO O
change VB O
configuration NN O
parameters NNS O
in IN O
the DT O
malware NN O
. . O

During IN O
this DT O
stage NN O
of IN O
the DT O
activation NN O
cycle NN O
, , O
the DT O
malware NN O
increases VBZ O
the DT O
beaconing NN O
time NN O
to TO O
avoid VB O
detection NN O
. . O

Command NNP O
to TO O
change VB O
the DT O
beaconing NN O
changeArchive NN O
: : O
The DT O
final JJ O
command NN O
of IN O
the DT O
activation NN O
cycle NN O
is VBZ O
the DT O
download NN O
of IN O
an DT O
archive NN O
. . O

This DT O
archive NN O
is VBZ O
stored VBN O
in IN O
the DT O
same JJ O
host NN O
has VBZ O
the DT O
webviews NNS O
. . O

The DT O
archive NN O
is VBZ O
a DT O
ZIP NNP O
containing VBG O
several JJ O
files NNS O
, , O
which WDT O
is VBZ O
protected VBN O
with IN O
a DT O
password NN O
. . O

Change NNP O
archive JJ O
command NN O
After IN O
this DT O
activation NN O
cycle NN O
, , O
the DT O
malware NN O
will MD O
start VB O
the DT O
collection NN O
of IN O
information NN O
activities NNS O
and CC O
dissemination NN O
. . O

Malicious JJ O
activity NN O
Once IN O
the DT O
activation NN O
cycle NN O
ends VBZ O
, , O
the DT O
trojan NN O
will MD O
start VB O
its PRP$ O
malicious JJ O
activities NNS O
. . O

These DT O
activities NNS O
depend VBP O
on IN O
the DT O
device NN O
configuration NN O
. . O

Depending VBG O
if IN O
the DT O
victim NN O
has VBZ O
any DT O
of IN O
the DT O
targeted JJ O
applications NNS O
, , O
the DT O
anti-virus NN O
installed VBD O
or CC O
geographic JJ O
location NN O
, , O
the DT O
malware NN O
can MD O
harvest VB O
credentials NNS O
from IN O
the DT O
targeted JJ O
applications NNS O
, , O
exfiltrate VBP O
all DT O
personal JJ O
information NN O
or CC O
simply RB O
use VB O
the DT O
victim NN O
's POS O
device NN O
to TO O
send VB O
SMS NNP O
to TO O
spread VB O
the DT O
trojan NN O
The DT O
malware NN O
deploys VBZ O
overlaying VBG O
webviews NNS O
to TO O
trick VB O
the DT O
user NN O
and CC O
eventually RB O
steal VB O
their PRP$ O
login NN O
credentials NNS O
. . O

These DT O
are VBP O
adapted VBN O
to TO O
the DT O
information NN O
the DT O
malicious JJ O
operator NN O
wants VBZ O
to TO O
retrieve VB O
. . O

The DT O
first JJ O
webview NN O
overlay NN O
is VBZ O
created VBN O
on IN O
step NN O
6 CD O
of IN O
the DT O
activation NN O
cycle NN O
. . O

Pin NNP O
request NN O
overlay NN O
This DT O
overlay NN O
asks VBZ O
the DT O
user NN O
to TO O
provide VB O
their PRP$ O
PIN NNP O
to TO O
unlock VB O
the DT O
mobile JJ O
device NN O
, , O
which WDT O
is VBZ O
immediately RB O
exfiltrated VBN O
to TO O
the DT O
C2 NNP O
. . O

The DT O
last JJ O
step NN O
of IN O
the DT O
activation NN O
cycle NN O
is VBZ O
the DT O
download NN O
of IN O
a DT O
password-protected JJ O
ZIP NNP O
file NN O
. . O

This DT O
file NN O
contains VBZ O
all DT O
HTML NNP O
, , O
CSS NNP O
and CC O
PNG NNP O
files NNS O
necessary JJ O
to TO O
create VB O
overlays NNS O
. . O

Talos NNP O
found VBD O
189 CD O
logos NN O
from IN O
banks NNS O
to TO O
cryptocurrency VB O
exchanges NNS O
inside IN O
the DT O
archive JJ O
, , O
all DT O
of IN O
which WDT O
could MD O
be VB O
targeted VBN O
. . O

The DT O
archive NN O
also RB O
contained VBD O
all PDT O
the DT O
necessary JJ O
codes NNS O
to TO O
target VB O
Australian JJ O
financial JJ O
institutions NNS O
. . O

The DT O
overlays NNS O
are VBP O
activated VBN O
by IN O
the DT O
malicious JJ O
operator NN O
using VBG O
the DT O
command NN O
changeActivity NN O
, , O
as IN O
seen VBN O
on IN O
step NN O
5 CD O
of IN O
the DT O
activation NN O
cycle NN O
. . O

In IN O
this DT O
case NN O
, , O
we PRP O
can MD O
see VB O
that IN O
the DT O
HTML NNP O
code NN O
of IN O
the DT O
overlay NN O
is VBZ O
stored VBN O
in IN O
the DT O
C2 NNP O
infrastructure NN O
. . O

However RB O
, , O
since IN O
the DT O
archive NN O
that WDT O
is VBZ O
downloaded VBN O
into IN O
the DT O
device NN O
has VBZ O
all PDT O
the DT O
necessary JJ O
information NN O
and CC O
the DT O
malicious JJ O
actor NN O
has VBZ O
access NN O
to TO O
the DT O
device NN O
via IN O
SMS NNP O
, , O
the DT O
malicious JJ O
operator NN O
can MD O
keep VB O
its PRP$ O
activity NN O
even RB O
without IN O
the DT O
C2 NNP O
infrastructure NN O
. . O

Infrastructure NN O
The DT O
infrastructure NN O
supporting VBG O
this DT O
malware NN O
is VBZ O
rather RB O
complex JJ O
. . O

It PRP O
is VBZ O
clear JJ O
that IN O
on IN O
all DT O
stages NNS O
there EX O
are VBP O
at IN O
least JJS O
two CD O
layers NNS O
. . O

The DT O
infrastructure NN O
has VBZ O
several JJ O
layers NNS O
, , O
although IN O
not RB O
being VBG O
very RB O
dynamic JJ O
, , O
still RB O
has VBZ O
several JJ O
layers NNS O
each DT O
one CD O
providing VBG O
some DT O
level NN O
of IN O
protection NN O
. . O

All PDT O
the DT O
IP NNP O
addresses VBZ O
belong RB O
to TO O
the DT O
same JJ O
company NN O
Hetzner NNP B-Organization
, , O
an DT O
IP-hosting JJ O
firm NN O
in IN O
Germany NNP O
. . O

COVERAGE NNP O
Cisco NNP B-Organization
Cloud NNP B-System
Web NNP I-System
Security NNP I-System
( ( O
CWS NNP O
) ) O
or CC O
Web NNP B-System
Security NNP I-System
Appliance NNP I-System
( ( O
WSA NNP O
) ) O
web VBP O
scanning VBG O
prevents NNS O
access NN O
to TO O
malicious JJ O
websites NNS O
and CC O
detects NNS O
malware VBP O
used VBN O
in IN O
these DT O
attacks NNS O
. . O

Email NNP O
Security NNP O
can MD O
block VB O
malicious JJ O
emails NNS O
sent VBN O
by IN O
threat NN O
actors NNS O
as IN O
part NN O
of IN O
their PRP$ O
campaign NN O
. . O

Network NNP O
Security NNP O
appliances NNS O
such JJ O
as IN O
Next-Generation NNP B-System
Firewall NNP I-System
( ( O
NGFW NNP O
) ) O
, , O
Next-Generation NNP B-System
Intrusion NNP I-System
Prevention NNP I-System
System NNP I-System
( ( O
NGIPS NNP O
) ) O
, , O
and CC O
Meraki NNP B-System
MX NNP I-System
can MD O
detect VB O
malicious JJ O
activity NN O
associated VBN O
with IN O
this DT O
threat NN O
. . O

AMP NNP O
Threat NNP O
Grid NNP O
helps VBZ O
identify VB O
malicious JJ O
binaries NNS O
and CC O
build VB O
protection NN O
into IN O
all DT O
Cisco NNP B-Organization
Security NNP O
products NNS O
. . O

Umbrella NN O
, , O
our PRP$ O
secure JJ O
internet NN O
gateway NN O
( ( O
SIG NNP O
) ) O
, , O
blocks VBZ O
users NNS O
from IN O
connecting VBG O
to TO O
malicious JJ O
domains NNS O
, , O
IPs NNP O
, , O
and CC O
URLs NNP O
, , O
whether IN O
users NNS O
are VBP O
on IN O
or CC O
off IN O
the DT O
corporate JJ O
network NN O
. . O

Open NNP O
Source NNP O
SNORTⓇ NNP O
Subscriber NNP O
Rule NNP O
Set NNP O
customers NNS O
can MD O
stay VB O
up RB O
to TO O
date NN O
by IN O
downloading VBG O
the DT O
latest JJS O
rule NN O
pack NN O
available JJ O
for IN O
purchase NN O
on IN O
Snort.org NNP O
. . O

INDICATORS NNP O
OF NNP O
COMPROMISE NNP O
( ( O
IOCS NNP O
) ) O
Domains VBZ O
Facebook-photos-au.su JJ O
Homevideo2-12l.ml NNP B-Indicator
videohosting1-5j.gq NN B-Indicator
URLs NNP O
hxxp NN B-Indicator
: : I-Indicator
//88.99.227 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
26/html2/2018/GrafKey/new-inj-135-3-dark.html JJ I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//88.99.227 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
26/html2/arc92/au483x.zip CD I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//94.130.106 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
117:8080/api/v1/report/records.php CD I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//88.99.227 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
26/html2/new-inj-135-3-white.html JJ I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//facebook-photos-au JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
su/ChristinaMorrow NN I-Indicator
hxxp NN B-Indicator
: : I-Indicator
//homevideo2-12l JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
ml/mms3/download_3.php NN I-Indicator
IP NNP O
addresses VBZ O
78.46.201.36 CD B-Indicator
88.99.170.84 CD B-Indicator
88.99.227.26 CD B-Indicator
94.130.106.117 CD B-Indicator
88.99.174.200 CD B-Indicator
88.99.189.31 CD B-Indicator
Hash NNP O
369fcf48c1eb982088c22f86672add10cae967af82613bee6fb8a3669603dc48 CD B-Indicator
b2d4fcf03c7a8bf135fbd3073bea450e2e6661ad8ef2ab2058a3c04f81fc3f3e NN B-Indicator

8f5d5d8419a4832d175a6028c9e7d445f1e99fdc12170db257df79831c69ae4e CD B-Indicator
a5ebcdaf5fd10ec9de85d62e48cc97a4e08c699a7ebdeab0351b86ab1370557d NN B-Indicator
84578b9b2c3cc1c7bbfcf4038a6c76ae91dfc82eef5e4c6815627eaf6b4ae6f6 CD B-Indicator

89eecd91dff4bf42bebbf3aa85aa512ddf661d3e9de4c91196c98f4fc325a018 CD B-Indicator
9edee3f3d539e3ade61ac2956a6900d93ba3b535b6a76b3a9ee81e2251e25c61 CD B-Indicator
0e48e5dbc3a60910c1460b382d28e087a580f38f57d3f82d4564309346069bd1 CD B-Indicator
c113cdd2a5e164dcba157fc4e6026495a1cfbcb0b1a8bf3e38e7eddbb316e01f NN B-Indicator

1819d2546d9c9580193827c0d2f5aad7e7f2856f7d5e6d40fd739b6cecdb1e9e CD B-Indicator
b213c1de737b72f8dd7185186a246277951b651c64812692da0b9fdf1be5bf15 NN B-Indicator
453e7827e943cdda9121948f3f4a68d6289d09777538f92389ca56f6e6de03f0 CD B-Indicator
0246dd4acd9f64ff1508131c57a7b29e995e102c74477d5624e1271700ecb0e2 CD B-Indicator

88034e0eddfdb6297670d28ed810aef87679e9492e9b3e782cc14d9d1a55db84 CD B-Indicator
e08f08f4fa75609731c6dd597dc55c8f95dbdd5725a6a90a9f80134832a07f2e JJ B-Indicator
01c5b637f283697350ca361f241416303ab6123da4c6726a6555ac36cb654b5c CD B-Indicator
1fb06666befd581019af509951320c7e8535e5b38ad058069f4979e9a21c7e1c CD B-Indicator

6bdfb79f813448b7f1b4f4dbe6a45d1938f3039c93ecf80318cedd1090f7e341 CD B-Indicator
ADDITIONAL NNP O
INFORMATION NNP O
Packages NNP O
monitored VBD O
pin.secret.access NN B-Indicator
com.chase.sig.android NN B-Indicator
com.morganstanley.clientmobile.prod NN B-Indicator
com.wf.wellsfargomobile NN B-Indicator
com.citi.citimobile NN B-Indicator
com.konylabs.capitalone NN B-Indicator
com.infonow.bofa NN B-Indicator
com.htsu.hsbcpersonalbanking VBG B-Indicator
com.usaa.mobile.android.usaa NN B-Indicator

com.schwab.mobile NN B-Indicator
com.americanexpress.android.acctsvcs.us NN O
com.pnc.ecommerce.mobile NN B-Indicator
com.regions.mobbanking VBG B-Indicator
com.clairmail.fth JJ B-Indicator
com.grppl.android.shell.BOS NN B-Indicator
com.tdbank NN B-Indicator
com.huntington.m NN B-Indicator
com.citizensbank.androidapp NN B-Indicator
com.usbank.mobilebanking VBG B-Indicator
com.ally.MobileBanking VBG B-Indicator
com.key.android JJ B-Indicator
com.unionbank.ecommerce.mobile.android NN B-Indicator
com.mfoundry.mb.android.mb_BMOH071025661 NN B-Indicator

com.bbt.cmol NN B-Indicator
com.sovereign.santander NN B-Indicator
com.mtb.mbanking.sc.retail.prod NN B-Indicator
com.fi9293.godough NN B-Indicator
com.commbank.netbank NN B-Indicator
org.westpac.bank VBD B-Indicator
org.stgeorge.bank JJ B-Indicator
au.com.nab.mobile IN B-Indicator
au.com.bankwest.mobile JJ B-Indicator
au.com.ingdirect.android JJ B-Indicator
org.banksa.bank NN B-Indicator
com.anz.android NN B-Indicator
com.anz.android.gomoney NN B-Indicator
com.citibank.mobile.au NN B-Indicator
org.bom.bank NN B-Indicator
com.latuabancaperandroid NN B-Indicator

com.comarch.mobile NN B-Indicator
com.jpm.sig.android NN B-Indicator
com.konylabs.cbplpat NN B-Indicator
by.belinvestbank NN B-Indicator
no.apps.dnbnor JJ B-Indicator
com.arkea.phonegap NN B-Indicator
com.alseda.bpssberbank NN B-Indicator
com.belveb.belvebmobile NN B-Indicator
com.finanteq.finance.ca NN B-Indicator
pl.eurobank NN B-Indicator
pl.eurobank2 NN B-Indicator
pl.noblebank.mobile IN B-Indicator
com.getingroup.mobilebanking VBG B-Indicator
hr.asseco.android.mtoken.getin NN B-Indicator
pl.getinleasing.mobile NN B-Indicator
com.icp.ikasa.getinon NN B-Indicator

eu.eleader.mobilebanking.pekao JJ B-Indicator
softax.pekao.powerpay NN B-Indicator
softax.pekao.mpos NN B-Indicator
dk.jyskebank.mobilbank NN B-Indicator
com.starfinanz.smob.android.bwmobilbanking VBG B-Indicator
eu.newfrontier.iBanking.mobile.SOG.Retail JJ B-Indicator
com.accessbank.accessbankapp NN B-Indicator
com.sbi.SBIFreedomPlus NN B-Indicator
com.zenithBank.eazymoney NN B-Indicator
net.cts.android.centralbank NN B-Indicator
com.f1soft.nmbmobilebanking.activities.main NN B-Indicator
com.lb.smartpay NN B-Indicator
com.mbmobile NN B-Indicator

com.db.mobilebanking VBG B-Indicator
com.botw.mobilebanking VBG B-Indicator
com.fg.wallet NN B-Indicator
com.sbi.SBISecure NN B-Indicator
com.icsfs.safwa NN B-Indicator
com.interswitchng.www NN B-Indicator
com.dhanlaxmi.dhansmart.mtc NN B-Indicator
com.icomvision.bsc.tbc NN B-Indicator
hr.asseco.android.jimba.cecro NN B-Indicator
com.vanso.gtbankapp NN B-Indicator
com.fss.pnbpsp NN B-Indicator
com.mfino.sterling VBG B-Indicator
cy.com.netinfo.netteller.boc JJ B-Indicator
ge.mobility.basisbank NN B-Indicator
com.snapwork.IDBI NN B-Indicator

com.lcode.apgvb NN B-Indicator
com.fact.jib NN B-Indicator
mn.egolomt.bank NN B-Indicator
com.pnbrewardz NN B-Indicator
com.firstbank.firstmobile NN B-Indicator
wit.android.bcpBankingApp.millenniumPL NN B-Indicator
com.grppl.android.shell.halifax NN B-Indicator
com.revolut.revolut NN B-Indicator
de.commerzbanking.mobil NN B-Indicator
uk.co.santander.santanderUK JJ B-Indicator
se.nordea.mobilebank NN B-Indicator
com.snapwork.hdfc NN B-Indicator
com.csam.icici.bank.imobile NN B-Indicator
com.msf.kbank.mobile NN B-Indicator

com.bmm.mobilebankingapp NN B-Indicator
net.bnpparibas.mescomptes NNS B-Indicator
fr.banquepopulaire.cyberplus VBP B-Indicator
com.caisseepargne.android.mobilebanking VBG B-Indicator
com.palatine.android.mobilebanking.prod NN B-Indicator
com.ocito.cdn.activity.creditdunord NN B-Indicator
com.fullsix.android.labanquepostale.accountaccess NN B-Indicator
mobi.societegenerale.mobile.lappli NN B-Indicator
com.db.businessline.cardapp NN B-Indicator
com.skh.android.mbanking VBG B-Indicator
com.ifs.banking.fiid1491 NN B-Indicator

de.dkb.portalapp NN B-Indicator
pl.pkobp.ipkobiznes NNS B-Indicator
pl.com.suntech.mobileconnect VBP B-Indicator
eu.eleader.mobilebanking.pekao.firm JJ B-Indicator
pl.mbank NN B-Indicator
pl.upaid.nfcwallet.mbank NN B-Indicator
eu.eleader.mobilebanking.bre NN B-Indicator
pl.asseco.mpromak.android.app.bre NN B-Indicator
pl.asseco.mpromak.android.app.bre.hd NN B-Indicator
pl.mbank.mnews NNS B-Indicator
eu.eleader.mobilebanking.raiffeisen VBP B-Indicator
pl.raiffeisen.nfc NN B-Indicator
hr.asseco.android.jimba.rmb NN B-Indicator

com.advantage.RaiffeisenBank NN B-Indicator
pl.bzwbk.ibiznes24 NN B-Indicator
pl.bzwbk.bzwbk24 NN B-Indicator
pl.bzwbk.mobile.tab.bzwbk24 NN B-Indicator
com.comarch.mobile.investment NN B-Indicator
com.android.vending VBG B-Indicator
com.snapchat.android JJ B-Indicator
jp.naver.line.android NN B-Indicator
com.viber.voip NN B-Indicator
com.gettaxi.android NN B-Indicator
com.whatsapp NN B-Indicator
com.tencent.mm NN B-Indicator
com.skype.raider NN B-Indicator
com.ubercab NN B-Indicator
com.paypal.android.p2pmobile NN B-Indicator

com.circle.android NN B-Indicator
com.coinbase.android NN B-Indicator
com.walmart.android NN B-Indicator
com.bestbuy.android NN B-Indicator
com.ebay.gumtree.au NN B-Indicator
com.ebay.mobile NN B-Indicator
com.westernunion.android.mtapp NN B-Indicator
com.moneybookers.skrillpayments NNS B-Indicator
com.gyft.android VBP B-Indicator
com.amazon.mShop.android.shopping VBG B-Indicator
com.comarch.mobile.banking.bgzbnpparibas.biznes NNS B-Indicator
pl.bnpbgzparibas.firmapp RB B-Indicator
com.finanteq.finance.bgz VBP B-Indicator
pl.upaid.bgzbnpp NN B-Indicator

de.postbank.finanzassistent NN B-Indicator
pl.bph NN B-Indicator
de.comdirect.android NN B-Indicator
com.starfinanz.smob.android.sfinanzstatus NN B-Indicator
de.sdvrz.ihb.mobile.app NN B-Indicator
pl.ing.mojeing VBG B-Indicator
com.ing.mobile JJ B-Indicator
pl.ing.ingksiegowosc NN B-Indicator
com.comarch.security.mobilebanking VBG B-Indicator
com.comarch.mobile.investment.ing VBG B-Indicator
com.ingcb.mobile.cbportal JJ B-Indicator
de.buhl.finanzblick NN B-Indicator
pl.pkobp.iko NN B-Indicator
pl.ipko.mobile NN B-Indicator
pl.inteligo.mobile NN B-Indicator
de.number26.android NN B-Indicator

pl.millennium.corpApp NN I-Indicator
eu.transfer24.app NN O
pl.aliorbank.aib NN O
pl.corelogic.mtoken VBN B-Indicator
alior.bankingapp.android JJ B-Indicator
com.ferratumbank.mobilebank NN B-Indicator
com.swmind.vcc.android.bzwbk_mobile.app NN B-Indicator
de.schildbach.wallet NN B-Indicator
piuk.blockchain.android JJ B-Indicator
com.bitcoin.mwallet NN B-Indicator
com.btcontract.wallet NN B-Indicator
com.bitpay.wallet NN B-Indicator
com.bitpay.copay NN B-Indicator
btc.org.freewallet.app NN B-Indicator
org.electrum.electrum NN B-Indicator

com.xapo NN B-Indicator
com.airbitz NN B-Indicator
com.kibou.bitcoin NN B-Indicator
com.qcan.mobile.bitcoin.wallet NN B-Indicator
me.cryptopay.android JJ B-Indicator
com.bitcoin.wallet NN B-Indicator
lt.spectrofinance.spectrocoin.android.wallet NN B-Indicator
com.kryptokit.jaxx NN B-Indicator
com.wirex NN B-Indicator
bcn.org.freewallet.app NN B-Indicator
com.hashengineering.bitcoincash.wallet NN B-Indicator
bcc.org.freewallet.app NN B-Indicator
com.coinspace.app NN B-Indicator
btg.org.freewallet.app NN B-Indicator
net.bither NN B-Indicator

co.edgesecure.app NN B-Indicator
com.arcbit.arcbit NN B-Indicator
distributedlab.wallet NN B-Indicator
de.schildbach.wallet_test JJS B-Indicator
com.aegiswallet NN B-Indicator
com.plutus.wallet NN B-Indicator
com.coincorner.app.crypt NN B-Indicator
eth.org.freewallet.app NN B-Indicator
secret.access NN B-Indicator
secret.pattern JJ B-Indicator
RuMMS NNP B-Malware
: : O
The DT O
Latest NNP O
Family NNP O
of IN O
Android NNP B-System
Malware NNP O
Attacking NNP O
Users NNP O
in IN O
Russia NNP O
Via NNP O
SMS NNP O
Phishing NNP O
April NNP O
26 CD O
, , O
2016 CD O
Introduction NNP O
Recently NNP O
we PRP O
observed VBD O
an DT O
Android NNP B-Malware
malware NN O
family NN O
being VBG O
used VBN O
to TO O
attack VB O
users NNS O
in IN O
Russia NNP O
. . O

The DT O
malware NN O
samples NNS O
were VBD O
mainly RB O
distributed VBN O
through IN O
a DT O
series NN O
of IN O
malicious JJ O
subdomains NNS O
registered VBN O
under IN O
a DT O
legitimate JJ O
domain NN O
belonging NN O
to TO O
a DT O
well-known JJ O
shared JJ O
hosting NN O
service NN O
provider NN O
in IN O
Russia NNP O
. . O

Because IN O
all PDT O
the DT O
URLs NNP O
used VBN O
in IN O
this DT O
campaign NN O
have VBP O
the DT O
form NN O
of IN O
hxxp NN B-Indicator
: : I-Indicator
//yyyyyyyy JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
XXXX.ru/mms.apk NNP I-Indicator
( ( O
where WRB O
XXXX.ru NN B-Indicator
represents VBZ O
the DT O
hosting VBG O
provider NN O
’ NNP O
s NN O
domain NN O
) ) O
, , O
we PRP O
named VBD O
this DT O
malware NN O
family NN O
RuMMS NNP B-Malware
. . O

To TO O
lure VB O
the DT O
victims NNS O
to TO O
download VB O
the DT O
malware NN O
, , O
threat NN O
actors NNS O
use VBP O
SMS NNP O
phishing VBG O
– NNP O
sending VBG O
a DT O
short JJ O
SMS NNP O
message NN O
containing VBG O
a DT O
malicious JJ O
URL NNP O
to TO O
the DT O
potential JJ O
victims NNS O
. . O

Unwary JJ O
users NNS O
who WP O
click VBP O
the DT O
seemingly RB O
innocuous JJ O
link NN O
will MD O
have VB O
their PRP$ O
device NN O
infected VBN O
with IN O
RuMMS NNP B-Malware
malware NN O
. . O

Figure NN O
1 CD O
describes NN O
this DT O
infection NN O
process NN O
and CC O
the DT O
main JJ O
behaviors NNS O
of IN O
RuMMS NNP B-Malware
. . O

On IN O
April NNP O
3 CD O
, , O
2016 CD O
, , O
we PRP O
still RB O
observed VBD O
new JJ O
RuMMS NNP B-Malware
samples NNS O
emerging VBG O
in IN O
the DT O
wild NN O
. . O

The DT O
earliest JJS O
identified JJ O
sample NN O
, , O
however RB O
, , O
can MD O
be VB O
traced VBN O
back RB O
to TO O
Jan. NNP O
18 CD O
, , O
2016 CD O
. . O

Within IN O
this DT O
time NN O
period NN O
, , O
we PRP O
identified VBD O
close JJ O
to TO O
300 CD O
samples NNS O
belonging VBG O
to TO O
this DT O
family NN O
( ( O
all DT O
sample NN O
hashes NNS O
are VBP O
listed VBN O
in IN O
the DT O
Appendix NNP O
) ) O
. . O

After IN O
landing VBG O
on IN O
the DT O
victim NN O
’ NNP O
s NN O
phone NN O
, , O
the DT O
RuMMS NNP B-Malware
apps NN O
will MD O
request VB O
device NN O
administrator NN O
privileges NNS O
, , O
remove VB O
their PRP$ O
icons NNS O
to TO O
hide VB O
themselves PRP O
from IN O
users NNS O
, , O
and CC O
remain VBP O
running VBG O
in IN O
the DT O
background NN O
to TO O
perform VB O
a DT O
series NN O
of IN O
malicious JJ O
behaviors NNS O
. . O

So RB O
far RB O
we PRP O
have VBP O
identified VBN O
the DT O
following JJ O
behaviors NNS O
: : O
Sending NNP O
device NN O
information NN O
to TO O
a DT O
remote JJ O
command NN O
and CC O
control NN O
( ( O
C2 NNP O
) ) O
server NN O
. . O

Contacting VBG O
the DT O
C2 NNP O
server NN O
for IN O
instructions NNS O
. . O

Sending VBG O
SMS NNP O
messages NNS O
to TO O
financial JJ O
institutions NNS O
to TO O
query VB O
account NN O
balances NNS O
. . O

Uploading VBG O
any DT O
incoming JJ O
SMS NNP O
messages NNS O
( ( O
including VBG O
the DT O
balance NN O
inquiry NN O
results NNS O
) ) O
to TO O
the DT O
remote JJ O
C2 NNP O
server NN O
. . O

Sending VBG O
C2-specified JJ O
SMS NNP O
messages NNS O
to TO O
phone NN O
numbers NNS O
in IN O
the DT O
victim NN O
’ NNP O
s NN O
contacts NNS O
. . O

Forward NNP O
incoming VBG O
phone NN O
calls NNS O
to TO O
intercept VB O
voice-based JJ O
two-factor JJ O
authentication NN O
. . O

Each DT O
of IN O
these DT O
behaviors NNS O
is VBZ O
under IN O
the DT O
control NN O
of IN O
the DT O
remote JJ O
C2 NNP O
server NN O
. . O

In IN O
other JJ O
words NNS O
, , O
the DT O
C2 NNP O
server NN O
can MD O
specify VB O
the DT O
message NN O
contents NNS O
to TO O
be VB O
sent VBN O
, , O
the DT O
time NN O
period NN O
in IN O
which WDT O
to TO O
forward VB O
the DT O
voice NN O
call NN O
, , O
and CC O
the DT O
recipients NNS O
of IN O
outgoing VBG O
messages NNS O
. . O

As IN O
part NN O
of IN O
our PRP$ O
investigation NN O
into IN O
this DT O
malware NN O
, , O
we PRP O
emulated VBD O
an DT O
infected JJ O
Android NNP B-System
device NN O
in IN O
order NN O
to TO O
communicate VB O
with IN O
the DT O
RuMMS NNP B-Malware
C2 NNP O
server NN O
. . O

During IN O
one CD O
session NN O
, , O
the DT O
C2 NNP O
server NN O
commanded VBD O
our PRP$ O
emulated JJ O
device NN O
to TO O
send VB O
four CD O
different JJ O
SMS NNP O
messages NNS O
to TO O
four CD O
different JJ O
phone NN O
numbers NNS O
, , O
all DT O
of IN O
which WDT O
were VBD O
associated VBN O
with IN O
Russian JJ O
financial JJ O
institutions NNS O
. . O

At IN O
least JJS O
three CD O
of IN O
the DT O
messages NNS O
were VBD O
intended VBN O
to TO O
check VB O
a DT O
user NN O
’ NN O
s NN O
account NN O
balance NN O
at IN O
the DT O
institution NN O
( ( O
we PRP O
could MD O
not RB O
confirm VB O
the DT O
purpose NN O
of IN O
the DT O
fourth JJ O
) ) O
.Through IN O
additional JJ O
research NN O
, , O
we PRP O
identified VBD O
several JJ O
forum NN O
posts NNS O
where WRB O
victims NNS O
complained VBD O
of IN O
funds NNS O
( ( O
up IN O
to TO O
600 CD O
rubles NNS O
) ) O
were VBD O
transferred VBN O
out IN O
of IN O
their PRP$ O
accounts NNS O
after IN O
RuMMS NNP B-Malware
infected VBD O
their PRP$ O
phones NNS O
. . O

We PRP O
do VBP O
not RB O
know VB O
exactly RB O
how WRB O
many JJ O
people NNS O
have VBP O
been VBN O
infected VBN O
with IN O
RuMMS NNP B-Malware
malware NN O
. . O

However RB O
, , O
our PRP$ O
data NNS O
suggests VBZ O
that IN O
there EX O
have VBP O
been VBN O
at IN O
least JJS O
2,729 CD O
infections NNS O
between IN O
January NNP O
2016 CD O
and CC O
early JJ O
April NNP O
2016 CD O
, , O
with IN O
a DT O
peak NN O
in IN O
March NNP O
of IN O
more JJR O
than IN O
1,100 CD O
infections NNS O
. . O

Smishing VBG O
: : O
The DT O
Major NNP O
Way NNP O
To TO O
Distribute NNP O
RuMMS NNP B-Malware
We PRP O
have VBP O
not RB O
observed VBN O
any DT O
instances NNS O
of IN O
RuMMS NNP B-Malware
on IN O
Google NNP B-System
Play NNP I-System
or CC O
other JJ O
online JJ O
app NN O
stores NNS O
. . O

Smishing VBG O
( ( O
SMS NNP O
phishing VBG O
) ) O
is VBZ O
currently RB O
the DT O
primary JJ O
way NN O
threat NN O
actors NNS O
are VBP O
distributing VBG O
the DT O
malware NN O
. . O

The DT O
process NN O
starts VBZ O
when WRB O
an DT O
SMS NNP O
phishing NN O
message NN O
arrives VBZ O
at IN O
a DT O
user NN O
’ NN O
s NN O
phone NN O
. . O

An DT O
example NN O
SMS NNP O
message NN O
is VBZ O
shown VBN O
in IN O
Figure NNP O
1 CD O
. . O

The DT O
message NN O
translates VBZ O
roughly RB O
to TO O
“ VB O
You PRP O
got VBD O
a DT O
photo NN O
in IN O
MMS NNP O
format NN O
: : O
hxxp NN B-Indicator
: : I-Indicator
//yyyyyyyy.XXXX.ru/mms.apk. JJ I-Indicator
” NNS O
So RB O
far RB O
we PRP O
identified VBD O
seven CD O
different JJ O
URLs NNP O
being VBG O
used VBN O
to TO O
spread VB O
RuMMS NNP B-Malware
in IN O
the DT O
wild NN O
. . O

All DT O
of IN O
the DT O
URLs NNP O
reference NN O
the DT O
file NN O
“ NNP O
mms.apk NN B-Indicator
” NN O
and CC O
all DT O
use VBP O
the DT O
domain NN O
“ NNP O
XXXX.ru NNP B-Indicator
” NNP O
, , O
which WDT O
belongs VBZ O
to TO O
a DT O
top JJ O
five CD O
shared VBD O
hosting VBG O
platform NN O
in IN O
Russia NNP O
( ( O
the DT O
domain NN O
itself PRP O
has VBZ O
been VBN O
obfuscated VBN O
to TO O
anonymize VB O
the DT O
provider NN O
) ) O
. . O

The DT O
threat NN O
actors NNS O
registered VBD O
at IN O
least JJS O
seven CD O
subdomains NNS O
through IN O
the DT O
hosting NN O
provider NN O
, , O
each DT O
consisting NN O
of IN O
eight CD O
random-looking JJ O
characters NNS O
( ( O
asdfgjcr NN B-Indicator
, , O
cacama18 NN B-Indicator
, , O
cacamadf NN B-Indicator
, , O
konkonq2 NN B-Indicator
, , O
mmsmtsh5 NN B-Indicator
, , O
riveroer NN B-Indicator
, , O
and CC O
sdfkjhl2 NN B-Indicator
. . O

) ) O
As IN O
of IN O
this DT O
writing NN O
, , O
no DT O
files NNS O
were VBD O
hosted VBN O
at IN O
any DT O
of IN O
the DT O
links NNS O
. . O

The DT O
threat NN O
actors NNS O
seem VBP O
to TO O
have VB O
abandoned VBN O
these DT O
URLs NNP O
and CC O
might MD O
be VB O
looking VBG O
into IN O
other JJ O
ways NNS O
to TO O
reach VB O
more JJR O
victims NNS O
. . O

Use NNP O
of IN O
a DT O
shared VBN O
hosting NN O
service NN O
to TO O
distribute VB O
malware NN O
is VBZ O
highly RB O
flexible JJ O
and CC O
low JJ O
cost NN O
for IN O
the DT O
threat NN O
actors NNS O
. . O

It PRP O
is VBZ O
also RB O
much JJ O
harder NN O
for IN O
network NN O
defenders NNS O
or CC O
researchers NNS O
to TO O
track VB O
a DT O
campaign NN O
where WRB O
the DT O
infrastructure NN O
is VBZ O
a DT O
moving VBG O
target NN O
. . O

Many JJ O
top JJ O
providers NNS O
in IN O
Russia NNP O
offer NN O
cheap JJ O
prices NNS O
for IN O
their PRP$ O
shared VBN O
hosting NN O
services NNS O
, , O
and CC O
some DT O
even RB O
provide VBP O
free JJ O
30-day JJ O
trial NN O
periods NNS O
. . O

Threat NN O
actors NNS O
can MD O
register VB O
subdomains NNS O
through IN O
the DT O
hosting NN O
provider NN O
and CC O
use VB O
the DT O
provider NN O
’ NNP O
s NN O
services NNS O
for IN O
a DT O
short-period JJ O
campaign NN O
. . O

A DT O
few JJ O
days NNS O
later RB O
they PRP O
can MD O
cancel VB O
the DT O
trial NN O
and CC O
do VB O
not RB O
need VB O
to TO O
pay VB O
a DT O
penny NN O
. . O

In IN O
addition NN O
, , O
these DT O
out-of-the-box JJ O
hosting NN O
services NNS O
usually RB O
provide VBP O
better JJR O
infrastructure NN O
than IN O
the DT O
attackers NNS O
could MD O
manage VB O
to TO O
construct VB O
( ( O
or CC O
compromise NN O
) ) O
themselves PRP O
. . O

RuMMS NNP B-Malware
Code NNP O
Analysis NNP O
All NNP O
RuMMS NNP B-Malware
samples NNS O
share NN O
the DT O
same JJ O
behaviors NNS O
, , O
major JJ O
parts NNS O
of IN O
which WDT O
are VBP O
shown VBN O
in IN O
Figure NNP O
1 CD O
. . O

However RB O
, , O
the DT O
underlying VBG O
code NN O
can MD O
be VB O
quite RB O
different JJ O
in IN O
that DT O
various JJ O
obfuscation NN O
mechanisms NNS O
were VBD O
adopted VBN O
to TO O
evade VB O
detection NN O
by IN O
anti-virus JJ O
tools NNS O
. . O

We PRP O
used VBD O
a DT O
sample JJ O
app NN O
named VBN O
“ NNP O
org.starsizew MD B-Indicator
” VB O
with IN O
an DT O
MD5 NNP O
of IN O
d8caad151e07025fdbf5f3c26e3ceaff NN B-Indicator
to TO O
analyze VB O
RuMMS NNP B-Malware
’ NNP O
s NN O
code NN O
. . O

Several JJ O
of IN O
the DT O
main JJ O
components NNS O
of IN O
RuMMS NNP B-Malware
are VBP O
shown VBN O
in IN O
Figure NNP O
2 CD O
. . O

The DT O
activity NN O
class NN O
“ NNP O
org.starsizew.MainActivity NN B-Indicator
” NNP O
executes VBZ O
when WRB O
the DT O
app NN O
is VBZ O
started VBN O
. . O

It PRP O
first RB O
starts VBZ O
another DT O
activity NN O
defined VBN O
in IN O
“ NNP O
org.starsizew.Aa MD B-Indicator
” VB O
to TO O
request VB O
device NN O
administrator NN O
privileges NNS O
, , O
and CC O
then RB O
calls VBZ O
the DT O
following JJ O
API NNP O
of IN O
“ NNP O
android.content.pm.PackageManager NN B-Indicator
” NNP O
( ( O
the DT O
Android NNP B-System
package NN O
manager NN O
to TO O
remove VB O
its PRP$ O
own JJ O
icon NN O
on IN O
the DT O
home NN O
screen NN O
in IN O
order NN O
to TO O
conceal VB O
the DT O
existence NN O
of IN O
RuMMS NNP B-Malware
from IN O
the DT O
user NN O
: : O
At IN O
the DT O
same JJ O
time NN O
, , O
” JJ O
org.starsizew.MainActivity NN B-Indicator
” NNP O
will MD O
start VB O
the DT O
main JJ O
service NN O
as IN O
defined VBN O
in IN O
“ NNP O
org.starsizew.Tb NN B-Indicator
” NN O
, , O
and CC O
use VB O
a DT O
few JJ O
mechanisms NN O
to TO O
keep VB O
the DT O
main JJ O
service NN O
running VBG O
continuously RB O

in IN O
the DT O
background NN O
. . O

The DT O
class NN O
“ NNP O
org.starsizew.Ac NN B-Indicator
” NNP O
is VBZ O
designed VBN O
for IN O
this DT O
purpose NN O
; : O
its PRP$ O
only JJ O
task NN O
is VBZ O
to TO O
check VB O
if IN O
the DT O
main JJ O
service NN O
is VBZ O
running VBG O
, , O
and CC O
restart VB O
the DT O
main JJ O
service NN O
if IN O
the DT O
answer NN O
is VBZ O
no DT O
. . O

The DT O
class NN O
“ NNP O
org.starsizew.Tb NN B-Indicator
” NNP O
also RB O
has VBZ O
a DT O
self-monitoring JJ O
mechanism NN O
to TO O
restart VB O
itself PRP O
when WRB O
its PRP$ O
own JJ O
onDestroy NN O
API NNP O
is VBZ O
triggered VBN O
. . O

Other JJ O
than IN O
that DT O
, , O
its PRP$ O
major JJ O
functionality NN O
is VBZ O
to TO O
collect VB O
private JJ O
device NN O
information NN O
, , O
upload NN O
it PRP O
to TO O
a DT O
remote JJ O
C2 NNP O
server NN O
, , O
and CC O
handle VB O
any DT O
commands NNS O
as IN O
requested VBN O
by IN O
the DT O
C2 NNP O
server NN O
. . O

All PDT O
those DT O
functions NNS O
are VBP O
implemented VBN O
in IN O
asynchronous JJ O
tasks NNS O
by IN O
“ NNP O
org.starsizew.i NN B-Indicator
” NN O
. . O

The DT O
class NN O
“ NNP O
org.starsizew.Ma NN B-Indicator
” NN O
is VBZ O
registered VBN O
to TO O
intercept VB O
incoming VBG O
SMS NNP O
messages NNS O
, , O
the DT O
arrival NN O
of IN O
which WDT O
will MD O
trigger VB O
the DT O
Android NNP B-System
system NN O
to TO O
call VB O
its PRP$ O
“ NNP O
onReceive JJ O
” NNP O
API NNP O
. . O

Its PRP$ O
major JJ O
functionality NN O
is VBZ O
also RB O
implemented VBN O
through IN O
the DT O
call NN O
of IN O
the DT O
asynchronous JJ O
task NN O
( ( O
“ JJ O
org.starsizew.i RB B-Indicator
” NN O
) ) O
, , O
including VBG O
uploading VBG O
the DT O
incoming NN O
SMS NNP O
messages NNS O
to TO O
the DT O
remote JJ O
C2 NNP O
server NN O
and CC O
executing VBG O
any DT O
commands NNS O
as IN O
instructed VBN O
by IN O
the DT O
remote JJ O
attacker NN O
. . O

C2 NNP O
Communication NNP O
The DT O
C2 NNP O
communication NN O
includes VBZ O
two CD O
parts NNS O
: : O
sending VBG O
information NN O
to TO O
the DT O
remote JJ O
HTTP NNP O
server NN O
and CC O
parsing VBG O
the DT O
server NN O
’ NNP O
s VBZ O
response NN O
to TO O
execute VB O
any DT O
commands NNS O
as IN O
instructed VBN O
by IN O
the DT O
remote JJ O
attackers NNS O
. . O

The DT O
functionality NN O
for IN O
these DT O
two CD O
parts NNS O
is VBZ O
implemented VBN O
by IN O
doInBackground NN O
and CC O
onPostExecute NN O
respectively RB O
, , O
two CD O
API NNP O
methods NNS O
of IN O
“ NNP O
android.os.AsyncTask NN B-Indicator
” NN O
as IN O
extended VBN O
by IN O
class NN O
“ NNP O
org.starsizew.i NN B-Indicator
” NN O
. . O

Figure NN O
3 CD O
. . O

Method NNP O
doInBackground NN O
: : O
to TO O
send VB O
information NN O
to TO O
remote VB O
C2 NNP O
server NN O
As IN O
seen VBN O
from IN O
the DT O
major JJ O
code NN O
body NN O
of IN O
method NN O
doInBackground NN O
shown VBN O
in IN O
Figure NN O
3 CD O
( ( O
some DT O
of IN O
the DT O
original JJ O
classes NNS O
and CC O
methods NNS O
are VBP O
renamed VBN O
for IN O
easier JJR O
understanding NN O
) ) O
, , O
there EX O
are VBP O
three CD O
calls NNS O
to TO O
HttpPost VB O
with IN O
different JJ O
contents NNS O
as IN O
parameters NNS O
. . O

At IN O
line NN O
5 CD O
, , O
local JJ O
variable JJ O
v4 NN O
specifies VBZ O
the DT O
first JJ O
parameter NN O
url NN O
, , O
which WDT O
can MD O
be VB O
changed VBN O
by IN O
the DT O
remote JJ O
C2 NNP O
server NN O
later RB O
. . O

These DT O
URLs NNP O
are VBP O
all DT O
in IN O
the DT O
form NN O
of IN O
“ JJ O
http NN B-Indicator
: : I-Indicator
// JJ I-Indicator
$ $ I-Indicator
C2. NNP I-Indicator
$ $ I-Indicator
SERVER. NNP I-Indicator
$ $ I-Indicator
IP/api/ NNP I-Indicator
? . I-Indicator

id= JJ I-Indicator
$ $ I-Indicator
NUM NNP I-Indicator
” NNP O
. . O

The DT O
second JJ O
parameter NN O
is VBZ O
a DT O
constant JJ O
string NN O
“ NN O
POST NNP O
” NNP O
, , O
and CC O
the DT O
third JJ O
parameter NN O
is VBZ O
a DT O
series NN O
of IN O
key-value JJ O
pairs NNS O
to TO O
be VB O
sent VBN O
, , O
assembled VBN O
at IN O
runtime NN O
. . O

The DT O
value NN O
of IN O
the DT O
first JJ O
item NN O
, , O
whose WP$ O
key NN O
is VBZ O
“ JJ O
method NN O
” NNP O
( ( O
line NN O
7 CD O
) ) O
, , O
indicates VBZ O
the DT O
type NN O
of IN O
the DT O
contents NNS O
: : O
install NN O
, , O
info NN O
and CC O
sms NN O
. . O

The DT O
first JJ O
type NN O
of IN O
content NN O
, , O
starting VBG O
with IN O
“ NNP O
method=install NN O
” NNP O
, , O
will MD O
be VB O
sent VBN O
when WRB O
the DT O
app NN O
is VBZ O
started VBN O
for IN O
the DT O
first JJ O
time NN O
, , O
including VBG O
the DT O
following JJ O
device NN O
private JJ O
information NN O
: : O
Victim NNP O
identifier NN O
Network NNP O
operator NN O
Device NNP O
model NN O
Device NNP O
OS NNP O
version NN O
Phone NNP O
number NN O
Device NNP O
identifier RB O
App NNP O
version NN O
Country NNP O
The DT O
second JJ O
type NN O
of IN O
information NN O
will MD O
be VB O
sent VBN O
periodically RB O
to TO O
indicate VB O
that IN O
the DT O
device NN O
is VBZ O
alive JJ O
. . O

It PRP O
only RB O
has VBZ O
two CD O
parts NNS O
, , O
the DT O
method NN O
indicated VBN O
by IN O
word NN O
“ NNP O
info NN O
” NN O
and CC O
the DT O
victim NN O
identifier NN O
. . O

The DT O
third JJ O
type NN O
of IN O
information NN O
will MD O
be VB O
sent VBN O
when WRB O
RuMMS NNP B-Malware
intercepts VBZ O
any DT O
SMS NNP O
messages NNS O
, , O
including VBG O
the DT O
balance NN O
inquiry NN O
results NNS O
when WRB O
it PRP O
contacts VBZ O
the DT O
SMS NNP O
code NN O
of IN O
a DT O
particular JJ O
financial JJ O
service NN O
. . O

Method NNP O
onPostExecute NN O
parses VBZ O
the DT O
response NN O
from IN O
the DT O
above JJ O
HTTP NNP O
session NN O
and CC O
executes VBZ O
the DT O
commands NNS O
provided VBN O
by IN O
the DT O
remote JJ O
attacker NN O
. . O

As IN O
seen VBN O
from IN O
the DT O
code NN O
in IN O
Figure NNP O
5 CD O
, , O
the DT O
commands NNS O
RuMMS NNP B-Malware
supports NNS O
right RB O
now RB O
include VBP O
: : O
install_true NN O
: : O
to TO O
modify VB O
app JJ O
preference NN O
to TO O
indicate VB O
that IN O
the DT O
C2 NNP O
server NN O
received VBD O
the DT O
victim NN O
device NN O
’ NNP O
s NN O
status NN O
. . O

sms_send NN O
: : O
to TO O
send VB O
C2-specified NNP O
SMS NNP O
messages NNS O
to TO O
C2-specified JJ O
recipients NNS O
. . O

sms_grab NN O
: : O
to TO O
upload VB O
periodically RB O
the DT O
SMS NNP O
messages NNS O
in IN O
the DT O
inbox NN O
to TO O
C2 NNP O
server NN O
. . O

delivery NN O
: : O
to TO O
deliver VB O
specified VBN O
text NN O
to TO O
all DT O
victim NN O
’ NNP O
s NN O
contacts NNS O
( ( O
SMS NNP O
worming VBG O
) ) O
. . O

call_number NN O
: : O
to TO O
forward VB O
phone NN O
calls NNS O
to TO O
intercept VB O
voice NN O
based VBN O
two-factor JJ O
authentication NN O
. . O

new_url NN O
: : O
to TO O
change VB O
the DT O
URL NNP O
of IN O
the DT O
C2 NNP O
server NN O
in IN O
the DT O
app JJ O
preference NN O
. . O

ussd NN O
: : O
to TO O
call VB O
a DT O
C2-specified JJ O
phone NN O
number NN O
. . O

Figure NN O
5 CD O
. . O

Method NNP O
onPostExecute NN O
: : O
to TO O
handle VB O
instructions NNS O
from IN O
remote JJ O
C2 NNP O
Figure NNP O
6 CD O
shows VBZ O
an DT O
example NN O
response NN O
sent VBD O
back RB O
from IN O
one CD O
C2 NNP O
server NN O
. . O

Note NN O
that IN O
inside IN O
this DT O
single JJ O
response NN O
, , O
there EX O
is VBZ O
one CD O
“ NN O
install_true NN O
” NNP O
command NN O
, , O
one CD O
“ NN O
sms_grab NN O
” NNP O
command NN O
and CC O
four CD O
“ NN O
sms_send NN O
” NNP O
commands VBZ O
. . O

With IN O
the DT O
four CD O
“ NN O
sms_send NN O
” NNP O
commands VBZ O
, , O
the DT O
messages NNS O
as IN O
specified VBN O
in IN O
the DT O
key JJ O
“ NNP O
text NN O
” NN O
will MD O
be VB O
sent VBN O
immediately RB O
to TO O
the DT O
specified VBN O
short JJ O
numbers NNS O
. . O

Our PRP$ O
analysis NN O
suggests VBZ O
that IN O
the DT O
four CD O
short JJ O
numbers NNS O
are VBP O
associated VBN O
with IN O
Russian JJ O
financial JJ O
institutions NNS O
, , O
presumably RB O
where WRB O
a DT O
victim NN O
would MD O
be VB O
likely RB O
to TO O
have VB O
accounts NNS O
. . O

Figure NN O
6 CD O
. . O

Example JJ O
Response NNP O
in IN O
JSON NNP O
format NN O
In IN O
particular JJ O
, , O
short JJ O
number NN O
“ NNP O
+7494 NNP O
” NNP O
is VBZ O
associated VBN O
with IN O
a DT O
payment NN O
service NN O
provider NN O
in IN O
Russia NNP O
. . O

The DT O
provider NN O
’ NNP O
s VBZ O
website RB O
described VBN O
how WRB O
the DT O
code NN O
7494 CD O
can MD O
be VB O
used VBN O
to TO O
provide VB O
a DT O
series NN O
of IN O
payment-related JJ O
capabilities NNS O
. . O

For IN O
example NN O
, , O
sending VBG O
text JJ O
“ JJ O
Balance NNP O
” NNP O
will MD O
trigger VB O
a DT O
response NN O
with IN O
the DT O
victim NN O
’ NNP O
s JJ O
wallet NN O
balance NN O
. . O

Sending VBG O
text NN O
“ NNP O
confirm NN O
1 CD O
” NN O
will MD O
include VB O
proof NN O
of IN O
payment NN O
. . O

Sending VBG O
text NN O
“ NNP O
call NN O
on IN O
” NN O
will MD O
activate VB O
the DT O
USSD NNP O
payment NN O
confirmation NN O
service NN O
. . O

During IN O
our PRP$ O
investigation NN O
, , O
we PRP O
observed VBD O
the DT O
C2 NNP O
server NN O
sending VBG O
multiple JJ O
“ JJ O
balance NN O
” NNP O
commands VBZ O
to TO O
different JJ O
institutions NNS O
, , O
presumably RB O
to TO O
query VB O
the DT O
victim NN O
’ NNP O
s VBZ O
financial JJ O
account NN O
balances NNS O
. . O

RuMMS NNP B-Malware
can MD O
upload VB O
responses NNS O
to TO O
the DT O
balance NN O
inquiries NNS O
( ( O
received VBN O
via IN O
SMS NNP O
message NN O
) ) O
to TO O
the DT O
remote JJ O
C2 NNP O
server NN O
, , O
which WDT O
can MD O
send VB O
back RB O
additional JJ O
commands NNS O
to TO O
be VB O
sent VBN O
from IN O
the DT O
victim NN O
to TO O
the DT O
provider NN O
’ NNP O
s JJ O
payment NN O
service NN O
. . O

These DT O
could MD O
include VB O
resetting VBG O
the DT O
user NN O
’ NNP O
s NN O
PIN NNP O
, , O
enabling VBG O
or CC O
disabling VBG O
various JJ O
alerts NNS O
and CC O
confirmations NNS O
, , O
and CC O
confirming VBG O
the DT O
user NN O
’ NNP O
s NN O
identity NN O
. . O

RuMMS NNP B-Malware
Samples NNP O
, , O
C2 NNP O
, , O
Hosting NNP O
Sites NNP O
, , O
Infections NNP O
and CC O
Timeline NNP O
In IN O
total JJ O
we PRP O
captured VBD O
297 CD O
RuMMS NNP B-Malware
samples NNS O
, , O
all DT O
of IN O
which WDT O
attempt NN O
to TO O
contact VB O
an DT O
initial JJ O
C2 NNP O
server NN O
that IN O
we PRP O
extracted VBD O
from IN O
the DT O
app JJ O
package NN O
. . O

Figure NN O
7 CD O
lists VBZ O
the DT O
IP NNP O
addresses NNS O
of IN O
these DT O
C2 NNP O
servers NNS O
, , O
the DT O
number NN O
of IN O
RuMMS NNP B-Malware
apps NN O
that WDT O
connect VBP O
to TO O
each DT O
of IN O
them PRP O
, , O
and CC O
the DT O
example NN O
URL NNP O
used VBD O
as IN O
the DT O
first JJ O
parameter NN O
of IN O
the DT O
HttpPost NNP O
operation NN O
( ( O
used VBN O
in IN O
the DT O
code NN O
of IN O
Figure NNP O
3 CD O
) ) O
. . O

This DT O
indicates VBZ O
that IN O
multiple JJ O
C2 NNP O
servers NNS O
were VBD O
used VBN O
in IN O
this DT O
campaign NN O
, , O
but CC O
one CD O
( ( O
37.1.207.31 CD B-Indicator
) ) O
was VBD O
the DT O
most RBS O
heavily RB O
used VBN O
. . O

Figure NN O
7 CD O
. . O

RuMMS NNP B-Malware
samples NNS O
and CC O
C2 NNP O
servers NNS O
Figure NNP O
8 CD O
shows VBZ O
how WRB O
these DT O
samples NNS O
, , O
C2 NNP O
servers NNS O
and CC O
hosting VBG O
websites NNS O
are VBP O
related VBN O
to TO O
each DT O
other JJ O
, , O
including VBG O
when WRB O
they PRP O
were VBD O
compiled VBN O
or CC O
observed VBN O
. . O

In IN O
the DT O
quadrant NN O
, , O
the DT O
smaller JJR O
boxes NNS O
in IN O
blue-gray JJ O
represent NN O
particular JJ O
apps NN O
in IN O
the DT O
RuMMS NNP B-Malware
family NN O
, , O
while IN O
the DT O
bigger JJR O
boxes NNS O
in IN O
deep-blue JJ O
represent NN O
C2 NNP O
servers NNS O
used VBN O
by IN O
some DT O
RuMMS NNP B-Malware
apps NN O
. . O

The DT O
dotted JJ O
arrows NNS O
represent VBP O
the DT O
use NN O
of IN O
a DT O
particular JJ O
C2 NNP O
server NN O
by IN O
a DT O
specific JJ O
app NN O
to TO O
send VB O
information NN O
and CC O
fetch NN O
instructions NNS O
. . O

In IN O
this DT O
figure NN O
we PRP O
have VBP O
11 CD O
RuMMS NNP B-Malware
samples NNS O
, , O
all DT O
of IN O
which WDT O
were VBD O
hosted VBN O
on IN O
the DT O
website NN O
as IN O
shown VBN O
in IN O
the DT O
“ NNP O
y NN O
” NNP O
axis NN O
. . O

The DT O
dates NNS O
on IN O
the DT O
“ NNP O
x NNP O
” NNP O
axis VBZ O
show VBP O
the DT O
dates NNS O
when WRB O
we PRP O
first RB O
saw VBD O
these DT O
apps NNS O
in IN O
the DT O
wild NN O
. . O

This DT O
figure NN O
demonstrates VBZ O
the DT O
following VBG O
interesting JJ O
information NN O
: : O
The DT O
time NN O
range NN O
when WRB O
threat NN O
actors NNS O
distributed VBD O
RuMMS NNP B-Malware
on IN O
those DT O
shared-hosting JJ O
websites NNS O
is VBZ O
from IN O
January NNP O
2016 CD O
to TO O
March NNP O
2016 CD O
. . O

Threat NN O
actors NNS O
used VBD O
different JJ O
websites NNS O
to TO O
host VB O
different JJ O
payloads NNS O
at IN O
different JJ O
times NNS O
. . O

This DT O
kind NN O
of IN O
“ NN O
moving VBG O
target NN O
” NNP O
behavior NN O
made VBD O
it PRP O
harder JJR O
to TO O
track VB O
their PRP$ O
actions NNS O
. . O

The DT O
same JJ O
websites NNS O
have VBP O
hosted VBN O
different JJ O
RuMMS NNP B-Malware
samples NNS O
at IN O
different JJ O
dates NNS O
. . O

C2 NNP O
servers NNS O
are VBP O
shared VBN O
by IN O
multiple JJ O
samples NNS O
. . O

This DT O
matches VBZ O
our PRP$ O
observations NNS O
of IN O
C2 NNP O
servers NNS O
as IN O
shown VBN O
in IN O
Figure NNP O
7 CD O
. . O

Figure NN O
8 CD O
. . O

RuMMS NNP B-Malware
samples NNS O
, , O
hosting VBG O
sites NNS O
, , O
C2 NNP O
servers NNS O
from IN O
Jan. NNP O
2016 CD O
to TO O
Mar NNP O
. . O

2016 CD O
We PRP O
do VBP O
not RB O
know VB O
exactly RB O
how WRB O
many JJ O
people NNS O
have VBP O
been VBN O
infected VBN O
with IN O
RuMMS NNP B-Malware
malware NN O
; : O
however RB O
, , O
our PRP$ O
data NNS O
suggests VBZ O
that IN O
there EX O
are VBP O
at IN O
least JJS O
2,729 CD O
infections NNS O
with IN O
RuMMS NNP B-Malware
samples NNS O
from IN O
January NNP O
2016 CD O
to TO O
early JJ O
April NNP O
2016 CD O
. . O

Figure NN O
9 CD O
shows VBZ O
the DT O
number NN O
of IN O
RuMMS NNP B-Malware
infections NNS O
recorded VBN O
in IN O
the DT O
last JJ O
four CD O
months NNS O
. . O

When WRB O
we PRP O
first RB O
observed VBD O
the DT O
malware NN O
in IN O
January NNP O
, , O
we PRP O
recorded VBD O
380 CD O
infections NNS O
. . O

In IN O
February NNP O
, , O
we PRP O
recorded VBD O
767 CD O
infections NNS O
. . O

In IN O
March NNP O
, , O
it PRP O
peaked VBD O
at IN O
1,169 CD O
infections NNS O
. . O

In IN O
April NNP O
, , O
at IN O
the DT O
time NN O
of IN O
writing VBG O
this DT O
post NN O
, , O
we PRP O
recorded VBD O
413 CD O
RuMMS NNP B-Malware
infections NNS O
. . O

Although IN O
the DT O
propagation NN O
trend NN O
seems VBZ O
to TO O
be VB O
slowing VBG O
down RP O
a DT O
bit NN O
, , O
the DT O
figure NN O
tells VBZ O
us PRP O
that IN O
RuMMS NNP B-Malware
malware NN O
is VBZ O
still RB O
alive JJ O
in IN O
the DT O
wild NN O
. . O

We PRP O
continue VBP O
to TO O
monitor VB O
its PRP$ O
progress NN O
. . O

Conclusion NN O
Smishing NNP O
( ( O
SMS NNP O
phishing VBG O
) ) O
offers VBZ O
a DT O
unique JJ O
vector NN O
to TO O
infect VB O
mobile JJ O
users NNS O
. . O

The DT O
recent JJ O
RuMMS NNP B-Malware
campaign NN O
shows VBZ O
that IN O
Smishing VBG O
is VBZ O
still RB O
a DT O
popular JJ O
means NN O
for IN O
threat NN O
actors NNS O
to TO O
distribute VB O
their PRP$ O
malware NN O
. . O

In IN O
addition NN O
, , O
the DT O
use NN O
of IN O
shared-hosting JJ O
providers NNS O
adds VBZ O
flexibility NN O
to TO O
the DT O
threat NN O
actor NN O
’ NNP O
s NN O
campaign NN O
and CC O
makes VBZ O
it PRP O
harder JJR O
for IN O
defending VBG O
parties NNS O
to TO O
track VB O
these DT O
moving VBG O
targets NNS O
. . O

Fortunately RB O
, , O
FireEye NNP B-System
Mobile NNP I-System
Threat NNP I-System
Prevention NNP I-System
platform NN O
can MD O
recognize VB O
the DT O
malicious JJ O
SMS NNP O
and CC O
networking JJ O
behaviors NNS O
used VBN O
by IN O
these DT O
RuMMS NNP B-Malware
samples NNS O
, , O
and CC O
help VB O
us PRP O
quickly RB O
identify VB O
the DT O
threat NN O
. . O

To TO O
protect VB O
yourself PRP O
from IN O
these DT O
threats NNS O
, , O
FireEye NNP B-Organization
suggests VBZ O
that IN O
users NNS O
: : O
Take VB O
caution NN O
before IN O
clicking VBG O
any DT O
links NNS O
where WRB O
you PRP O
are VBP O
not RB O
sure JJ O
about IN O
the DT O
origin NN O
. . O

Don NNP O
’ NNP O
t NN O
install NN O
apps NN O
outside IN O
the DT O
official JJ O
app NN O
store NN O
. . O

Exodus NN B-Malware
: : O
New NNP O
Android NNP B-System
Spyware NNP O
Made NNP O
in IN O
Italy NNP O
Mar NNP O
29 CD O
Summary NNP O
We PRP O
identified VBD O
a DT O
new JJ O
Android NNP B-System
spyware NN O
platform NN O
we PRP O
named VBD O
Exodus NNP B-Malware
, , O
which WDT O
is VBZ O
composed VBN O
of IN O
two CD O
stages NNS O
we PRP O
call VBP O
Exodus NNP B-Malware
One CD I-Malware
and CC O
Exodus NNP B-Malware
Two CD I-Malware
. . O

We PRP O
have VBP O
collected VBN O
numerous JJ O
samples NNS O
spanning VBG O
from IN O
2016 CD O
to TO O
early JJ O
2019 CD O
. . O

Instances NNS O
of IN O
this DT O
spyware NN O
were VBD O
found VBN O
on IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
, , O
disguised VBD O
as IN O
service NN O
applications NNS O
from IN O
mobile JJ O
operators NNS O
. . O

Both DT O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
pages NNS O
and CC O
the DT O
decoys NN O
of IN O
the DT O
malicious JJ O
apps NN O
are VBP O
in IN O
Italian JJ O
. . O

According VBG O
to TO O
publicly RB O
available JJ O
statistics NNS O
, , O
as RB O
well RB O
as IN O
confirmation NN O
from IN O
Google NNP B-Organization
, , O
most JJS O
of IN O
these DT O
apps NNS O
collected VBD O
a DT O
few JJ O
dozens NNS O
installations NNS O
each DT O
, , O
with IN O
one CD O
case NN O
reaching VBG O
over IN O
350 CD O
. . O

All DT O
of IN O
the DT O
victims NNS O
are VBP O
located VBN O
in IN O
Italy NNP O
. . O

All DT O
of IN O
these DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
pages NNS O
have VBP O
been VBN O
taken VBN O
down RP O
by IN O
Google NNP B-Organization
. . O

We PRP O
believe VBP O
this DT O
spyware NN O
platform NN O
is VBZ O
developed VBN O
by IN O
an DT O
Italian JJ O
company NN O
called VBD O
eSurv NN B-Organization
, , O
which WDT O
primarily RB O
operates VBZ O
in IN O
the DT O
business NN O
of IN O
video NN O
surveillance NN O
. . O

According VBG O
to TO O
public JJ O
records NNS O
it PRP O
appears VBZ O
that IN O
eSurv NN B-Organization
began VBD O
to TO O
also RB O
develop VB O
intrusion NN O
software NN O
in IN O
2016 CD O
. . O

Exodus NNP B-Malware
is VBZ O
equipped VBN O
with IN O
extensive JJ O
collection NN O
and CC O
interception NN O
capabilities NNS O
. . O

Worryingly NNP O
, , O
some DT O
of IN O
the DT O
modifications NNS O
enforced VBN O
by IN O
the DT O
spyware NN O
might MD O
expose VB O
the DT O
infected JJ O
devices NNS O
to TO O
further JJ O
compromise NN O
or CC O
data NNS O
tampering NN O
. . O

Disguised VBN O
Spyware NNP O
Uploaded NNP O
on IN O
Google NNP B-System
Play NNP I-System
Store NNP I-System
We PRP O
identified VBD O
previously RB O
unknown JJ O
spyware NN O
apps IN O
being VBG O
successfully RB O
uploaded VBN O
on IN O
Google NNP B-System
Play NNP I-System
Store NNP I-System
multiple JJ O
times NNS O
over IN O
the DT O
course NN O
of IN O
over IN O
two CD O
years NNS O
. . O

These DT O
apps NNS O
would MD O
remain VB O
available JJ O
on IN O
the DT O
Play NNP B-System
Store NNP I-System
for IN O
months NNS O
and CC O
would MD O
eventually RB O
be VB O
re-uploaded JJ O
. . O

While IN O
details NNS O
would MD O
vary VB O
, , O
all DT O
of IN O
the DT O
identified JJ O
copies NNS O
of IN O
this DT O
spyware NN O
shared VBD O
a DT O
similar JJ O
disguise NN O
. . O

In IN O
most JJS O
cases NNS O
they PRP O
would MD O
be VB O
crafted VBN O
to TO O
appear VB O
as IN O
applications NNS O
distributed VBN O
by IN O
unspecified JJ O
mobile NN O
operators NNS O
in IN O
Italy NNP O
. . O

Often RB O
the DT O
app JJ O
description NN O
on IN O
the DT O
Play NNP B-System
Store NNP I-System
would MD O
reference VB O
some DT O
SMS NNP O
messages VBZ O
the DT O
targets NNS O
would MD O
supposedly RB O
receive VB O
leading VBG O
them PRP O
to TO O
the DT O
Play NNP B-System
Store NNP I-System
page NN O
. . O

All DT O
of IN O
the DT O
Play NNP B-System
Store NNP I-System
pages VBZ O
we PRP O
identified VBD O
and CC O
all DT O
of IN O
the DT O
decoys NN O
of IN O
the DT O
apps NN O
themselves PRP O
are VBP O
written VBN O
in IN O
Italian JJ O
. . O

According VBG O
to TO O
Google NNP B-Organization
, , O
whom WP O
we PRP O
have VBP O
contacted VBN O
to TO O
alert VB O
about IN O
our PRP$ O
discoveries NNS O
, , O
nearly RB O
25 CD O
variants NNS O
of IN O
this DT O
spyware NN O
were VBD O
uploaded VBN O
on IN O
Google NNP B-System
Play NNP I-System
Store NNP I-System
. . O

Google NNP B-System
Play NNP I-System
has VBZ O
removed VBN O
the DT O
apps NN O
and CC O
they PRP O
stated VBD O
that IN O
" JJ O
thanks NNS O
to TO O
enhanced VB O
detection NN O
models NNS O
, , O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
will MD O
now RB O
be VB O
able JJ O
to TO O
better RBR O
detect VB O
future JJ O
variants NNS O
of IN O
these DT O
applications NNS O
'' '' O
. . O

While IN O
Google NNP I-Organization
did VBD O
not RB O
share NN O
with IN O
us PRP O
the DT O
total JJ O
number NN O
of IN O
infected JJ O
devices NNS O
, , O
they PRP O
confirmed VBD O
that IN O
one CD O
of IN O
these DT O
malicious JJ O
apps NN O
collected VBD O
over IN O
350 CD O
installations NNS O
through IN O
the DT O
Play NNP B-System
Store NNP I-System
, , O
while IN O
other JJ O
variants NNS O
collected VBN O
few JJ O
dozens NNS O
each DT O
, , O
and CC O
that IN O
all DT O
infections NNS O
were VBD O
located VBN O
in IN O
Italy NNP O
. . O

We PRP O
have VBP O
directly RB O
observed VBN O
multiple JJ O
copies NNS O
of IN O
Exodus NNP B-Malware
with IN O
more JJR O
than IN O
50 CD O
installs NNS O
and CC O
we PRP O
can MD O
estimate VB O
the DT O
total JJ O
number NN O
of IN O
infections NNS O
to TO O
amount VB O
in IN O
the DT O
several JJ O
hundreds NNS O
, , O
if IN O
not RB O
a DT O
thousand NN O
or CC O
more JJR O
. . O

Stage NN O
1 CD O
: : O
Exodus NN B-Malware
One CD I-Malware
The DT O
first JJ O
stage NN O
installed VBN O
by IN O
downloading VBG O
the DT O
malicious JJ O
apps NN O
uploaded VBD O
on IN O
Google NNP B-System
Play NNP I-System
Store NNP I-System
only RB O
acts VBZ O
as IN O
a DT O
dropper NN O
. . O

Following VBG O
are VBP O
some DT O
examples NNS O
of IN O
the DT O
decoys NNS O
used VBN O
by IN O
these DT O
droppers NNS O
: : O
The DT O
purpose NN O
of IN O
Exodus NNP B-Malware
One NNP I-Malware
seems VBZ O
to TO O
be VB O
to TO O
collect VB O
some DT O
basic JJ O
identifying JJ O
information NN O
about IN O
the DT O
device NN O
( ( O
namely RB O
the DT O
IMEI NNP O
code NN O
and CC O
the DT O
phone NN O
number NN O
) ) O
and CC O
send VB O
it PRP O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
server NN O
. . O

This DT O
is VBZ O
usually RB O
done VBN O
in IN O
order NN O
to TO O
validate VB O
the DT O
target NN O
of IN O
a DT O
new JJ O
infection NN O
. . O

This DT O
is VBZ O
further RB O
corroborated VBN O
by IN O
some DT O
older JJR O
and CC O
unobfuscated JJ O
samples NNS O
from IN O
2016 CD O
, , O
whose WP$ O
primary JJ O
classes NNS O
are VBP O
named VBN O
CheckValidTarget NNP O
. . O

During IN O
our PRP$ O
tests NNS O
the DT O
spyware NN O
was VBD O
upgraded VBN O
to TO O
the DT O
second JJ O
stage NN O
on IN O
our PRP$ O
test NN O
device NN O
immediately RB O
after IN O
the DT O
first JJ O
check-ins NNS O
. . O

This DT O
suggests VBZ O
that IN O
the DT O
operators NNS O
of IN O
the DT O
Command NNP O
& CC O
Control NNP O
are VBP O
not RB O
enforcing VBG O
a DT O
validation NN O
of IN O
the DT O
targets NNS O
. . O

Additionally RB O
, , O
during IN O
a DT O
period NN O
of IN O
several JJ O
days NNS O
, , O
our PRP$ O
infected JJ O
test NN O
device NN O
was VBD O
never RB O
remotely RB O
disinfected VBN O
by IN O
the DT O
operators NNS O
. . O

For IN O
the DT O
purpose NN O
of IN O
this DT O
report NN O
we PRP O
analyze VBP O
here RB O
the DT O
Exodus NNP B-Malware
One NNP I-Malware
sample NN O
with IN O
hash NN O
8453ce501fee1ca8a321f16b09969c517f92a24b058ac5b54549eabd58bf1884 CD B-Indicator
which WDT O
communicated VBN O
with IN O
the DT O
Command NNP O
& CC O
Control NNP O
server NN O
at IN O
54.71.249.137 CD B-Indicator
. . O

Other JJ O
samples NNS O
communicated VBN O
with IN O
other JJ O
servers NNS O
listed VBN O
at IN O
the DT O
bottom NN O
of IN O
this DT O
report NN O
. . O

Exodus NNP O
One CD O
checks-in NN O
by IN O
sending VBG O
a DT O
POST NNP O
request NN O
containing VBG O
the DT O
app JJ O
package NN O
name NN O
, , O
the DT O
device NN O
IMEI NNP O
and CC O
an DT O
encrypted VBN O
body NN O
containing VBG O
additional JJ O
device NN O
information NN O
. . O

The DT O
encrypted JJ O
body NN O
is VBZ O
composed VBN O
of IN O
various JJ O
identifiers NNS O
which WDT O
are VBP O
joined VBN O
together RB O
: : O
doFinal JJ O
( ( O
) ) O
is VBZ O
called VBN O
to TO O
encrypt VB O
the DT O
device NN O
information NN O
string NN O
: : O
The DT O
user NN O
agent NN O
string NN O
is VBZ O
built VBN O
from IN O
the DT O
package NN O
name NN O
and CC O
IMEI NNP O
number NN O
: : O
Finally RB O
the DT O
HTTP NNP O
request NN O
is VBZ O
sent VBN O
to TO O
the DT O
server NN O
at IN O
https NN B-Indicator
: : I-Indicator
//54.71.249.137/eddd0317-2bdc-4140-86cb-0e8d7047b874 NN I-Indicator
. . O

Many JJ O
of IN O
the DT O
strings NNS O
in IN O
the DT O
application NN O
are VBP O
XOR NNP O
'd MD O
with IN O
the DT O
key JJ O
Kjk1MmphFG NNP O
: : O
After IN O
some DT O
additional JJ O
requests NNS O
, , O
the DT O
dropper NN O
made VBD O
a DT O
POST NNP O
request NN O
to TO O
https VB B-Indicator
: : I-Indicator
//54.71.249.137/56e087c9-fc56-49bb-bbd0-4fafc4acd6e1 NN I-Indicator
which WDT O
returned VBD O
a DT O
zip NN O
file NN O
containing VBG O
the DT O
second JJ O
stage NN O
binaries NNS O
. . O

Stage NN O
2 CD O
: : O
Exodus NN B-Malware
Two CD I-Malware
The DT O
Zip NNP O
archive NN O
returned VBN O
by IN O
the DT O
check-in NN O
performed VBN O
by IN O
Exodus NNP B-Malware
One NNP I-Malware
is VBZ O
a DT O
collection NN O
of IN O
files NNS O
including VBG O
the DT O
primary JJ O
payload NN O
mike.jar NN B-Indicator
and CC O
several JJ O
compiled JJ O
utilities NNS O
that WDT O
serve VBP O
different JJ O
functions NNS O
. . O

At IN O
least JJS O
in IN O
most JJS O
recent JJ O
versions NNS O
, , O
as IN O
of IN O
January NNP O
2019 CD O
, , O
the DT O
Zip NNP O
archive NN O
would MD O
actually RB O
contain VB O
the DT O
i686 NN O
, , O
arm NN O
and CC O
arm64 JJ O
versions NNS O
of IN O
all DT O
deployed JJ O
binaries NNS O
. . O

File NNP O
Name NNP O
Modified NNP O
Date NNP O
SHA256 NNP O
null_arm VBD O
2018-02-27 JJ O
06:44:00 CD O
48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88 CD B-Indicator
null_i686 JJ O
2018-02-27 JJ O
06:44:00 CD O
c228a534535b22a316a97908595a2d793d0fecabadc32846c6d1bfb08ca9a658 JJ B-Indicator
null_arm64 JJ O
2018-02-27 JJ O
06:43:00 CD O
48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88 CD B-Indicator

sepolicy-inject_arm JJ O
2019-01-08 JJ O
04:55:00 CD O
47449a612697ad99a6fbd6e02a84e957557371151f2b034a411ebb10496648c8 CD B-Indicator
sepolicy-inject_arm64 JJ O
2019-01-08 JJ O
04:55:00 CD O
824ad333320cbb7873dc49e61c14f749b0e0d88723635524463f2e6f56ea133a CD B-Indicator
sepolicy-inject_i686 JJ O
2019-01-08 JJ O
04:55:00 CD O
13ec6cec511297ac3137cf7d6e4a7c4f5dd2b24478a06262a44f13a3d61070b6 CD B-Indicator

rootdaemon_arm NN O
2019-01-08 JJ O
04:55:00 CD O
00c787c0c0bc26caf623e66373a5aaa1b913b9caee1f34580bdfdd21954b7cc4 CD B-Indicator
rootdaemon_arm64 JJ O
2019-01-08 JJ O
04:55:00 CD O
3ee3a973c62ba5bd9eab595a7c94b7a26827c5fa5b21964d511ab58903929ec5 CD B-Indicator
mike.jar JJ B-Indicator
2018-12-06 JJ O
05:50:00 CD O
a42a05bf9b412cd84ea92b166d790e8e72f1d01764f93b05ace62237fbabe40e NN B-Indicator

rootdaemon_i686 VB O
2019-01-08 JJ O
04:55:00 CD O
b46f282f9a1bce3798faee3212e28924730a657eb93cda3824c449868b6ee2e7 JJ B-Indicator
zygotedaemonarm NN O
2019-01-08 JJ O
04:55:00 CD O
e3f65f84dd6c2c3a5a653a3788d78920c0321526062a6b53daaf23fa57778a5f JJ B-Indicator
zygotedaemonarm64 CD O
2019-01-08 JJ O
04:55:00 CD O
11499ff2418f4523344de81a447f6786fdba4982057d4114f64db929990b4b59 CD B-Indicator

zygotedaemoni686 NN O
2019-01-08 JJ O
04:55:00 CD O
3c9f08b3280851f54414dfa5a57f40d3b7be7b73736fa0ba21b078e75ce54d33 CD B-Indicator
sapp.apk JJ B-Indicator
2019-01-08 JJ O
04:53:00 CD O
4bf1446c412dd5c552539490d03e999a6ceb96ae60a9e7846427612bec316619 CD B-Indicator
placeholder NN O
2018-03-29 JJ O
16:31:00 CD O
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 NN B-Indicator

After IN O
download NN O
, , O
Exodus NNP B-Malware
One NNP I-Malware
would MD O
dynamically RB O
load VB O
and CC O
execute VB O
the DT O
primary JJ O
stage NN O
2 CD O
payload NN O
mike.jar NN B-Indicator
using VBG O
the DT O
Android NNP B-System
API NNP I-System
DexClassLoader NNP O
( ( O
) ) O
. . O

mike.jar NN B-Indicator
implements NNS O
most RBS O
of IN O
the DT O
data NNS O
collection NN O
and CC O
exfiltration NN O
capabilities NNS O
of IN O
this DT O
spyware NN O
. . O

Of IN O
the DT O
various JJ O
binaries NNS O
downloaded VBD O
, , O
the DT O
most RBS O
interesting JJ O
are VBP O
null JJ O
, , O
which WDT O
serves VBZ O
as IN O
a DT O
local JJ O
and CC O
reverse NN O
shell NN O
, , O
and CC O
rootdaemon NN O
, , O
which WDT O
takes VBZ O
care NN O
of IN O
privilege NN O
escalation NN O
and CC O
data NNS O
acquisition NN O
. . O

rootdaemon NN O
will MD O
first VB O
attempt NN O
to TO O
jailbreak VB O
the DT O
device NN O
using VBG O
a DT O
modified JJ O
version NN O
of IN O
the DT O
DirtyCow NNP B-Vulnerability
exploit NN I-Vulnerability
. . O

Similarly RB O
to TO O
another DT O
Android NNP B-System
spyware NN O
made VBN O
in IN O
Italy NNP O
, , O
originally RB O
discovered VBN O
by IN O
Lukas NNP O
Stefanko NNP O
and CC O
later RB O
named VBN O
Skygofree NNP B-Malware
and CC O
analyzed VBN O
in IN O
depth NN O
by IN O
Kaspersky NNP B-Organization
Labs NNP I-Organization
, , O
Exodus NNP B-Malware
also RB O
takes VBZ O
advantage NN O
of IN O
" JJ O
protectedapps NN O
'' '' O
, , O
a DT O
feature NN O
in IN O
Huawei NNP B-Organization
phones NNS O
that WDT O
allows VBZ O
to TO O
configure VB O
power-saving NN O
options NNS O
for IN O
running VBG O
applications NNS O
. . O

By IN O
manipulating VBG O
a DT O
SQLite NNP O
database NN O
, , O
Exodus NNP B-Malware
is VBZ O
able JJ O
to TO O
keep VB O
itself PRP O
running VBG O
even RB O
when WRB O
the DT O
screen NN O
goes VBZ O
off RB O
and CC O
the DT O
application NN O
would MD O
otherwise RB O
be VB O
suspended VBN O
to TO O
reduce VB O
battery NN O
consumption NN O
. . O

Additionally RB O
, , O
rootdaemon JJ O
attempts NNS O
to TO O
remove VB O
its PRP$ O
own JJ O
power NN O
usage NN O
statistics NNS O
from IN O
Huawei NNP B-Organization
phones NNS O
' POS O
SystemManager NN O
: : O
Similarly RB O
, , O
the DT O
malicious JJ O
application NN O
probably RB O
attempts VBZ O
to TO O
minimize VB O
traces NNS O
on IN O
Samsung NNP B-Organization
phones NNS O
by IN O
adding VBG O
to TO O
the DT O
file NN O
/data/data/com.samsung.android.securitylogagent/shared_prefs/apm_sp_status_of_apps.xml VBZ B-Indicator
the DT O
following JJ O
lines NNS O
: : O
And CC O
adding VBG O
to TO O
the DT O
file NN O
/data/data/com.samsung.android.securitylogagent/shared_prefs/com.samsung.android.securitylogagent_preferences.xml NN B-Indicator

these DT O
lines NNS O
instead RB O
: : O
Data NNP O
Collection NNP O
and CC O
Exfiltration NNP O
As NNP O
mentioned VBD O
, , O
mike.jar FW B-Indicator
equips VBZ O
the DT O
spyware NN O
with IN O
extensive JJ O
collection NN O
capabilities NNS O
, , O
including VBG O
: : O
Retrieve VB O
a DT O
list NN O
of IN O
installed JJ O
applications NNS O
. . O

Record NNP O
surroundings VBZ O
using VBG O
the DT O
built-in JJ O
microphone NN O
in IN O
3gp CD O
format NN O
. . O

Retrieve VB O
the DT O
browsing NN O
history NN O
and CC O
bookmarks NNS O
from IN O
Chrome NNP B-System
and CC O
SBrowser NNP B-System
( ( O
the DT O
browser NN O
shipped VBD O
with IN O
Samsung NNP B-Organization
phones NNS O
) ) O
. . O

Extract JJ O
events NNS O
from IN O
the DT O
Calendar NNP B-System
app NN I-System
. . O

Extract VB O
the DT O
calls NNS O
log NN O
. . O

Record NNP O
phone NN O
calls VBZ O
audio NN O
in IN O
3gp CD O
format NN O
. . O

Take VB O
pictures NNS O
with IN O
the DT O
embedded JJ O
camera NN O
. . O

Collect JJ O
information NN O
on IN O
surrounding VBG O
cellular JJ O
towers NNS O
( ( O
BTS NNP O
) ) O
. . O

Extract VB O
the DT O
address NN B-System
book NN I-System
. . O

Extract VB O
the DT O
contacts NNS O
list NN O
from IN O
the DT O
Facebook NNP B-System
app NN I-System
. . O

Extract JJ O
logs NNS O
from IN O
Facebook NNP B-System
Messenger NNP I-System
conversations NNS O
. . O

Take VB O
a DT O
screenshot NN O
of IN O
any DT O
app NN O
in IN O
foreground NN O
. . O

Extract JJ O
information NN O
on IN O
pictures NNS O
from IN O
the DT O
Gallery NNP O
. . O

Extract JJ O
information NN O
from IN O
th NN O
GMail NNP B-System
app NN O
. . O

Dump NNP O
data NNS O
from IN O
the DT O
IMO NNP O
messenger NN B-System
app NN O
. . O

Extract NNP O
call JJ O
logs NNS O
, , O
contacts NNS O
and CC O
messages NNS O
from IN O
the DT O
Skype NNP B-System
app NN O
. . O

Retrieve NNP O
all DT O
SMS NNP O
messages NNS O
. . O

Extract JJ O
messages NNS O
and CC O
the DT O
encryption NN O
key NN O
from IN O
the DT O
Telegram NNP B-System
app NN O
. . O

Dump NNP O
data NNS O
from IN O
the DT O
Viber NNP B-System
messenger NN I-System
app NN O
. . O

Extract JJ O
logs NNS O
from IN O
WhatsApp NNP B-System
. . O

Retrieve NNP O
media NNS O
exchanged VBD O
through IN O
WhatsApp NNP B-System
. . O

Extract VB O
the DT O
Wi-Fi NNP O
network NN O
's POS O
password NN O
. . O

Extract NNP O
data NNS O
from IN O
WeChat NNP B-System
app NN O
. . O

Extract NNP O
current JJ O
GPS NNP O
coordinates NNS O
of IN O
the DT O
phone NN O
. . O

While IN O
some DT O
of IN O
these DT O
acquisition NN O
are VBP O
performed VBN O
purely RB O
through IN O
code NN O
in IN O
mike.jar NN B-Indicator
, , O
some DT O
others NNS O
that IN O
require VBP O
access NN O
to TO O
, , O
for IN O
example NN O
, , O
SQLite NNP O
databases VBZ O
or CC O
other JJ O
files NNS O
in IN O
the DT O
application NN O
's POS O
storage NN O
are VBP O
performed VBN O
through IN O
rootdaemon NN O
instead RB O
, , O
which WDT O
should MD O
be VB O
running VBG O
with IN O
root NN O
privileges NNS O
. . O

In IN O
order NN O
to TO O
achieve VB O
this DT O
, , O
mike.jar VBZ B-Indicator
connects NNS O
to TO O
rootdaemon VB O
through IN O
various JJ O
TCP NNP O
ports NNS O
that IN O
the DT O
daemon JJ O
binds NNS O
on IN O
some DT O
extraction NN O
routines NNS O
for IN O
supported JJ O
applications NNS O
: : O
Port NN B-Indicator
6202 CD I-Indicator
: : O
WhatsApp NNP B-System
extraction NN O
service NN O
. . O

Ports NNS B-Indicator
6203 CD I-Indicator
and CC I-Indicator
6204 CD I-Indicator
: : O
Facebook NNP B-Organization
extraction NN O
service NN O
. . O

Port NN B-Indicator
6205 CD I-Indicator
: : O
Gmail NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6206 CD I-Indicator
: : O
Skype NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6207 CD I-Indicator
: : O
Viber NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6208 CD I-Indicator
: : O
IMO NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6209 CD I-Indicator
: : O
Telegram NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6210 CD I-Indicator
: : O
SBrowser NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6211 CD I-Indicator
: : O
Calendar NNP B-System
extraction NN O
service NN O
. . O

Port NN B-Indicator
6212 CD I-Indicator
: : O
Chrome NNP B-System
extraction NN O
service NN O
. . O

These DT O
services NNS O
appear VBP O
to TO O
be VB O
running VBG O
on IN O
all DT O
network NN O
interfaces NNS O
and CC O
are VBP O
therefore RB O
accessible JJ O
to TO O
anyone NN O
sharing VBG O
a DT O
local JJ O
network NN O
with IN O
an DT O
infected JJ O
device NN O
. . O

Following VBG O
we PRP O
can MD O
see VB O
an DT O
example NN O
of IN O
a DT O
connection NN O
to TO O
port VB B-Indicator
6209 CD I-Indicator
which WDT O
is VBZ O
used VBN O
to TO O
extract VB O
data NNS O
from IN O
the DT O
Telegram NNP B-System
app NN O
. . O

We PRP O
are VBP O
able JJ O
to TO O
send VB O
commands NNS O
to TO O
the DT O
service NN O
such JJ O
as IN O
dumpmsgdb NN O
or CC O
getkey NN O
( ( O
which WDT O
dumps VBZ O
the DT O
tgnet.dat NN B-Indicator
file NN I-Indicator
) ) O
. . O

Data NNS O
acquired VBD O
from IN O
mike.jar NN B-Indicator
's POS O
extraction NN O
modules NNS O
is VBZ O
normally RB O
XORed JJ O
and CC O
stored VBN O
in IN O
a DT O
folder NN O
named VBN O
.lost+found NN O
on IN O
the DT O
SD NNP O
card NN O
. . O

Data NNP O
is VBZ O
eventually RB O
exfiltrated VBN O
over IN O
a DT O
TLS NNP O
connection NN O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
server VBZ B-Indicator
ws.my-local-weather JJR I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
through IN O
an DT O
upload JJ O
queue NN O
. . O

As IN O
mentioned VBN O
before IN O
, , O
our PRP$ O
test NN O
device NN O
was VBD O
automatically RB O
from IN O
stage NN O
one CD O
to TO O
stage VB O
two CD O
, , O
which WDT O
started VBD O
collecting VBG O
data NNS O
. . O

For IN O
example NN O
, , O
the DT O
password NN O
of IN O
the DT O
WiFi NNP O
network NN O
used VBN O
by IN O
the DT O
phone NN O
was VBD O
stored VBN O
in IN O
the DT O
folder NN O
/storage/emulated/0/.lost+found/0BBDA068-9D27-4B55-B226-299FCF2B4242/ JJ B-Indicator
using VBG O
the DT O
following VBG O
file NN O
name NN O
format NN O
DD_MM_2019_HH_mm_ss_XXXXXXXXXXXXX.txt.crypt NNP B-Indicator
( ( O
the DT O
datetime NN O
followed VBN O
by IN O
the DT O
IMEI NNP O
) ) O
. . O

Eventually RB O
we PRP O
observed VBD O
the DT O
agent NN O
exfiltrate VB O
the DT O
WiFi NNP O
password NN O
from IN O
our PRP$ O
test NN O
phone NN O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
server NN O
: : O
Similarly RB O
, , O
the DT O
agent NN O
also RB O
sent VBD O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
the DT O
list NN O
of IN O
installed JJ O
apps NN O
: : O
This DT O
Command NNP O
& CC O
Control NNP O
seems VBZ O
to TO O
have VB O
been VBN O
active JJ O
since IN O
at IN O
least JJS O
April NNP O
2017 CD O
and CC O
was VBD O
registered VBN O
impersonating VBG O
the DT O
legitimate JJ O
service NN O
AccuWeather NNP B-System
. . O

Local JJ O
and CC O
Remote NNP O
Shells NNP O
In IN O
order NN O
to TO O
execute VB O
commands NNS O
on IN O
the DT O
infected JJ O
devices NNS O
, , O
as RB O
well RB O
as IN O
to TO O
provide VB O
a DT O
reverse NN O
shell NN O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
operators NNS O
, , O
Exodus NNP B-Malware
Two CD I-Malware
immediately RB O
attempts NNS O
to TO O
execute VB O
a DT O
payload NN O
it PRP O
downloads VBZ O
with IN O
the DT O
name NN O
null NN O
. . O

Once RB O
launched VBN O
, , O
null NN O
will MD O
first VB O
verify VB O
whether IN O
it PRP O
is VBZ O
able JJ O
to TO O
fork VB O
on IN O
the DT O
system NN O
and CC O
that IN O
there EX O
is VBZ O
no DT O
other JJ O
instance NN O
of IN O
itself PRP O
currently RB O
running VBG O
by IN O
checking VBG O
whether IN O
the DT O
local JJ O
port NN B-Indicator
number NN I-Indicator
6842 CD I-Indicator
is VBZ O
available JJ O
. . O

This DT O
payload NN O
will MD O
then RB O
attempt VB O
to TO O
instantiate VB O
a DT O
remote JJ O
reverse NN O
/system/bin/sh NNP B-Indicator
shell NN O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
ws.my-local-weather JJ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
on IN O
port NN B-Indicator
22011 CD I-Indicator
. . O

It PRP O
is VBZ O
worth JJ O
noticing VBG O
that IN O
this DT O
remote JJ O
reverse NN O
shell NN O
does VBZ O
not RB O
employ VB O
any DT O
transport NN O
cryptography NN O
. . O

The DT O
traffic NN O
transits VBZ O
in IN O
clear JJ O
and CC O
is VBZ O
therefore RB O
potentially RB O
exposed VBN O
to TO O
man-in-the-middle JJ O
attacks NNS O
: : O
At IN O
the DT O
same JJ O
time NN O
, , O
null NN O
will MD O
also RB O
bind VB O
a DT O
local JJ O
shell NN O
on IN O
0.0.0.0:6842 CD B-Indicator
. . O

This DT O
local JJ O
port NN O
is VBZ O
used VBN O
by IN O
Exodus NNP B-Malware
Two CD I-Malware
to TO O
execute VB O
various JJ O
commands NNS O
on IN O
the DT O
Android NNP B-System
device NN O
, , O
such JJ O
as IN O
enabling VBG O
or CC O
disabling VBG O
certain JJ O
services NNS O
, , O
or CC O
parsing VBG O
app JJ O
databases NNS O
. . O

However RB O
, , O
binding VBG O
a DT O
shell NN O
on IN O
all DT O
available JJ O
interfaces NNS O
will MD O
obviously RB O
make VB O
it PRP O
accessible JJ O
to TO O
anyone NN O
who WP O
is VBZ O
sharing VBG O
at IN O
least JJS O
a DT O
local JJ O
network NN O
with IN O
an DT O
infected JJ O
device NN O
. . O

For IN O
example NN O
, , O
if IN O
an DT O
infected JJ O
device NN O
is VBZ O
connected VBN O
to TO O
a DT O
public JJ O
Wi-Fi NNP O
network NN O
any DT O
other JJ O
host NN O
will MD O
be VB O
able JJ O
to TO O
obtain VB O
a DT O
terminal NN O
on IN O
the DT O
device NN O
without IN O
any DT O
form NN O
of IN O
authentication NN O
or CC O
verification NN O
by IN O
simply RB O
connecting VBG O
to TO O
the DT O
port NN O
. . O

If IN O
the DT O
mobile NN O
operator NN O
does VBZ O
n't RB O
enforce VB O
proper JJ O
client NN O
isolation NN O
, , O
it PRP O
is VBZ O
possible JJ O
that IN O
the DT O
infected JJ O
devices NNS O
are VBP O
also RB O
exposed VBN O
to TO O
the DT O
rest NN O
of IN O
the DT O
cellular JJ O
network NN O
. . O

Obviously RB O
, , O
this DT O
inevitably NN O
leaves VBZ O
the DT O
device NN O
open MD O
not RB O
only RB O
to TO O
further JJ O
compromise NN O
but CC O
to TO O
data NNS O
tampering VBG O
as RB O
well RB O
. . O

null NN O
is VBZ O
not RB O
the DT O
only JJ O
payload NN O
opening VBG O
a DT O
shell NN O
on IN O
the DT O
phone NN O
. . O

The DT O
rootdaemon NN O
binary NN O
in IN O
fact NN O
offers NNS O
several JJ O
other JJ O
possibilities NNS O
to TO O
execute VB O
commands NNS O
on IN O
the DT O
infected JJ O
device NN O
just RB O
by IN O
connecting VBG O
to TO O
TCP NNP O
port NN B-Indicator
6200 CD I-Indicator
and CC O
issuing VBG O
one CD O
of IN O
the DT O
following JJ O
commands NNS O
. . O

Sending VBG O
the DT O
command NN O
sh NN O
to TO O
TCP NNP O
port NN B-Indicator
6200 CD I-Indicator
results NNS O
in IN O
a DT O
full JJ O
terminal NN O
being VBG O
dropped VBD O
: : O
Sending VBG O
the DT O
command NN O
cmd NN O
followed VBN O
by IN O
a DT O
proper JJ O
terminal NN O
command NN O
will MD O
execute VB O
it PRP O
and CC O
print VB O
the DT O
output NN O
( ( O
in IN O
the DT O
example NN O
we PRP O
use VBP O
id JJ O
which WDT O
displays VBZ O
the DT O
identity NN O
of IN O
the DT O
system NN O
user JJ O
running VBG O
the DT O
issued JJ O
commands NNS O
) ) O
: : O
Doing VBG O
the DT O
same JJ O
as IN O
above IN O
but CC O
with IN O
command NN O
sucmd NN O
will MD O
run VB O
the DT O
terminal JJ O
command NN O
as IN O
root NN O
: : O
Other JJ O
commands NNS O
supported VBN O
by IN O
rootdaemon NN O
on IN O
TCP NNP O
port NN B-Indicator
6200 CD I-Indicator
are VBP O
su VBN O
( ( O
which WDT O
in IN O
our PRP$ O
tests NNS O
did VBD O
n't RB O
properly RB O
work NN O
) ) O
, , O
loadsocketpolicy NN O
, , O
loadfilepolicy NN O
, , O
remount NN O
and CC O
removeroot NN O

. . O

At IN O
the DT O
cost NN O
of IN O
possibly RB O
being VBG O
overly RB O
verbose RB O
, , O
following VBG O
is VBZ O
the DT O
output NN O
of IN O
an DT O
nmap JJ O
scan NN O
of IN O
the DT O
infected JJ O
Android NNP O
device NN O
from IN O
a DT O
laptop NN O
in IN O
the DT O
same JJ O
local JJ O
network NN O
, , O
which WDT O
further RB O
demonstrantes VBZ O
the DT O
availability NN O
of IN O
the DT O
same JJ O
open JJ O
TCP NNP O
ports NNS O
that IN O
we PRP O
have VBP O
mentioned VBN O
thus RB O
far RB O
: : O
Identification NN O
of IN O
eSurv JJ B-Organization
Presence NNP O
of IN O
Italian JJ O
language NN O
At IN O
a DT O
first JJ O
look NN O
, , O
the DT O
first JJ O
samples NNS O
of IN O
the DT O
spyware NN O
we PRP O
obtained VBD O
did VBD O
not RB O
show VB O
immediately RB O
evident JJ O
connections NNS O
to TO O
any DT O
company NN O
. . O

However RB O
, , O
the DT O
persistent JJ O
presence NN O
of IN O
Italian JJ O
language NN O
both DT O
on IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP O
pages NNS O
as RB O
well RB O
as IN O
inside IN O
the DT O
spyware NN O
code NN O
was VBD O
a DT O
clear JJ O
sign NN O
that IN O
an DT O
Italian JJ O
actor NN O
was VBD O
behind IN O
the DT O
creation NN O
of IN O
this DT O
platform NN O
. . O

Initially RB O
some DT O
particular JJ O
words NNS O
from IN O
the DT O
decompiled JJ O
classes.dex NN B-Indicator
of IN O
Exodus NNP B-Malware
Two CD O
sent VBD O
us PRP O
in IN O
the DT O
right JJ O
direction NN O
. . O

" NN O
Mundizza NNP O
'' '' O
is VBZ O
a DT O
dialectal JJ O
word NN O
, , O
a DT O
derivative NN O
of IN O
the DT O
proper JJ O
Italian JJ O
word NN O
" NN O
immondizia NN O
'' '' O
that WDT O
translates VBZ O
to TO O
" VB O
trash NN O
'' '' O
or CC O
" JJ O
garbage NN O
'' '' O
in IN O
English NNP O
. . O

Interestingly RB O
, , O
" PRP O
mundizza NN O
'' '' O
is VBZ O
typical JJ O
of IN O
Calabria NNP O
, , O
a DT O
region NN O
in IN O
the DT O
south NN O
of IN O
Italy NNP O
, , O
and CC O
more RBR O
specifically RB O
it PRP O
appears VBZ O
to TO O
be VB O
language NN O
native NN O
of IN O
the DT O
city NN O
of IN O
Catanzaro NNP O
. . O

Additionally RB O
, , O
some DT O
copies NNS O
of IN O
Exodus NNP O
One NNP O
use NN O
the DT O
following JJ O
XOR NN O
key NN O
: : O
Rino NNP O
Gattuso NNP O
is VBZ O
a DT O
famous JJ O
retired JJ O
Italian JJ O
footballer NN O
, , O
originally RB O
from IN O
Calabria NNP O
. . O

While IN O
not RB O
too RB O
seriously RB O
, , O
these DT O
elements NNS O
made VBD O
us PRP O
restrict VB O
our PRP$ O
research NN O
into IN O
surveillance NN O
companies NNS O
from IN O
the DT O
region NN O
. . O

Overlapping VBG O
Infrastructure NN O
with IN O
eSurv JJ O
Surveillance NNP O
Cameras NNP O
The DT O
Command NNP O
& CC O
Control NNP O
domain VBP O
configured VBN O
in IN O
several JJ O
of IN O
the DT O
malicious JJ O
applications NNS O
found VBD O
on IN O
Google NNP B-System
Play NNP I-System
Store NNP I-System
, , O
ws.my-local-weather JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
, , O
points NNS O
to TO O
the DT O
IP NNP O
address NN O
54.69.156.31 CD B-Indicator
which WDT O
serves VBZ O
a DT O
self-signed JJ O
TLS NNP O
certificate NN O
with IN O
the DT O
certificate NN O
common JJ O
name NN O
MyCert NNP O
and CC O
fingerprint JJ O
11:41:45:2F CD B-Indicator
: : I-Indicator
A7:07:23:54 NN I-Indicator
: : O
AE:9A NN B-Indicator
: : I-Indicator
CE NN I-Indicator
: : I-Indicator
F4 NN I-Indicator
: : I-Indicator
FE:56 NN I-Indicator
: : I-Indicator
AE NN I-Indicator
: : I-Indicator
AC NN I-Indicator
: : O
B1 NN B-Indicator
: : I-Indicator
C2:15:9F:6A NN I-Indicator
: : I-Indicator
FC:1E NN I-Indicator
: : I-Indicator
CC:7D NN I-Indicator
: : B-Indicator
F8:61 NN I-Indicator
: : I-Indicator
E3:25:26:73:6A NN I-Indicator
. . O

A DT O
search NN O
for IN O
this DT O
certificate NN O
fingerprint NN O
on IN O
the DT O
Internet NNP O
scanning NN O
service NN O
Censys NNP O
returns VBZ O
8 CD O
additional JJ O
servers NNS O
: : O
IP NNP O
address VBD O
34.208.71.9 CD B-Indicator
34.212.92.0 CD B-Indicator
34.216.43.114 CD B-Indicator
52.34.144.229 CD B-Indicator
54.69.156.31 CD B-Indicator
54.71.249.137 CD B-Indicator
54.189.5.198 CD B-Indicator
78.5.0.195 CD B-Indicator
207.180.245.74 CD B-Indicator
Opening VBG O
the DT O
Command NNP O
& CC O
Control NNP O
web VBP O
page NN O
in IN O
a DT O
browser NN O
presents VBZ O
a DT O
Basic JJ O
Authentication NN O
prompt NN O
: : O
Closing NN O
this DT O
prompt NN O
causes VBZ O
the DT O
server NN O
to TO O
send VB O
a DT O
" NN O
401 CD O
Unauthorized VBN O
Response NN O
'' '' O
with IN O
an DT O
" JJ O
Access NNP O
Denied NNP O
'' '' O
message NN O
in IN O
Italian JJ O

. . O

All DT O
of IN O
the DT O
other JJ O
IP NNP O
address NN O
we PRP O
discovered VBD O
sharing VBG O
the DT O
same JJ O
TLS NNP O
certificate NN O
behave NN O
in IN O
the DT O
same JJ O
way NN O
. . O

The DT O
Command NNP O
& CC O
Control NNP O
server NN O
also RB O
displays VBZ O
a DT O
favicon NN O
image NN O
which WDT O
looks VBZ O
like IN O
a DT O
small JJ O
orange NN O
ball NN O
. . O

At IN O
the DT O
time NN O
of IN O
writing NN O
, , O
a DT O
reverse JJ O
image NN O
search NN O
for IN O
the DT O
favicon NN O
on IN O
Shodan NNP O
using VBG O
the DT O
query NN O
http.favicon.hash:990643579 NN B-Indicator
returned VBD O
around IN O
40 CD O
web NN O
servers NNS O
which WDT O
use VBP O
the DT O
same JJ O
favicon NN O
. . O

Many JJ O
of IN O
these DT O
servers NNS O
are VBP O
control JJ O
panels NNS O
for IN O
video JJ O
surveillance NN O
systems NNS O
developed VBN O
by IN O
the DT O
Italian JJ O
company NN O
eSurv NN O
, , O
based VBN O
in IN O
Catanzaro NNP O
, , O
in IN O
Calabria NNP O
, , O
Italy NNP O
. . O

Their PRP$ O
publicly RB O
advertised VBN O
products NNS O
include VBP O
CCTV NNP O
management NN O
systems NNS O
, , O
surveillance NN O
drones NNS O
, , O
face NN O
and CC O
license JJ O
plate NN O
recognition NN O
systems NNS O
. . O

eSurv NN B-Organization
's POS O
logo NN O
is VBZ O
identical JJ O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
server VBZ O
favicon NN O
. . O

Older JJR O
samples NNS O
connecting VBG O
to TO O
eSurv VB B-Organization
Finally NNP O
, , O
Google NNP B-Organization
shared VBD O
with IN O
us PRP O
some DT O
older JJR O
samples NNS O
of IN O
Exodus NNP B-Malware
One NNP I-Malware
( ( O
with IN O
hashes NNS O
2055584625d24687bd027a63bc0b8faa7d1a854a535de74afba24840a52b1d2f CD B-Indicator
and CC O
a37f5d2418c5f2f64d06ba28fe62edee1293a56158ddfa9f04020e316054363f NN B-Indicator
) ) O
which WDT O
are VBP O
not RB O
obfuscated VBN O
and CC O
use VB O
the DT O
following JJ O
disguise NN O
: : O
The DT O
configuration NN O
of IN O
these DT O
older JJR O
samples NNS O

is VBZ O
very RB O
similar JJ O
to TO O
newer VB O
ones NNS O
, , O
but CC O
it PRP O
provides VBZ O
additional JJ O
insights NNS O
being VBG O
not RB O
obfuscated VBN O
: : O
Firstly RB O
we PRP O
can MD O
notice VB O
that DT O
, , O
instead RB O
of IN O
generic JJ O
domain NN O
names NNS O
or CC O
IP NNP O
addresses NNS O
, , O
these DT O
samples NNS O
communicated VBD O
with IN O
a DT O
Command NNP O
& CC O
Control NNP O
server RB O
located VBD O
at IN O
attiva.exodus.esurv JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
it PRP I-Indicator
( ( O
" JJ O
attiva NN O
'' '' O
is VBZ O
the DT O
Italian JJ O
for IN O
" JJ O
activate NN O
'' '' O
) ) O
. . O

( ( O
We PRP I-System
named VBD O
the DT O
spyware NN O
" NNP O
Exodus NNP O
'' '' O
after IN O
this DT O
Command NNP O
& CC O
Control NNP O
domain NN O
name NN O
. . O

) ) O
Following VBG O
is VBZ O
the DT O
snippet NN O
of IN O
code NN O
in IN O
these DT O
older JJR O
Exodus NNP B-Malware
One CD I-Malware
samples VBZ O
showing VBG O
the DT O
connection NN O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
: : O
Below NNP O
is VBZ O
the DT O
almost RB O
identical JJ O
composition NN O
of IN O
the DT O
request NN O
to TO O
the DT O
Command NNP O
& CC O
Control NNP O
server NN O
in IN O
mike.jar NN B-Indicator
( ( O
also RB O
containing VBG O
the DT O
path NN O
7e661733-e332-429a-a7e2-23649f27690f JJ O
) ) O
: : O
To TO O
further VB O
corroborate VB O
the DT O
connection NN O
of IN O
the DT O
Exodus NNP B-Malware
spyware NN I-Malware
with IN O
eSurv NN O
, , O
the DT O
domain NN B-Indicator
attiva.exodus.esurv.it JJ I-Indicator
resolves NNS O
to TO O
the DT O
IP NNP O
212.47.242.236 CD B-Indicator
which WDT O
, , O
according VBG O
to TO O

public JJ O
passive JJ O
DNS NNP O
data NN O
, , O
in IN O
2017 CD O
was VBD O
used VBN O
to TO O
host VB O
the DT O
domain NN B-Indicator
server1cs.exodus.connexxa.it NN I-Indicator
. . O

Connexxa NNP O
was VBD O
a DT O
company NN O
also RB O
from IN O
Catanzaro NNP O
. . O

According VBG O
to TO O
publicly RB O
available JJ O
information NN O
, , O
the DT O
founder NN O
of IN O
Connexxa NNP B-Organization
seems VBZ O
to TO O
also RB O
be VB O
the DT O
CEO NNP O
of IN O
eSurv NN B-Organization
. . O

Interestingly RB O
, , O
we PRP O
found VBD O
other JJ O
DNS NNP O
records NNS O
mostly RB O
from IN O
2017 CD O
that WDT O
follow VBP O
a DT O
similar JJ O
pattern NN O
and CC O
appear VB O
to TO O
contain VB O
two-letters NNS O
codes NNS O
for IN O
districts NNS O
in IN O
Italy NNP O
: : O
Server NNP O
City NNP O
server1bo.exodus.connexxa NN B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Bologna NNP O
server1bs.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Brescia NNP O
server1cs.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Cosenza NNP O
server1ct.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Catania NNP O
server1fermo.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
server1fi.exodus.connexxa JJ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Firenze NNP O
server1gioiat.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
server1na.exodus.connexxa JJ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Napoli NNP O
server1rc.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Reggio NNP O
Calabria NNP O
server2ct.exodus.connexxa NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Catania NNP O
server2cz.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Catanzaro NNP O
server2fi.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Firenze NNP O
server2mi.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Milano NNP O
server2rc.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Reggio NNP O
Calabria NNP O
server3bo.exodus.connexxa NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Bologna NNP O
server3ct.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Catania NNP O
server3.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
server3fi.exodus.connexxa JJ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Firenze NNP O
server4fi.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Firenze NNP O
serverrt.exodus.connexxa VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] VB I-Indicator
it PRP I-Indicator
Public NNP O
Resume NNP O
Confirms NNP O
Development NNP O
of IN O
Android NNP B-System
Agent NNP O
Additionally NNP O
, , O
an DT O
employee NN O
of IN O
eSurv JJ B-Organization
quite RB O
precisely RB O
described VBN O
their PRP$ O
work NN O
in IN O
developing VBG O
an DT O
" NN O
agent NN O
to TO O
gather VB O
data NNS O
from IN O
Android NNP B-System
devices NNS O
and CC O
send VB O
it PRP O
to TO O
a DT O
C NNP O
& CC O
C NNP O
server NN O
'' '' O
as RB O
well RB O
as IN O
researching VBG O
" JJ O
vulnerabilities NNS O
in IN O
mobile JJ O
devices NNS O
( ( O
mainly RB O
Android NNP B-System
) ) O
'' '' O
in IN O
a DT O
publicly RB O
available JJ O
resume NN O
. . O

Further RB O
details NNS O
in IN O
it PRP O
reflect VBP O
characteristics NNS O
of IN O
Exodus NNP B-Malware
( ( O
such JJ O
as IN O
the DT O
bypass NN O
of IN O
power NN O
managers NNS O
we PRP O
described VBD O
from IN O
Exodus NNP B-Malware
One NNP I-Malware
, , O
and CC O
more JJR O
) ) O
: : O
Indicators NNS O
of IN O
Compromise NNP O
Exodus NNP B-Malware
One CD I-Malware
011b6bcebd543d4eb227e840f04e188fb01f2335b0b81684b60e6b45388d3820 CD B-Indicator
0f5f1409b1ebbee4aa837d20479732e11399d37f05b47b5359dc53a4001314e5 CD B-Indicator
2055584625d24687bd027a63bc0b8faa7d1a854a535de74afba24840a52b1d2f CD B-Indicator

26fef238028ee4b5b8da631c77bfb44ada3d5db8129c45dea5df6a51c9ea5f55 CD B-Indicator
33a9da16d096426c82f150e39fc4f9172677885cfeaedcff10c86414e88be802 CD B-Indicator
34d000ee1e36efd10eb37e2b79d69249d5a85682a61390a89a1b9391c46bf2ba CD B-Indicator
4f6146956b50ae3a6e80a1c1f771dba848ba677064eb0e166df5804ac2766898 CD B-Indicator

5db49122d866967295874ab2c1ce23a7cde50212ff044bbea1da9b49bb9bc149 CD B-Indicator
70e2eea5609c6954c61f2e5e0a3aea832d0643df93d18d7d78b6f9444dcceef0 CD B-Indicator
80810a8ec9624f317f832ac2e212dba033212258285344661e5da11b0d9f0b62 CD B-Indicator
8453ce501fee1ca8a321f16b09969c517f92a24b058ac5b54549eabd58bf1884 CD B-Indicator

a37f5d2418c5f2f64d06ba28fe62edee1293a56158ddfa9f04020e316054363f NN B-Indicator
db59407f72666526fca23d31e3b4c5df86f25eff178e17221219216c6975c63f NN B-Indicator
e0acbb0d7e55fb67e550a6bf5cf5c499a9960eaf5f037b785f9004585202593b NN B-Indicator
Exodus NNP B-Malware
One NNP I-Malware
Package NNP O
Names NNP O
com.phonecarrier.linecheck VB B-Indicator

rm.rf NN I-Indicator
operatore.italia MD B-Indicator
it.offertetelefonicheperte VB I-Indicator
it.servizipremium NN B-Indicator
assistenza.sim NN B-Indicator
assistenza.linea.riattiva NN B-Indicator
assistenza.linea NN B-Indicator
it.promofferte JJ B-Indicator
Exodus NNP B-Malware
Two CD I-Malware
64c11fdb317d6b7c9930e639f55863df592f23f3c7c861ddd97048891a90c64b CD B-Indicator
a42a05bf9b412cd84ea92b166d790e8e72f1d01764f93b05ace62237fbabe40e NNS B-Indicator
Exodus CD B-Malware
Two CD I-Malware

ELF NNP O
Utilities VBZ O
00c787c0c0bc26caf623e66373a5aaa1b913b9caee1f34580bdfdd21954b7cc4 CD B-Indicator
11499ff2418f4523344de81a447f6786fdba4982057d4114f64db929990b4b59 CD B-Indicator
13ec6cec511297ac3137cf7d6e4a7c4f5dd2b24478a06262a44f13a3d61070b6 CD B-Indicator
3c9f08b3280851f54414dfa5a57f40d3b7be7b73736fa0ba21b078e75ce54d33 CD B-Indicator

3ee3a973c62ba5bd9eab595a7c94b7a26827c5fa5b21964d511ab58903929ec5 CD B-Indicator
47449a612697ad99a6fbd6e02a84e957557371151f2b034a411ebb10496648c8 CD B-Indicator
48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88 CD B-Indicator
824ad333320cbb7873dc49e61c14f749b0e0d88723635524463f2e6f56ea133a CD B-Indicator

b46f282f9a1bce3798faee3212e28924730a657eb93cda3824c449868b6ee2e7 NN B-Indicator
c228a534535b22a316a97908595a2d793d0fecabadc32846c6d1bfb08ca9a658 NN B-Indicator
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 NN B-Indicator
e3f65f84dd6c2c3a5a653a3788d78920c0321526062a6b53daaf23fa57778a5f NN B-Indicator

Command NNP O
& CC O
Controls NNP O
ad1.fbsba VBZ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
ws.my-local-weather JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
com NN I-Indicator
54.71.249 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
137 CD I-Indicator
54.69.156 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
31 CD I-Indicator
162.243.172 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
208 CD I-Indicator
attiva.exodus.esurv JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
it PRP I-Indicator
The DT O
rise NN O
of IN O
mobile JJ O
banker NN O
Asacub NNP B-Malware
28 CD O
AUG NNP O
2018 CD O
We PRP O
encountered VBD O
the DT O
Trojan-Banker.AndroidOS.Asacub NNP B-Malware
family NN O
for IN O
the DT O
first JJ O
time NN O
in IN O
2015 CD O
, , O
when WRB O
the DT O
first JJ O
versions NNS O
of IN O
the DT O
malware NN O
were VBD O
detected VBN O
, , O
analyzed VBN O
, , O
and CC O
found VBD O
to TO O
be VB O
more JJR O
adept JJ O
at IN O
spying VBG O
than IN O
stealing VBG O
funds NNS O
. . O

The DT O
Trojan NNP O
has VBZ O
evolved VBN O
since IN O
then RB O
, , O
aided VBN O
by IN O
a DT O
large-scale JJ O
distribution NN O
campaign NN O
by IN O
its PRP$ O
creators NNS O
( ( O
in IN O
spring-summer NN O
2017 CD O
) ) O
, , O
helping VBG O
Asacub NNP B-Malware
to TO O
claim VB O
top JJ O
spots NNS O
in IN O
last JJ O
year NN O
’ VBD O
s JJ O
ranking NN O
by IN O
number NN O
of IN O
attacks NNS O
among IN O
mobile JJ O
banking NN O
Trojans NNPS O
, , O
outperforming VBG O
other JJ O
families NNS O
such JJ O
as IN O
Svpeng NNP B-Malware
and CC O
Faketoken NNP B-Malware
. . O

We PRP O
decided VBD O
to TO O
take VB O
a DT O
peek NN O
under IN O
the DT O
hood NN O
of IN O
a DT O
modern JJ O
member NN O
of IN O
the DT O
Asacub NNP B-Malware
family NN O
. . O

Our PRP$ O
eyes NNS O
fell VBD O
on IN O
the DT O
latest JJS O
version NN O
of IN O
the DT O
Trojan NNP O
, , O
which WDT O
is VBZ O
designed VBN O
to TO O
steal VB O
money NN O
from IN O
owners NNS O
of IN O
Android NNP B-System
devices NNS O
connected VBN O
to TO O
the DT O
mobile JJ O
banking NN O
service NN O
of IN O
one CD O
of IN O
Russia NNP O
’ NNP O
s RB O
largest JJS O
banks NNS O
. . O

Asacub NNP B-Malware
versions NNS O
Sewn NNP O
into IN O
the DT O
body NN O
of IN O
the DT O
Trojan NNP O
is VBZ O
the DT O
version NN O
number NN O
, , O
consisting VBG O
of IN O
two CD O
or CC O
three CD O
digits NNS O
separated VBN O
by IN O
periods NNS O
. . O

The DT O
numbering NN O
seems VBZ O
to TO O
have VB O
started VBN O
anew RB O
after IN O
the DT O
version NN O
9 CD O
. . O

The DT O
name NN O
Asacub NNP B-Malware
appeared VBD O
with IN O
version NN O
4 CD O
in IN O
late JJ O
2015 CD O
; : O
previous JJ O
versions NNS O
were VBD O
known VBN O
as IN O
Trojan-SMS.AndroidOS.Smaps NNP B-Indicator
. . O

Versions NNS O
5.X.X-8.X.X CD O
were VBD O
active JJ O
in IN O
2016 CD O
, , O
and CC O
versions NNS O
9.X.X-1.X.X CD O
in IN O
2017 CD O
. . O

In IN O
2018 CD O
, , O
the DT O
most RBS O
actively RB O
distributed JJ O
versions NNS O
were VBD O
5.0.0 CD O
and CC O
5.0.3 CD O
. . O

Communication NN O
with IN O
C NNP O
& CC O
C NNP O
Although IN O
Asacub NNP B-Malware
’ NNP O
s NN O
capabilities NNS O
gradually RB O
evolved VBD O
, , O
its PRP$ O
network NN O
behavior NN O
and CC O
method NN O
of IN O
communication NN O
with IN O
the DT O
command-and-control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server RB O
changed VBN O
little RB O
. . O

This DT O
strongly RB O
suggested VBD O
that IN O
the DT O
banking NN O
Trojans NNPS O
, , O
despite IN O
differing VBG O
in IN O
terms NNS O
of IN O
capability NN O
, , O
belong RB O
to TO O
the DT O
same JJ O
family NN O
. . O

Data NNP O
was VBD O
always RB O
sent VBN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
via IN O
HTTP NNP O
in IN O
the DT O
body NN O
of IN O
a DT O
POST NNP O
request NN O
in IN O
encrypted JJ O
form NN O
to TO O
the DT O
relative JJ O
address NN O
/something/index.php NN B-Indicator
. . O

In IN O
earlier JJR O
versions NNS O
, , O
the DT O
something NN O
part NN O
of IN O
the DT O
relative JJ O
path NN O
was VBD O
a DT O
partially RB O
intelligible JJ O
, , O
yet RB O
random JJ O
mix NN O
of IN O
words NNS O
and CC O
short JJ O
combinations NNS O
of IN O
letters NNS O
and CC O
numbers NNS O
separated VBN O
by IN O
an DT O
underscore NN O
, , O
for IN O
example NN O
, , O
“ NNP O
bee_bomb NN O
” NN O
or CC O
“ VB O
my_te2_mms JJ O
” NN O
. . O

Example NN O
of IN O
traffic NN O
from IN O
an DT O
early JJ O
version NN O
of IN O
Asacub NNP B-Malware
( ( O
2015 CD O
) ) O
The DT O
data NN O
transmitted VBD O
and CC O
received VBD O
is VBZ O
encrypted VBN O
with IN O
the DT O
RC4 NNP O
algorithm NN O
and CC O
encoded VBD O
using VBG O
the DT O
base64 JJ O
standard NN O
. . O

The DT O
C NNP O
& CC O
C NNP O
address NN O
and CC O
the DT O
encryption NN O
key NN O
( ( O
one CD O
for IN O
different JJ O
modifications NNS O
in IN O
versions NNS O
4.x CD O
and CC O
5.x CD O
, , O
and CC O
distinct JJ O
for IN O
different JJ O
C NNP O
& CC O
Cs NNP O
in IN O
later JJ O
versions NNS O
) ) O
are VBP O
stitched VBN O
into IN O
the DT O
body NN O
of IN O
the DT O
Trojan NNP O
. . O

In IN O
early JJ O
versions NNS O
of IN O
Asacub NNP B-Malware
, , O
.com NNP O
, , O
.biz NNP O
, , O
.info NNP O
, , O
.in NNP O
, , O
.pw NNP O
were VBD O
used VBN O
as IN O
top-level JJ O
domains NNS O
. . O

In IN O
the DT O
2016 CD O
version NN O
, , O
the DT O
value NN O
of IN O
the DT O
User-Agent JJ O
header NN O
changed VBD O
, , O
as IN O
did VBD O
the DT O
method NN O
of IN O
generating VBG O
the DT O
relative JJ O
path NN O
in IN O
the DT O
URL NNP O
: : O
now RB O
the DT O
part NN O
before IN O
/index.php NN O
is VBZ O
a DT O
mix NN O
of IN O
a DT O
pronounceable JJ O
( ( O
if IN O
not RB O
entirely RB O
meaningful JJ O
) ) O
word NN O
and CC O
random NN O
letters NNS O
and CC O
numbers NNS O
, , O
for IN O
example NN O
, , O
“ NNP O
muromec280j9tqeyjy5sm1qy71 VBZ B-Indicator
” CD O
or CC O
“ VB O
parabbelumf8jgybdd6w0qa0 JJ B-Indicator
” NN O
. . O

Moreover RB O
, , O
incoming VBG O
traffic NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
began VBD O
to TO O
use VB O
gzip JJ O
compression NN O
, , O
and CC O
the DT O
top-level JJ O
domain NN O
for IN O
all DT O
C NNP O
& CC O
Cs NNP O
was VBD O
.com VBN O
: : O
Since IN O
December NNP O
2016 CD O
, , O
the DT O
changes NNS O
in IN O
C NNP O
& CC O
C NNP O
communication NN O
methods NNS O
have VBP O
affected VBN O
only RB O
how WRB O
the DT O
relative JJ O
path NN O
in IN O
the DT O
URL NNP O
is VBZ O
generated VBN O
: : O
the DT O
pronounceable JJ O
word NN O
was VBD O
replaced VBN O
by IN O
a DT O
rather RB O
long JJ O
random JJ O
combination NN O
of IN O
letters NNS O
and CC O
numbers NNS O
, , O
for IN O
example NN O
, , O
“ NNP O
ozvi4malen7dwdh VBZ B-Indicator
” CD O
or CC O
“ VB O
f29u8oi77024clufhw1u5ws62 JJ B-Indicator
” NN O
. . O

At IN O
the DT O
time NN O
of IN O
writing VBG O
this DT O
article NN O
, , O
no DT O
other JJ O
significant JJ O
changes NNS O
in IN O
Asacub NNP B-Malware
’ NNP O
s NN O
network NN O
behavior NN O
had VBD O
been VBN O
observed VBN O
: : O
The DT O
origin NN O
of IN O
Asacub NNP B-Malware
It PRP O
is VBZ O
fairly RB O
safe JJ O
to TO O
say VB O
that IN O
the DT O
Asacub NNP B-Malware
family NN O
evolved VBD O
from IN O
Trojan-SMS.AndroidOS.Smaps NNP B-Indicator
. . O

Communication NN O
between IN O
both DT O
Trojans NNP O
and CC O
their PRP$ O
C NNP O
& CC O
C NNP O
servers NNS O
is VBZ O
based VBN O
on IN O
the DT O
same JJ O
principle NN O
, , O
the DT O
relative JJ O
addresses NNS O
to TO O
which WDT O
Trojans NNP O
send VBP O
network NN O
requests NNS O
are VBP O
generated VBN O
in IN O
a DT O
similar JJ O
manner NN O
, , O
and CC O
the DT O
set NN O
of IN O
possible JJ O
commands NNS O
that IN O
the DT O
two CD O
Trojans NNS O
can MD O
perform VB O
also RB O
overlaps NNS O
. . O

What WP O
’ VBD O
s PRP O
more RBR O
, , O
the DT O
numbering NN O
of IN O
Asacub NNP B-Malware
versions NNS O
is VBZ O
a DT O
continuation NN O
of IN O
the DT O
Smaps NNP B-Malware
system NN O
. . O

The DT O
main JJ O
difference NN O
is VBZ O
that IN O
Smaps NNP B-Malware
transmits VBZ O
data NNS O
as IN O
plain NN O
text NN O
, , O
while IN O
Asacub NNP B-Malware
encrypts NNS O
data NNS O
with IN O
the DT O
RC4 NNP O
algorithm NN O
and CC O
then RB O
encodes VB O
it PRP O
into IN O
base64 JJ O
format NN O
. . O

Let VB O
’ NNP O
s VB O
compare JJ O
examples NNS O
of IN O
traffic NN O
from IN O
Smaps NNP B-Malware
and CC O
Asacub NNP B-Malware
— NNP O
an DT O
initializing VBG O
request NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
with IN O
information NN O
about IN O
the DT O
infected JJ O
device NN O
and CC O
a DT O
response NN O
from IN O
the DT O
server NN O
with IN O
a DT O
command NN O
for IN O
execution NN O
: : O
Smaps NNP B-Malware
request VB O
Asacub NNP B-Malware
request NN O
Decrypted NNP O
data NN O
from IN O
Asacub NNP B-Malware
traffic NN O
: : O
{ ( O
“ VB O
id JJ O
” NN O
: : O
” JJ O
532bf15a-b784-47e5-92fa-72198a2929f5″ JJ B-Indicator
, , O
” JJ O
type NN O
” NN O
: : O
” JJ O
get NN O
” NNP O
, , O
” NNP O
info VBZ O
” NN O
: : O
” NN O
imei:365548770159066 NN O
, , O
country NN O
: : O
PL NNP O
, , O
cell NN O
: : O
Tele2 NN O

, , O
android:4.2.2 NN O
, , O
model NN O
: : O
GT-N5100 JJ O
, , O
phonenumber NN O
: : O
+486679225120 NN O
, , O
sim:6337076348906359089f NN O
, , O
app NN O
: : O
null NN O
, , O
ver:5.0.2″ NN O
} ) O
Data NNP O
sent VBD O
to TO O
the DT O
server NN O
[ NNP O
{ ( O
“ JJ O
command NN O
” NN O
: : O
” NN O
sent VBD O
& CC O
& CC O
& CC O
” NNP O
, , O
” NNP O
params VBZ O
” NNS O
: : O
{ ( O
“ VB O
to TO O
” VB O
: : O
” NN O
+79262000900″ NN O
, , O
” NNP O
body NN O
” NN O
: : O
” NN O
\u0410\u0412\u0422\u041e\u041f\u041b\u0410\u0422\u0415\u0416 NN O

1000 CD O
50″ CD O
, , O
” NNP O
timestamp VBZ O
” NN O
: : O
” NN O
1452272572″ CD O
} ) O
} ) O
, , O
{ ( O
“ JJ O
command NN O
” NN O
: : O
” NN O
sent VBD O
& CC O
& CC O
& CC O
” NNP O
, , O
” NNP O
params VBZ O
” NNS O
: : O
{ ( O
“ VB O
to TO O
” VB O
: : O
” NN O
+79262000900″ NN O
, , O
” NNP O
body NN O
” NN O
: : O
” JJ O
BALANCE NNP O
” NNP O
, , O
” NNP O
timestamp VBZ O
” NN O
: : O
” NN O
1452272573″ CD O
} ) O
} ) O
] JJ O
Instructions NNS O
received VBD O
from IN O
the DT O
server NN O
A DT O
comparison NN O
can MD O
also RB O
be VB O
made VBN O
of IN O
the DT O
format NN O
in IN O
which WDT O
Asacub NNP O
and CC O
Smaps NNP O
forward RB O
incoming VBG O
SMS NNP O
( ( O
encoded VBN O
with IN O
the DT O
base64 NN O
algorithm NN O
) ) O
from IN O
the DT O
device NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
: : O
Smaps NNS O

format NN O
Asacub NNP O
format NN O
Decrypted NNP O
data NN O
from IN O
Asacub NNP O
traffic NN O
: : O
{ ( O
“ VB O
data NNS O
” NNS O
: : O
” NN O
2015:10:14_02:41:15″ CD O
, , O
” NNP O
id VBZ O
” NN O
: : O
” JJ O
532bf15a-b784-47e5-92fa-72198a2929f5″ JJ B-Indicator
, , O
” JJ O
text NN O
” NN O
: : O
” JJ O
SSB0aG91Z2h0IHdlIGdvdCBwYXN0IHRoaXMhISBJJ20gbm90IGh1bmdyeSBhbmQgbmU= NNP O
” NNP O
, , O
” NNP O
number NN O
” NN O
: : O
” NN O
1790″ CD O
, , O
” CD O
type NN O

” NN O
: : O
” JJ O
load NN O
” NN O
} ) O
Propagation NNP O
The DT O
banking NN O
Trojan NNP O
is VBZ O
propagated VBN O
via IN O
phishing VBG O
SMS NNP O
containing VBG O
a DT O
link NN O
and CC O
an DT O
offer NN O
to TO O
view VB O
a DT O
photo NN O
or CC O
MMS NNP O
. . O

The DT O
link NN O
points NNS O
to TO O
a DT O
web JJ O
page NN O
with IN O
a DT O
similar JJ O
sentence NN O
and CC O
a DT O
button NN O
for IN O
downloading VBG O
the DT O
APK NNP O
file NN O
of IN O
the DT O
Trojan NNP O
to TO O
the DT O
device NN O
. . O

The DT O
Trojan NNP O
download NN O
window NN O
Asacub NNP B-Malware
masquerades NNS O
under IN O
the DT O
guise NN O
of IN O
an DT O
MMS NNP O
app NN O
or CC O
a DT O
client NN O
of IN O
a DT O
popular JJ O
free JJ O
ads NNS O
service NN O
. . O

We PRP O
came VBD O
across IN O
the DT O
names NNS O
Photo NNP O
, , O
Message NNP O
, , O
Avito NNP O
Offer NNP O
, , O
and CC O
MMS NNP O
Message NNP O
. . O

App NNP O
icons NNS O
under IN O
which WDT O
Asacub NNP B-Malware
masks VBZ O
itself PRP O
The DT O
APK NNP O
files NNS O
of IN O
the DT O
Trojan NNP O
are VBP O
downloaded VBN O
from IN O
sites NNS O
such JJ O
as IN O
mmsprivate NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
site NN I-Indicator
, , O
photolike JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
fun NN I-Indicator
, , O
you-foto JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
site NN I-Indicator
, , O
and CC O
mms4you NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] IN I-Indicator
me PRP I-Indicator
under IN O
names NNS O
in IN O
the DT O
format NN O
: : O
photo_ NN B-Indicator
[ IN I-Indicator
number NN I-Indicator
] NNP I-Indicator
_img.apk NNP I-Indicator
, , O
mms_ NN B-Indicator
[ NNP I-Indicator
number NN I-Indicator
] NNP I-Indicator
_img.apk NNP I-Indicator
avito_ VBZ B-Indicator
[ JJ I-Indicator
number NN I-Indicator
] NNP I-Indicator
.apk NNP I-Indicator
, , O
mms.img_ NN B-Indicator
[ NNP I-Indicator
number NN I-Indicator
] NNP I-Indicator
_photo.apk NNP I-Indicator
, , O
mms NN B-Indicator
[ NNP I-Indicator
number NN I-Indicator
] NNP I-Indicator
_photo.image.apk NNP I-Indicator
, , O
mms NN B-Indicator
[ NNP I-Indicator
number NN I-Indicator
] NNP I-Indicator
_photo.img.apk NNP I-Indicator
, , O
mms.img.photo_ NN B-Indicator
[ NNP I-Indicator
number NN I-Indicator
] NNP I-Indicator
.apk NNP I-Indicator
, , O
photo_ NN B-Indicator
[ NNP I-Indicator
number NN I-Indicator
] NNP I-Indicator
_obmen.img.apk NNP I-Indicator
. . O

For IN O
the DT O
Trojan NNP O
to TO O
install VB O
, , O
the DT O
user NN O
must MD O
allow VB O
installation NN O
of IN O
apps NN O
from IN O
unknown JJ O
sources NNS O
in IN O
the DT O
device NN O
settings NNS O
. . O

Infection NN O
During IN O
installation NN O
, , O
depending VBG O
on IN O
the DT O
version NN O
of IN O
the DT O
Trojan NNP O
, , O
Asacub NNP B-Malware
prompts VBZ O
the DT O
user NN O
either DT O
for IN O
Device NNP O
Administrator NNP O
rights NNS O
or CC O
for IN O
permission NN O
to TO O
use VB O
AccessibilityService NNP O
. . O

After IN O
receiving VBG O
the DT O
rights NNS O
, , O
it PRP O
sets VBZ O
itself PRP O
as IN O
the DT O
default NN O
SMS NNP O
app NN O
and CC O
disappears NNS O
from IN O
the DT O
device NN O
screen NN O
. . O

If IN O
the DT O
user NN O
ignores VBZ O
or CC O
rejects VBZ O
the DT O
request NN O
, , O
the DT O
window NN O
reopens VBZ O
every DT O
few JJ O
seconds NNS O
. . O

The DT O
Trojan NNP O
requests NNS O
Device NNP O
Administrator NNP O
rights NNS O
The DT O
Trojan NNP O
requests NNS O
permission NN O
to TO O
use VB O
AccessibilityService NNP O
After IN O
installation NN O
, , O
the DT O
Trojan NNP O
starts VBZ O
communicating VBG O
with IN O
the DT O
cybercriminals NNS O
’ NNP O
C NNP O
& CC O
C NNP O
server NN O
. . O

All DT O
data NNS O
is VBZ O
transmitted VBN O
in IN O
JSON NNP O
format NN O
( ( O
after IN O
decryption NN O
) ) O
. . O

It PRP O
includes VBZ O
information NN O
about IN O
the DT O
smartphone NN O
model NN O
, , O
the DT O
OS NNP O
version NN O
, , O
the DT O
mobile NN O
operator NN O
, , O
and CC O
the DT O
Trojan NNP O
version NN O
. . O

Let VB O
’ PRP O
s VB O
take VB O
an DT O
in-depth JJ O
look NN O
at IN O
Asacub NNP B-Malware
5.0.3 CD O
, , O
the DT O
most RBS O
widespread JJ O
version NN O
in IN O
2018 CD O
. . O

Structure NN O
of IN O
data NNS O
sent VBN O
to TO O
the DT O
server NN O
: : O
To TO O
begin VB O
with IN O
, , O
the DT O
Trojan NNP O
sends VBZ O
information NN O
about IN O
the DT O
device NN O
to TO O
the DT O
server NN O
: : O
In IN O
response NN O
, , O
the DT O
server NN O
sends VBZ O
the DT O
code NN O
of IN O
the DT O
command NN O
for IN O
execution NN O
( ( O
“ JJ O
command NN O
” NN O
) ) O
, , O
its PRP$ O
parameters NNS O
( ( O
“ JJ O
params NNS O
” VBP O
) ) O
, , O
and CC O
the DT O
time NN O
delay NN O
before IN O
execution NN O
( ( O
“ JJ O
waitrun NN O
” NN O
in IN O
milliseconds NNS O
) ) O
. . O

List NN O
of IN O
commands NNS O
sewn VBP O
into IN O
the DT O
body NN O
of IN O
the DT O
Trojan NNP O
: : O
Command NNP O
code NN O
Parameters NNP O
Actions NNP O
2 CD O
– NNP O
Sending VBG O
a DT O
list NN O
of IN O
contacts NNS O
from IN O
the DT O
address JJ B-System
book NN I-System
of IN O
the DT O
infected JJ O
device NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server RB O
7 CD O
“ NNS O
to TO O
” VB O
: : O
int NN O
Calling VBG O
the DT O
specified VBN O
number NN O
11 CD O
“ NN O
to TO O
” VB O
: : O
int NN O
, , O
“ NNP O
body NN O
” NN O
: : O
string NN O
Sending VBG O
an DT O
SMS NN O
with IN O
the DT O
specified VBN O
text NN O
to TO O
the DT O
specified VBN O
number NN O
19 CD O
“ NNP O
text NN O
” NN O
: : O
string NN O
, , O
“ NNP O
n FW O
” NN O
: : O
string NN O
Sending VBG O
SMS NNP O
with IN O
the DT O
specified VBN O
text NN O
to TO O
numbers NNS O
from IN O
the DT O
address JJ B-System
book NN I-System
of IN O
the DT O
infected JJ O
device NN O
, , O
with IN O
the DT O
name NN O
of IN O
the DT O
addressee NN O
from IN O
the DT O

address NN B-System
book NN I-System
substituted VBD O
into IN O
the DT O
message NN O
text VBD O
40 CD O
“ NNP O
text NN O
” NN O
: : O
string NN O
Shutting VBG O
down RP O
applications NNS O
with IN O
specific JJ O
names NNS O
( ( O
antivirus NN O
and CC O
banking NN O
applications NNS O
) ) O
The DT O
set NN O
of IN O
possible JJ O
commands NNS O
is VBZ O
the DT O
most RBS O
significant JJ O
difference NN O
between IN O
the DT O
various JJ O
flavors NNS O
of IN O
Asacub NNP B-Malware
. . O

In IN O
the DT O
2015-early JJ O
2016 CD O
versions NNS O
examined VBN O
in IN O
this DT O
article NN O
, , O
C NNP O
& CC O
C NNP O
instructions NNS O
in IN O
JSON NNP O
format NN O
contained VBD O
the DT O
name NN O
of IN O
the DT O
command NN O
in IN O
text JJ O
form NN O
( ( O
“ JJ O
get_sms NN O
” NN O
, , O
“ NNP O
block_phone NN O
” NN O
) ) O
. . O

In IN O
later JJ O
versions NNS O
, , O
instead RB O
of IN O
the DT O
name NN O
of IN O
the DT O
command NN O
, , O
its PRP$ O
numerical JJ O
code NN O
was VBD O
transmitted VBN O
. . O

The DT O
same JJ O
numerical JJ O
code NN O
corresponded VBD O
to TO O
one CD O
command NN O
in IN O
different JJ O
versions NNS O
, , O
but CC O
the DT O
set NN O
of IN O
supported JJ O
commands NNS O
varied VBN O
. . O

For IN O
example NN O
, , O
version NN O
9.0.7 CD O
( ( O
2017 CD O
) ) O
featured VBD O
the DT O
following JJ O
set NN O
of IN O
commands NNS O
: : O
2 CD O
, , O
4 CD O
, , O
8 CD O
, , O
11 CD O
, , O
12 CD O
, , O
15 CD O
, , O
16 CD O
, , O
17 CD O
, , O
18 CD O
, , O
19 CD O
, , O
20 CD O
. . O

After IN O
receiving VBG O
the DT O
command NN O
, , O
the DT O
Trojan NNP O
attempts NNS O
to TO O
execute VB O
it PRP O
, , O
before IN O
informing VBG O
C NNP O
& CC O
C NNP O
of IN O
the DT O
execution NN O
status NN O
and CC O
any DT O
data NNS O
received VBN O
. . O

The DT O
“ NNP O
id NN O
” NNP O
value NN O
inside IN O
the DT O
“ NNP O
data NNS O
” NNP O
block NN O
is VBZ O
equal JJ O
to TO O
the DT O
“ NNP O
timestamp NN O
” NNP O
value NN O
of IN O
the DT O
relevant JJ O
command NN O
: : O
In IN O
addition NN O
, , O
the DT O
Trojan NNP O
sets VBZ O
itself PRP O
as IN O
the DT O
default NN O
SMS NNP O
application NN O
and CC O
, , O
on IN O
receiving VBG O
a DT O
new JJ O
SMS NNP O
, , O
forwards VBZ O
the DT O
sender NN O
’ NNP O
s VBZ O
number NN O
and CC O
the DT O
message NN O
text NN O
in IN O
base64 JJ O
format NN O
to TO O
the DT O
cybercriminal NN O
: : O
Thus RB O
, , O
Asacub NNP B-Malware
can MD O
withdraw VB O
funds NNS O
from IN O
a DT O
bank NN O
card NN O
linked VBN O
to TO O
the DT O
phone NN O
by IN O
sending VBG O
SMS NNP O
for IN O
the DT O
transfer NN O
of IN O
funds NNS O
to TO O
another DT O
account NN O
using VBG O
the DT O
number NN O
of IN O
the DT O
card NN O
or CC O
mobile JJ O
phone NN O
. . O

Moreover RB O
, , O
the DT O
Trojan NNP O
intercepts NNS O
SMS NNP O
from IN O
the DT O
bank NN O
that WDT O
contain VBP O
one-time JJ O
passwords NNS O
and CC O
information NN O
about IN O
the DT O
balance NN O
of IN O
the DT O
linked VBN O
bank NN O
card NN O
. . O

Some DT O
versions NNS O
of IN O
the DT O
Trojan NNP O
can MD O
autonomously RB O
retrieve VB O
confirmation NN O
codes NNS O
from IN O
such JJ O
SMS NNP O
and CC O
send VB O
them PRP O
to TO O
the DT O
required JJ O
number NN O
. . O

What WP O
’ VBD O
s PRP O
more RBR O
, , O
the DT O
user NN O
can MD O
not RB O
check VB O
the DT O
balance NN O
via IN O
mobile JJ O
banking NN O
or CC O
change NN O
any DT O
settings NNS O
there RB O
, , O
because IN O
after IN O
receiving VBG O
the DT O
command NN O
with IN O
code NN O
40 CD O
, , O
the DT O
Trojan NNP O
prevents VBZ O
the DT O
banking NN O
app NN O
from IN O
running VBG O
on IN O
the DT O
phone NN O
. . O

User NNP O
messages NNS O
created VBN O
by IN O
the DT O
Trojan NNP O
during IN O
installation NN O
typically RB O
contain JJ O
grammatical JJ O
and CC O
spelling JJ O
errors NNS O
, , O
and CC O
use VB O
a DT O
mixture NN O
of IN O
Cyrillic NNP O
and CC O
Latin NNP O
characters NNS O
. . O

The DT O
Trojan NNP O
also RB O
employs VBZ O
various JJ O
obfuscation NN O
methods NNS O
: : O
from IN O
the DT O
simplest JJS O
, , O
such JJ O
as IN O
string VBG O
concatenation NN O
and CC O
renaming NN O
of IN O
classes NNS O
and CC O
methods NNS O
, , O
to TO O
implementing VBG O
functions NNS O
in IN O
native JJ O
code NN O
and CC O
embedding VBG O
SO NNP O
libraries NNS O
in IN O
C/C++ NNP O
in IN O
the DT O
APK NNP O
file NN O
, , O
which WDT O
requires VBZ O
the DT O
use NN O
of IN O
additional JJ O
tools NNS O
or CC O
dynamic JJ O
analysis NN O
for IN O
deobfuscation NN O
, , O
since IN O
most JJS O
tools NNS O
for IN O
static JJ O
analysis NN O
of IN O
Android NNP O
apps NN O
support NN O
only RB O
Dalvik NNP O
bytecode NN O
. . O

In IN O
some DT O
versions NNS O
of IN O
Asacub NNP B-Malware
, , O
strings NNS O
in IN O
the DT O
app NN O
are VBP O
encrypted VBN O
using VBG O
the DT O
same JJ O
algorithm NN O
as IN O
data NNS O
sent VBD O
to TO O
C NNP O
& CC O
C NNP O
, , O
but CC O
with IN O
different JJ O
keys NNS O
. . O

Example NN O
of IN O
using VBG O
native JJ O
code NN O
for IN O
obfuscation NN O
Examples NNS O
of IN O
using VBG O
string VBG O
concatenation NN O
for IN O
obfuscation NN O
Example NNP O
of IN O
encrypting VBG O
strings NNS O
in IN O
the DT O
Trojan NNP O
Asacub NNP B-Malware
distribution NN O
geography NN O
Asacub NNP B-Malware
is VBZ O
primarily RB O
aimed VBN O
at IN O
Russian JJ O
users NNS O
: : O
98 CD O
% NN O
of IN O
infections NNS O
( ( O
225,000 CD O
) ) O
occur NN O
in IN O
Russia NNP O
, , O
since IN O
the DT O
cybercriminals NNS O
specifically RB O
target VBP O
clients NNS O
of IN O
a DT O
major JJ O
Russian JJ O
bank NN O
. . O

The DT O
Trojan NNP O
also RB O
hit VBD O
users NNS O
from IN O
Ukraine NNP O
, , O
Turkey NNP O
, , O
Germany NNP O
, , O
Belarus NNP O
, , O
Poland NNP O
, , O
Armenia NNP O
, , O
Kazakhstan NNP O
, , O
the DT O
US NNP O
, , O
and CC O
other JJ O
countries NNS O
. . O

Conclusion NN O
The DT O
case NN O
of IN O
Asacub NNP B-Malware
shows VBZ O
that IN O
mobile JJ O
malware NN O
can MD O
function VB O
for IN O
several JJ O
years NNS O
with IN O
minimal JJ O
changes NNS O
to TO O
the DT O
distribution NN O
scheme NN O
. . O

It PRP O
is VBZ O
basically RB O
SMS JJ O
spam NN O
: : O
many JJ O
people NNS O
still RB O
follow VBP O
suspicious JJ O
links NNS O
, , O
install JJ O
software NN O
from IN O
third-party JJ O
sources NNS O
, , O
and CC O
give VB O
permissions NNS O
to TO O
apps VB O
without IN O
a DT O
second JJ O
thought NN O
. . O

At IN O
the DT O
same JJ O
time NN O
, , O
cybercriminals NNS O
are VBP O
reluctant JJ O
to TO O
change VB O
the DT O
method NN O
of IN O
communication NN O
with IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
, , O
since IN O
this DT O
would MD O
require VB O
more JJR O
effort NN O
and CC O
reap VB O
less JJR O
benefit NN O
than IN O
modifying VBG O
the DT O
executable JJ O
file NN O
. . O

The DT O
most RBS O
significant JJ O
change NN O
in IN O
this DT O
particular JJ O
Trojan NNP O
’ NNP O
s VBD O
history NN O
was VBD O
the DT O
encryption NN O
of IN O
data NNS O
sent NN O
between IN O
the DT O
device NN O
and CC O
C NNP O
& CC O
C NNP O
. . O

That DT O
said VBD O
, , O
so RB O
as IN O
to TO O
hinder VB O
detection NN O
of IN O
new JJ O
versions NNS O
, , O
the DT O
Trojan NNP O
’ NNP O
s VBD O
APK NNP O
file NN O
and CC O
the DT O
C NNP O
& CC O
C NNP O
server NN O
domains NNS O
are VBP O
changed VBN O
regularly RB O
, , O
and CC O
the DT O
Trojan NNP O
download NN O
links NNS O
are VBP O
often RB O
one-time-use JJ O
. . O

IOCs NNP O
C NNP O
& CC O
C NNP O
IP NNP O
addresses VBZ O
: : O
155.133.82.181 CD B-Indicator
155.133.82.240 CD B-Indicator
155.133.82.244 CD B-Indicator
185.234.218.59 CD B-Indicator
195.22.126.160 CD B-Indicator
195.22.126.163 CD B-Indicator
195.22.126.80 CD B-Indicator
195.22.126.81 CD B-Indicator
5.45.73.24 CD B-Indicator
5.45.74.130 CD B-Indicator
IP NNP I-Indicator
addresses NNS I-Indicator
from IN O
which WDT O
the DT O
Trojan NNP O
was VBD O
downloaded VBN O
: : O
185.174.173.31 CD B-Indicator
185.234.218.59 CD B-Indicator
188.166.156.110 CD B-Indicator
195.22.126.160 CD B-Indicator
195.22.126.80 CD B-Indicator
195.22.126.81 CD B-Indicator

195.22.126.82 CD B-Indicator
195.22.126.83 CD B-Indicator
SHA256 NN O
: : O
158c7688877853ffedb572ccaa8aa9eff47fa379338151f486e46d8983ce1b67 CD B-Indicator
3aedbe7057130cf359b9b57fa533c2b85bab9612c34697585497734530e7457d CD B-Indicator
f3ae6762df3f2c56b3fe598a9e3ff96ddf878c553be95bacbd192bd14debd637 NN B-Indicator
df61a75b7cfa128d4912e5cb648cfc504a8e7b25f6c83ed19194905fef8624c8 NN B-Indicator

c0cfd462ab21f6798e962515ac0c15a92036edd3e2e63639263bf2fd2a10c184 NN B-Indicator
d791e0ce494104e2ae0092bb4adc398ce740fef28fa2280840ae7f61d4734514 VBZ B-Indicator
38dcec47e2f4471b032a8872ca695044ddf0c61b9e8d37274147158f689d65b9 CD B-Indicator
27cea60e23b0f62b4b131da29fdda916bc4539c34bb142fb6d3f8bb82380fe4c CD B-Indicator

31edacd064debdae892ab0bc788091c58a03808997e11b6c46a6a5de493ed25d CD B-Indicator
87ffec0fe0e7a83e6433694d7f24cfde2f70fc45800aa2acb8e816ceba428951 CD B-Indicator
eabc604fe6b5943187c12b8635755c303c450f718cc0c8e561df22a27264f101 JJ B-Indicator
Kernel NNP O
Backdoor NNP O
found VBD O
in IN O
Gadgets NNS O
Powered VBN O
by IN O
Popular NNP O
Chinese NNP O
ARM NNP B-System

Maker NNP O
May NNP O
12 CD O
, , O
2016 CD O
Mohit NNP O
Kumar NNP O
How NNP O
to TO O
Hack VB O
an DT O
Android NNP B-System
device NN O
? . O

It PRP O
is VBZ O
possibly RB O
one CD O
of IN O
the DT O
most RBS O
frequently RB O
asked VBN O
questions NNS O
on IN O
the DT O
Internet NNP O
. . O

Although IN O
it PRP O
's VBZ O
not RB O
pretty RB O
simple JJ O
to TO O
hack VB O
Android NNP B-System
devices NNS O
and CC O
gadgets NNS O
, , O
sometimes RB O
you PRP O
just RB O
get VB O
lucky JJ O
to TO O
find VB O
a DT O
backdoor JJ O
access NN O
. . O

Thanks NNS O
to TO O
Allwinner NNP B-Organization
, , O
a DT O
Chinese JJ O
ARM NNP B-System
system-on-a-chip NN O
maker NN O
, , O
which WDT O
has VBZ O
recently RB O
been VBN O
caught VBN O
shipping VBG O
a DT O
version NN O
of IN O
Linux NNP B-System
Kernel NNP O
with IN O
an DT O
incredibly RB O
simple JJ O
and CC O
easy-to-use JJ O
built-in JJ O
backdoor NN O
. . O

Chinese JJ O
fabless NN O
semiconductor NN O
company NN O
Allwinner NNP B-Organization
is VBZ O
a DT O
leading VBG O
supplier NN O
of IN O
application NN O
processors NNS O
that WDT O
are VBP O
used VBN O
in IN O
many JJ O
low-cost JJ O
Android NNP B-System
tablets NNS O
, , O
ARM-based JJ B-Organization
PCs NNS O
, , O
set-top JJ O
boxes NNS O
, , O
and CC O
other JJ O
electronic JJ O
devices NNS O
worldwide RB O
. . O

Simple JJ O
Backdoor NNP O
Exploit NNP O
to TO O
Hack NNP O
Android NNP B-System
Devices NNPS O
All NNP O
you PRP O
need VBP O
to TO O
do VB O
to TO O
gain VB O
root JJ O
access NN O
of IN O
an DT O
affected JJ O
Android NNP B-System
device NN O
is… NN O
Send NNP O
the DT O
text NN O
" NN O
rootmydevice NN O
'' '' O
to TO O
any DT O
undocumented JJ O
debugging NN O
process NN O
. . O

The DT O
local JJ O
privileges NNS O
escalation VBP O
backdoor JJ O
code NN O
for IN O
debugging VBG O
ARM-powered NNP B-System
Android NNP B-System
devices NNS O
managed VBD O
to TO O
make VB O
its PRP$ O
way NN O
in IN O
shipped VBN O
firmware NN O
after IN O
firmware NN O
makers NNS O
wrote VBD O
their PRP$ O
own JJ O
kernel NN O
code NN O
underneath IN O
a DT O
custom NN O
Android NNP B-System
build NN O
for IN O
their PRP$ O
devices NNS O
, , O
though IN O
the DT O
mainstream NN O
kernel NN O
source NN O
is VBZ O
unaffected VBN O
. . O

The DT O
backdoor NN O
code NN O
is VBZ O
believed VBN O
to TO O
have VB O
been VBN O
left VBN O
by IN O
mistake NN O
by IN O
the DT O
authors NNS O
after IN O
completing VBG O
the DT O
debugging NN O
process NN O
. . O

For IN O
exploiting VBG O
this DT O
issue NN O
, , O
any DT O
process NN O
running VBG O
with IN O
any DT O
UID NNP O
can MD O
be VB O
converted VBN O
into IN O
root NN O
easily RB O
by IN O
simply RB O
using VBG O
the DT O
following JJ O
command NN O
: : O
echo JJ O
" NN O
rootmydevice NN B-Indicator
'' '' O
> CC I-Indicator
/proc/sunxi_debug/sunxi_debug VB I-Indicator
The DT O
Linux NNP B-Indicator
3.4-sunxi JJ I-Indicator
kernel NN O
was VBD O
originally RB O
designed VBN O
to TO O
support VB O
the DT O
Android NNP B-System
operating NN O
system NN O
on IN O
Allwinner NNP B-Organization
ARM NNP B-System
for IN O
tablets NNS O
, , O
but CC O
later RB O
it PRP O
was VBD O
used VBN O
to TO O
port VB O
Linux NNP B-System
to TO O
many JJ O
Allwinner NNP B-Organization
processors NNS O
on IN O
boards NNS O
like IN O
Banana NNP B-System
Pi NNP I-System
micro-PCs NN I-System
, , O
Orange NNP B-System
Pi NNP I-System
, , O
and CC O
other JJ O
devices NNS O
. . O

At IN O
the DT O
forum NN O
of IN O
the DT O
Armbian NNP B-System
operating NN O
system NN O
, , O
a DT O
moderator NN O
who WP O
goes VBZ O
by IN O
the DT O
name NN O
Tkaiser NNP O
noted VBD O
that IN O
the DT O
backdoor NN O
code NN O
could MD O
remotely RB O
be VB O
exploitable JJ O
" JJ O
if IN O
combined VBN O
with IN O
networked JJ O
services NNS O
that WDT O
might MD O
allow VB O
access NN O
to TO O
/proc VB B-Indicator
. . O

'' '' O
This DT O
security NN O
hole NN O
is VBZ O
currently RB O
present JJ O
in IN O
every DT O
operating NN O
system NN O
image NN O
for IN O
A83T NNP B-System
, , O
H3 NNP B-System
or CC O
H8 NNP B-System
devices NNS O
that WDT O
rely VBP O
on IN O
kernel NNS B-System
3.4 CD I-System
, , O
he PRP O
added VBD O
. . O

This DT O
blunder NN O
made VBN O
by IN O
the DT O
company NN O
has VBZ O
been VBN O
frustrating VBG O
to TO O
many JJ O
developers NNS O
. . O

Allwinner NNP B-Organization
has VBZ O
also RB O
been VBN O
less RBR O
transparent JJ O
about IN O
the DT O
backdoor NN O
code NN O
. . O

David NNP O
Manouchehri NNP O
released VBD O
the DT O
information NN O
about IN O
the DT O
backdoor NN O
through IN O
its PRP$ O
own JJ O
Github NNP B-Organization
account NN O
( ( O
Pastebin NNP B-Organization
) ) O
and CC O
then RB O
apparently RB O
deleted VBD O
it PRP O
. . O

Mobile NNP O
Malware NNP O
Evolution NNP O
: : O
2013 CD O
24 CD O
FEB NNP O
2014 CD O
The DT O
mobile JJ O
malware NN O
sector NN O
is VBZ O
growing VBG O
rapidly RB O
both DT O
technologically RB O
and CC O
structurally RB O
. . O

It PRP O
is VBZ O
safe JJ O
to TO O
say VB O
that IN O
today NN O
’ NNP O
s NN O
cybercriminal NN O
is VBZ O
no RB O
longer RBR O
a DT O
lone NN O
hacker NN O
but CC O
part NN O
of IN O
a DT O
serious JJ O
business NN O
operation NN O
. . O

There EX O
are VBP O
various JJ O
types NNS O
of IN O
actors NNS O
involved VBN O
in IN O
the DT O
mobile JJ O
malware NN O
industry NN O
: : O
virus NN O
writers NNS O
, , O
testers NNS O
, , O
interface NN O
designers NNS O
of IN O
both DT O
the DT O
malicious JJ O
apps NN O
and CC O
the DT O
web NN O
pages NNS O
they PRP O
are VBP O
distributed VBN O
from IN O
, , O
owners NNS O
of IN O
the DT O
partner NN O
programs NNS O
that WDT O
spread VBP O
the DT O
malware NN O
, , O
and CC O
mobile JJ O
botnet NN O
owners NNS O
. . O

This DT O
division NN O
of IN O
labor NN O
among IN O
the DT O
cybercriminals NNS O
can MD O
also RB O
be VB O
seen VBN O
in IN O
the DT O
behavior NN O
of IN O
their PRP$ O
Trojans NNPS O
. . O

In IN O
2013 CD O
, , O
there EX O
was VBD O
evidence NN O
of IN O
cooperation NN O
( ( O
most RBS O
probably RB O
on IN O
a DT O
commercial JJ O
basis NN O
) ) O
between IN O
different JJ O
groups NNS O
of IN O
virus NN O
writers NNS O
. . O

For IN O
example NN O
, , O
the DT O
botnet NN O
Trojan-SMS.AndroidOS.Opfake.a NNP B-Malware
, , O
in IN O
addition NN O
to TO O
its PRP$ O
own JJ O
activity NN O
, , O
also RB O
spread VBP O
Backdoor.AndroidOS.Obad.a NNP B-Malware
by IN O
sending VBG O
spam NN O
containing VBG O
a DT O
link NN O
to TO O
the DT O
malware NN O
to TO O
the DT O
victim NN O
’ NNP O
s JJ O
list NN O
of IN O
contacts NNS O
. . O

It PRP O
is VBZ O
now RB O
clear JJ O
that IN O
a DT O
distinct JJ O
industry NN O
has VBZ O
developed VBN O
and CC O
is VBZ O
becoming VBG O
more RBR O
focused JJ O
on IN O
extracting VBG O
profits NNS O
, , O
which WDT O
is VBZ O
clearly RB O
evident JJ O
from IN O
the DT O
functionality NN O
of IN O
the DT O
malware NN O
. . O

2013 CD O
in IN O
figures NNS O
A NNP O
total NN O
of IN O
143,211 CD O
new JJ O
modifications NNS O
of IN O
malicious JJ O
programs NNS O
targeting VBG O
mobile JJ O
devices NNS O
were VBD O
detected VBN O
in IN O
all DT O
of IN O
2013 CD O
( ( O
as IN O
of IN O
January NNP O
1 CD O
, , O
2014 CD O
) ) O
. . O

In IN O
2013 CD O
, , O
3,905,502 CD O
installation NN O
packages NNS O
were VBD O
used VBN O
by IN O
cybercriminals NNS O
to TO O
distribute VB O
mobile JJ O
malware NN O
. . O

Overall JJ O
in IN O
2012-2013 JJ O
we PRP O
detected VBD O
approximately RB O
10,000,000 CD O
unique JJ O
malicious JJ O
installation NN O
packages NNS O
: : O
Different NNP O
installation NN O
packages NNS O
can MD O
install VB O
programs NNS O
with IN O
the DT O
same JJ O
functionality NN O
that WDT O
differ VBZ O
only RB O
in IN O
terms NNS O
of IN O
the DT O
malicious JJ O
app NN O
interface NN O
and CC O
, , O
for IN O
instance NN O
, , O
the DT O
content NN O
of IN O
the DT O
text NN O
messages VBZ O
it PRP O
spreads VBZ O
. . O

Android NNP B-System
remains VBZ O
a DT O
prime JJ O
target NN O
for IN O
malicious JJ O
attacks NNS O
. . O

98.05 CD O
% NN O
of IN O
all DT O
malware NN O
detected VBN O
in IN O
2013 CD O
targeted VBD O
this DT O
platform NN O
, , O
confirming VBG O
both PDT O
the DT O
popularity NN O
of IN O
this DT O
mobile JJ O
OS NNP O
and CC O
the DT O
vulnerability NN O
of IN O
its PRP$ O
architecture NN O
. . O

Most JJS O
mobile JJ O
malware NN O
is VBZ O
designed VBN O
to TO O
steal VB O
users NNS O
’ NNP O
money NN O
, , O
including VBG O
SMS-Trojans NNS O
, , O
and CC O
lots NNS O
of IN O
backdoors NNS O
and CC O
Trojans NNPS O
. . O

Over IN O
the DT O
year NN O
, , O
the DT O
number NN O
of IN O
mobile JJ O
malware NN O
modifications NNS O
designed VBN O
for IN O
phishing NN O
, , O
the DT O
theft NN O
of IN O
credit NN O
card NN O
information NN O
and CC O
money NN O
increased VBN O
by IN O
a DT O
factor NN O
of IN O
19.7 CD O
. . O

In IN O
2013 CD O
, , O
Kaspersky NNP B-Organization
Lab NNP I-Organization
mobile NN O
products NNS O
prevented VBD O
2,500 CD O
infections NNS O
by IN O
banking VBG O
Trojans NNS O
. . O

Methods NNS O
and CC O
techniques NNS O
2013 CD O
not RB O
only RB O
saw VBD O
a DT O
radical JJ O
increase NN O
in IN O
output NN O
from IN O
mobile JJ O
virus NN O
writers NNS O
but CC O
also RB O
saw VBD O
them PRP O
actively RB O
applying VBG O
methods NNS O
and CC O
technologies NNS O
that WDT O
allowed VBD O
cybercriminals NNS O
to TO O
use VB O
their PRP$ O
malware NN O
more RBR O
effectively RB O
. . O

There EX O
were VBD O
several JJ O
distinct JJ O
areas NNS O
where WRB O
mobile NN O
malware NN O
underwent JJ O
advances NNS O
. . O

Distribution NN O
Cybercriminals NNS O
made VBN O
use NN O
of IN O
some DT O
exceptionally RB O
sophisticated JJ O
methods NNS O
to TO O
infect VB O
mobile JJ O
devices NNS O
. . O

Infecting VBG O
legal JJ O
web NN O
resources NNS O
help VBP O
spread VB O
mobile JJ O
malware NN O
via IN O
popular JJ O
websites NNS O
. . O

More JJR O
and CC O
more JJR O
smartphone NN O
and CC O
tablet NN O
owners NNS O
use VBP O
their PRP$ O
devices NNS O
to TO O
access NN O
websites NNS O
, , O
unaware VBP O
that IN O
even RB O
the DT O
most RBS O
reputable JJ O
resources NNS O
can MD O
be VB O
hacked VBN O
. . O

According VBG O
to TO O
our PRP$ O
data NNS O
, , O
0.4 CD O
% NN O
of IN O
the DT O
websites NNS O
visited VBN O
by IN O
users NNS O
of IN O
our PRP$ O
products NNS O
were VBD O
compromised VBN O
sites NNS O
. . O

Distribution NNP O
via IN O
alternative JJ O
app NN O
stores NNS O
. . O

In IN O
Asia NNP O
there EX O
are VBP O
numerous JJ O
companies NNS O
producing VBG O
Android-based JJ B-System
devices NNS O
and CC O
Android NNP B-System
apps NN O
, , O
and CC O
many JJ O
of IN O
them PRP O
offer VBP O
users NNS O
their PRP$ O
own JJ O
app NN O
stores NNS O
containing VBG O
programs NNS O
that WDT O
can MD O
not RB O
be VB O
found VBN O
in IN O
Google NNP B-System
Play NNP I-System
. . O

The DT O
purely JJ O
nominal JJ O
control NN O
over IN O
the DT O
applications NNS O
uploaded VBD O
to TO O
these DT O
stores NNS O
means VBZ O
attackers NNS O
can MD O
conceal VB O
Trojans NNPS O
in IN O
apps NN O
made VBN O
to TO O
look VB O
like IN O
innocent JJ O
games NNS O
or CC O
utilities NNS O
. . O

Distribution NN O
via IN O
botnets NNS O
. . O

As IN O
a DT O
rule NN O
, , O
bots NNS O
self-proliferate JJ O
by IN O
sending VBG O
out RP O
text JJ O
messages NNS O
with IN O
a DT O
malicious JJ O
link NN O
to TO O
addresses NNS O
in IN O
the DT O
victim NN O
’ NNP O
s NN O
address NN O
book NN O
. . O

We PRP O
also RB O
registered VBD O
one CD O
episode NN O
of IN O
mobile JJ O
malware NN O
spreading VBG O
via IN O
a DT O
third-party JJ O
botnet NN O
. . O

Resistance NN O
to TO O
anti-malware JJ O
protection NN O
The DT O
ability NN O
of IN O
malicious JJ O
software NN O
to TO O
operate VB O
continuously RB O
on IN O
the DT O
victim NN O
’ NNP O
s NN O
mobile JJ O
device NN O
is VBZ O
an DT O
important JJ O
aspect NN O
of IN O
its PRP$ O
development NN O
. . O

The DT O
longer RBR O
a DT O
Trojan NNP O
“ NNP O
lives VBZ O
” NNP O
on IN O
a DT O
smartphone NN O
, , O
the DT O
more JJR O
money NN O
it PRP O
will MD O
make VB O
for IN O
the DT O
owner NN O
. . O

This DT O
is VBZ O
an DT O
area NN O
where WRB O
virus NN O
writers NNS O
are VBP O
actively RB O
working VBG O
, , O
resulting VBG O
in IN O
a DT O
large JJ O
number NN O
of IN O
technological JJ O
innovations NNS O
. . O

Criminals NNS O
are VBP O
increasingly RB O
using VBG O
obfuscation NN O
, , O
the DT O
deliberate NN O
act NN O
of IN O
creating VBG O
complex JJ O
code NN O
to TO O
make VB O
it PRP O
difficult JJ O
to TO O
analyze VB O
. . O

The DT O
more RBR O
complex JJ O
the DT O
obfuscation NN O
, , O
the DT O
longer JJR O
it PRP O
will MD O
take VB O
an DT O
antivirus JJ O
solution NN O
to TO O
neutralize VB O
the DT O
malicious JJ O
code NN O
. . O

Tellingly RB O
, , O
current JJ O
virus NN O
writers NNS O
have VBP O
mastered VBN O
commercial JJ O
obfuscators NNS O
. . O

This DT O
implies VBZ O
they PRP O
have VBP O
made VBN O
considerable JJ O
investments NNS O
. . O

For IN O
example NN O
, , O
one CD O
commercial JJ O
obfuscator NN O
, , O
which WDT O
cost NN O
€350 NN O
, , O
was VBD O
used VBN O
for IN O
Trojans NNPS O
and CC O
Opfak.bo NNP B-Malware
Obad.a NNP I-Malware
Android NNP O
vulnerabilities NNS O
are VBP O
used VBN O
by IN O
criminals NNS O
for IN O
three CD O
reasons NNS O
: : O
to TO O
bypass VB O
the DT O
code NN O
integrity NN O
check NN O
when WRB O
installing VBG O
an DT O
application NN O
( ( O
vulnerability NN O
Master NNP O
Key NNP O
) ) O
; : O
to TO O
enhance VB O
the DT O
rights NNS O
of IN O
malicious JJ O
applications NNS O
, , O
considerably RB O
extending VBG O
their PRP$ O
capabilities NNS O
; : O
and CC O
to TO O
make VB O
it PRP O
more RBR O
difficult JJ O
to TO O
remove VB O
malware NN O
. . O

For IN O
example NN O
, , O
Svpeng NNP B-Malware
uses VBZ O
a DT O
previously RB O
unknown JJ O
vulnerability NN O
to TO O
protect VB O
itself PRP O
from IN O
being VBG O
removed VBN O
manually RB O
or CC O
by IN O
the DT O
antivirus JJ O
program NN O
. . O

Cybercriminals NNS O
also RB O
exploit VBP O
the DT O
Master NNP B-Vulnerability
Key NNP I-Vulnerability
vulnerability NN I-Vulnerability
and CC O
have VBP O
learned VBN O
to TO O
embed VB O
unsigned JJ O
executable JJ O
files NNS O
in IN O
Android NNP B-System
installation NN O
packages NNS O
. . O

Digital NNP O
signature NN O
verification NN O
can MD O
be VB O
bypassed VBN O
by IN O
giving VBG O
the DT O
malicious JJ O
file NN O
exactly RB O
the DT O
same JJ O
name NN O
as IN O
a DT O
legitimate JJ O
file NN O
and CC O
placing VBG O
it PRP O
on IN O
the DT O
same JJ O
level NN O
in IN O
the DT O
archive NN O
. . O

The DT O
system NN O
verifies VBZ O
the DT O
signature NN O
of IN O
the DT O
legitimate JJ O
file NN O
while IN O
installing VBG O
the DT O
malicious JJ O
file NN O
. . O

Unfortunately RB O
, , O
there EX O
is VBZ O
a DT O
specific JJ O
feature NN O
of IN O
Android NNP O
vulnerabilities NNS O
that WDT O
means VBZ O
it PRP O
is VBZ O
only RB O
possible JJ O
to TO O
get VB O
rid JJ O
of IN O
them PRP O
by IN O
receiving VBG O
an DT O
update NN O
from IN O
the DT O
device NN O
manufacturers NNS O
. . O

However RB O
, , O
many JJ O
users NNS O
are VBP O
in IN O
no DT O
hurry NN O
to TO O
update VB O
the DT O
operating NN O
systems NNS O
of IN O
their PRP$ O
products NNS O
. . O

If IN O
a DT O
smartphone NN O
or CC O
tablet NN O
was VBD O
released VBN O
more JJR O
than IN O
a DT O
year NN O
ago RB O
, , O
it PRP O
is VBZ O
probably RB O
no RB O
longer RB O
supported VBN O
by IN O
the DT O
manufacturer NN O
and CC O
patching NN O
of IN O
vulnerabilities NNS O
is VBZ O
no DT O
longer RB O
provided VBN O
. . O

In IN O
that DT O
case NN O
, , O
the DT O
only JJ O
help NN O
comes VBZ O
from IN O
an DT O
antivirus JJ O
solution NN O
, , O
for IN O
example NN O
, , O
Kaspersky NNP B-System
Internet NNP I-System
Security NNP I-System
for IN O
Android NNP B-System
. . O

Embedding VBG O
malicious JJ O
code NN O
in IN O
legitimate JJ O
programs NNS O
helps VBZ O
conceal JJ O
infections NNS O
from IN O
the DT O
victim NN O
. . O

Of IN O
course NN O
, , O
this DT O
does VBZ O
not RB O
mean VB O
the DT O
digital JJ O
signature NN O
of IN O
the DT O
software NN O
developer NN O
can MD O
be VB O
used VBN O
. . O

However RB O
, , O
due JJ O
to TO O
the DT O
absence NN O
of IN O
certification NN O
centers NNS O
verifying VBG O
the DT O
digital JJ O
signatures NNS O
of IN O
Android NNP O
programs NNS O
, , O
nothing NN O
prevents NNS O
criminals NNS O
from IN O
adding VBG O
their PRP$ O
own JJ O
signature NN O
. . O

As IN O
a DT O
result NN O
, , O
a DT O
copy NN O
of IN O
Angry JJ B-System
Birds NNS I-System
installed VBN O
from IN O
an DT O
unofficial JJ O
app NN O
store NN O
or CC O
downloaded VBN O
from IN O
a DT O
forum NN O
could MD O
easily RB O
contain VB O
malicious JJ O
functionality NN O
. . O

Capabilities NNS O
and CC O
functionality NN O
In IN O
2013 CD O
, , O
we PRP O
detected VBD O
several JJ O
technological JJ O
innovations NNS O
developed VBD O
and CC O
used VBN O
by IN O
criminals NNS O
in IN O
their PRP$ O
malicious JJ O
software NN O
. . O

Below IN O
are VBP O
descriptions NNS O
of IN O
some DT O
of IN O
the DT O
most RBS O
interesting JJ O
. . O

Control NN O
of IN O
malware NN O
from IN O
a DT O
single JJ O
center NN O
provides VBZ O
maximum JJ O
flexibility NN O
. . O

Botnets NNS O
can MD O
make VB O
considerably RB O
more JJR O
money NN O
than IN O
autonomous JJ O
Trojans NNPS O
. . O

It PRP O
comes VBZ O
as IN O
no DT O
surprise NN O
then RB O
that IN O
many JJ O
SMS-Trojans NNS O
include VBP O
bot JJ O
functionality NN O
. . O

According VBG O
to TO O
our PRP$ O
estimates NNS O
, , O
about RB O
60 CD O
% NN O
of IN O
mobile JJ O
malware NN O
are VBP O
elements NNS O
of IN O
both DT O
large JJ O
and CC O
small JJ O
mobile JJ O
botnets NNS O
. . O

By IN O
using VBG O
Google NNP B-System
Cloud NNP I-System
Messaging NNP I-System
botnet NN O
owners NNS O
can MD O
operate VB O
without IN O
a DT O
C NNP O
& CC O
C NNP O
server NN O
, , O
thus RB O
eliminating VBG O
the DT O
threat NN O
of IN O
the DT O
botnet NN O
being VBG O
detected VBN O
and CC O
blocked VBN O
by IN O
law NN O
enforcement NN O
authorities NNS O
. . O

Google NNP B-System
Cloud NNP I-System
Messaging NNP I-System
is VBZ O
designed VBN O
to TO O
send VB O
short JJ O
message NN O
( ( O
up IN O
to TO O
4 CD O
KB NNP O
) ) O
to TO O
mobile VB O
devices NNS O
via IN O
Google NNP B-Organization
services NNS O
. . O

The DT O
developer NN O
simply RB O
has VBZ O
to TO O
register VB O
and CC O
receive VB O
a DT O
unique JJ O
ID NNP O
for IN O
his PRP$ O
applications NNS O
. . O

The DT O
commands NNS O
received VBD O
via IN O
GCM NNP B-System
can MD O
not RB O
be VB O
blocked VBN O
immediately RB O
on IN O
an DT O
infected JJ O
device NN O
. . O

We PRP O
have VBP O
detected VBN O
several JJ O
malicious JJ O
programs NNS O
using VBG O
GCM NNP B-System
for IN O
command NN O
and CC O
control NN O
– VBP O
the DT O
widespread JJ O
Trojan-SMS.AndroidOS.FakeInst.a NNP B-Malware
, , O
Trojan-SMS.AndroidOS.Agent.ao NNP B-Malware
, , O
and CC O
Trojan-SMS.AndroidOS.OpFake.a NNP B-Malware
among IN O
others NNS O
. . O

Google NNP B-Organization
is VBZ O
actively RB O
combating VBG O
this DT O
use NN O
of IN O
the DT O
service NN O
, , O
responding VBG O
quickly RB O
to TO O
reports NNS O
from IN O
antivirus NN O
companies NNS O
and CC O
blocking VBG O
the DT O
IDs NNP O
of IN O
cybercriminals NNS O
. . O

Attacks NNS O
on IN O
Windows NNP B-System
XP NNP I-System
allows VBZ O
mobile JJ O
malware NN O
to TO O
infect VB O
a DT O
PC NN O
after IN O
connecting VBG O
a DT O
smartphone NN O
or CC O
tablet NN O
. . O

In IN O
early JJ O
2013 CD O
we PRP O
detected VBD O
two CD O
identical JJ O
applications NNS O
on IN O
Google NNP B-System
Play NNP I-System
that WDT O
were VBD O
allegedly RB O
designed VBN O
for IN O
cleaning VBG O
the DT O
operating NN O
system NN O
of IN O
Android-based JJ B-System
devices NNS O
from IN O
unnecessary JJ O
processes NNS O
. . O

In IN O
fact NN O
, , O
the DT O
applications NNS O
are VBP O
designed VBN O
to TO O
download VB O
the DT O
autorun.inf NN B-Indicator
file NN I-Indicator
, , O
an DT O
icon NN O
file NN O
and CC O
the DT O
win32-Trojan JJ B-System
file NN O
, , O
which WDT O
the DT O
mobile JJ O
malicious JJ O
program NN O
locates NNS O
in IN O
the DT O
root NN O
directory NN O
of IN O
an DT O
SD NNP B-System
card NN I-System
. . O

On IN O
connecting VBG O
a DT O
smartphone NN O
in IN O
the DT O
USB NNP B-System
drive NN I-System
emulation NN O
mode NN O
to TO O
a DT O
computer NN O
running VBG O
Windows NNP B-System
XP NNP I-System
, , O
the DT O
system NN O
automatically RB O
starts VBZ O
the DT O
Trojan NNP O
( ( O
if IN O
AutoPlay NNP O
on IN O
the DT O
external JJ O
media NNS O
is VBZ O
not RB O
disabled VBN O
) ) O
and CC O
is VBZ O
infected VBN O
. . O

The DT O
Trojan NNP O
allows VBZ O
the DT O
criminals NNS O
to TO O
remotely VB O
control VB O
the DT O
victim NN O
’ NNP O
s NN O
computer NN O
and CC O
is VBZ O
capable JJ O
of IN O
recording VBG O
sound NN O
from IN O
a DT O
microphone NN O
. . O

We PRP O
would MD O
like VB O
to TO O
emphasize VB O
that IN O
this DT O
method NN O
of IN O
attack NN O
only RB O
works VBZ O
on IN O
Windows NNP B-System
XP NNP I-System
and CC O
Android NNP B-System
versions NNS O
prior RB O
to TO O
2.2 CD O
. . O

The DT O
most RBS O
advanced JJ O
mobile JJ O
malicious JJ O
programs NNS O
today NN O
are VBP O
Trojans NNPS O
targeting VBG O
users NNS O
’ NNP O
bank NN O
accounts NNS O
– VBP O
the DT O
most RBS O
attractive JJ O
source NN O
of IN O
criminal JJ O
earnings NNS O
. . O

Trend NN O
of IN O
the DT O
year NN O
: : O
mobile NN O
banking NN O
Trojans NNPS O
2013 CD O
was VBD O
marked VBN O
by IN O
a DT O
rapid JJ O
rise NN O
in IN O
the DT O
number NN O
of IN O
Android NNP B-System
banking NN O
Trojans NNPS O
. . O

The DT O
cyber NN O
industry NN O
of IN O
mobile JJ O
malware NN O
is VBZ O
becoming VBG O
more RBR O
focused JJ O
on IN O
making VBG O
profits NNS O
more RBR O
effectively RB O
, , O
i.e. FW O
, , O
mobile JJ O
phishing NN O
, , O
theft NN O
of IN O
credit NN O
card NN O
information NN O
, , O
money NN O
transfers NNS O
from IN O
bank NN O
cards NNS O
to TO O
mobile VB O
phones NNS O
and CC O
from IN O
phones NNS O
to TO O
the DT O
criminalas NNS O
’ POS O
e-wallets NNS O
. . O

Cybercriminals NNS O
have VBP O
become VBN O
obsessed VBN O
by IN O
this DT O
method NN O
of IN O
illegal JJ O
earnings NNS O
: : O
at IN O
the DT O
beginning NN O
of IN O
the DT O
year NN O
we PRP O
knew VBD O
only RB O
67 CD O
banking NN O
Trojans NNPS O
, , O
but CC O
by IN O
the DT O
end NN O
of IN O
the DT O
year NN O
there EX O
were VBD O
already RB O
1321 CD O
unique JJ O
samples NNS O
. . O

Kaspersky NNP B-System
Lab NNP I-System
mobile NN O
products NNS O
prevented VBD O
2,500 CD O
infections NNS O
by IN O
banking VBG O
Trojans NNS O
. . O

mobile_treats_2013_04s VB O
The DT O
number NN O
of IN O
mobile JJ O
banking NN O
Trojans NNPS O
in IN O
our PRP$ O
collection NN O
Mobile NNP O
banking NN O
Trojans NNPS O
can MD O
run VB O
together RB O
with IN O
Win-32 NNP B-System
Trojans NNPS O
to TO O
bypass VB O
the DT O
two-factor JJ O
authentication NN O
– NNP O
mTAN NN O
theft NN O
( ( O
the DT O
theft NN O
of IN O
banking NN O
verification NN O
codes VBZ O
that IN O
banks NNS O
send VBP O
their PRP$ O
customers NNS O
in IN O
SMS NNP O
messages NNS O
) ) O
. . O

However RB O
, , O
in IN O
2013 CD O
, , O
autonomous JJ O
mobile NN O
banking NN O
Trojans NNPS O
developed VBD O
further RB O
. . O

Currently RB O
, , O
such JJ O
Trojans NNPS O
attack VBP O
a DT O
limited JJ O
number NN O
of IN O
bank NN O
customers NNS O
, , O
but CC O
it PRP O
is VBZ O
expected VBN O
that IN O
cybercriminals NNS O
will MD O
invent VB O
new JJ O
techniques NNS O
that WDT O
will MD O
allow VB O
them PRP O
to TO O
expand VB O
the DT O
number NN O
and CC O
the DT O
geography NN O
of IN O
potential JJ O
victims NNS O
. . O

mobile_treats_2013_05s NN O
Infections NNS O
caused VBN O
by IN O
mobile JJ O
banking NN O
programs NNS O
Today NNP O
, , O
the DT O
majority NN O
of IN O
banking NN O
Trojan NNP O
attacks NNS O
affect VBP O
users NNS O
in IN O
Russia NNP O
and CC O
the DT O
CIS NNP O
. . O

However RB O
, , O
this DT O
situation NN O
will MD O
not RB O
last JJ O
long JJ O
: : O
given VBN O
the DT O
cybercriminals NNS O
’ VBP O
interest NN O
in IN O
user NNP O
bank NN O
accounts NNS O
, , O
the DT O
activity NN O
of IN O
mobile JJ O
banking NN O
Trojans NNPS O
is VBZ O
expected VBN O
to TO O
grow VB O
in IN O
other JJ O
countries NNS O
in IN O
2014 CD O
. . O

As IN O
mentioned VBN O
above IN O
, , O
banking NN O
Trojans NNS O
are VBP O
perhaps RB O
the DT O
most RBS O
complex JJ O
of IN O
all DT O
mobile JJ O
threats NNS O
, , O
and CC O
Svpeng NNP B-Malware
is VBZ O
one CD O
of IN O
the DT O
most RBS O
striking JJ O
examples NNS O
. . O

Svpeng NNP B-Malware
In IN O
mid-July NN O
, , O
we PRP O
detected VBD O
Trojan-SMS.AndroidOS.Svpeng.a NNP B-Malware
which WDT O
, , O
unlike IN O
its PRP$ O
SMS NNP O
Trojan NNP O
counterparts NNS O
, , O
is VBZ O
focused VBN O
on IN O
stealing VBG O
money NN O
from IN O
the DT O
victiim NN O
’ NNP O
s VBD O
bank NN O
account NN O
rather RB O
than IN O
from IN O
his PRP$ O
mobile JJ O
phone NN O
. . O

It PRP O
can MD O
not RB O
act VB O
independently RB O
and CC O
operates VBZ O
strictly RB O
in IN O
accordance NN O
with IN O
commands NNS O
received VBN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

This DT O
malicious JJ O
program NN O
spreads NNS O
via IN O
SMS NNP O
spam NN O
and CC O
from IN O
compromised VBN O
legitimate NN O
sites NNS O
that IN O
redirect VBP O
mobile JJ O
users NNS O
to TO O
a DT O
malicious JJ O
resource NN O
. . O

There EX O
the DT O
user NN O
is VBZ O
prompted VBN O
to TO O
download VB O
and CC O
install VB O
a DT O
Trojan NNP O
imitating VBG O
an DT O
Adobe NNP B-System
Flash NNP I-System
Player NNP I-System
update NN O
. . O

Svpeng NNP B-Malware
is VBZ O
capable JJ O
of IN O
doing VBG O
lots NNS O
of IN O
things NNS O
. . O

It PRP O
collects VBZ O
information NN O
about IN O
the DT O
smartphone NN O
( ( O
IMEI NNP O
, , O
country NN O
, , O
service NN O
provider NN O
, , O
operating VBG O
system NN O
language NN O
) ) O
and CC O
sends VBZ O
it PRP O
to TO O
the DT O
host NN O
via IN O
the DT O
HTTP NNP O
POST NNP O
request NN O
. . O

This DT O
appears VBZ O
to TO O
be VB O
necessary JJ O
to TO O
determine VB O
the DT O
number NN O
of IN O
banks NNS O
the DT O
victim NN O
may MD O
use VB O
. . O

Svpeng NNP B-Malware
is VBZ O
only RB O
currently RB O
attacking VBG O
clients NNS O
of IN O
Russian JJ O
banks NNS O
. . O

Typically RB O
, , O
however RB O
, , O
cybercriminals NNS O
first RB O
test-run VBP O
a DT O
technology NN O
on IN O
the DT O
Russian NNP O
sector NN O
of IN O
the DT O
Internet NNP O
and CC O
then RB O
roll VB O
it PRP O
out RP O
globally RB O
, , O
attacking VBG O
users NNS O
in IN O
other JJ O
countries NNS O
. . O

It PRP O
steals VBZ O
SMS NNP O
messages NNS O
and CC O
information NN O
about IN O
voice NN O
calls NNS O
. . O

It PRP O
helps VBZ O
the DT O
attacker NN O
find VBP O
out RP O
which WDT O
banks NNS O
the DT O
owner NN O
of IN O
the DT O
smartphone NN O
calls VBZ O
– IN O
the DT O
Trojan NNP O
receives VBZ O
a DT O
list NN O
of IN O
bank NN O
phone NN O
numbers NNS O
from IN O
its PRP$ O
C NNP O
& CC O
C NNP O
server NN O
. . O

It PRP O
steals VBZ O
money NN O
from IN O
the DT O
victim NN O
’ NNP O
s VBD O
bank NN O
account NN O
. . O

In IN O
Russia NNP O
, , O
some DT O
major JJ O
banks NNS O
offer VBP O
their PRP$ O
clients NNS O
a DT O
special JJ O
service NN O
that WDT O
allows VBZ O
them PRP O
to TO O
transfer VB O
money NN O
from IN O
their PRP$ O
bank NN O
card NN O
to TO O
their PRP$ O
mobile JJ O
phone NN O
account NN O
. . O

Customers NNS O
have VBP O
to TO O
send VB O
a DT O
set NN O
text JJ O
message NN O
from IN O
their PRP$ O
phone NN O
to TO O
a DT O
specific JJ O
bank NN O
number NN O
. . O

Svpeng NNP B-Malware
sends VBZ O
the DT O
corresponding JJ O
messages NNS O
to TO O
the DT O
SMS NNP O
services NNS O
of IN O
two CD O
banks NNS O
. . O

Svpeng NN B-Malware
does VBZ O
this DT O
to TO O
check VB O
if IN O
the DT O
cards NNS O
from IN O
these DT O
banks NNS O
are VBP O
attached VBN O
to TO O
the DT O
number NN O
of IN O
the DT O
infected JJ O
phone NN O
and CC O
to TO O
find VB O
out RP O
the DT O
account NN O
balance NN O
. . O

If IN O
the DT O
phone NN O
is VBZ O
attached VBN O
to TO O
a DT O
bank NN O
card NN O
, , O
commands NNS O
are VBP O
sent VBN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
with IN O
instructions NNS O
to TO O
transfer VB O
money NN O
from IN O
the DT O
user NN O
’ NNP O
s VBD O
bank NN O
account NN O
to TO O
his/her VB O
mobile JJ O
account NN O
. . O

The DT O
cybercriminals NNS O
then RB O
send VB O
this DT O
money NN O
to TO O
a DT O
digital JJ O
wallet NN O
or CC O
to TO O
a DT O
premium JJ O
number NN O
and CC O
cash NN O
it PRP O
in IN O
. . O

It PRP O
steals VBZ O
logins NNS O
and CC O
passwords NNS O
to TO O
online VB O
banking NN O
accounts NNS O
by IN O
substituting VBG O
he PRP O
window VBD O
displayed VBN O
by IN O
the DT O
bank NN O
application NN O
. . O

Currently RB O
, , O
this DT O
only JJ O
affects VBZ O
Russian JJ O
banks NNS O
, , O
but CC O
the DT O
technology NN O
behind IN O
Svpeng NNP B-Malware
could MD O
easily RB O
be VB O
used VBN O
to TO O
target VB O
other JJ O
banking NN O
applications NNS O
. . O

It PRP O
steals VBZ O
bank NN O
card NN O
information NN O
( ( O
the DT O
number NN O
, , O
the DT O
expiry NN O
date NN O
, , O
CVC2/CVV2 NNP O
) ) O
imitating VBG O
the DT O
process NN O
of IN O
registering VBG O
the DT O
bank NN O
card NN O
with IN O
Google NNP B-System
Play NNP I-System
. . O

If IN O
the DT O
user NN O
has VBZ O
launched VBN O
Play NNP B-System
Market NNP I-System
, , O
the DT O
Trojan NNP O
intercepts VBZ O
the DT O
event NN O
and CC O
displays VBZ O
a DT O
window NN O
on IN O
top NN O
of IN O
the DT O
Google NNP B-System
Play NNP I-System
window NN O
, , O
prompting VBG O
the DT O
user NN O
to TO O
enter VB O
his/her PRP O
bank NN O
card NN O
details NNS O
in IN O
the DT O
fake NN O
window NN O
. . O

The DT O
data NNS O
entered VBN O
by IN O
the DT O
user NN O
is VBZ O
sent VBN O
to TO O
the DT O
cybercriminals NNS O
. . O

mobile_treats_2013_06s NN O
It PRP O
extorts VBZ O
money NN O
from IN O
users NNS O
by IN O
threatening VBG O
to TO O
block VB O
the DT O
smartphone NN O
: : O
it PRP O
displays VBZ O
a DT O
message NN O
demanding VBG O
$ $ O
500 CD O
to TO O
unblock VB O
the DT O
device NN O
. . O

In IN O
actual JJ O
fact NN O
, , O
the DT O
Trojan NNP O
does VBZ O
not RB O
block VB O
anything NN O
and CC O
the DT O
phone NN O
can MD O
be VB O
used VBN O
without IN O
any DT O
problems NNS O
. . O

It PRP O
hides VBZ O
traces NNS O
of IN O
its PRP$ O
activity NN O
by IN O
masking VBG O
the DT O
outgoing NN O
and CC O
incoming VBG O
text JJ O
messages NNS O
and CC O
blocking VBG O
calls NNS O
and CC O
messages NNS O
from IN O
numbers NNS O
belonging VBG O
to TO O
the DT O
bank NN O
. . O

The DT O
Trojan NNP O
gets VBZ O
the DT O
list NN O
of IN O
bank NN O
phone NN O
numbers NNS O
from IN O
its PRP$ O
C NNP O
& CC O
C NNP O
server NN O
. . O

It PRP O
protects VBZ O
itself PRP O
from IN O
deletion NN O
by IN O
requesting VBG O
Device NNP O
Administrator NNP O
rights NNS O
during IN O
the DT O
installation NN O
. . O

As IN O
a DT O
result NN O
, , O
the DT O
Trojan NNP O
delete JJ O
button NN O
in IN O
the DT O
list NN O
of IN O
applications NNS O
becomes NNS O
inactive VBP O
, , O
which WDT O
may MD O
cause VB O
problems NNS O
for IN O
inexperienced JJ O
users NNS O
. . O

It PRP O
is VBZ O
impossible JJ O
to TO O
deprive VB O
it PRP O
of IN O
these DT O
rights NNS O
without IN O
the DT O
use NN O
of IN O
specialized JJ O
tools NNS O
( ( O
such JJ O
as IN O
Kaspersky NNP B-System
Internet NNP I-System
Security NNP I-System
for IN O
Android NNP B-System
) ) O
. . O

To TO O
protect VB O
itself PRP O
from IN O
being VBG O
removed VBN O
, , O
Svpeng NNP B-Malware
uses VBZ O
a DT O
previously RB O
unknown JJ O
vulnerability NN O
in IN O
Android NNP B-System
. . O

It PRP O
uses VBZ O
the DT O
same JJ O
trick NN O
to TO O
prevent VB O
the DT O
smartphone NN O
from IN O
being VBG O
returned VBN O
to TO O
its PRP$ O
factory NN O
settings NNS O
. . O

The DT O
Trojan NNP O
is VBZ O
distributed VBN O
in IN O
Russia NNP O
and CC O
CIS NNP O
countries NNS O
. . O

But CC O
, , O
as IN O
we PRP O
have VBP O
already RB O
mentioned VBN O
, , O
the DT O
criminals NNS O
could MD O
easily RB O
turn VB O
their PRP$ O
attention NN O
to TO O
users NNS O
in IN O
other JJ O
countries NNS O
. . O

Perkele NNP B-Malware
and CC O
Wroba NNP B-Malware
Foreign NNP O
users NNS O
have VBP O
also RB O
been VBN O
on IN O
the DT O
receiving VBG O
end NN O
of IN O
several JJ O
malicious JJ O
innovations NNS O
targeting VBG O
bank NN O
accounts NNS O
. . O

The DT O
Perkele NNP B-Malware
Android NNP O
Trojan NNP O
not RB O
only RB O
attacks VBZ O
Russian JJ O
users NNS O
but CC O
also RB O
clients NNS O
of IN O
several JJ O
European JJ O
banks NNS O
. . O

It PRP O
is VBZ O
of IN O
interest NN O
primarily RB O
because IN O
it PRP O
operates VBZ O
in IN O
conjunction NN O
with IN O
various JJ O
banking VBG O
win32-Trojans NNS B-System
. . O

Its PRP$ O
main JJ O
task NN O
is VBZ O
to TO O
bypass VB O
the DT O
two-factor JJ O
authentication NN O
of IN O
the DT O
client NN O
in IN O
the DT O
online NN O
banking NN O
system NN O
. . O

Due JJ O
to TO O
the DT O
specific JJ O
nature NN O
of IN O
its PRP$ O
activity NN O
, , O
Perkele NNP B-Malware
is VBZ O
distributed VBN O
in IN O
a DT O
rather RB O
unusual JJ O
way NN O
. . O

When WRB O
a DT O
user NN O
enters VBZ O
an DT O
Internet NNP O
banking NN O
site NN O
on IN O
a DT O
computer NN O
infected VBN O
by IN O
banking VBG O
malware NN O
( ( O
ZeuS NNP B-Malware
, , O
Citadel NNP B-Malware
) ) O
, , O
a DT O
request NN O
about IN O
the DT O
smartphone NN O
number NN O
and CC O
type NN O
of IN O
operating NN O
system NN O
is VBZ O
injected VBN O
into IN O
the DT O
code NN O
of IN O
the DT O
authentication NN O
page NN O
. . O

This DT O
data NN O
is VBZ O
immediately RB O
sent VBN O
to TO O
the DT O
cybercriminals NNS O
and CC O
the DT O
computer NN O
displays VBZ O
the DT O
QR NNP O
code NN O
containing VBG O
a DT O
link NN O
to TO O
the DT O
alleged VBN O
certificate NN O
of IN O
the DT O
online NN O
banking NN O
system NN O
. . O

After IN O
scanning VBG O
the DT O
QR NNP O
code NN O
and CC O
installing VBG O
a DT O
component NN O
downloaded VBN O
from IN O
the DT O
link NN O
, , O
the DT O
user NN O
infects VBZ O
his PRP$ O
smartphone NN O
with IN O
the DT O
Trojan NNP O
program NN O
that WDT O
boasts VBZ O
functionality NN O
that WDT O
is VBZ O
of IN O
great JJ O
interest NN O
to TO O
the DT O
attackers NNS O
. . O

Perkele NNP B-Malware
intercepts NNS O
mTANs NN O
( ( O
confirmation NN O
codes NNS O
for IN O
banking VBG O
operations NNS O
) ) O
sent VBN O
by IN O
the DT O
bank NN O
via IN O
text JJ O
message NN O
. . O

By IN O
using VBG O
the DT O
login NN O
and CC O
password NN O
stolen VBN O
from IN O
the DT O
browser NN O
, , O
the DT O
Windows NNP O
Trojan NNP O
initiates VBZ O
a DT O
fake JJ O
transaction NN O
while IN O
Perkele NNP B-Malware
intercepts NNS O
( ( O
via IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
) ) O
the DT O
mTAN NN O
sent VBN O
by IN O
the DT O
bank NN O
to TO O
the DT O
user NN O
. . O

Money NN O
then RB O
disappears VBZ O
from IN O
the DT O
victim NN O
’ NNP O
s NN O
account NN O
and CC O
is VBZ O
cashed VBN O
in IN O
without IN O
the DT O
owner NN O
’ NNP O
s NN O
knowledge NN O
. . O

The DT O
Korean NNP O
malware NN O
Wroba NNP B-Malware
, , O
in IN O
addition NN O
to TO O
the DT O
traditional JJ O
vector NN O
of IN O
infection NN O
via IN O
file-sharing JJ O
services NNS O
, , O
spreads NNS O
via IN O
alternative JJ O
app NN O
stores NNS O
. . O

Once IN O
it PRP O
infects VBZ O
a DT O
device NN O
, , O
Wroba NNP B-Malware
behaves VBZ O
very RB O
aggressively RB O
. . O

It PRP O
searches VBZ O
for IN O
mobile JJ O
banking NN O
applications NNS O
, , O
removes VBZ O
them PRP O
and CC O
uploads JJ O
counterfeit NN O
versions NNS O
. . O

From IN O
the DT O
outside NN O
, , O
they PRP O
are VBP O
indistinguishable JJ O
from IN O
the DT O
legitimate JJ O
applications NNS O
. . O

However RB O
, , O
they PRP O
possess VBP O
no DT O
banking NN O
functions NNS O
, , O
and CC O
merely RB O
steal VB O
the DT O
logins NNS O
and CC O
passwords NNS O
entered VBN O
by IN O
users NNS O
. . O

ViperRAT NN B-Malware
: : O
The DT O
Mobile NNP O
APT NNP O
Targeting VBG O
The DT O
Israeli NNP B-Organization
Defense NNP I-Organization
Force NNP I-Organization
That WDT O
Should MD O
Be VB O
On IN O
Your NNP O
Radar NNP O
February NNP O
16 CD O
, , O
2017 CD O
ViperRAT NNP B-Malware
is VBZ O
an DT O
active JJ O
, , O
advanced JJ O
persistent NN O
threat NN O
( ( O
APT NNP O
) ) O
that WDT O
sophisticated VBD O
threat NN O
actors NNS O
are VBP O
actively RB O
using VBG O
to TO O
target VB O
and CC O
spy VB O
on IN O
the DT O
Israeli NNP B-Organization
Defense NNP I-Organization
Force.The NNP I-Organization
threat NN O
actors NNS O
behind IN O
the DT O
ViperRAT NNP B-Malware
surveillanceware NN O
collect VBP O
a DT O
significant JJ O
amount NN O
of IN O
sensitive JJ O
information NN O
off IN O
of IN O
the DT O
device NN O
, , O
and CC O
seem VBP O
most RBS O
interested JJ O
in IN O
exfiltrating VBG O
images NNS O
and CC O
audio JJ O
content NN O
. . O

The DT O
attackers NNS O
are VBP O
also RB O
hijacking VBG O
the DT O
device NN O
camera NN O
to TO O
take VB O
pictures NNS O
. . O

Using VBG O
data NNS O
collected VBN O
from IN O
the DT O
Lookout NNP B-Organization
global JJ O
sensor NN O
network NN O
, , O
the DT O
Lookout NNP O
research NN O
team NN O
was VBD O
able JJ O
to TO O
gain VB O
unique JJ O
visibility NN O
into IN O
the DT O
ViperRAT NNP B-Malware
malware NN O
, , O
including VBG O
11 CD O
new JJ O
, , O
unreported JJ O
applications NNS O
. . O

We PRP O
also RB O
discovered VBD O
and CC O
analyzed JJ O
live NN O
, , O
misconfigured VBD O
malicious JJ O
command NN O
and CC O
control NN O
servers NNS O
( ( O
C2 NNP O
) ) O
, , O
from IN O
which WDT O
we PRP O
were VBD O
able JJ O
to TO O
identify VB O
how WRB O
the DT O
attacker NN O
gets VBZ O
new JJ O
, , O
infected JJ O
apps NN O
to TO O
secretly RB O
install VB O
and CC O
the DT O
types NNS O
of IN O
activities NNS O
they PRP O
are VBP O
monitoring VBG O
. . O

In IN O
addition NN O
, , O
we PRP O
uncovered VBD O
the DT O
IMEIs NNP O
of IN O
the DT O
targeted JJ O
individuals NNS O
( ( O
IMEIs NNP O
will MD O
not RB O
be VB O
shared VBN O
publicly RB O
for IN O
the DT O
privacy NN O
and CC O
safety NN O
of IN O
the DT O
victims NNS O
) ) O
as RB O
well RB O
as IN O
the DT O
types NNS O
of IN O
exfiltrated JJ O
content NN O
. . O

In IN O
aggregate NN O
, , O
the DT O
type NN O
of IN O
information NN O
stolen VBN O
could MD O
let VB O
an DT O
attacker NN O
know VBP O
where WRB O
a DT O
person NN O
is VBZ O
, , O
with IN O
whom WP O
they PRP O
are VBP O
associated VBN O
( ( O
including VBG O
contacts NNS O
’ RB O
profile IN O
photos NNS O
) ) O
, , O
the DT O
messages NNS O
they PRP O
are VBP O
sending VBG O
, , O
the DT O
websites NNS O
they PRP O
visit VBP O
and CC O
search VBP O
history NN O
, , O
screenshots NNS O
that IN O
reveal VBP O
data NNS O
from IN O
other JJ O
apps NN O
on IN O
the DT O
device NN O
, , O
the DT O
conversations NNS O
they PRP O
have VBP O
in IN O
the DT O
presence NN O
of IN O
the DT O
device NN O
, , O
and CC O
a DT O
myriad NN O
of IN O
images NNS O
including VBG O
anything NN O
at IN O
which WDT O
device NN O
’ NN O
s NN O
camera NN O
is VBZ O
pointed VBN O
. . O

Lookout NN B-Organization
has VBZ O
determined VBN O
ViperRAT NNP B-Malware
is VBZ O
a DT O
very RB O
sophisticated JJ O
threat NN O
that WDT O
adds VBZ O
to TO O
the DT O
mounting VBG O
evidence NN O
that IN O
targeted VBD O
mobile JJ O
attacks NNS O
against IN O
governments NNS O
and CC O
business NN O
is VBZ O
a DT O
real JJ O
problem NN O
. . O

Lookout NN B-Organization
researchers NNS O
have VBP O
been VBN O
tracking VBG O
this DT O
threat NN O
for IN O
the DT O
last JJ O
month NN O
. . O

Given VBN O
that IN O
this DT O
is VBZ O
an DT O
active JJ O
threat NN O
, , O
we PRP O
’ VBP O
ve RB O
been VBN O
working VBG O
behind-the-scenes NNS O
with IN O
our PRP$ O
customers NNS O
to TO O
ensure VB O
both DT O
personal JJ O
and CC O
enterprise NN O
customers NNS O
are VBP O
protected VBN O
from IN O
this DT O
threat NN O
and CC O
only RB O
decided VBD O
to TO O
come VB O
forward RB O
with IN O
this DT O
information NN O
after IN O
the DT O
research NN O
team NN O
at IN O
Kaspersky NNP B-Organization
released VBD O
a DT O
report NN O
earlier RBR O
today NN O
. . O

Additionally RB O
, , O
we PRP O
have VBP O
determined VBN O
that IN O
though IN O
original JJ O
reports NNS O
of IN O
this DT O
story NN O
attribute NN O
this DT O
surveillanceware NN O
tool NN O
to TO O
Hamas NNP B-Organization
, , O
this DT O
may MD O
not RB O
be VB O
the DT O
case NN O
, , O
as IN O
we PRP O
demonstrate VBP O
below IN O
. . O

The DT O
increasing VBG O
sophistication NN O
of IN O
surveillanceware NN O
The DT O
structure NN O
of IN O
the DT O
surveillanceware NN O
indicates VBZ O
it PRP O
is VBZ O
very RB O
sophisticated JJ O
. . O

Analysis NN O
indicates VBZ O
there EX O
are VBP O
currently RB O
two CD O
distinct JJ O
variants NNS O
of IN O
ViperRAT NNP B-Malware
. . O

The DT O
first JJ O
variant NN O
is VBZ O
a DT O
“ NN O
first RB O
stage JJ O
application NN O
, , O
” VBP O
that IN O
performs NNS O
basic JJ O
profiling NN O
of IN O
a DT O
device NN O
, , O
and CC O
under IN O
certain JJ O
conditions NNS O
attempts NNS O
to TO O
download VB O
and CC O
install VB O
a DT O
much RB O
more RBR O
comprehensive JJ O
surveillanceware NN O
component NN O
, , O
which WDT O
is VBZ O
the DT O
second JJ O
variant NN O
. . O

The DT O
first JJ O
variant JJ O
involves VBZ O
social JJ O
engineering NN O
the DT O
target NN O
into IN O
downloading VBG O
a DT O
trojanized JJ O
app NN O
. . O

Previous JJ O
reports NNS O
alleged VBD O
this DT O
surveillanceware NN O
tool NN O
was VBD O
deployed VBN O
using VBG O
‘ JJ O
honey NN O
traps NNS O
’ VB O
where WRB O
the DT O
actor NN O
behind IN O
it PRP O
would MD O
reach VB O
out IN O
to TO O
targets NNS O
via IN O
fake JJ O
social JJ O
media NNS O
profiles NNS O
of IN O
young JJ O
women NNS O
. . O

After IN O
building VBG O
an DT O
initial JJ O
rapport NN O
with IN O
targets NNS O
, , O
the DT O
actors NNS O
behind IN O
these DT O
social JJ O
media NNS O
accounts NNS O
would MD O
instruct VB O
victims NNS O
to TO O
install VB O
an DT O
additional JJ O
app NN O
for IN O
easier JJR O
communication NN O
. . O

Specifically RB O
, , O
Lookout NNP B-Organization
determined VBD O
these DT O
were VBD O
trojanized JJ O
versions NNS O
of IN O
the DT O
apps NN O
SR NNP B-System
Chat NNP I-System
and CC O
YeeCall NNP B-System
Pro NNP I-System
. . O

We PRP O
also RB O
uncovered VBD O
ViperRAT NNP B-Malware
in IN O
a DT O
billiards NNS O
game NN O
, , O
an DT O
Israeli JJ O
Love NNP O
Songs NNP O
player NN O
, , O
and CC O
a DT O
Move NNP O
To TO O
iOS VB B-System
app NN O
. . O

The DT O
second JJ O
stage NN O
The DT O
second JJ O
stage NN O
apps NN O
contain VBP O
the DT O
surveillanceware NN O
capabilities NNS O
. . O

Lookout RB B-Organization
uncovered JJ O
nine CD O
secondary JJ O
payload NN O
applications NNS O
: : O
* VB O
These DT O
apps NNS O
have VBP O
not RB O
been VBN O
previously RB O
reported VBN O
and CC O
were VBD O
discovered VBN O
using VBG O
data NNS O
from IN O
the DT O
Lookout NNP B-Organization
global JJ O
sensor NN O
network NN O
, , O
which WDT O
collects VBZ O
app NN O
and CC O
device NN O
information NN O
from IN O
over IN O
100 CD O
million CD O
sensors NNS O
to TO O
provide VB O
researchers NNS O
and CC O
customers NNS O
with IN O
a DT O
holistic JJ O
look NN O
at IN O
the DT O
mobile JJ O
threat NN O
ecosystem NN O
today NN O
. . O

Naming VBG O
additional JJ O
payload NN O
applications NNS O
as IN O
system NN O
updates VBZ O
is VBZ O
a DT O
clever NN O
technique NN O
used VBN O
by IN O
malware NN O
authors NNS O
to TO O
trick VB O
victims NNS O
into IN O
believing VBG O
a DT O
threat NN O
isn NN O
’ NNP O
t NN O
present NN O
on IN O
their PRP$ O
device NN O
. . O

ViperRAT NNP B-Malware
takes VBZ O
this DT O
one CD O
step NN O
further RB O
by IN O
using VBG O
its PRP$ O
dropper NN O
app NN O
to TO O
identify VB O
an DT O
appropriate JJ O
second JJ O
stage NN O
‘ JJ O
update JJ O
’ NNS O
that WDT O
may MD O
go VB O
unnoticed JJ O
. . O

For IN O
example NN O
, , O
if IN O
a DT O
victim NN O
has VBZ O
Viber NNP B-System
on IN O
their PRP$ O
device NN O
, , O
it PRP O
will MD O
choose VB O
to TO O
retrieve VB O
the DT O
Viber NNP B-System
Update NNP I-System
second JJ O
stage NN O
. . O

If IN O
he PRP O
doesn VBZ O
’ JJ O
t NNS O
have VBP O
Viber NNP O
, , O
the DT O
generically-named JJ O
System NNP O
Updates NNP O
app VBP O
gets VBZ O
downloaded VBN O
and CC O
installed VBN O
instead RB O
. . O

What WP O
was VBD O
taken VBN O
The DT O
actors NNS O
behind IN O
ViperRAT NNP B-Malware
seem VBP O
to TO O
be VB O
particularly RB O
interested JJ O
in IN O
image NN O
data NNS O
. . O

We PRP O
were VBD O
able JJ O
to TO O
identify VB O
that IN O
8,929 CD O
files NNS O
had VBD O
been VBN O
exfiltrated VBN O
from IN O
compromised VBN O
devices NNS O
and CC O
that IN O
the DT O
overwhelming JJ O
majority NN O
of IN O
these DT O
, , O
97 CD O
percent NN O
, , O
were VBD O
highly RB O
likely JJ O
encrypted VBN O
images NNS O
taken VBN O
using VBG O
the DT O
device NN O
camera NN O
. . O

We PRP O
also RB O
observed VBD O
automatically RB O
generated VBN O
files NNS O
on IN O
the DT O
C2 NNP O
, , O
indicating VBG O
the DT O
actor NN O
behind IN O
this DT O
campaign NN O
also RB O
issues NNS O
commands NNS O
to TO O
search VB O
for IN O
and CC O
exfiltrate VB O
PDF NNP O
and CC O
Office NNP O
documents NNS O
. . O

This DT O
should MD O
be VB O
highly RB O
alarming VBG O
to TO O
any DT O
government NN O
agency NN O
or CC O
enterprise NN O
. . O

We PRP O
observed VBD O
legitimate JJ O
exfiltrated JJ O
files NNS O
of IN O
the DT O
following JJ O
types NNS O
of IN O
data NNS O
: : O
Contact NNP O
information NN O
Compressed VBD O
recorded VBN O
audio NN O
in IN O
the DT O
Adaptive JJ O
Multi-Rate NNP O
( ( O
amr NN O
) ) O
file NN O
format NN O
Images NNS O
captured VBN O
from IN O
the DT O
device NN O
camera NN O
Images NNP O
stored VBN O
on IN O
both DT O
internal JJ O
device NN O
and CC O
SDCard NNP O
storage NN O
that WDT O
are VBP O
listed VBN O
in IN O
the DT O
MediaStore NNP O
Device NNP O
geolocation NN O
information NN O
SMS NNP O
content NN O
Chrome NNP O
browser NN O
search NN O
history NN O
and CC O
bookmarks NNS O
Call NNP O
log NN O
information NN O
Cell NNP O
tower NN O
information NN O
Device NNP O
network NN O
metadata NN O
; : O
such JJ O
as IN O
phone NN O
number NN O
, , O
device NN O
software NN O
version NN O
, , O
network NN O
country NN O
, , O
network NN O
operator NN O
, , O
SIM NNP O
country NN O
, , O
SIM NNP O
operator NN O
, , O
SIM NNP O
serial NN O
, , O
IMSI NNP O
, , O
voice NN O
mail NN O
number NN O
, , O
phone NN O

type NN O
, , O
network NN O
type NN O
, , O
data NNS O
state NN O
, , O
data NN O
activity NN O
, , O
call NN O
state NN O
, , O
SIM NNP O
state NN O
, , O
whether IN O
device NN O
is VBZ O
roaming VBG O
, , O
and CC O
if IN O
SMS NNP O
is VBZ O
supported VBN O
. . O

Standard NNP O
browser NN O
search NN O
history NN O
Standard NNP O
browser NN O
bookmarks NNS O
Device NNP O
handset NN O
metadata NN O
; : O
such JJ O
as IN O
brand NN O
, , O
display NN O
, , O
hardware NN O
, , O
manufacturer NN O
, , O
product NN O
, , O
serial JJ O
, , O
radio JJ O
version NN O
, , O
and CC O
SDK NNP O
. . O

Command NNP O
and CC O
control VB O
API NNP O
calls VBZ O
ViperRAT NNP B-Malware
samples NNS O
are VBP O
capable JJ O
of IN O
communicating VBG O
to TO O
C2 NNP O
servers NNS O
through IN O
an DT O
exposed JJ O
API NNP O
as RB O
well RB O
as IN O
websockets NNS O
. . O

Below NNP O
is VBZ O
a DT O
collection NN O
of IN O
API NNP O
methods NNS O
and CC O
a DT O
brief JJ O
description NN O
around IN O
their PRP$ O
purpose NN O
. . O

On IN O
attribution NN O
Media NNP O
reporting NN O
on IN O
ViperRAT NNP B-Malware
thus RB O
far RB O
attributes VBZ O
this DT O
surveillanceware JJ O
tool NN O
to TO O
Hamas NNP B-Organization
. . O

Israeli JJ O
media NNS O
published VBD O
the DT O
first JJ O
reports NNS O
about IN O
the DT O
social JJ O
networking NN O
and CC O
social JJ O
engineering NN O
aspects NNS O
of IN O
this DT O
campaign NN O
. . O

However RB O
it PRP O
’ VBZ O
s JJ O
unclear IN O
whether IN O
organizations NNS O
that IN O
later RB O
reported VBN O
on IN O
ViperRAT NNP B-Malware
performed VBD O
their PRP$ O
own JJ O
independent JJ O
research NN O
or CC O
simply RB O
based VBN O
their PRP$ O
content NN O
on IN O
the DT O
original JJ O
Israeli NNP O
report NN O
. . O

Hamas NNP B-Organization
is VBZ O
not RB O
widely RB O
known VBN O
for IN O
having VBG O
a DT O
sophisticated JJ O
mobile JJ O
capability NN O
, , O
which WDT O
makes VBZ O
it PRP O
unlikely JJ O
they PRP O
are VBP O
directly RB O
responsible JJ O
for IN O
ViperRAT NNP B-Malware
. . O

ViperRAT NNP B-Malware
has VBZ O
been VBN O
operational JJ O
for IN O
quite RB O
some DT O
time NN O
, , O
with IN O
what WP O
appears VBZ O
to TO O
be VB O
a DT O
test NN O
application NN O
that WDT O
surfaced VBD O
in IN O
late JJ O
2015 CD O
. . O

Many JJ O
of IN O
the DT O
default NN O
strings NNS O
in IN O
this DT O
application NN O
are VBP O
in IN O
Arabic NNP O
, , O
including VBG O
the DT O
name NN O
. . O

It PRP O
is VBZ O
unclear JJ O
whether IN O
this DT O
means VBZ O
early JJ O
samples NNS O
were VBD O
targeting VBG O
Arabic NNP O
speakers NNS O
or CC O
if IN O
the DT O
developers NNS O
behind IN O
it PRP O
are VBP O
fluent JJ O
in IN O
Arabic NNP O
. . O

This DT O
leads VBZ O
us PRP O
to TO O
believe VB O
this DT O
is VBZ O
another DT O
actor NN O
. . O

What WP O
this DT O
means VBZ O
for IN O
you PRP O
All DT O
Lookout IN B-Organization
customers NNS O
are VBP O
protected VBN O
from IN O
this DT O
threat NN O
. . O

However RB O
, , O
the DT O
existence NN O
of IN O
threats NNS O
like IN O
ViperRAT NNP B-Malware
and CC O
Pegasus NNP B-Malware
, , O
the DT O
most RBS O
sophisticated JJ O
piece NN O
of IN O
mobile JJ O
surveillanceware NN O
we PRP O
’ VBP O
ve RB O
seen VBN O
to TO O
date NN O
, , O
are VBP O
evidence NN O
that IN O
attackers NNS O
are VBP O
targeting VBG O
mobile JJ O
devices NNS O
. . O

Mobile JJ O
devices NNS O
are VBP O
at IN O
the DT O
frontier NN O
of IN O
cyber NN O
espionage NN O
, , O
and CC O
other JJ O
criminal JJ O
motives NNS O
. . O

Enterprise NN O
and CC O
government NN O
employees NNS O
all DT O
use VBP O
these DT O
devices NNS O
in IN O
their PRP$ O
day-to-day JJ O
work NN O
, , O
which WDT O
means VBZ O
IT NNP O
and CC O
security NN O
leaders NNS O
within IN O
these DT O
organizations NNS O
must MD O
prioritize VB O
mobile NN O
in IN O
their PRP$ O
security NN O
strategies NNS O
. . O

Check VB B-Organization
Point NN I-Organization
researchers NNS O
discovered VBD O
another DT O
widespread JJ O
malware NN O
campaign NN O
on IN O
Google NNP B-System
Play NNP I-System
, , O
Google NNP B-Organization
’ NNP O
s VBZ O
official JJ O
app JJ O
store NN O
. . O

The DT O
malware NN O
, , O
dubbed VBN O
“ NN O
Judy NNP B-Malware
” NNP O
, , O
is VBZ O
an DT O
auto-clicking JJ O
adware NN O
which WDT O
was VBD O
found VBN O
on IN O
41 CD O
apps NNS O
developed VBN O
by IN O
a DT O
Korean JJ O
company NN O
. . O

The DT O
malware NN O
uses VBZ O
infected JJ O
devices NNS O
to TO O
generate VB O
large JJ O
amounts NNS O
of IN O
fraudulent JJ O
clicks NNS O
on IN O
advertisements NNS O
, , O
generating VBG O
revenues NNS O
for IN O
the DT O
perpetrators NNS O
behind IN O
it PRP O
. . O

The DT O
malicious JJ O
apps NN O
reached VBD O
an DT O
astonishing JJ O
spread NN O
between IN O
4.5 CD O
million CD O
and CC O
18.5 CD O
million CD O
downloads NNS O
. . O

Some DT O
of IN O
the DT O
apps NN O
we PRP O
discovered VBD O
resided VBN O
on IN O
Google NNP B-System
Play NNP I-System
for IN O
several JJ O
years NNS O
, , O
but CC O
all DT O
were VBD O
recently RB O
updated VBN O
. . O

It PRP O
is VBZ O
unclear JJ O
how WRB O
long RB O
the DT O
malicious JJ O
code NN O
existed VBD O
inside IN O
the DT O
apps NN O
, , O
hence RB O
the DT O
actual JJ O
spread NN O
of IN O
the DT O
malware NN O
remains VBZ O
unknown JJ O
. . O

We PRP O
also RB O
found VBD O
several JJ O
apps NNS O
containing VBG O
the DT O
malware NN O
, , O
which WDT O
were VBD O
developed VBN O
by IN O
other JJ O
developers NNS O
on IN O
Google NNP B-System
Play NNP I-System
. . O

The DT O
connection NN O
between IN O
the DT O
two CD O
campaigns NNS O
remains VBZ O
unclear JJ O
, , O
and CC O
it PRP O
is VBZ O
possible JJ O
that IN O
one CD O
borrowed VBD O
code NN O
from IN O
the DT O
other JJ O
, , O
knowingly RB O
or CC O
unknowingly RB O
. . O

The DT O
oldest JJS O
app NN O
of IN O
the DT O
second JJ O
campaign NN O
was VBD O
last JJ O
updated JJ O
in IN O
April NNP O
2016 CD O
, , O
meaning VBG O
that IN O
the DT O
malicious JJ O
code NN O
hid NN O
for IN O
a DT O
long JJ O
time NN O
on IN O
the DT O
Play NNP B-System
store NN I-System
undetected VBD O
. . O

These DT O
apps NN O
also RB O
had VBD O
a DT O
large JJ O
amount NN O
of IN O
downloads NNS O
between IN O
4 CD O
and CC O
18 CD O
million CD O
, , O
meaning VBG O
the DT O
total JJ O
spread NN O
of IN O
the DT O
malware NN O
may MD O
have VB O
reached VBN O
between IN O
8.5 CD O
and CC O
36.5 CD O
million CD O
users NNS O
. . O

Similar JJ O
to TO O
previous JJ O
malware NN O
which WDT O
infiltrated VBD O
Google NNP B-System
Play NNP I-System
, , O
such JJ O
as IN O
FalseGuide NNP B-Malware
and CC O
Skinner NNP B-Malware
, , O
Judy NNP O
relies VBZ O
on IN O
the DT O
communication NN O
with IN O
its PRP$ O
Command NNP O
and CC O
Control NNP O
server NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
for IN O
its PRP$ O
operation NN O
. . O

After IN O
Check NNP B-Organization
Point NNP I-Organization
notified VBD O
Google NNP B-Organization
about IN O
this DT O
threat NN O
, , O
the DT O
apps NN O
were VBD O
swiftly RB O
removed VBN O
from IN O
the DT O
Play NNP B-System
store NN I-System
. . O

How WRB O
Judy NNP B-Malware
operates VBZ O
: : O
To TO O
bypass VB O
Bouncer NNP B-System
, , O
Google NNP B-System
Play NNP I-System
’ NNP O
s NN O
protection NN O
, , O
the DT O
hackers NNS O
create VBP O
a DT O
seemingly RB O
benign JJ O
bridgehead NN O
app NN O
, , O
meant NN O
to TO O
establish VB O
connection NN O
to TO O
the DT O
victim NN O
’ NNP O
s NN O
device NN O
, , O
and CC O
insert VB O
it PRP O
into IN O
the DT O
app NN O
store NN O
. . O

Once RB O
a DT O
user NN O
downloads VBZ O
a DT O
malicious JJ O
app NN O
, , O
it PRP O
silently RB O
registers VBZ O
receivers NNS O
which WDT O
establish VB O
a DT O
connection NN O
with IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

The DT O
server NN O
replies VBZ O
with IN O
the DT O
actual JJ O
malicious JJ O
payload NN O
, , O
which WDT O
includes VBZ O
JavaScript NNP O
code NN O
, , O
a DT O
user-agent JJ O
string NN O
and CC O
URLs NNP O
controlled VBN O
by IN O
the DT O
malware NN O
author NN O
. . O

The DT O
malware NN O
opens VBZ O
the DT O
URLs NNP O
using VBG O
the DT O
user NN O
agent NN O
that WDT O
imitates VBZ O
a DT O
PC NN O
browser NN O
in IN O
a DT O
hidden JJ O
webpage NN O
and CC O
receives VBZ O
a DT O
redirection NN O
to TO O
another DT O
website NN O
. . O

Once RB O
the DT O
targeted JJ O
website NN O
is VBZ O
launched VBN O
, , O
the DT O
malware NN O
uses VBZ O
the DT O
JavaScript NNP O
code NN O
to TO O
locate VB O
and CC O
click VB O
on IN O
banners NNS O
from IN O
the DT O
Google NNP B-System
ads NNS I-System
infrastructure NN O
. . O

Upon IN O
clicking VBG O
the DT O
ads NNS O
, , O
the DT O
malware NN O
author NN O
receives VBZ O
payment NN O
from IN O
the DT O
website JJ O
developer NN O
, , O
which WDT O
pays VBZ O
for IN O
the DT O
illegitimate NN O
clicks NNS O
and CC O
traffic NN O
. . O

The DT O
JavaScript NNP O
code NN O
locates VBZ O
the DT O
targeted JJ O
ads NNS O
by IN O
searching VBG O
for IN O
iframes NNS O
which WDT O
contain VBP O
ads NNS O
from IN O
Google NNP B-System
ads NNS I-System
infrastructure NN O
, , O
as IN O
shown VBN O
in IN O
the DT O
image NN O
below IN O
: : O
The DT O
fraudulent JJ O
clicks NNS O
generate VBP O
a DT O
large JJ O
revenue NN O
for IN O
the DT O
perpetrators NNS O
, , O
especially RB O
since IN O
the DT O
malware NN O
reached VBD O
a DT O
presumably RB O
wide JJ O
spread NN O
. . O

Who WP O
is VBZ O
behind IN O
Judy NNP B-Malware
? . O

The DT O
malicious JJ O
apps NNS O
are VBP O
all DT O
developed VBN O
by IN O
a DT O
Korean JJ O
company NN O
named VBN O
Kiniwini NNP B-Organization
, , O
registered VBD O
on IN O
Google NNP B-System
Play NNP I-System
as IN O
ENISTUDIO NNP B-Organization
corp NN I-Organization
. . O

The DT O
company NN O
develops VBZ O
mobile JJ O
apps NN O
for IN O
both DT O
Android NNP B-System
and CC O
iOS JJ B-System
platforms NNS O
. . O

It PRP O
is VBZ O
quite RB O
unusual JJ O
to TO O
find VB O
an DT O
actual JJ O
organization NN O
behind IN O
mobile JJ O
malware NN O
, , O
as IN O
most JJS O
of IN O
them PRP O
are VBP O
developed VBN O
by IN O
purely RB O
malicious JJ O
actors NNS O
. . O

It PRP O
is VBZ O
important JJ O
to TO O
note VB O
that IN O
the DT O
activity NN O
conducted VBN O
by IN O
the DT O
malware NN O
is VBZ O
not RB O
borderline JJ O
advertising NN O
, , O
but CC O
definitely RB O
an DT O
illegitimate NN O
use NN O
of IN O
the DT O
users NNS O
’ VBP O
mobile JJ O
devices NNS O
for IN O
generating VBG O
fraudulent JJ O
clicks NNS O
, , O
benefiting VBG O
the DT O
attackers NNS O
. . O

In IN O
addition NN O
to TO O
the DT O
clicking NN O
activity NN O
, , O
Judy NNP B-Malware
displays VBZ O
a DT O
large JJ O
amount NN O
of IN O
advertisements NNS O
, , O
which WDT O
in IN O
some DT O
cases NNS O
leave VBP O
users NNS O
with IN O
no DT O
option NN O
but CC O
clicking VBG O
on IN O
the DT O
ad NN O
itself PRP O
. . O

Although IN O
most JJS O
apps NNS O
have VBP O
positive JJ O
ratings NNS O
, , O
some DT O
of IN O
the DT O
users NNS O
have VBP O
noticed VBN O
and CC O
reported VBN O
Judy NNP B-Malware
’ NNP O
s VBP O
suspicious JJ O
activities NNS O
, , O
as IN O
seen VBN O
in IN O
the DT O
images NNS O
below RB O
: : O
As IN O
seen VBN O
in IN O
previous JJ O
malware NN O
, , O
such JJ O
as IN O
DressCode NNP B-Malware
, , O
a DT O
high JJ O
reputation NN O
does VBZ O
not RB O
necessarily RB O
indicate VB O
that IN O
the DT O
app NN O
is VBZ O
safe JJ O
for IN O
use NN O
. . O

Hackers NNS O
can MD O
hide VB O
their PRP$ O
apps NN O
’ IN O
real JJ O
intentions NNS O
or CC O
even RB O
manipulate JJ O
users NNS O
into IN O
leaving VBG O
positive JJ O
ratings NNS O
, , O
in IN O
some DT O
cases NNS O
unknowingly RB O
. . O

Users NNS O
can MD O
not RB O
rely VB O
on IN O
the DT O
official JJ O
app NN O
stores NNS O
for IN O
their PRP$ O
safety NN O
, , O
and CC O
should MD O
implement VB O
advanced JJ O
security NN O
protections NNS O
capable JJ O
of IN O
detecting VBG O
and CC O
blocking VBG O
zero-day JJ O
mobile JJ O
malware NN O
. . O

PHA NNP O
Family NNP O
Highlights NNP O
: : O
Bread NNP B-Malware
( ( O
and CC O
Friends NNP O
) ) O
January NNP O
9 CD O
, , O
2020 CD O
In IN O
this DT O
edition NN O
of IN O
our PRP$ O
PHA NNP O
Family NNP O
Highlights NNP O
series NN O
we PRP O
introduce VBP O
Bread NNP B-Malware
, , O
a DT O
large-scale JJ O
billing NN O
fraud NN O
family NN O
. . O

We PRP O
first RB O
started VBD O
tracking VBG O
Bread NNP B-Malware
( ( O
also RB O
known VBN O
as IN O
Joker NNP B-Malware
) ) O
in IN O
early JJ O
2017 CD O
, , O
identifying VBG O
apps NN O
designed VBN O
solely RB O
for IN O
SMS NNP O
fraud NN O
. . O

As IN O
the DT O
Play NNP B-System
Store NNP I-System
has VBZ O
introduced VBN O
new JJ O
policies NNS O
and CC O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
has VBZ O
scaled VBN O
defenses NNS O
, , O
Bread NNP B-Malware
apps NN O
were VBD O
forced VBN O
to TO O
continually RB O
iterate VB O
to TO O
search VB O
for IN O
gaps NNS O
. . O

They PRP O
have VBP O
at IN O
some DT O
point NN O
used VBN O
just RB O
about IN O
every DT O
cloaking NN O
and CC O
obfuscation NN O
technique NN O
under IN O
the DT O
sun NN O
in IN O
an DT O
attempt NN O
to TO O
go VB O
undetected JJ O
. . O

Many JJ O
of IN O
these DT O
samples NNS O
appear VBP O
to TO O
be VB O
designed VBN O
specifically RB O
to TO O
attempt VB O
to TO O
slip VB O
into IN O
the DT O
Play NNP B-System
Store NNP I-System
undetected JJ O
and CC O
are VBP O
not RB O
seen VBN O
elsewhere RB O
. . O

In IN O
this DT O
post NN O
, , O
we PRP O
show VBP O
how WRB O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
has VBZ O
defended VBN O
against IN O
a DT O
well NN O
organized VBN O
, , O
persistent JJ O
attacker NN O
and CC O
share NN O
examples NNS O
of IN O
their PRP$ O
techniques NNS O
. . O

TL NNP O
; : O
DR NNP O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
detected VBD O
and CC O
removed VBD O
1.7k CD O
unique JJ O
Bread NNP B-Malware
apps NN O
from IN O
the DT O
Play NNP B-System
Store NNP I-System
before IN O
ever RB O
being VBG O
downloaded VBN O
by IN O
users NNS O
Bread NNP B-Malware
apps VBP O
originally RB O
performed VBN O
SMS NNP O
fraud NN O
, , O
but CC O
have VBP O
largely RB O
abandoned VBN O
this DT O
for IN O
WAP NNP O
billing NN O
following VBG O
the DT O
introduction NN O
of IN O
new JJ O
Play NNP B-System
policies NNS O
restricting VBG O
use NN O
of IN O
the DT O
SEND_SMS NNP O
permission NN O
and CC O
increased VBN O
coverage NN O
by IN O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
More NNP O
information NN O
on IN O
stats NNS O
and CC O
relative JJ O
impact NN O
is VBZ O
available JJ O
in IN O
the DT O
Android NNP B-System
Security NNP O
2018 CD O
Year NNP O
in IN O
Review NNP O
report NN O
BILLING NNP O
FRAUD NNP O
Bread NNP B-Malware
apps NN O
typically RB O
fall RB O
into IN O
two CD O
categories NNS O
: : O
SMS NNP O
fraud NN O
( ( O
older JJR O
versions NNS O
) ) O
and CC O
toll NN O
fraud NN O
( ( O
newer JJR O
versions NNS O
) ) O
. . O

Both DT O
of IN O
these DT O
types NNS O
of IN O
fraud NN O
take NN O
advantage NN O
of IN O
mobile JJ O
billing NN O
techniques NNS O
involving VBG O
the DT O
user NN O
’ NNP O
s NN O
carrier NN O
. . O

SMS NNP O
Billing NNP O
Carriers NNP O
may MD O
partner NN O
with IN O
vendors NNS O
to TO O
allow VB O
users NNS O
to TO O
pay VB O
for IN O
services NNS O
by IN O
SMS NNP O
. . O

The DT O
user NN O
simply RB O
needs VBZ O
to TO O
text VB O
a DT O
prescribed JJ O
keyword NN O
to TO O
a DT O
prescribed JJ O
number NN O
( ( O
shortcode NN O
) ) O
. . O

A DT O
charge NN O
is VBZ O
then RB O
added VBN O
to TO O
the DT O
user NN O
’ NNP O
s NN O
bill NN O
with IN O
their PRP$ O
mobile JJ O
service NN O
provider NN O
. . O

Toll NNP O
Billing NNP O
Carriers NNP O
may MD O
also RB O
provide VB O
payment NN O
endpoints NNS O
over IN O
a DT O
web JJ O
page NN O
. . O

The DT O
user NN O
visits VBZ O
the DT O
URL NNP O
to TO O
complete VB O
the DT O
payment NN O
and CC O
enters NNS O
their PRP$ O
phone NN O
number NN O
. . O

Verification NN O
that IN O
the DT O
request NN O
is VBZ O
coming VBG O
from IN O
the DT O
user NN O
’ NNP O
s NN O
device NN O
is VBZ O
completed VBN O
using VBG O
two CD O
possible JJ O
methods NNS O
: : O
The DT O
user NN O
connects VBZ O
to TO O
the DT O
site NN O
over IN O
mobile JJ O
data NNS O
, , O
not RB O
WiFi NNP O
( ( O
so IN O
the DT O
service NN O
provider NN O
directly RB O
handles VBZ O
the DT O
connection NN O
and CC O
can MD O
validate VB O
the DT O
phone NN O
number NN O
) ) O
; : O
or CC O
The DT O
user NN O
must MD O
retrieve VB O
a DT O
code NN O
sent NN O
to TO O
them PRP O
via IN O
SMS NNP O
and CC O
enter VB O
it PRP O
into IN O
the DT O
web JJ O
page NN O
( ( O
thereby RB O
proving VBG O
access NN O
to TO O
the DT O
provided VBN O
phone NN O
number NN O
) ) O
. . O

Fraud NNP O
Both NNP O
of IN O
the DT O
billing NN O
methods NNS O
detailed VBN O
above IN O
provide NN O
device NN O
verification NN O
, , O
but CC O
not RB O
user JJ O
verification NN O
. . O

The DT O
carrier NN O
can MD O
determine VB O
that IN O
the DT O
request NN O
originates VBZ O
from IN O
the DT O
user NN O
’ NNP O
s NN O
device NN O
, , O
but CC O
does VBZ O
not RB O
require VB O
any DT O
interaction NN O
from IN O
the DT O
user NN O
that WDT O
can MD O
not RB O
be VB O
automated VBN O
. . O

Malware NNP O
authors NNS O
use VBP O
injected JJ O
clicks NNS O
, , O
custom NN O
HTML NNP O
parsers NNS O
and CC O
SMS NNP O
receivers NNS O
to TO O
automate VB O
the DT O
billing NN O
process NN O
without IN O
requiring VBG O
any DT O
interaction NN O
from IN O
the DT O
user NN O
. . O

STRING NN O
& CC O
DATA NNP O
OBFUSCATION NNP O
Bread NNP O
apps NN O
have VBP O
used VBN O
many JJ O
innovative JJ O
and CC O
classic JJ O
techniques NNS O
to TO O
hide VB O
strings NNS O
from IN O
analysis NN O
engines NNS O
. . O

Here RB O
are VBP O
some DT O
highlights NNS O
. . O

Standard NNP O
Encryption NNP O
Frequently NNP O
, , O
Bread NNP O
apps VBP O
take VB O
advantage NN O
of IN O
standard JJ O
crypto NN O
libraries NNS O
in IN O
` `` O
java.util.crypto NN B-Indicator
` `` O
. . O

We PRP O
have VBP O
discovered VBN O
apps RP O
using VBG O
AES NNP O
, , O
Blowfish NNP O
, , O
and CC O
DES NNP O
as RB O
well RB O
as IN O
combinations NNS O
of IN O
these DT O
to TO O
encrypt VB O
their PRP$ O
strings NNS O
. . O

Custom NNP O
Encryption NNP O
Other JJ O
variants NNS O
have VBP O
used VBN O
custom-implemented JJ O
encryption NN O
algorithms NN O
. . O

Some DT O
common JJ O
techniques NNS O
include VBP O
: : O
basic JJ O
XOR NNP O
encryption NN O
, , O
nested VBN O
XOR NN O
and CC O
custom NN O
key-derivation NN O
methods NNS O
. . O

Some DT O
variants NNS O
have VBP O
gone VBN O
so RB O
far RB O
as IN O
to TO O
use VB O
a DT O
different JJ O
key NN O
for IN O
the DT O
strings NNS O
of IN O
each DT O
class NN O
. . O

Split NNP O
Strings NNP O
Encrypted NNP O
strings NNS O
can MD O
be VB O
a DT O
signal NN O
that IN O
the DT O
code NN O
is VBZ O
trying VBG O
to TO O
hide VB O
something NN O
. . O

Bread NNP B-Malware
has VBZ O
used VBN O
a DT O
few JJ O
tricks NNS O
to TO O
keep VB O
strings NNS O
in IN O
plaintext NN O
while IN O
preventing VBG O
basic JJ O
string NN O
matching NN O
. . O

Going VBG O
one CD O
step NN O
further RBR O
, , O
these DT O
substrings NNS O
are VBP O
sometimes RB O
scattered VBN O
throughout IN O
the DT O
code NN O
, , O
retrieved VBN O
from IN O
static JJ O
variables NNS O
and CC O
method NN O
calls NNS O
. . O

Various JJ O
versions NNS O
may MD O
also RB O
change VB O
the DT O
index NN O
of IN O
the DT O
split NN O
( ( O
e.g NN O
. . O

“ JJ O
.clic JJ O
” NN O
and CC O
“ JJ O
k NN O
( ( O
) ) O
; : O
” VBN O
) ) O
. . O

Delimiters NNS O
Another DT O
technique NN O
to TO O
obfuscate VB O
unencrypted JJ O
strings NNS O
uses NNS O
repeated VBD O
delimiters NNS O
. . O

A DT O
short JJ O
, , O
constant JJ O
string NN O
of IN O
characters NNS O
is VBZ O
inserted VBN O
at IN O
strategic JJ O
points NNS O
to TO O
break VB O
up RP O
keywords NNS O
: : O
At IN O
runtime NN O
, , O
the DT O
delimiter NN O
is VBZ O
removed VBN O
before IN O
using VBG O
the DT O
string NN O
: : O
API NNP O
OBFUSCATION NNP O
SMS NNP O
and CC O
toll NN O
fraud NN O
generally RB O
requires VBZ O
a DT O
few JJ O
basic JJ O
behaviors NNS O
( ( O
for IN O
example NN O
, , O
disabling VBG O
WiFi NNP O
or CC O
accessing VBG O
SMS NNP O
) ) O
, , O
which WDT O
are VBP O
accessible JJ O
by IN O
a DT O
handful NN O
of IN O
APIs NNP O
. . O

Given VBN O
that IN O
there EX O
are VBP O
a DT O
limited JJ O
number NN O
of IN O
behaviors NNS O
required VBN O
to TO O
identify VB O
billing NN O
fraud NN O
, , O
Bread NNP B-Malware
apps NN O
have VBP O
had VBN O
to TO O
try VB O
a DT O
wide JJ O
variety NN O
of IN O
techniques NNS O
to TO O
mask VB O
usage NN O
of IN O
these DT O
APIs NNP O
. . O

Reflection NN O
Most JJS O
methods NNS O
for IN O
hiding VBG O
API NNP O
usage JJ O
tend VBP O
to TO O
use VB O
Java NNP O
reflection NN O
in IN O
some DT O
way NN O
. . O

In IN O
some DT O
samples NNS O
, , O
Bread NNP B-Malware
has VBZ O
simply RB O
directly RB O
called VBD O
the DT O
Reflect NNP O
API NNP O
on IN O
strings NNS O
decrypted VBN O
at IN O
runtime NN O
. . O

JNI NNP O
Bread NNP B-Malware
has VBZ O
also RB O
tested VBN O
our PRP$ O
ability NN O
to TO O
analyze VB O
native JJ O
code NN O
. . O

In IN O
one CD O
sample NN O
, , O
no DT O
SMS-related JJ O
code NN O
appears VBZ O
in IN O
the DT O
DEX NNP O
file NN O
, , O
but CC O
there EX O
is VBZ O
a DT O
native JJ O
method NN O
registered VBD O
. . O

Two CD O
strings NNS O
are VBP O
passed VBN O
into IN O
the DT O
call NN O
, , O
the DT O
shortcode NN O
and CC O
keyword NN O
used VBN O
for IN O
SMS NNP O
billing NN O
( ( O
getter JJ O
methods NNS O
renamed VBN O
here RB O
for IN O
clarity NN O
) ) O
. . O

In IN O
the DT O
native JJ O
library NN O
, , O
it PRP O
stores NNS O
the DT O
strings NNS O
to TO O
access NN O
the DT O
SMS NNP O
API NNP O
. . O

The DT O
nativesend JJ O
method NN O
uses VBZ O
the DT O
Java NNP O
Native NNP O
Interface NNP O
( ( O
JNI NNP O
) ) O
to TO O
fetch VB O
and CC O
call VB O
the DT O
Android NNP B-System
SMS NNP O
API NNP O
. . O

The DT O
following NN O
is VBZ O
a DT O
screenshot NN O
from IN O
IDA NNP O
with IN O
comments NNS O
showing VBG O
the DT O
strings NNS O
and CC O
JNI NNP O
functions NNS O
. . O

WebView NNP O
JavaScript NNP O
Interface NNP O
Continuing NNP O
on IN O
the DT O
theme NN O
of IN O
cross-language NN O
bridges NNS O
, , O
Bread NNP B-Malware
has VBZ O
also RB O
tried VBN O
out RP O
some DT O
obfuscation NN O
methods NNS O
utilizing VBG O
JavaScript NNP O
in IN O
WebViews NNP O
. . O

The DT O
following JJ O
method NN O
is VBZ O
declared VBN O
in IN O
the DT O
DEX NNP O
. . O

Without IN O
context NN O
, , O
this DT O
method NN O
does VBZ O
not RB O
reveal VB O
much RB O
about IN O
its PRP$ O
intended JJ O
behavior NN O
, , O
and CC O
there EX O
are VBP O
no DT O
calls NNS O
made VBN O
to TO O
it PRP O
anywhere RB O
in IN O
the DT O
DEX NNP O
. . O

However RB O
, , O
the DT O
app NN O
does VBZ O
create VB O
a DT O
WebView NNP O
and CC O
registers VBZ O
a DT O
JavaScript NNP O
interface NN O
to TO O
this DT O
class NN O
. . O

This DT O
gives VBZ O
JavaScript NNP O
run NN O
in IN O
the DT O
WebView NNP O
access NN O
to TO O
this DT O
method NN O
. . O

The DT O
app NN O
loads VBZ O
a DT O
URL NNP O
pointing NN O
to TO O
a DT O
Bread-controlled JJ O
server NN O
. . O

The DT O
response NN O
contains VBZ O
some DT O
basic JJ O
HTML NNP O
and CC O
JavaScript NNP O
. . O

In IN O
green JJ O
, , O
we PRP O
can MD O
see VB O
the DT O
references NNS O
to TO O
the DT O
SMS NNP O
API NNP O
. . O

In IN O
red JJ O
, , O
we PRP O
see VBP O
those DT O
values NNS O
being VBG O
passed VBN O
into IN O
the DT O
suspicious JJ O
Java NNP O
method NN O
through IN O
the DT O
registered JJ O
interface NN O
. . O

Now RB O
, , O
using VBG O
these DT O
strings NNS O
method1 NN O
can MD O
use VB O
reflection NN O
to TO O
call VB O
sendTextMessage NN O
and CC O
process NN O
the DT O
payment NN O
. . O

PACKING NN O
In IN O
addition NN O
to TO O
implementing VBG O
custom JJ O
obfuscation NN O
techniques NNS O
, , O
apps NNS O
have VBP O
used VBN O
several JJ O
commercially RB O
available JJ O
packers NNS O
including VBG O
: : O
Qihoo360 NN B-System
, , O
AliProtect NNP B-System
and CC O
SecShell NNP B-System
. . O

More RBR O
recently RB O
, , O
we PRP O
have VBP O
seen VBN O
Bread-related NNP B-Malware
apps JJ O
trying VBG O
to TO O
hide VB O
malicious JJ O
code NN O
in IN O
a DT O
native JJ O
library NN O
shipped VBD O
with IN O
the DT O
APK NNP O
. . O

Earlier RBR O
this DT O
year NN O
, , O
we PRP O
discovered VBD O
apps RP O
hiding VBG O
a DT O
JAR NNP O
in IN O
the DT O
data NN O
section NN O
of IN O
an DT O
ELF NNP O
file NN O
which WDT O
it PRP O
then RB O
dynamically RB O
loads VBZ O
using VBG O
DexClassLoader NNP O
. . O

The DT O
figure NN O
below NN O
shows VBZ O
a DT O
fragment NN O
of IN O
encrypted JJ O
JAR NNP O
stored VBD O
in IN O
.rodata NNP O
section NN O
of IN O
a DT O
shared VBN O
object NN O
shipped VBN O
with IN O
the DT O
APK NNP O
as RB O
well RB O
as IN O
the DT O
XOR NNP O
key NN O
used VBN O
for IN O
decryption NN O
. . O

After IN O
we PRP O
blocked VBD O
those DT O
samples NNS O
, , O
they PRP O
moved VBD O
a DT O
significant JJ O
portion NN O
of IN O
malicious JJ O
functionality NN O
into IN O
the DT O
native JJ O
library NN O
, , O
which WDT O
resulted VBD O
in IN O
a DT O
rather RB O
peculiar JJ O
back RB O
and CC O
forth NN O
between IN O
Dalvik NNP O
and CC O
native JJ O
code NN O
: : O
COMMAND NNP O
& CC O
CONTROL NNP O
Dynamic NNP O
Shortcodes NNP O
& CC O
Content NNP O
Early NNP O
versions NNS O
of IN O
Bread NNP O
utilized VBD O
a DT O
basic JJ O
command NN O
and CC O
control NN O
infrastructure NN O
to TO O
dynamically RB O
deliver VB O
content NN O
and CC O
retrieve VB O
billing NN O
details NNS O
. . O

In IN O
the DT O
example NN O
server NN O
response NN O
below IN O
, , O
the DT O
green JJ O
fields NNS O
show VBP O
text JJ O
to TO O
be VB O
shown VBN O
to TO O
the DT O
user NN O
. . O

The DT O
red JJ O
fields NNS O
are VBP O
used VBN O
as IN O
the DT O
shortcode NN O
and CC O
keyword NN O
for IN O
SMS NNP O
billing NN O
. . O

State NN O
Machines NNS O
Since IN O
various JJ O
carriers NNS O
implement VBP O
the DT O
billing NN O
process NN O
differently RB O
, , O
Bread NNP B-Malware
has VBZ O
developed VBN O
several JJ O
variants NNS O
containing VBG O
generalized JJ O
state NN O
machines NNS O
implementing VBG O
all DT O
possible JJ O
steps NNS O
. . O

At IN O
runtime NN O
, , O
the DT O
apps NN O
can MD O
check VB O
which WDT O
carrier NN O
the DT O
device NN O
is VBZ O
connected VBN O
to TO O
and CC O
fetch VB O
a DT O
configuration NN O
object NN O
from IN O
the DT O
command NN O
and CC O
control NN O
server NN O
. . O

The DT O
configuration NN O
contains VBZ O
a DT O
list NN O
of IN O
steps NNS O
to TO O
execute VB O
with IN O
URLs NNP O
and CC O
JavaScript NNP O
. . O

The DT O
steps NNS O
implemented VBN O
include VBP O
: : O
Load VB O
a DT O
URL NNP O
in IN O
a DT O
WebView NNP O
Run NNP O
JavaScript NNP O
in IN O
WebView NNP O
Toggle NNP O
WiFi NNP O
state NN O
Toggle NNP O
mobile NN O
data NNS O
state NN O
Read/modify NNP O
SMS NNP O
inbox NN O
Solve NNP O
captchas NN O
Captchas NNP O
One CD O
of IN O
the DT O
more RBR O
interesting JJ O
states NNS O
implements VBP O
the DT O
ability NN O
to TO O
solve VB O
basic JJ O
captchas NN O
( ( O
obscured JJ O
letters NNS O
and CC O
numbers NNS O
) ) O
. . O

First RB O
, , O
the DT O
app NN O
creates VBZ O
a DT O
JavaScript NNP O
function NN O
to TO O
call VB O
a DT O
Java NNP O
method NN O
, , O
getImageBase64 NN O
, , O
exposed VBN O
to TO O
WebView NNP O
using VBG O
addJavascriptInterface NN O
. . O

The DT O
value NN O
used VBN O
to TO O
replace VB O
GET_IMG_OBJECT NNP O
comes VBZ O
from IN O
the DT O
JSON NNP O
configuration NN O
. . O

The DT O
app NN O
then RB O
uses VBZ O
JavaScript NNP O
injection NN O
to TO O
create VB O
a DT O
new JJ O
script NN O
in IN O
the DT O
carrier NN O
’ NNP O
s NN O
web NN O
page NN O
to TO O
run VB O
the DT O
new JJ O
function NN O
. . O

The DT O
base64-encoded JJ O
image NN O
is VBZ O
then RB O
uploaded JJ O
to TO O
an DT O
image NN O
recognition NN O
service NN O
. . O

If IN O
the DT O
text NN O
is VBZ O
retrieved VBN O
successfully RB O
, , O
the DT O
app NN O
uses VBZ O
JavaScript NNP O
injection NN O
again RB O
to TO O
submit VB O
the DT O
HTML NNP O
form NN O
with IN O
the DT O
captcha NN O
answer NN O
. . O

CLOAKING NNP O
Client-side NNP O
Carrier NNP O
Checks NNP O
In IN O
our PRP$ O
basic JJ O
command NN O
& CC O
control NN O
example NN O
above IN O
, , O
we PRP O
didn VBP O
’ JJ O
t NN O
address IN O
the DT O
( ( O
incorrectly RB O
labeled VBN O
) ) O
“ NN O
imei JJ O
” NNP O
field NN O
. . O

This DT O
contains VBZ O
the DT O
Mobile NNP O
Country NNP O
Code NNP O
( ( O
MCC NNP O
) ) O
and CC O
Mobile NNP O
Network NNP O
Code NNP O
( ( O
MNC NNP O
) ) O
values VBZ O
that IN O
the DT O
billing NN O
process NN O
will MD O
work VB O
for IN O
. . O

In IN O
this DT O
example NN O
, , O
the DT O
server NN O
response NN O
contains VBZ O
several JJ O
values NNS O
for IN O
Thai NNP O
carriers NNS O
. . O

The DT O
app NN O
checks NNS O
if IN O
the DT O
device NN O
’ NNP O
s NN O
network NN O
matches VBZ O
one CD O
of IN O
those DT O
provided VBN O
by IN O
the DT O
server NN O
. . O

If IN O
it PRP O
does VBZ O
, , O
it PRP O
will MD O
commence VB O
with IN O
the DT O
billing NN O
process NN O
. . O

If IN O
the DT O
value NN O
does VBZ O
not RB O
match VB O
, , O
the DT O
app NN O
skips VBZ O
the DT O
“ JJ O
disclosure NN O
” NNP O
page NN O
and CC O
billing NN O
process NN O
and CC O
brings VBZ O
the DT O
user NN O
straight VBD O
to TO O
the DT O
app NN O
content NN O
. . O

In IN O
some DT O
versions NNS O
, , O
the DT O
server NN O
would MD O
only RB O
return VB O
valid JJ O
responses NNS O
several JJ O
days NNS O
after IN O
the DT O
apps NN O
were VBD O
submitted VBN O
. . O

Server-side JJ O
Carrier NNP O
Checks NNP O
In IN O
the DT O
JavaScript NNP O
bridge NN O
API NNP O
obfuscation NN O
example NN O
covered VBN O
above IN O
, , O
the DT O
server NN O
supplied VBD O
the DT O
app NN O
with IN O
the DT O
necessary JJ O
strings NNS O
to TO O
complete VB O
the DT O
billing NN O
process NN O
. . O

However RB O
, , O
analysts NNS O
may MD O
not RB O
always RB O
see VB O
the DT O
indicators NNS O
of IN O
compromise NN O
in IN O
the DT O
server NN O
’ NNP O
s NN O
response NN O
. . O

In IN O
this DT O
example NN O
, , O
the DT O
requests NNS O
to TO O
the DT O
server NN O
take VB O
the DT O
following JJ O
form NN O
: : O
Here RB O
, , O
the DT O
“ NN O
operator NN O
” JJ O
query NN O
parameter NN O
is VBZ O
the DT O
Mobile JJ O
Country NNP O
Code NNP O
and CC O
Mobile NNP O
Network NNP O
Code NNP O
. . O

The DT O
server NN O
can MD O
use VB O
this DT O
information NN O
to TO O
determine VB O
if IN O
the DT O
user NN O
’ NNP O
s NN O
carrier NN O
is VBZ O
one CD O
of IN O
Bread NNP B-Malware
’ NNP O
s JJ O
targets NNS O
. . O

If IN O
not RB O
, , O
the DT O
response NN O
is VBZ O
scrubbed VBN O
of IN O
the DT O
strings NNS O
used VBN O
to TO O
complete VB O
the DT O
billing NN O
fraud NN O
. . O

MISLEADING NN O
USERS NNS O
Bread NNP B-Malware
apps NN O
sometimes RB O
display VB O
a DT O
pop-up NN O
to TO O
the DT O
user NN O
that WDT O
implies VBZ O
some DT O
form NN O
of IN O
compliance NN O
or CC O
disclosure NN O
, , O
showing VBG O
terms NNS O
and CC O
conditions NNS O
or CC O
a DT O
confirm JJ O
button NN O
. . O

However RB O
, , O
the DT O
actual JJ O
text NN O
would MD O
often RB O
only RB O
display VB O
a DT O
basic JJ O
welcome JJ O
message NN O
. . O

Other JJ O
versions NNS O
included VBD O
all PDT O
the DT O
pieces NNS O
needed VBN O
for IN O
a DT O
valid JJ O
disclosure NN O
message NN O
. . O

However RB O
, , O
there EX O
are VBP O
still RB O
two CD O
issues NNS O
here RB O
: : O
The DT O
numbers NNS O
to TO O
contact VB O
for IN O
cancelling VBG O
the DT O
subscription NN O
are VBP O
not RB O
real JJ O
The DT O
billing NN O
process NN O
commences NNS O
even RB O
if IN O
you PRP O
don VBP O
’ JJ O
t NN O
hit VBD O
the DT O
“ NNP O
Confirm NNP O
” NNP O
button VBD O
Even RB O
if IN O
the DT O
disclosure NN O
here RB O
displayed VBN O
accurate JJ O
information NN O
, , O
the DT O
user NN O
would MD O
often RB O
find VB O
that IN O
the DT O
advertised JJ O
functionality NN O
of IN O
the DT O
app NN O
did VBD O
not RB O
match VB O
the DT O
actual JJ O
content NN O
. . O

Bread NNP B-Malware
apps VBZ O
frequently RB O
contain VBP O
no DT O
functionality NN O
beyond IN O
the DT O
billing NN O
process NN O
or CC O
simply RB O
clone JJ O
content NN O
from IN O
other JJ O
popular JJ O
apps NN O
. . O

VERSIONING NN O
Bread NNP B-Malware
has VBZ O
also RB O
leveraged VBN O
an DT O
abuse NN O
tactic JJ O
unique NN O
to TO O
app VB O
stores NNS O
: : O
versioning NN O
. . O

Some DT O
apps NNS O
have VBP O
started VBN O
with IN O
clean JJ O
versions NNS O
, , O
in IN O
an DT O
attempt NN O
to TO O
grow VB O
user NN O
bases NNS O
and CC O
build VB O
the DT O
developer NN O
accounts VBZ O
’ JJ O
reputations NNS O
. . O

Only RB O
later RB O
is VBZ O
the DT O
malicious JJ O
code NN O
introduced VBD O
, , O
through IN O
an DT O
update NN O
. . O

Interestingly RB O
, , O
early JJ O
“ JJ O
clean JJ O
” NN O
versions NNS O
contain VBP O
varying VBG O
levels NNS O
of IN O
signals NNS O
that IN O
the DT O
updates NNS O
will MD O
include VB O
malicious JJ O
code NN O
later RBR O
. . O

Some DT O
are VBP O
first JJ O
uploaded JJ O
with IN O
all PDT O
the DT O
necessary JJ O
code NN O
except IN O
the DT O
one CD O
line NN O
that WDT O
actually RB O
initializes VBZ O
the DT O
billing NN O
process NN O
. . O

Others NNS O
may MD O
have VB O
the DT O
necessary JJ O
permissions NNS O
, , O
but CC O
are VBP O
missing VBG O
the DT O
classes NNS O
containing VBG O
the DT O
fraud NN O
code NN O
. . O

And CC O
others NNS O
have VBP O
all DT O
malicious JJ O
content NN O
removed VBD O
, , O
except IN O
for IN O
log NN O
comments NNS O
referencing VBG O
the DT O
payment NN O
process NN O
. . O

All DT O
of IN O
these DT O
methods NNS O
attempt VBP O
to TO O
space NN O
out RP O
the DT O
introduction NN O
of IN O
possible JJ O
signals NNS O
in IN O
various JJ O
stages NNS O
, , O
testing VBG O
for IN O
gaps NNS O
in IN O
the DT O
publication NN O
process NN O
. . O

However RB O
, , O
GPP NNP O
does VBZ O
not RB O
treat VB O
new JJ O
apps NN O
and CC O
updates VBZ O
any DT O
differently RB O
from IN O
an DT O
analysis NN O
perspective NN O
. . O

FAKE NNP O
REVIEWS NNP O
When WRB O
early JJ O
versions NNS O
of IN O
apps NN O
are VBP O
first RB O
published VBN O
, , O
many JJ O
five CD O
star JJ O
reviews NNS O
appear VBP O
with IN O
comments NNS O
like IN O
: : O
“ NNS O
So IN O
.. JJ O
good JJ O
.. NN O
” NNP O
“ NNP O
very RB O
beautiful JJ O
” NN O
Later NNP O
, , O
1 CD O
star NN O
reviews NNS O
from IN O
real JJ O
users NNS O
start VBP O
appearing VBG O
with IN O
comments NNS O
like IN O
: : O
“ JJ O
Deception NNP O
” NNP O
“ VBD O
The DT O
app NN O
is VBZ O
not RB O
honest JJ O
… NN O
” NNP O
SUMMARY NNP O
Sheer NNP O
volume NN O
appears VBZ O
to TO O
be VB O
the DT O
preferred JJ O
approach NN O
for IN O
Bread NNP B-Malware
developers NNS O
. . O

At IN O
different JJ O
times NNS O
, , O
we PRP O
have VBP O
seen VBN O
three CD O
or CC O
more JJR O
active JJ O
variants NNS O
using VBG O
different JJ O
approaches NNS O
or CC O
targeting VBG O
different JJ O
carriers NNS O
. . O

Within IN O
each DT O
variant NN O
, , O
the DT O
malicious JJ O
code NN O
present NN O
in IN O
each DT O
sample NN O
may MD O
look VB O
nearly RB O
identical JJ O
with IN O
only RB O
one CD O
evasion NN O
technique NN O
changed VBD O
. . O

Sample JJ O
1 CD O
may MD O
use VB O
AES-encrypted JJ B-Organization
strings NNS O
with IN O
reflection NN O
, , O
while IN O
Sample JJ O
2 CD O
( ( O
submitted VBN O
on IN O
the DT O
same JJ O
day NN O
) ) O
will MD O
use VB O
the DT O
same JJ O
code NN O
but CC O
with IN O
plaintext JJ O
strings NNS O
. . O

At IN O
peak JJ O
times NNS O
of IN O
activity NN O
, , O
we PRP O
have VBP O
seen VBN O
up RP O
to TO O
23 CD O
different JJ O
apps NN O
from IN O
this DT O
family NN O
submitted VBN O
to TO O
Play VB B-System
in IN O
one CD O
day NN O
. . O

At IN O
other JJ O
times NNS O
, , O
Bread NNP B-Malware
appears VBZ O
to TO O
abandon VB O
hope NN O
of IN O
making VBG O
a DT O
variant JJ O
successful JJ O
and CC O
we PRP O
see VBP O
a DT O
gap NN O
of IN O
a DT O
week NN O
or CC O
longer JJR O
before IN O
the DT O
next JJ O
variant NN O
. . O

This DT O
family NN O
showcases VBZ O
the DT O
amount NN O
of IN O
resources NNS O
that WDT O
malware VBP O
authors NNS O
now RB O
have VBP O
to TO O
expend VB O
. . O

Google NNP B-System
Play NNP I-System
Protect NNP I-System
is VBZ O
constantly RB O
updating JJ O
detection NN O
engines NNS O
and CC O
warning VBG O
users NNS O
of IN O
malicious JJ O
apps NNS O
installed VBN O
on IN O
their PRP$ O
device NN O
. . O

SELECTED NNP O
SAMPLES NNP O
Package NNP O
Name NNP O
SHA-256 NNP O
Digest NNP O
com.rabbit.artcamera NN B-Indicator
18c277c7953983f45f2fe6ab4c7d872b2794c256604e43500045cb2b2084103f CD B-Indicator
org.horoscope.astrology.predict NN B-Indicator
6f1a1dbeb5b28c80ddc51b77a83c7a27b045309c4f1bff48aaff7d79dfd4eb26 CD B-Indicator
com.theforest.rotatemarswallpaper NN B-Indicator
4e78a26832a0d471922eb61231bc498463337fed8874db5f70b17dd06dcb9f09 CD B-Indicator

com.jspany.temp NN B-Indicator
0ce78efa764ce1e7fb92c4de351ec1113f3e2ca4b2932feef46d7d62d6ae87f5 CD B-Indicator
com.hua.ru.quan JJ B-Indicator
780936deb27be5dceea20a5489014236796a74cc967a12e36cb56d9b8df9bc86 CD B-Indicator
com.rongnea.udonood NN B-Indicator
8b2271938c524dd1064e74717b82e48b778e49e26b5ac2dae8856555b5489131 CD B-Indicator

com.mbv.a.wp NN B-Indicator
01611e16f573da2c9dbc7acdd445d84bae71fecf2927753e341d8a5652b89a68 CD B-Indicator
com.pho.nec.sg NN B-Indicator
b4822eeb71c83e4aab5ddfecfb58459e5c5e10d382a2364da1c42621f58e119b NN B-Indicator
Exobot NNP B-Malware
( ( O
Marcher NNP B-Malware
) ) O
- : O
Android $ B-System
banking VBG O
Trojan NNP O
on IN O
the DT O
rise NN O
February NNP O
2017 CD O
Introduction NNP O
The DT O
past JJ O
months NNS O
many JJ O
different JJ O
banking NN O
Trojans NNS O
for IN O

the DT O
Android NNP B-System
platform NN O
have VBP O
received VBN O
media NNS O
attention NN O
. . O

One CD O
of IN O
these DT O
, , O
called VBD O
Marcher NNP B-Malware
( ( O
aka IN O
Exobot NNP B-Malware
) ) O
, , O
seems VBZ O
to TO O
be VB O
especially RB O
active JJ O
with IN O
different JJ O
samples NNS O
appearing VBG O
on IN O
a DT O
daily JJ O
basis NN O
. . O

This DT O
malware NN O
variant NN O
also RB O
appears VBZ O
to TO O
be VB O
technically RB O
superior JJ O
to TO O
many JJ O
other JJ O
banking NN O
Trojans NNPS O
being VBG O
able JJ O
to TO O
use VB O
its PRP$ O
overlay NN O
attack NN O
even RB O
on IN O
Android NNP B-System
6 CD I-System
, , O
which WDT O
has VBZ O
technical JJ O
improvements NNS O
compared VBN O
to TO O
the DT O
previous JJ O
Android NNP B-System
versions NNS O
to TO O
prevent VB O
such JJ O
attacks NNS O
. . O

The DT O
main JJ O
infection NN O
vector NN O
is VBZ O
a DT O
phishing VBG O
attack NN O
using VBG O
SMS/MMS NNP O
. . O

The DT O
social JJ O
engineering NN O
message NN O
includes VBZ O
a DT O
link NN O
that WDT O
leads VBZ O
to TO O
a DT O
fake JJ O
version NN O
of IN O
a DT O
popular JJ O
app NN O
, , O
using VBG O
names NNS O
like IN O
Runtastic NNP B-System
, , O
WhatsApp NNP B-System
or CC O
Netflix NNP B-System
. . O

On IN O
installation NN O
, , O
the DT O
app NN O
requests VBZ O
the DT O
user NN O
to TO O
provide VB O
SMS NNP O
storage NN O
access NN O
and CC O
high JJ O
Android NNP B-System
privileges NNS O
such JJ O
as IN O
Device NNP O
Admin NNP O
. . O

Other JJ O
infection NN O
vectors NNS O
include VBP O
pornographic JJ O
websites NNS O
serving VBG O
apps NN O
called VBN O
Adobe NNP B-System
Flash NNP I-System
or CC O
YouPorn NNP B-System
. . O

The DT O
Marcher NNP B-Malware
banking NN O
malware NN O
uses VBZ O
two CD O
main JJ O
attack NN O
vectors NNS O
. . O

The DT O
first JJ O
attack NN O
vector NN O
is VBZ O
to TO O
compromise VB O
the DT O
out NN O
of IN O
band NN O
authentication NN O
for IN O
online JJ O
banks NNS O
that WDT O
rely VBP O
on IN O
SMS NNP O
using VBG O
SMS NNP O
forwarding NN O
. . O

The DT O
second JJ O
attack NN O
vector NN O
, , O
the DT O
overlay NN O
attack NN O
, , O
shows VBZ O
a DT O
customized JJ O
phishing NN O
window NN O
whenever WRB O
a DT O
targeted JJ O
application NN O
is VBZ O
started VBN O
on IN O
the DT O
device NN O
. . O

The DT O
overlay NN O
window NN O
is VBZ O
often RB O
indistinguishable JJ O
from IN O
the DT O
expected VBN O
screen NN O
( ( O
such JJ O
as IN O
a DT O
login NN O
screen NN O
for IN O
a DT O
banking NN O
app NN O
) ) O
and CC O
is VBZ O
used VBN O
to TO O
steal VB O
the DT O
victim NN O
’ NNP O
s NN O
banking NN O
credentials NNS O
. . O

The DT O
target NN O
list NN O
and CC O
bank NN O
specific JJ O
fake JJ O
login NN O
pages NNS O
can MD O
be VB O
dynamically RB O
updated JJ O
via IN O
their PRP$ O
C2 NNP O
panel NN O
( ( O
dashboard JJ O
back-end NN O
) ) O
which WDT O
significantly RB O
increases VBZ O
the DT O
adaptability NN O
and CC O
scalability NN O
of IN O
this DT O
attack NN O
. . O

In IN O
addition NN O
, , O
this DT O
type NN O
of IN O
Android NNP B-System
banking NN O
malware NN O
does VBZ O
not RB O
require VB O
the DT O
device NN O
to TO O
be VB O
rooted VBN O
or CC O
the DT O
app NN O
to TO O
have VB O
any DT O
specific JJ O
Android NNP B-System
permission NN O
( ( O
besides IN O
android.permission.INTERNET NN B-Indicator
to TO O
retrieve VB O
the DT O
overlay NN O
contents NNS O
and CC O
send VB O
its PRP$ O
captured VBN O
data NN O
) ) O
. . O

The DT O
many JJ O
changes NNS O
we PRP O
see VBP O
in IN O
the DT O
way NN O
the DT O
attacks NNS O
are VBP O
performed VBN O
show NN O
that IN O
attackers NNS O
are VBP O
heavily RB O
experimenting VBG O
to TO O
find VB O
the DT O
best JJS O
way NN O
of IN O
infecting VBG O
a DT O
mobile JJ O
device NN O
and CC O
abusing VBG O
existing VBG O
functionality NN O
to TO O
perform VB O
successful JJ O
phishing VBG O
attacks NNS O
. . O

The DT O
next JJ O
stage NN O
in IN O
device NN O
infection NN O
could MD O
be VB O
the DT O
use NN O
of IN O
exploit JJ O
kits NNS O
and CC O
malvertising NN O
, , O
which WDT O
would MD O
be VB O
quite RB O
effective JJ O
due JJ O
the DT O
many JJ O
Android NNP B-Vulnerability
vulnerabilities NNS I-Vulnerability
and CC O
consumers NNS O
with IN O
unpatched JJ B-Vulnerability
devices NNS I-Vulnerability
. . O

In IN O
addition NN O
future NN O
Trojans NNP O
could MD O
leverage VB O
root JJ O
exploits NNS O
to TO O
make VB O
them PRP O
almost RB O
impossible JJ O
to TO O
remove VB O
and CC O
give VB O
malicious JJ O
actors NNS O
the DT O
ability NN O
to TO O
hook VB O
generic JJ O
low JJ O
level NN O
API NNP O
’ NNP O
s NN O
that WDT O
are VBP O
used VBN O
by IN O
all DT O
( ( O
banking NN O
) ) O
applications NNS O
, , O
just RB O
like IN O
the DT O
attack NN O
vector NN O
as IN O
has VBZ O
been VBN O
used VBN O
on IN O
the DT O
desktop NN O
platform NN O
for IN O
years NNS O
. . O

Technical JJ O
Analysis NNP O
Permissions NNP O
Marcher NNP B-Malware
’ NNP O
s VBD O
APK NNP O
size NN O
is VBZ O
fairly RB O
small JJ O
( ( O
only RB O
683KB CD O
for IN O
sample NN O
eb8f02fc30ec49e4af1560e54b53d1a7 NN B-Indicator
) ) O
, , O
much RB O
smaller JJR O
than IN O
most JJS O
legitimate JJ O
apps NN O
and CC O
other JJ O
popular JJ O
mobile NNS O
malware NN O
samples NNS O
. . O

This DT O
sample NN O
only RB O
includes VBZ O
Dalvik NNP O
bytecode NN O
and CC O
resources NNS O
without IN O
any DT O
native JJ O
libraries NNS O
. . O

The DT O
package NN O
name NN O
( ( O
vyn.hhsdzgvoexobmkygffzwuewrbikzud NN B-Indicator
) ) O
and CC O
its PRP$ O
many JJ O
activities NNS O
and CC O
services NNS O
have VBP O
randomized VBN O
names NNS O
, , O
probably RB O
to TO O
make VB O
it PRP O
a DT O
bit RB O
more RBR O
difficult JJ O
to TO O
detect VB O
the DT O
package NN O
using VBG O
blacklisting NN O
. . O

The DT O
set NN O
of IN O
permissions NNS O
required VBN O
by IN O
Marcher NNP B-Malware
according VBG O
to TO O
the DT O
manifest NN O
is VBZ O
as IN O
follows VBZ O
: : O
∗ JJ O
android.permission.CHANGE_NETWORK_STATE NN B-Indicator
( ( O
change NN O
network NN O
connectivity NN O
state NN O
) ) O
∗ NN O
android.permission.SEND_SMS NN B-Indicator
( ( O
send JJ O
SMS NNP O
messages NNS O
) ) O
∗ VBP O
android.permission.USES_POLICY_FORCE_LOCK NN B-Indicator
( ( O
lock VB O
the DT O
device NN O
) ) O
∗ NN O
android.permission.RECEIVE_BOOT_COMPLETED NN B-Indicator
( ( O
start JJ O
malware NN O
when WRB O
device NN O
boots NNS O
) ) O
∗ VBP O
android.permission.INTERNET NN B-Indicator
( ( O
communicate NN O
with IN O
the DT O
internet NN O
) ) O
∗ NN O
android.permission.VIBRATE NN B-Indicator

( ( O
control VB O
the DT O
vibrator NN O
) ) O
∗ NN O
android.permission.ACCESS_WIFI_STATE NN B-Indicator
( ( O
view NN O
information NN O
about IN O
the DT O
status NN O
of IN O
Wi-Fi NNP O
) ) O
∗ FW O
android.permission.WRITE_SMS NN B-Indicator
( ( O
edit/delete JJ O
SMS NNP O
) ) O
∗ NN O
android.permission.ACCESS_NETWORK_STATE NN B-Indicator
( ( O
view IN O
the DT O
status NN O
of IN O
all DT O
networks NNS O
) ) O
∗ VBP O
android.permission.WAKE_LOCK NN B-Indicator
( ( O
prevent VB O
the DT O
phone NN O
from IN O
going VBG O
to TO O
sleep VB O
) ) O
∗ FW O
android.permission.GET_TASKS NN B-Indicator
( ( O
retrieve JJ O
running NN O
applications NNS O
) ) O
∗ VBP O
android.permission.CALL_PHONE NN B-Indicator
( ( O
call VB O
phone NN O
numbers NNS O
) ) O

∗ JJ O
android.permission.WRITE_SETTINGS NN B-Indicator
( ( O
read/write VB O
global JJ O
system NN O
settings NNS O
) ) O
∗ VBP O
android.permission.RECEIVE_SMS NN B-Indicator
( ( O
intercept JJ O
SMS NNP O
messages NNS O
) ) O
∗ VBP O
android.permission.READ_PHONE_STATE NN B-Indicator
( ( O
read VB O
phone NN O
details NNS O
of IN O
the DT O
device NN O
such JJ O
as IN O
phone NN O
number NN O
and CC O
serial JJ O
number NN O
) ) O
∗ FW O
android.permission.CHANGE_WIFI_STATE NN B-Indicator
( ( O
connect JJ O
to TO O
and CC O
disconnect VB O
from IN O
Wi-Fi NNP O
networks NNS O
and CC O
make VB O
changes NNS O
to TO O
configured VB O
networks NNS O
) ) O
∗ VBP O
android.permission.READ_CONTACTS NN B-Indicator
( ( O
read VB O
all DT O
contact VB O
data NNS O
) ) O
* VBP O
android.permission.READ_SMS NN B-Indicator

( ( O
read VB O
SMS NNP O
messages NNS O
) ) O
Obviously RB O
a DT O
fairly RB O
significant JJ O
list NN O
of IN O
permissions NNS O
of IN O
which WDT O
many JJ O
are VBP O
suspicious JJ O
, , O
especially RB O
when WRB O
combined VBN O
. . O

Runtastic JJ B-System
sample NN O
permission NN O
prompt JJ O
Runtastic NNP B-System
sample NN O
permission NN O
prompt NN O
Checking NNP O
foreground NN O
app NN O
Marcher NNP B-Malware
is VBZ O
one CD O
of IN O
the DT O
few JJ O
Android NNP O
banking NN O
Trojans NNPS O
to TO O
use VB O
the DT O
AndroidProcesses NNP O
library NN O
, , O
which WDT O
enables VBZ O
the DT O
application NN O
to TO O
obtain VB O
the DT O
name NN O
of IN O
the DT O
Android NNP B-System
package NN O
that WDT O
is VBZ O
currently RB O
running VBG O
in IN O
the DT O
foreground NN O
. . O

This DT O
library NN O
is VBZ O
used VBN O
because IN O
it PRP O
uses VBZ O
the DT O
only RB O
( ( O
publicly RB O
known VBN O
) ) O
way NN O
to TO O
retrieve VB O
this DT O
information NN O
on IN O
Android NNP B-System
6 CD I-System
( ( O
using VBG O
the DT O
process NN O
OOM NNP O
score NN O
read NN O
from IN O
the DT O
/proc NNP O
directory NN O
) ) O
. . O

When WRB O
the DT O
current JJ O
app NN O
on IN O
the DT O
foreground NN O
matches VBZ O
with IN O
an DT O
app NN O
targeted VBN O
by IN O
the DT O
malware NN O
, , O
the DT O
Trojan NNP O
will MD O
show VB O
the DT O
corresponding JJ O
phishing NN O
overlay NN O
, , O
making VBG O
the DT O
user NN O
think VBP O
it PRP O
is VBZ O
the DT O
app NN O
that WDT O
was VBD O
just RB O
started VBN O
. . O

Dynamic NNP O
overlays NNS O
When WRB O
victims NNS O
open VBP O
up RP O
a DT O
targeted JJ O
app NN O
, , O
Marcher NNP B-Malware
smoothly RB O
displays VBZ O
an DT O
overlay NN O
, , O
a DT O
customized JJ O
WebView NNP O
, , O
looks VBZ O
in IN O
its PRP$ O
application NN O
preferences NNS O
( ( O
main_prefs.xml NN O
) ) O
and CC O
decides VBZ O
which WDT O
specified VBD O
URL NNP O
is VBZ O
needed VBN O
for IN O
the DT O
targeted JJ O
app NN O
. . O

The DT O
complete JJ O
list NN O
of IN O
apps NN O
can MD O
be VB O
seen VBN O
below IN O
. . O

The DT O
phishing NN O
pages NNS O
shown VBN O
in IN O
the DT O
overlay NN O
use NN O
Ajax NNP O
calls VBZ O
to TO O
communicate VB O
with IN O
a DT O
PHP NNP O
back-end NN O
which WDT O
stores NNS O
all DT O
user NN O
input NN O
. . O

The DT O
C2 NNP O
backend NN O
url JJ O
looks VBZ O
like IN O
this DT O
: : O
https NN B-Indicator
: : I-Indicator
//evilhost/c2folder/njs2/ NN I-Indicator
? . I-Indicator

fields NNS I-Indicator
[ VBD I-Indicator
] NNP I-Indicator
. . O

There EX O
is VBZ O
no DT O
way NN O
to TO O
access NN O
the DT O
original JJ O
app NN O
again RB O
even RB O
if IN O
victims NNS O
terminate VBP O
the DT O
overlay NN O
process NN O
and CC O
reopen VB O
app NN O
, , O
until IN O
credit NN O
card NN O
( ( O
name NN O
, , O
number NN O
, , O
expiry JJ O
date NN O
, , O
security NN O
code NN O
) ) O
and/or VBZ O
bank NN O
information NN O
( ( O
PIN NNP O
, , O
VBV NNP O
passcode NN O
, , O
date NN O
of IN O
birth NN O
, , O
etc FW O
. . O

) ) O
are VBP O
filled VBN O
in IN O
and CC O
verified VBD O
. . O

The DT O
information NN O
is VBZ O
then RB O
stored VBN O
in IN O
local JJ O
app NN O
database NN O
as RB O
well RB O
as IN O
sent NN O
to TO O
the DT O
backend NN O
. . O

Agent NN B-Malware
Smith NNP I-Malware
: : O
A DT O
New NNP O
Species NNP O
of IN O
Mobile NNP O
Malware NNP O
July NNP O
10 CD O
, , O
2019 CD O
Check NNP B-Organization
Point NNP I-Organization
Researchers NNP O
recently RB O
discovered VBD O
a DT O
new JJ O
variant NN O
of IN O
mobile JJ O
malware NN O
that WDT O
quietly RB O
infected VBD O
around IN O
25 CD O
million CD O
devices NNS O
, , O
while IN O
the DT O
user NN O
remains VBZ O
completely RB O
unaware JJ O
. . O

Disguised VBN O
as IN O
Google NNP B-Organization
related VBD O
app NN O
, , O
the DT O
core NN O
part NN O
of IN O
malware NN O
exploits NNS O
various JJ O
known VBN O
Android NNP B-Vulnerability
vulnerabilities NNS I-Vulnerability
and CC O
automatically RB O
replaces NNS O
installed VBD O
apps NN O
on IN O
the DT O
device NN O
with IN O
malicious JJ O
versions NNS O
without IN O
the DT O
user NN O
’ NNP O
s NN O
interaction NN O
. . O

This DT O
unique JJ O
on-device JJ O
, , O
just-in-time JJ O
( ( O
JIT NNP O
) ) O
approach NN O
inspired VBD O
researchers NNS O
to TO O
dub VB O
this DT O
malware NN O
as IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
. . O

“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
currently RB O
uses VBZ O
its PRP$ O
broad JJ O
access NN O
to TO O
the DT O
device NN O
’ NNP O
s JJ O
resources NNS O
to TO O
show VB O
fraudulent JJ O
ads NNS O
for IN O
financial JJ O
gain NN O
. . O

This DT O
activity NN O
resembles VBZ O
previous JJ O
campaigns NNS O
such JJ O
as IN O
Gooligan NNP B-Malware
, , O
HummingBad NNP B-Malware
and CC O
CopyCat NNP B-Malware
. . O

The DT O
primary JJ O
targets NNS O
, , O
so RB O
far RB O
, , O
are VBP O
based VBN O
in IN O
India NNP O
though IN O
other JJ O
Asian JJ O
countries NNS O
such JJ O
as IN O
Pakistan NNP O
and CC O
Bangladesh NNP O
are VBP O
also RB O
affected VBN O
. . O

In IN O
a DT O
much-improved JJ O
Android NNP B-System
security NN O
environment NN O
, , O
the DT O
actors NNS O
behind IN O
Agent NNP B-Malware
Smith NNP I-Malware
seem VBP O
to TO O
have VB O
moved VBN O
into IN O
the DT O
more RBR O
complex JJ O
world NN O
of IN O
constantly RB O
searching VBG O
for IN O
new JJ O
loopholes NNS O
, , O
such JJ O
as IN O
Janus NNP B-Vulnerability
, , O
Bundle NNP B-Vulnerability
and CC O
Man-in-the-Disk NNP B-Vulnerability
, , O
to TO O
achieve VB O
a DT O
3-stage JJ O
infection NN O
chain NN O
, , O
in IN O
order NN O
to TO O
build VB O
a DT O
botnet NN O
of IN O
controlled JJ O
devices NNS O
to TO O
earn VB O
profit NN O
for IN O
the DT O
perpetrator NN O
. . O

“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
is VBZ O
possibly RB O
the DT O
first JJ O
campaign NN O
seen VBN O
that IN O
ingrates NNS O
and CC O
weaponized VBD O
all PDT O
these DT O
loopholes NNS O
and CC O
are VBP O
described VBN O
in IN O
detail NN O
below NN O
. . O

In IN O
this DT O
case NN O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
is VBZ O
being VBG O
used VBN O
to TO O
for IN O
financial JJ O
gain NN O
through IN O
the DT O
use NN O
of IN O
malicious JJ O
advertisements NNS O
. . O

However RB O
, , O
it PRP O
could MD O
easily RB O
be VB O
used VBN O
for IN O
far RB O
more RBR O
intrusive JJ O
and CC O
harmful JJ O
purposes NNS O
such JJ O
as IN O
banking VBG O
credential JJ O
theft NN O
. . O

Indeed RB O
, , O
due JJ O
to TO O
its PRP$ O
ability NN O
to TO O
hide VB O
it PRP O
’ NNP O
s VBD O
icon NN O
from IN O
the DT O
launcher NN O
and CC O
impersonates VBZ O
any DT O
popular JJ O
existing VBG O
apps NN O
on IN O
a DT O
device NN O
, , O
there EX O
are VBP O
endless JJ O
possibilities NNS O
for IN O
this DT O
sort NN O
of IN O
malware NN O
to TO O
harm VB O
a DT O
user NN O
’ NN O
s JJ O
device NN O
. . O

Check NNP B-Organization
Point NNP I-Organization
Research NNP O
has VBZ O
submitted VBN O
data NNS O
to TO O
Google NNP B-Organization
and CC O
law NN O
enforcement NN O
units NNS O
to TO O
facilitate VB O
further JJ O
investigation NN O
. . O

As IN O
a DT O
result NN O
, , O
information NN O
related VBN O
to TO O
the DT O
malicious JJ O
actor NN O
is VBZ O
tentatively RB O
redacted VBN O
in IN O
this DT O
publication NN O
. . O

Check NNP B-Organization
Point NNP I-Organization
has VBZ O
worked VBN O
closely RB O
with IN O
Google NNP B-Organization
and CC O
at IN O
the DT O
time NN O
of IN O
publishing NN O
, , O
no DT O
malicious JJ O
apps NN O
remain VBP O
on IN O
the DT O
Play NNP B-System
Store NNP I-System
. . O

Encounter NN O
In IN O
early JJ O
2019 CD O
, , O
the DT O
Check NNP B-Organization
Point NNP I-Organization
Research NNP O
team NN O
observed VBD O
a DT O
surge NN O
of IN O
Android NNP B-System
malware NNP O
attack NN O
attempts NNS O
against IN O
users NNS O
in IN O
India NNP O
which WDT O
had VBD O
strong JJ O
characteristics NNS O
of IN O
Janus NNP B-Vulnerability
vulnerability NN O
abuse NN O
; : O
All DT O
samples VBZ O
our PRP$ O
team NN O
collected VBD O
during IN O
preliminary JJ O
investigation NN O
had VBD O
the DT O
ability NN O
to TO O
hide VB O
their PRP$ O
app JJ O
icons NNS O
and CC O
claim NN O
to TO O
be VB O
Google NNP B-Organization
related JJ O
updaters NNS O
or CC O
vending VBG O
modules NNS O
( ( O
a DT O
key JJ O
component NN O
of IN O
Google NNP B-System
Play NNP I-System
framework NN O
) ) O
. . O

Upon IN O
further JJ O
analysis NN O
it PRP O
became VBD O
clear JJ O
this DT O
application NN O
was VBD O
as RB O
malicious JJ O
as IN O
they PRP O
come VBP O
and CC O
initially RB O
resembled VBD O
the DT O
CopyCat NNP B-Malware
malware NN O
, , O
discovered VBN O
by IN O
Check NNP B-Organization
Point NNP I-Organization
Research NNP O
back RB O
in IN O
April NNP O
2016 CD O
. . O

As IN O
the DT O
research NN O
progressed VBD O
, , O
it PRP O
started VBD O
to TO O
reveal VB O
unique JJ O
characteristics NNS O
which WDT O
made VBD O
us PRP O
believe VBP O
we PRP O
were VBD O
looking VBG O
at IN O
an DT O
all-new JJ O
malware NN O
campaign NN O
found VBN O
in IN O
the DT O
wild NN O
. . O

After IN O
a DT O
series NN O
of IN O
technical JJ O
analysis NN O
( ( O
which WDT O
is VBZ O
covered VBN O
in IN O
detail NN O
below IN O
) ) O
and CC O
heuristic JJ O
threat NN O
hunting NN O
, , O
we PRP O
discovered VBD O
that IN O
a DT O
complete JJ O
“ NN O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
infection NN O
has VBZ O
three CD O
main JJ O
phases NNS O
: : O
A DT O
dropper NN O
app NN O
lures VBZ O
victim NN O
to TO O
install VB O
itself PRP O
voluntarily RB O
. . O

The DT O
initial JJ O
dropper NN O
has VBZ O
a DT O
weaponized VBN O
Feng NNP O
Shui NNP O
Bundle NNP O
as IN O
encrypted JJ O
asset NN O
files NNS O
. . O

Dropper NNP O
variants NNS O
are VBP O
usually RB O
barely RB O
functioning VBG O
photo NN O
utility NN O
, , O
games NNS O
, , O
or CC O
sex NN O
related VBN O
apps NN O
. . O

The DT O
dropper NN O
automatically RB O
decrypts NNS O
and CC O
installs VBZ O
its PRP$ O
core NN O
malware NN O
APK NNP O
which WDT O
later RB O
conducts VBZ O
malicious JJ O
patching NN O
and CC O
app NN O
updates NNS O
. . O

The DT O
core NN O
malware NN O
is VBZ O
usually RB O
disguised VBN O
as IN O
Google NNP B-Organization
Updater NNP O
, , O
Google NNP B-Organization
Update NNP O
for IN O
U NNP O
or CC O
“ VB O
com.google.vending VBG B-Indicator
” NNP O
. . O

The DT O
core NN O
malware NN O
’ NNP O
s NN O
icon NN O
is VBZ O
hidden VBN O
. . O

The DT O
core NN O
malware NN O
extracts VBZ O
the DT O
device NN O
’ NNP O
s NN O
installed VBD O
app JJ O
list NN O
. . O

If IN O
it PRP O
finds VBZ O
apps RB O
on IN O
its PRP$ O
prey JJ O
list NN O
( ( O
hard-coded JJ O
or CC O
sent VBN O
from IN O
C NNP O
& CC O
C NNP O
server NN O
) ) O
, , O
it PRP O
will MD O
extract VB O
the DT O
base NN O
APK NNP O
of IN O
the DT O
target NN O
innocent JJ O
app NN O
on IN O
the DT O
device NN O
, , O
patch VB O
the DT O
APK NNP O
with IN O
malicious JJ O
ads NNS O
modules NNS O
, , O
install VB O
the DT O
APK NNP O
back RB O
and CC O
replace VB O
the DT O
original JJ O
one CD O
as IN O
if IN O
it PRP O
is VBZ O
an DT O
update NN O
. . O

“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
repacks VBZ O
its PRP$ O
prey JJ O
apps NN O
at IN O
smali/baksmali JJ O
code NN O
level NN O
. . O

During IN O
the DT O
final JJ O
update NN O
installation NN O
process NN O
, , O
it PRP O
relies VBZ O
on IN O
the DT O
Janus NNP B-Vulnerability
vulnerability NN O
to TO O
bypass VB O
Android NNP B-System
’ NNP O
s VBD O
APK NNP O
integrity NN O
checks NNS O
. . O

Upon IN O
kill NN O
chain NN O
completion NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
will MD O
then RB O
hijack VB O
compromised VBN O
user RB O
apps NN O
to TO O
show VB O
ads NNS O
. . O

In IN O
certain JJ O
situations NNS O
, , O
variants NNS O
intercept VBP O
compromised VBN O
apps JJ O
’ NNP O
original JJ O
legitimate JJ O
ads NNS O
display VBP O
events NNS O
and CC O
report NN O
back RB O
to TO O
the DT O
intended VBN O
ad-exchange NN O
with IN O
the DT O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
hacker NN O
’ NNP O
s NN O
ad NN O
IDs NNP O
. . O

Our PRP$ O
intelligence NN O
shows VBZ O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
droppers NNS O
proliferate VBP O
through IN O
third-party JJ O
app NN O
store NN O
“ VBD O
9Apps CD B-System
” NN O
, , O
a DT O
UC NNP O
team NN O
backed VBD O
store NN O
, , O
targeted VBN O
mostly RB O
at IN O
Indian NNP O
( ( O
Hindi NNP O
) ) O
, , O
Arabic NNP O
, , O
and CC O
Indonesian JJ O
users NNS O
. . O

“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
itself PRP O
, , O
though RB O
, , O
seems VBZ O
to TO O
target VB O
mainly RB O
India NNP O
users NNS O
. . O

Unlike IN O
previously RB O
discovered VBN O
non NN O
Google NNP B-System
Play NNP I-System
centric JJ O
campaigns NNS O
whose WP$ O
victims NNS O
almost RB O
exclusively RB O
come VBN O
from IN O
less JJR O
developed JJ O
countries NNS O
and CC O
regions NNS O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
successfully RB O
penetrated VBD O
into IN O
noticeable JJ O
number NN O
of IN O
devices NNS O
in IN O
developed JJ O
countries NNS O
such JJ O
as IN O
Saudi NNP O
Arabia NNP O
, , O
UK NNP O
and CC O
US NNP O
. . O

Technical JJ O
Analysis NNP O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
has VBZ O
a DT O
modular JJ O
structure NN O
and CC O
consists VBZ O
of IN O
the DT O
following JJ O
modules NNS O
: : O
Loader NNP O
Core NNP O
Boot NNP O
Patch NNP O
AdSDK NNP O
Updater NNP O
As IN O
stated VBN O
above IN O
, , O
the DT O
first JJ O
step NN O
of IN O
this DT O
infection NN O
chain NN O
is VBZ O
the DT O
dropper NN O
. . O

The DT O
dropper NN O
is VBZ O
a DT O
repacked JJ O
legitimate JJ O
application NN O
which WDT O
contains VBZ O
an DT O
additional JJ O
piece NN O
of IN O
code NN O
– NNP O
“ NNP O
loader NN O
” NN O
. . O

The DT O
loader NN O
has VBZ O
a DT O
very RB O
simple JJ O
purpose NN O
, , O
extract NN O
and CC O
run VB O
the DT O
“ NN O
core NN O
” NNP O
module NN O
of IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
. . O

The DT O
“ NNP O
core NN O
” NN O
module NN O
communicates VBZ O
with IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
, , O
receiving VBG O
the DT O
predetermined JJ O
list NN O
of IN O
popular JJ O
apps NN O
to TO O
scan VB O
the DT O
device NN O
for IN O
. . O

If IN O
any DT O
application NN O
from IN O
that DT O
list NN O
was VBD O
found VBN O
, , O
it PRP O
utilizes VBZ O
the DT O
Janus NNP B-Vulnerability
vulnerability NN O
to TO O
inject VB O
the DT O
“ JJ O
boot NN O
” NN O
module NN O
into IN O
the DT O
repacked JJ O
application NN O
. . O

After IN O
the DT O
next JJ O
run NN O
of IN O
the DT O
infected JJ O
application NN O
, , O
the DT O
“ NNP O
boot NN O
” NNP O
module NN O
will MD O
run VB O
the DT O
“ NNP O
patch NN O
” NN O
module NN O
, , O
which WDT O
hooks VBZ O
the DT O
methods NNS O
from IN O
known VBN O
ad NN O
SDKs NN O
to TO O
its PRP$ O
own JJ O
implementation NN O
. . O

Figure NN O
1 CD O
: : O
‘ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s VBD O
modular JJ O
structure NN O
Technical NNP O
Analysis NNP O
– NNP O
Loader NNP O
Module NNP O
The DT O
“ NNP O
loader NN O
” NNP O
module NN O
, , O
as IN O
stated VBN O
above IN O
, , O
extracts NNS O
and CC O
runs VBZ O
the DT O
“ NN O
core NN O
” NN O
module NN O
. . O

While IN O
the DT O
“ NNP O
core NN O
” NN O
module NN O
resides NNS O
inside IN O
the DT O
APK NNP O
file NN O
, , O
it PRP O
is VBZ O
encrypted VBN O
and CC O
disguised VBN O
as IN O
a DT O
JPG NNP O
file NN O
– VBD O
the DT O
first JJ O
two CD O
bytes NNS O
are VBP O
actually RB O
the DT O
magic JJ O
header NN O
of IN O
JPG NNP O
files NNS O
, , O
while IN O
the DT O
rest NN O
of IN O
the DT O
data NN O
is VBZ O
encoded VBN O
with IN O
an DT O
XOR NN O
cipher NN O
. . O

Figure NN O
2 CD O
: : O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s JJ O
jpg NN O
file NN O
structure NN O
After IN O
the DT O
extraction NN O
, , O
the DT O
“ NNP O
loader NN O
” NNP O
module NN O
adds VBZ O
the DT O
code NN O
to TO O
the DT O
application NN O
while IN O
using VBG O
the DT O
legitimate JJ O
mechanism NN O
by IN O
Android NNP B-System
to TO O
handle VB O
large JJ O
DEX NNP O
files NNS O
. . O

Figure NN O
3 CD O
: : O
Loading VBG O
core RB O
malicious JJ O
code NN O
into IN O
the DT O
benign JJ O
application NN O
Once IN O
the DT O
“ NN O
core NN O
” NN O
module NN O
is VBZ O
extracted VBN O
and CC O
loaded VBN O
, , O
the DT O
“ NNP O
loader NN O
” NN O
uses VBZ O
the DT O
reflection NN O
technique NN O
to TO O
initialize VB O
and CC O
start VB O
the DT O
“ NN O
core NN O
” NN O
module NN O
. . O

Figure NN O
4 CD O
: : O
Loader NN O
calls VBZ O
initialization NN O
method NN O
Technical NNP O
Analysis NNP O
– NNP O
Core NNP O
Module NNP O
With IN O
the DT O
main JJ O
purpose NN O
of IN O
spreading VBG O
the DT O
infection NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
implements NNS O
in IN O
the DT O
“ NN O
core NN O
” NN O
module NN O
: : O
A DT O
series NN O
of IN O
‘ NNP O
Bundle NNP B-Vulnerability
’ NNP O
vulnerabilities NNS O
, , O
which WDT O
is VBZ O
used VBN O
to TO O
install VB O
applications NNS O
without IN O
the DT O
victim NN O
’ NNP O
s NN O
awareness NN O
. . O

The DT O
Janus NNP B-Vulnerability
vulnerability NN O
, , O
which WDT O
allows VBZ O
the DT O
actor NN O
to TO O
replace VB O
any DT O
application NN O
with IN O
an DT O
infected JJ O
version NN O
. . O

The DT O
“ NNP O
core NN O
” NN O
module NN O
contacts VBZ O
the DT O
C NNP O
& CC O
C NNP O
server NN O
, , O
trying VBG O
to TO O
get VB O
a DT O
fresh JJ O
list NN O
of IN O
applications NNS O
to TO O
search VB O
for IN O
, , O
or CC O
if IN O
that DT O
fails VBZ O
, , O
use VB O
a DT O
default NN O
app JJ O
list NN O
: : O
whatsapp JJ B-System
lenovo.anyshare.gps NN B-Indicator
mxtech.videoplayer.ad NN B-Indicator
jio.jioplay.tv NN B-Indicator
jio.media.jiobeats NNS B-Indicator
jiochat.jiochatapp VBP B-Indicator
jio.join JJ B-Indicator
good.gamecollection NN B-Indicator
opera.mini.native JJ B-Indicator
startv.hotstar NN B-Indicator
meitu.beautyplusme NN B-Indicator
domobile.applock NN B-Indicator
touchtype.swiftkey NN B-Indicator
flipkart.android JJ B-Indicator
cn.xender NN B-Indicator

eterno NN O
truecaller NN O
For IN O
each DT O
application NN O
on IN O
the DT O
list NN O
, , O
the DT O
“ NNP O
core NN O
” NN O
module NN O
checks NNS O
for IN O
a DT O
matching JJ O
version NN O
and CC O
MD5 NNP O
hash NN O
of IN O
the DT O
installed JJ O
application NN O
, , O
and CC O
also RB O
checks NNS O
for IN O
the DT O
application NN O
running VBG O
in IN O
the DT O
user-space NN O
. . O

If IN O
all DT O
conditions NNS O
are VBP O
met VBN O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
tries VBZ O
to TO O
infect VB O
the DT O
application NN O
. . O

The DT O
“ NNP O
core NN O
” NN O
module NN O
will MD O
use VB O
one CD O
of IN O
two CD O
methods NNS O
to TO O
infect VB O
the DT O
application NN O
– NNP O
Decompile NNP O
and CC O
Binary NNP O
. . O

The DT O
decompile NN O
method NN O
is VBZ O
based VBN O
on IN O
the DT O
fact NN O
that IN O
Android NNP B-System
applications NNS O
are VBP O
Java-based JJ O
, , O
meaning VBG O
it PRP O
is VBZ O
possible JJ O
to TO O
recompile VB O
it PRP O
. . O

Therefore RB O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
decompiles VBZ O
both CC O
the DT O
original JJ O
application NN O
and CC O
the DT O
malicious JJ O
payload NN O
and CC O
fuses VBZ O
them PRP O
together RB O
. . O

Figure NN O
5 CD O
: : O
core NN O
module NN O
mixes NNS O
malicious JJ O
payload NN O
with IN O
the DT O
original JJ O
application NN O
While IN O
decompiling VBG O
the DT O
original JJ O
app NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
has VBZ O
the DT O
opportunity NN O
to TO O
modify VB O
the DT O
methods NNS O
inside IN O
, , O
replace VB O
some DT O
of IN O
the DT O
methods NNS O
in IN O
the DT O
original JJ O
application NN O
that WDT O
handles VBZ O
advertisement NN O
with IN O
its PRP$ O
own JJ O
code NN O
and CC O
focus VB O
on IN O
methods NNS O
communicating VBG O
with IN O
‘ NNP O
AdMob NNP B-System
’ NNP O
, , O
‘ NNP O
Facebook NNP B-System
’ NNP O
, , O
‘ NNP O
MoPub NNP B-System
’ NNP O
and CC O
‘ NNP O
Unity NNP B-System
Ads NNP I-System
’ NNP O
. . O

Figure NN O
6 CD O
: : O
Targeted VBN O
ad NN O
network NN O
Figure NNP O
7 CD O
: : O
Injection NN O
example NN O
After IN O
all DT O
of IN O
the DT O
required JJ O
changes NNS O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
compiles VBZ O
the DT O
application NN O
and CC O
builds VBZ O
a DT O
DEX NNP O
file NN O
containing VBG O
both CC O
the DT O
original JJ O
code NN O
of IN O
the DT O
original JJ O
application NN O
and CC O
the DT O
malicious JJ O
payload NN O
. . O

In IN O
some DT O
cases NNS O
, , O
the DT O
decompilation NN O
process NN O
will MD O
fail VB O
, , O
and CC O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
will MD O
try VB O
another DT O
method NN O
for IN O
infecting VBG O
the DT O
original JJ O
application NN O
– VBZ O
A DT O
binary JJ O
patch NN O
, , O
which WDT O
simply RB O
provides VBZ O
a DT O
binary JJ O
file NN O
of IN O
the DT O
“ NNP O
boot NN O
” NNP O
module NN O
of IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
. . O

Once RB O
the DT O
payload NN O
is VBZ O
prepared JJ O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
uses VBZ O
it PRP O
to TO O
build VB O
another DT O
APK NNP O
file NN O
, , O
exploiting VBG O
the DT O
Janus NNP B-Vulnerability
vulnerability NN O
: : O
Figure NN O
8 CD O
: : O
The DT O
new JJ O
infected JJ O
APK NNP O
file NN O
structure NN O
Solely RB O
injecting VBG O
the DT O
code NN O
of IN O
the DT O
loader NN O
is VBZ O
not RB O
enough RB O
. . O

As IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
uses VBZ O
a DT O
modular JJ O
approach NN O
, , O
and CC O
as IN O
stated VBN O
earlier RBR O
, , O
the DT O
original JJ O
loader NN O
extracts NNS O
everything NN O
from IN O
the DT O
assets NNS O
, , O
the DT O
usage NN O
of IN O
the DT O
Janus NNP B-Vulnerability
vulnerability NN O
can MD O
only RB O
change VB O
the DT O
code NN O
of IN O
the DT O
original JJ O
application NN O
, , O
not RB O
the DT O
resources NNS O
. . O

This DT O
means VBZ O
that IN O
the DT O
only JJ O
thing NN O
possible JJ O
in IN O
this DT O
case NN O
is VBZ O
to TO O
replace VB O
its PRP$ O
DEX NNP O
file NN O
. . O

To TO O
overcome VB O
this DT O
issue NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
found VBD O
another DT O
solution NN O
. . O

Seeing VBG O
as IN O
the DT O
system NN O
loader NN O
of IN O
the DT O
DEX NNP O
files NNS O
( ( O
ART NNP O
) ) O
fully RB O
ignores VBZ O
everything NN O
that WDT O
goes VBZ O
after IN O
the DT O
data NN O
section NN O
, , O
the DT O
patcher NN O
writes VBZ O
all DT O
of IN O
its PRP$ O
resources NNS O
right RB O
there RB O
. . O

This DT O
action NN O
changes VBZ O
the DT O
original JJ O
file NN O
size NN O
of IN O
the DT O
DEX NNP O
file NN O
, , O
which WDT O
makes VBZ O
the DT O
malicious JJ O
resources NNS O
a DT O
part NN O
of IN O
the DT O
DEX NNP O
file NN O
, , O
a DT O
section NN O
that WDT O
is VBZ O
ignored VBN O
by IN O
the DT O
signature NN O
validation NN O
process NN O
. . O

Figure NN O
9 CD O
: : O
Malware NNP O
secretly RB O
adds VBZ O
malicious JJ O
resources NNS O
to TO O
the DT O
DEX NNP O
file NN O
Now RB O
, , O
after IN O
the DT O
alteration NN O
of IN O
the DT O
original JJ O
application NN O
, , O
Android NNP B-System
’ NNP O
s JJ O
package NN O
manager NN O
will MD O
think VB O
that IN O
this DT O
is VBZ O
an DT O
update NN O
for IN O
the DT O
application NN O
signed VBN O
by IN O
the DT O
same JJ O
certificate NN O
, , O
but CC O
in IN O
reality NN O
, , O
it PRP O
will MD O
execute VB O
the DT O
malicious JJ O
DEX NNP O
file NN O
. . O

Even RB O
now RB O
, , O
this DT O
is VBZ O
still RB O
not RB O
enough RB O
. . O

“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
needs VBZ O
to TO O
be VB O
updated/installed VBN O
without IN O
the DT O
user NN O
’ NNP O
s NN O
consent NN O
. . O

To TO O
achieve VB O
this DT O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
utilizes VBZ O
a DT O
series NN O
of IN O
1-day JJ B-Vulnerability
vulnerabilities NNS I-Vulnerability
, , O
which WDT O
allows VBZ O
any DT O
application NN O
to TO O
run VB O
an DT O
activity NN O
inside IN O
a DT O
system NN O
application NN O
, , O
even RB O
if IN O
this DT O
activity NN O
is VBZ O
not RB O
exported VBN O
. . O

The DT O
malicious JJ O
application NN O
sends VBZ O
a DT O
request NN O
to TO O
choose VB O
a DT O
network NN O
account NN O
, , O
a DT O
specific JJ O
account NN O
that WDT O
can MD O
only RB O
be VB O
processed VBN O
by IN O
authentication NN O
services NNS O
exported VBN O
by IN O
the DT O
malicious JJ O
application NN O
. . O

The DT O
system NN O
service NN O
‘ NNP O
AccountManagerService NNP O
’ NNP O
looks VBZ O
for IN O
the DT O
application NN O
that WDT O
can MD O
process VB O
this DT O
request NN O
. . O

While IN O
doing VBG O
so RB O
, , O
it PRP O
will MD O
reach VB O
a DT O
service NN O
exported VBN O
by IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
, , O
and CC O
sends VBZ O
out RP O
an DT O
authentication NN O
request NN O
that WDT O
would MD O
lead VB O
to TO O
a DT O
call NN O
to TO O
the DT O
‘ NNP O
addAccount NN O
’ NNP O
method NN O
. . O

Then RB O
, , O
a DT O
request NN O
is VBZ O
formed VBN O
in IN O
such JJ O
a DT O
way NN O
that IN O
an DT O
activity NN O
that WDT O
installs VBZ O
the DT O
application NN O
is VBZ O
called VBN O
, , O
bypassing VBG O
all DT O
security NN O
checks NNS O
. . O

Figure NN O
10 CD O
: : O
The DT O
algorithm NN O
of IN O
the DT O
malicious JJ O
update NN O
, , O
while IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
updates VBZ O
application NN O
If IN O
all DT O
that WDT O
has VBZ O
failed VBN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
turns VBZ O
to TO O
Man-in-the-Disk NNP B-Vulnerability
vulnerability NN O
for IN O
‘ NNP O
SHAREit NNP B-System
’ NNP O
or CC O
‘ NNP O
Xender NNP B-System
’ NNP O
applications NNS O
. . O

This DT O
is VBZ O
a DT O
very RB O
simple JJ O
process NN O
, , O
which WDT O
is VBZ O
replacing VBG O
their PRP$ O
update JJ O
file NN O
on IN O
SD NNP O
card NN O
with IN O
its PRP$ O
own JJ O
malicious JJ O
payload NN O
. . O

Figure NN O
11 CD O
: : O
‘ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
uses VBZ O
man-in-disk NN B-Vulnerability
to TO O
install VB O
the DT O
malicious JJ O
update JJ O
Technical NNP O
Analysis NNP O
– NNP O
Boot NNP O
Module NNP O
The DT O
“ NNP O
boot NN O
” NNP O
module NN O
is VBZ O
basically RB O
another DT O
“ NN O
loader NN O
” NNP O
module NN O
, , O
but CC O
this DT O
time NN O
it PRP O
’ VBZ O
s RB O
executed VBN O
in IN O
the DT O
infected JJ O
application NN O
. . O

The DT O
purpose NN O
of IN O
this DT O
module NN O
is VBZ O
to TO O
extract VB O
and CC O
execute VB O
a DT O
malicious JJ O
payload NN O
– VBD O
the DT O
“ NNP O
patch NN O
” NN O
module NN O
. . O

The DT O
infected JJ O
application NN O
contains VBZ O
its PRP$ O
payload NN O
inside IN O
the DT O
DEX NNP O
file NN O
. . O

All DT O
that DT O
is VBZ O
needed VBN O
is VBZ O
to TO O
get VB O
the DT O
original JJ O
size NN O
of IN O
the DT O
DEX NNP O
file NN O
and CC O
read VB O
everything NN O
that WDT O
comes VBZ O
after IN O
this DT O
offset NN O
. . O

Figure NN O
12 CD O
: : O
Boot NN O
module NN O
After IN O
the DT O
patch NN O
module NN O
is VBZ O
extracted VBN O
, , O
the DT O
“ NNP O
boot NN O
” NNP O
module NN O
executes VBZ O
it PRP O
, , O
using VBG O
the DT O
same JJ O
method NN O
described VBN O
in IN O
the DT O
“ JJ O
loader NN O
” NN O
module NN O
. . O

The DT O
“ NNP O
boot NN O
” NN O
module NN O
has VBZ O
placeholder NN O
classes NNS O
for IN O
the DT O
entry NN O
points NNS O
of IN O
the DT O
infected JJ O
applications NNS O
. . O

This DT O
allows VBZ O
the DT O
“ JJ O
boot NN O
” NN O
module NN O
to TO O
execute VB O
the DT O
payloads NNS O
when WRB O
the DT O
infected JJ O
application NN O
is VBZ O
started VBN O
. . O

Figure NN O
13 CD O
: : O
placeholder NN O
classes NNS O
in IN O
Boot NNP O
module NN O
Technical NNP O
Analysis NNP O
– NNP O
Patch NNP O
Module NNP O
When WRB O
“ NN O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
has VBZ O
reached VBN O
its PRP$ O
goal NN O
– VBZ O
a DT O
malicious JJ O
payload NN O
running VBG O
inside IN O
the DT O
original JJ O
application NN O
, , O
with IN O
hooks NNS O
on IN O
various JJ O
methods NNS O
– VBP O
at IN O
this DT O
point NN O
, , O
everything NN O
lies NNS O
with IN O
maintaining VBG O
the DT O
required JJ O
code NN O
in IN O
case NN O
of IN O
an DT O
update NN O
for IN O
the DT O
original JJ O
application NN O
. . O

While IN O
investing VBG O
a DT O
lot NN O
of IN O
resources NNS O
in IN O
the DT O
development NN O
of IN O
this DT O
malware NN O
, , O
the DT O
actor NN O
behind IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
does VBZ O
not RB O
want VB O
a DT O
real JJ O
update NN O
to TO O
remove VB O
all DT O
of IN O
the DT O
changes NNS O
made VBN O
, , O
so RB O
here RB O
is VBZ O
where WRB O
the DT O
“ NNP O
patch NN O
” NNP O
module NN O
comes VBZ O
in IN O
to TO O
play VB O
With IN O
the DT O
sole JJ O
purpose NN O
of IN O
disabling VBG O
automatic JJ O
updates NNS O
for IN O
the DT O
infected JJ O
application NN O
, , O
this DT O
module NN O
observes VBZ O
the DT O
update JJ O
directory NN O
for IN O
the DT O
original JJ O
application NN O
and CC O
removes VBZ O
the DT O
file NN O
once IN O
it PRP O
appears VBZ O
. . O

Another DT O
trick NN O
in IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s JJ O
arsenal NN O
is VBZ O
to TO O
change VB O
the DT O
settings NNS O
of IN O
the DT O
update NN O
timeout NN O
, , O
making VBG O
the DT O
original JJ O
application NN O
wait NN O
endlessly RB O
for IN O
the DT O
update JJ O
check NN O
. . O

Figure NN O
14 CD O
: : O
disabling NN O
infected JJ O
apps JJ O
auto-update JJ O
Figure NN O
15 CD O
: : O
changing VBG O
the DT O
settings NNS O
of IN O
the DT O
update NN O
timeout IN O
The DT O
Ad NNP O
Displaying NNP O
Payload NNP O
Following VBG O
all DT O
of IN O
the DT O
above NN O
, , O
now RB O
is VBZ O
the DT O
time NN O
to TO O
take VB O
a DT O
look NN O
into IN O
the DT O
actual JJ O
payload NN O
that WDT O
displays VBZ O
ads NNS O
to TO O
the DT O
victim NN O
. . O

In IN O
the DT O
injected JJ O
payload NN O
, , O
the DT O
module NN O
implements VBZ O
the DT O
method NN O
‘ NNP O
callActivityOnCreate NN O
’ NN O
. . O

At IN O
any DT O
time NN O
an DT O
infected JJ O
application NN O
will MD O
create VB O
an DT O
activity NN O
, , O
this DT O
method NN O
will MD O
be VB O
called VBN O
, , O
and CC O
call VB O
‘ NNP O
requestAd NN O
’ NN O
from IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s JJ O
code NN O
. . O

“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
will MD O
replace VB O
the DT O
original JJ O
application NN O
’ NNP O
s NN O
activities NNS O
with IN O
an DT O
in-house JJ O
SDK NNP O
’ NNP O
s NN O
activity NN O
, , O
which WDT O
will MD O
show VB O
the DT O
banner NN O
received VBD O
from IN O
the DT O
server NN O
. . O

In IN O
the DT O
case NN O
of IN O
the DT O
infected JJ O
application NN O
not RB O
specified VBN O
in IN O
the DT O
code NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
will MD O
simply RB O
show VB O
ads NNS O
on IN O
the DT O
activity NN O
being VBG O
loaded VBN O
. . O

Figure NN O
16 CD O
: : O
integrating VBG O
an DT O
in-house NN O
ad NN O
SDK NNP O
Figure NNP O
17 CD O
: : O
replacing NN O
original JJ O
app NN O
activities NNS O
with IN O
the DT O
malicious JJ O
ad NN O
SDK NNP O
activity NN O
Figure NNP O
18 CD O
: : O
the DT O
malware NN O
showing VBG O
ads NNS O
on IN O
any DT O
activity NN O
being VBG O
loaded VBN O
Connecting VBG O
the DT O
Dots NNP O
As IN O
our PRP$ O
malware NN O
sample NN O
analysis NN O
took VBD O
the DT O
team NN O
closer NN O
to TO O
reveal VB O
the DT O
“ NN O
Agent NNP O
Smith NNP O
” NNP O
campaign NN O
in IN O
its PRP$ O
entirety NN O
and CC O
it PRP O
is VBZ O
here RB O
that IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
investigation NN O
enters VBZ O
the DT O
center NN O
stage NN O
. . O

We PRP O
started VBD O
with IN O
most JJS O
frequently RB O
used VBN O
C NNP O
& CC O
C NNP O
domains VBZ O
“ VB O
a DT B-Indicator
* JJ I-Indicator
* NN I-Indicator
* NNP I-Indicator
d.com NN I-Indicator
” NNP O
, , O
“ VBZ O
a DT B-Indicator
* JJ I-Indicator
* NN I-Indicator
* NNP I-Indicator
d.net NN I-Indicator
” NN O
, , O
and CC O
“ VB O
a DT B-Indicator
* JJ I-Indicator
* NN I-Indicator
* NNP I-Indicator
d.org NN I-Indicator
” NN O
. . O

Among IN O
multiple JJ O
sub-domains NNS O
, , O
“ NNP O
ad.a VBZ B-Indicator
* NNP I-Indicator
* NNP I-Indicator
* NNP I-Indicator
d.org NN I-Indicator
” NN O
and CC O
“ NNP O
gd.a VBP B-Indicator
* NNP I-Indicator
* NNP I-Indicator
* NNP I-Indicator
d.org NN I-Indicator
” NNP O
both DT O
historically RB O
resolved VBN O
to TO O
the DT O
same JJ O
suspicious JJ O
IP NNP O
address NN O
. . O

The DT O
reverse NN O
DNS NNP O
history NN O
of IN O
this DT O
IP NNP O
brought VBD O
“ NNP O
ads.i NN B-Indicator
* NNP I-Indicator
* NNP I-Indicator
* NNP I-Indicator
e.com NN I-Indicator
” NN O
into IN O
our PRP$ O
attention NN O
. . O

An DT O
extended JJ O
malware NN O
hunting VBG O
process NN O
returned VBD O
to TO O
us PRP O
a DT O
large JJ O
set NN O
of IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
dropper NN O
variants NNS O
which WDT O
helped VBD O
us PRP O
further RBR O
deduce VB O
a DT O
relation NN O
among IN O
multiple JJ O
C NNP O
& CC O
C NNP O
server NN O
infrastructures NNS O
. . O

In IN O
a DT O
different JJ O
period NN O
of IN O
the DT O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
, , O
droppers NNS O
and CC O
core NN O
modules NNS O
used VBN O
various JJ O
combinations NNS O
of IN O
the DT O
“ NN O
a DT O
* JJ O
* NN O
* NNP O
d NN O
” NN O
and CC O
“ NN O
i NN O
* VBP O
* JJ O
* NNP O
e NN O
” NN O
domains NNS O
for IN O
malicious JJ O
operations NNS O
such JJ O
as IN O
prey JJ O
list NN O
query NN O
, , O
patch NN O
request NN O
and CC O
ads NNS O
request VBP O
. . O

With IN O
a DT O
bit NN O
of IN O
luck NN O
, , O
we PRP O
managed VBD O
to TO O
find VB O
logs NNS O
in IN O
which WDT O
the DT O
evidence NN O
showed VBD O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s NNP O
C NNP O
& CC O
C NNP O
front JJ O
end NN O
routinely RB O
distributes VBZ O
a DT O
workload NN O
between IN O
“ NNP O
w.h VBP B-Indicator
* NNP I-Indicator
* NNP I-Indicator
* NNP I-Indicator
g.com NN I-Indicator
” NN O
and CC O
“ NNP O
tt.a VBP B-Indicator
* NNP I-Indicator
* NNP I-Indicator
* NNP I-Indicator
d.net NN I-Indicator
” NN O
. . O

An DT O
in-depth JJ O
understanding NN O
of IN O
the DT O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s VBP O
campaign NN O
C NNP O
& CC O
C NNP O
infrastructure NN O
enabled VBD O
us PRP O
to TO O
reach VB O
the DT O
conclusion NN O
that IN O
the DT O
owner NN O
of IN O
“ NNP B-Indicator
i NN I-Indicator
* VBP I-Indicator
* JJ I-Indicator
* NNP I-Indicator
e.com NN I-Indicator
” NNP O
, , O
“ NNP O
h VBZ B-Indicator
* JJ I-Indicator
* NNP I-Indicator
* NNP I-Indicator
g.com NN I-Indicator
” NN O
is VBZ O
the DT O
group NN O
of IN O
hackers NNS O
behind IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
. . O

Figure NN O
19 CD O
: : O
C NNP O
& CC O
C NNP O
infrastructure NN O
diagram VBZ O
The DT O
Infection NNP O
Landscape NNP O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
droppers VBZ O
show VBP O
a DT O
very RB O
greedy JJ O
infection NN O
tactic NN O
. . O

It PRP O
’ VBZ O
s JJ O
not RB O
enough RB O
for IN O
this DT O
malware JJ O
family NN O
to TO O
swap VB O
just RB O
one CD O
innocent JJ O
application NN O
with IN O
an DT O
infected JJ O
double NN O
. . O

It PRP O
does VBZ O
so RB O
for IN O
each DT O
and CC O
every DT O
app NN O
on IN O
the DT O
device NN O
as RB O
long RB O
as IN O
the DT O
package NN O
names NNS O
are VBP O
on IN O
its PRP$ O
prey JJ O
list NN O
. . O

Over IN O
time NN O
, , O
this DT O
campaign NN O
will MD O
also RB O
infect VB O
the DT O
same JJ O
device NN O
, , O
repeatedly RB O
, , O
with IN O
the DT O
latest JJS O
malicious JJ O
patches NNS O
. . O

This DT O
lead JJ O
us PRP O
to TO O
estimate VB O
there EX O
to TO O
be VB O
over IN O
2.8 CD O
billion CD O
infections NNS O
in IN O
total JJ O
, , O
on IN O
around IN O
25 CD O
Million NNP O
unique JJ O
devices NNS O
, , O
meaning VBG O
that IN O
on IN O
average NN O
, , O
each DT O
victim NN O
would MD O
have VB O
suffered VBN O
roughly RB O
112 CD O
swaps NNS O
of IN O
innocent JJ O
applications NNS O
. . O

As IN O
an DT O
initial JJ O
attack NN O
vector NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
abuses VBZ O
the DT O
9Apps CD B-System
market NN O
– NN O
with IN O
over IN O
360 CD O
different JJ O
dropper NN O
variants NNS O
. . O

To TO O
maximize VB O
profit NN O
, , O
variants NNS O
with IN O
“ NNP O
MinSDK NNP O
” NNP O
or CC O
“ NNP O
OTA NNP O
” NNP O
SDK NNP O
are VBP O
present JJ O
to TO O
further JJ O
infect NN O
victims NNS O
with IN O
other JJ O
adware JJ O
families NNS O
. . O

The DT O
majority NN O
of IN O
droppers NNS O
in IN O
9Apps CD B-System
are VBP O
games NNS O
, , O
while IN O
the DT O
rest NN O
fall NN O
into IN O
categories NNS O
of IN O
adult NN O
entertainment NN O
, , O
media NNS O
player NN O
, , O
photo NN O
utilities NNS O
, , O
and CC O
system NN O
utilities NNS O
. . O

Figure NN O
20 CD O
: : O
dropper NN O
app NN O
category JJ O
distribution NN O
Among IN O
the DT O
vast JJ O
number NN O
of IN O
variants NNS O
, , O
the DT O
top JJ O
5 CD O
most JJS O
infectious JJ O
droppers NNS O
alone RB O
have VBP O
been VBN O
downloaded VBN O
more RBR O
than IN O
7.8 CD O
million CD O
times NNS O
of IN O
the DT O
infection NN O
operations NNS O
against IN O
innocent JJ O
applications NNS O
: : O
Figure NN O
21 CD O
: : O
Top JJ O
5 CD O
most JJS O
infectious JJ O
droppers NNS O
The DT O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
is VBZ O
primarily RB O
targeted VBN O
at IN O
Indian JJ O
users NNS O
, , O
who WP O
represent VBP O
59 CD O
% NN O
of IN O
the DT O
impacted JJ O
population NN O
. . O

Unlike IN O
previously RB O
seen VBN O
non-GP JJ O
( ( O
Google NNP B-System
Play NNP I-System
) ) O
centric NN O
malware NN O
campaigns NNS O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
has VBZ O
a DT O
significant JJ O
impact NN O
upon IN O
not RB O
only RB O
developing VBG O
countries NNS O
but CC O
also RB O
some DT O
developed JJ O
countries NNS O
where WRB O
GP NNP O
is VBZ O
readily RB O
available JJ O
. . O

For IN O
example NN O
, , O
the DT O
US NNP O
( ( O
with IN O
around IN O
303k CD O
infections NNS O
) ) O
, , O
Saudi NNP O
Arabia NNP O
( ( O
245k CD O
) ) O
, , O
Australia NNP O
( ( O
141k CD O
) ) O
and CC O
the DT O
UK NNP O
( ( O
137k CD O
) ) O
. . O

Figure NN O
22 CD O
: : O
world NN O
infection NN O
heat NN O
map NN O
Considering NNP O
that IN O
India NNP O
is VBZ O
by IN O
far RB O
the DT O
most RBS O
infected JJ O
county NN O
by IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
, , O
overall JJ O
compromised JJ O
device NN O
brand NN O
distribution NN O
is VBZ O
heavily RB O
influenced VBN O
by IN O
brand NN O
popularity NN O
among IN O
Indian JJ O
Android NNP B-System
users NNS O
: : O
Figure NN O
23 CD O
: : O
infected VBN O
brand NN O
distribution NN O
While IN O
most JJS O
infections NNS O
occurred VBD O
on IN O
devices NNS O
running VBG O
Android NNP B-System
5 CD I-System
and CC I-System
6 CD I-System
, , O
we PRP O
also RB O
see VBP O
a DT O
considerable JJ O
number NN O
of IN O
successful JJ O
attacks NNS O
against IN O
newer JJR O
Android NNP B-System
versions NNS O
. . O

It PRP O
is VBZ O
a DT O
worrying JJ O
observation NN O
. . O

AOSP NNP O
patched VBD O
the DT O
Janus NNP B-Vulnerability
vulnerability NN O
since IN O
version NN O
7 CD O
by IN O
introducing VBG O
APK NNP O
Signature NNP O
Scheme NNP O
V2 NNP O
. . O

However RB O
, , O
in IN O
order NN O
to TO O
block VB O
Janus NNP B-Vulnerability
abuse NN O
, , O
app NN O
developers NNS O
need VBP O
to TO O
sign VB O
their PRP$ O
apps NN O
with IN O
the DT O
new JJ O
scheme NN O
so IN O
that DT O
Android NNP B-System
framework NN O
security NN O
component NN O
could MD O
conduct VB O
integrity NN O
checks NNS O
with IN O
enhanced JJ O
features NNS O
. . O

Figure NN O
25 CD O
: : O
infected VBN O
Android NNP B-System
version NN O
distribution NN O
To TO O
further JJ O
analyze NN O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
’ NNP O
s JJ O
infection NN O
landscape NN O
, , O
we PRP O
dived VBD O
into IN O
the DT O
top JJ O
10 CD O
infected JJ O
countries NNS O
: : O
Country NNP O
Total NNP O
Devices NNPS O
Total NNP O
Infection NNP O
Event NNP O
Count NNP O
Avg NNP O
. . O

App NNP O
Swap NNP O
Per NNP O
Device NNP O
Avg NNP O
. . O

Droppers NNS O
Per NNP O
Device NNP O
Avg NNP O
. . O

Months NNS O
Device NNP O
Remained VBD O
Infected NNP O
India NNP O
15,230,123 CD O
2,017,873,249 CD O
2.6 CD O
1.7 CD O
2.1 CD O
Bangladesh NNP O
2,539,913 CD O
208,026,886 CD O
2.4 CD O
1.5 CD O
2.2 CD O
Pakistan NNP O
1,686,216 CD O
94,296,907 CD O
2.4 CD O
1.6 CD O
2 CD O
Indonesia NNP O
572,025 CD O
67,685,983 CD O
2 CD O
1.5 CD O
2.2 CD O
Nepal NNP O
469,274 CD O
44,961,341 CD O
2.4 CD O
1.6 CD O
2.4 CD O
US PRP O
302,852 CD O
19,327,093 CD O
1.7 CD O
1.4 CD O
1.8 CD O
Nigeria NNP O
287,167 CD O
21,278,498 CD O
2.4 CD O
1.3 CD O
2.3 CD O
Hungary NNP O
282,826 CD O
7,856,064 CD O
1.7 CD O
1.3 CD O
1.7 CD O
Saudi NNP O
Arabia NNP O
245,698 CD O
18,616,259 CD O
2.3 CD O

1.6 CD O
1.9 CD O
Myanmar NNP O
234,338 CD O
9,729,572 CD O
1.5 CD O
1.4 CD O
1.9 CD O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
Timeline NNP O
Early NNP O
signs NNS O
of IN O
activity NN O
from IN O
the DT O
actor NN O
behind IN O
“ JJ O
Agent NNP O
Smith NNP O
” NNP O
can MD O
be VB O
traced VBN O
back RB O
to TO O
January NNP O
2016 CD O
. . O

We PRP O
classify VBP O
this DT O
40-month JJ O
period NN O
into IN O
three CD O
main JJ O
stages NNS O
. . O

January NNP O
2016 CD O
– NN O
May NNP O
2018 CD O
: : O
In IN O
this DT O
stage NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
hackers NNS O
started VBD O
to TO O
try VB O
out RP O
9Apps CD O
as IN O
a DT O
distribution NN O
channel NN O
for IN O
their PRP$ O
adware NN O
. . O

During IN O
this DT O
period NN O
, , O
malware NN O
samples NNS O
display VBP O
some DT O
typical JJ O
adware NN O
characteristics NNS O
such JJ O
as IN O
unnecessary JJ O
permission NN O
requirements NNS O
and CC O
pop-up JJ O
windows NNS B-System
. . O

During IN O
this DT O
time NN O
, , O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
hackers NNS O
eventually RB O
built VBN O
up RP O
a DT O
vast JJ O
number NN O
of IN O
app JJ O
presence NN O
on IN O
9Apps CD B-System
, , O
which WDT O
later RB O
would MD O
serve VB O
as IN O
publication NN O
channels NNS O
for IN O
evolved JJ O
droppers NNS O
. . O

However RB O
, , O
samples NNS O
don VBP O
’ JJ O
t NNS O
have VBP O
key JJ O
capabilities NNS O
to TO O
infect VB O
innocent JJ O
apps NN O
on IN O
victim NN O
devices NNS O
yet RB O
. . O

May NNP O
2018 CD O
to TO O
April NNP O
2019 CD O
: : O
This DT O
is VBZ O
the DT O
actual JJ O
mature NN O
stage NN O
of IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
. . O

From IN O
early JJ O
2018 CD O
prior RB O
to TO O
May NNP O
, , O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
hackers NNS O
started VBD O
to TO O
experiment VB O
with IN O
Bundle NNP O
Feng NNP O
Shui NNP O
, , O
the DT O
key NN O
tool NN O
which WDT O
gives VBZ O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
malware NNP O
family NN O
capabilities NNS O
to TO O
infect VB O
innocent JJ O
apps NN O
on IN O
the DT O
device NN O
. . O

A DT O
series NN O
of IN O
pilot NN O
runs NNS O
were VBD O
executed VBN O
. . O

After IN O
some DT O
major JJ O
upgrade NN O
, , O
by IN O
mid-June NN O
, , O
the DT O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
reached VBD O
its PRP$ O
peak NN O
. . O

Its PRP$ O
dropper JJ O
family NN O
finished VBN O
integration NN O
with IN O
Bundle NNP O
Feng NNP O
Shui NNP O
and CC O
campaign NN O
C NNP O
& CC O
C NNP O
infrastructure NN O
was VBD O
shifted VBN O
to TO O
AWS NNP B-System
cloud NN O
. . O

The DT O
Campaign NNP O
achieved VBD O
exponential JJ O
growth NN O
from IN O
June NNP O
to TO O
December NNP O
2018 CD O
with IN O
the DT O
infection NN O
number NN O
staying VBG O
stable JJ O
into IN O
early JJ O
2019 CD O
. . O

Post-April JJ O
2019 CD O
: : O
Starting VBG O
from IN O
early JJ O
2019 CD O
, , O
the DT O
new JJ O
infection NN O
rate NN O
of IN O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
dropped VBD O
significantly RB O
. . O

From IN O
early JJ O
April NNP O
, , O
hackers NNS O
started VBD O
to TO O
build VB O
a DT O
new JJ O
major JJ O
update NN O
to TO O
the DT O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
under IN O
the DT O
name NN O
“ NNP O
leechsdk NN O
” NN O
. . O

Figure NN O
26 CD O
: : O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
Campaign NNP O
timeline NN O
Greater NNP O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
Campaign NNP O
Discovery NNP O
Orchestrating VBG O
a DT O
successful JJ O
9Apps CD B-System
centric JJ O
malware NN O
campaign NN O
, , O
the DT O
actor NN O
behind IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
established VBD O
solid JJ O
strategies NNS O
in IN O
malware JJ O
proliferation NN O
and CC O
payload NN O
delivery NN O
. . O

The DT O
actor NN O
also RB O
built VBD O
solid JJ O
backend NN O
infrastructures NNS O
which WDT O
can MD O
handle VB O
high JJ O
volume NN O
concurrent NN O
requests NNS O
. . O

During IN O
our PRP$ O
extended JJ O
threat NN O
hunting NN O
, , O
we PRP O
uncovered VBD O
11 CD O
apps NN O
on IN O
the DT O
Google NNP B-System
Play NNP I-System
store NN I-System
that WDT O
contain VBP O
a DT O
malicious JJ O
yet RB O
dormant JJ O
SDK NNP O
related VBD O
to TO O
“ VB O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
actor NN O
. . O

This DT O
discovery NN O
indicates VBZ O
the DT O
actor NN O
’ NNP O
s VBZ O
ambition NN O
in IN O
expanding VBG O
operations NNS O
into IN O
Google NNP B-System
Play NNP I-System
store NN O
with IN O
previous JJ O
success NN O
experience NN O
from IN O
the DT O
main JJ O
“ NN O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
. . O

Instead RB O
of IN O
embedding VBG O
core NN O
malware NN O
payload NN O
in IN O
droppers NNS O
, , O
the DT O
actor NN O
switches VBZ O
to TO O
a DT O
more RBR O
low-key JJ O
SDK NNP O
approach NN O
. . O

In IN O
the DT O
dangerous JJ O
module NN O
lies VBZ O
a DT O
kill NN O
switch NN O
logic NN O
which WDT O
looks VBZ O
for IN O
the DT O
keyword NN O
“ NNP O
infect NN O
” NN O
. . O

Once RB O
the DT O
keyword NN O
is VBZ O
present JJ O
, , O
the DT O
SDK NNP O
will MD O
switch VB O
from IN O
innocent JJ O
ads NNS O
server RB O
to TO O
malicious JJ O
payload NN O
delivery NN O
ones NNS O
. . O

Hence RB O
, , O
we PRP O
name VBP O
this DT O
new JJ O
spin-off NN O
campaign NN O
as IN O
Jaguar NNP O
Kill NNP O
Switch NNP O
. . O

The DT O
below NN O
code NN O
snippet NN O
is VBZ O
currently RB O
isolated VBN O
and CC O
dormant JJ O
. . O

In IN O
the DT O
future NN O
, , O
it PRP O
will MD O
be VB O
invoked VBN O
by IN O
malicious JJ O
SDK NNP O
during IN O
banner NN O
ads NNS O
display VBP O
. . O

Figure NN O
26 CD O
: : O
the DT O
kill NN O
switch VB O
code NN O
snippet NN O
Evidence NNP O
implies VBZ O
that IN O
the DT O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
actor NN O
is VBZ O
currently RB O
laying VBG O
the DT O
groundwork NN O
, , O
increasing VBG O
its PRP$ O
Google NNP B-System
Play NNP I-System
penetration NN O
rate NN O
and CC O
waiting VBG O
for IN O
the DT O
right JJ O
timing NN O
to TO O
kick VB O
off RP O
attacks NNS O
. . O

By IN O
the DT O
time NN O
of IN O
this DT O
publication NN O
, , O
two CD O
Jaguar NNP O
Kill NNP O
Switch NNP O
infected VBD O
app NN O
has VBZ O
reached VBN O
10 CD O
million CD O
downloads NNS O
while IN O
others NNS O
are VBP O
still RB O
in IN O
their PRP$ O
early JJ O
stages NNS O
. . O

Check NNP B-Organization
Point NNP I-Organization
Research NNP O
reported VBD O
these DT O
dangerous JJ O
apps NN O
to TO O
Google NNP B-Organization
upon IN O
discovery NN O
. . O

Currently RB O
, , O
all DT O
bespoke VBP O
apps NNS O
have VBP O
been VBN O
taken VBN O
down RP O
from IN O
the DT O
Google NNP B-System
Play NNP I-System
store NN O
. . O

Figure NN O
28 CD O
: : O
Jaguar NNP O
Kill NNP O
Switch NNP O
infected VBD O
GP NNP O
apps NN O
Peek NNP O
Into NNP O
the DT O
Actor NNP O
Based VBD O
on IN O
all DT O
of IN O
the DT O
above NN O
, , O
we PRP O
connected VBD O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
to TO O
a DT O
Chinese JJ O
internet NN O
company NN O
located VBN O
in IN O
Guangzhou NNP O
whose WP$ O
front JJ O
end NN O
legitimate NN O
business NN O
is VBZ O
to TO O
help VB O
Chinese NNP O
Android NNP B-System
developers NNS O
publish JJ O
and CC O
promote VB O
their PRP$ O
apps NN O
on IN O
overseas JJ O
platforms NNS O
. . O

Various JJ O
recruitment JJ O
posts NNS O
on IN O
Chinese JJ O
job NN O
sites NNS O
and CC O
Chinese JJ B-System
National NNP I-System
Enterprise NNP I-System
Credit NNP I-System
Information NNP I-System
Public NNP I-System
System NNP I-System
( ( I-System
NECIPS NNP I-System
) ) I-System
data NN O
led VBD O
us PRP O
one CD O
step NN O
further RBR O
, , O
linking VBG O
the DT O
actor NN O
to TO O
its PRP$ O
legal JJ O
entity NN O
name NN O
. . O

Interestingly RB O
, , O
we PRP O
uncovered VBD O
several JJ O
expired JJ O
job NN O
posting NN O
of IN O
Android NNP B-System
reverse NN O
engineer NN O
from IN O
the DT O
actor NN O
’ NNP O
s VBZ O
front JJ O
business NN O
published VBN O
in IN O
2018 CD O
and CC O
2019 CD O
. . O

It PRP O
seems VBZ O
that IN O
the DT O
people NNS O
who WP O
filled VBD O
these DT O
roles NNS O
are VBP O
key JJ O
to TO O
“ VB O
Agent NNP B-Malware
Smith NNP I-Malware
’ NNP O
s NN O
success NN O
, , O
yet RB O
not RB O
quite RB O
necessary JJ O
for IN O
actor NN O
’ NNP O
s NN O
legitimate JJ O
side NN O
of IN O
business NN O
. . O

With IN O
a DT O
better JJR O
understanding NN O
of IN O
the DT O
“ NNP O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
actor NN O
than IN O
we PRP O
had VBD O
in IN O
the DT O
initial JJ O
phase NN O
of IN O
campaign NN O
hunting NN O
, , O
we PRP O
examined VBD O
the DT O
list NN O
of IN O
target NN O
innocent JJ O
apps NN O
once RB O
again RB O
and CC O
discovered VBD O
the DT O
actor NN O
’ NNP O
s VBZ O
unusual JJ O
practices NNS O
in IN O
choosing VBG O
targets NNS O
. . O

It PRP O
seems VBZ O
, , O
“ FW O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
prey JJ O
list NN O
does VBZ O
not RB O
only RB O
have VBP O
popular JJ O
yet RB O
Janus NNP B-Vulnerability
vulnerable JJ O
apps NN O
to TO O
ensure VB O
high JJ O
proliferation NN O
, , O
but CC O
also RB O
contain VBP O
competitor JJ O
apps NN O
of IN O
actor NN O
’ NNP O
s NN O
legitimate NN O
business NN O
arm NN O
to TO O
suppress VB O
competition NN O
. . O

Conclusion NNP O
Although IN O
the DT O
actor NN O
behind IN O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
decided VBD O
to TO O
make VB O
their PRP$ O
illegally NN O
acquired VBN O
profit NN O
by IN O
exploiting VBG O
the DT O
use NN O
of IN O
ads NNS O
, , O
another DT O
actor NN O
could MD O
easily RB O
take VB O
a DT O
more RBR O
intrusive JJ O
and CC O
harmful JJ O
route NN O
. . O

With IN O
the DT O
ability NN O
to TO O
hide VB O
its PRP$ O
icon NN O
from IN O
the DT O
launcher NN O
and CC O
hijack NN O
popular JJ O
existing VBG O
apps NN O
on IN O
a DT O
device NN O
, , O
there EX O
are VBP O
endless JJ O
possibilities NNS O
to TO O
harm VB O
a DT O
user NN O
’ NN O
s VBP O
digital JJ O
even RB O
physical JJ O
security NN O
. . O

Today NN O
this DT O
malware NN O
shows VBZ O
unwanted JJ O
ads NNS O
, , O
tomorrow NN O
it PRP O
could MD O
steal VB O
sensitive JJ O
information NN O
; : O
from IN O
private JJ O
messages NNS O
to TO O
banking NN O
credentials NNS O
and CC O
much RB O
more RBR O
. . O

The DT O
“ JJ O
Agent NNP B-Malware
Smith NNP I-Malware
” NNP O
campaign NN O
serves VBZ O
as IN O
a DT O
sharp JJ O
reminder NN O
that WDT O
effort NN O
from IN O
system NN O
developers NNS O
alone RB O
is VBZ O
not RB O
enough RB O
to TO O
build VB O
a DT O
secure NN O
Android NNP B-System
eco-system NN O
. . O

It PRP O
requires VBZ O
attention NN O
and CC O
action NN O
from IN O
system NN O
developers NNS O
, , O
device NN O
manufacturers NNS O
, , O
app NN O
developers NNS O
, , O
and CC O
users NNS O
, , O
so IN O
that DT O
vulnerability NN O
fixes NNS O
are VBP O
patched VBN O
, , O
distributed VBN O
, , O
adopted VBN O
and CC O
installed VBN O
in IN O
time NN O
. . O

It PRP O
is VBZ O
also RB O
another DT O
example NN O
for IN O
why WRB O
organizations NNS O
and CC O
consumers NNS O
alike RB O
should MD O
have VB O
an DT O
advanced JJ O
mobile JJ O
threat NN O
prevention NN O
solution NN O
installed VBN O
on IN O
the DT O
device NN O
to TO O
protect VB O
themselves PRP O
against IN O
the DT O
possibility NN O
of IN O
unknowingly RB O
installing VBG O
malicious JJ O
apps NN O
, , O
even RB O
from IN O
trusted VBN O
app NN O
stores NNS O
. . O

Dvmap NN B-Malware
: : O
the DT O
first JJ O
Android NNP B-System
malware NN O
with IN O
code NN O
injection NN O
08 CD O
JUN NNP O
2017 CD O
In IN O
April NNP O
2017 CD O
we PRP O
started VBD O
observing VBG O
new JJ O
rooting VBG O
malware NN O
being VBG O
distributed VBN O
through IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
. . O

Unlike IN O
other JJ O
rooting VBG O
malware NN O
, , O
this DT O
Trojan NNP O
not RB O
only RB O
installs VBZ O
its PRP$ O
modules NNS O
into IN O
the DT O
system NN O
, , O
it PRP O
also RB O
injects VBZ O
malicious JJ O
code NN O
into IN O
the DT O
system NN O
runtime JJ O
libraries NNS O
. . O

Kaspersky NNP B-Organization
Lab NNP I-Organization
products NNS O
detect VBP O
it PRP O
as IN O
Trojan.AndroidOS.Dvmap.a NNP B-Indicator
. . O

The DT O
distribution NN O
of IN O
rooting VBG O
malware NN O
through IN O
Google NNP B-System
Play NNP I-System
is VBZ O
not RB O
a DT O
new JJ O
thing NN O
. . O

For IN O
example NN O
, , O
the DT O
Ztorg NNP B-Malware
Trojan NNP I-Malware
has VBZ O
been VBN O
uploaded VBN O
to TO O
Google NNP B-System
Play NNP I-System
almost RB O
100 CD O
times NNS O
since IN O
September NNP O
2016 CD O
. . O

But CC O
Dvmap NNP B-Malware
is VBZ O
very RB O
special JJ O
rooting VBG O
malware NN O
. . O

It PRP O
uses VBZ O
a DT O
variety NN O
of IN O
new JJ O
techniques NNS O
, , O
but CC O
the DT O
most RBS O
interesting JJ O
thing NN O
is VBZ O
that IN O
it PRP O
injects VBZ O
malicious JJ O
code NN O
into IN O
the DT O
system NN O
libraries VBZ O
– NNP O
libdmv.so NN B-Indicator
or CC O
libandroid_runtime.so NN B-Indicator
. . O

This DT O
makes VBZ O
Dvmap NNP B-Malware
the DT O
first JJ O
Android NNP B-System
malware NN O
that WDT O
injects VBZ O
malicious JJ O
code NN O
into IN O
the DT O
system NN O
libraries VBZ O
in IN O
runtime NN O
, , O
and CC O
it PRP O
has VBZ O
been VBN O
downloaded VBN O
from IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
more JJR O
than IN O
50,000 CD O
times NNS O
. . O

Kaspersky NNP B-Organization
Lab NNP I-Organization
reported VBD O
the DT O
Trojan NNP O
to TO O
Google NNP B-Organization
, , O
and CC O
it PRP O
has VBZ O
now RB O
been VBN O
removed VBN O
from IN O
the DT O
store NN O
. . O

To TO O
bypass VB O
Google NNP B-System
Play NNP I-System
Store NNP I-System
security NN O
checks NNS O
, , O
the DT O
malware NN O
creators NNS O
used VBD O
a DT O
very RB O
interesting JJ O
method NN O
: : O
they PRP O
uploaded VBD O
a DT O
clean JJ O
app NN O
to TO O
the DT O
store NN O
at IN O
the DT O
end NN O
of IN O
March NNP O
, , O
2017 CD O
, , O
and CC O
would MD O
then RB O
update VB O
it PRP O
with IN O
a DT O
malicious JJ O
version NN O
for IN O
short JJ O
period NN O
of IN O
time NN O
. . O

Usually RB O
they PRP O
would MD O
upload VB O
a DT O
clean JJ O
version NN O
back RB O
on IN O
Google NNP B-System
Play NNP I-System
the DT O
very RB O
same JJ O
day NN O
. . O

They PRP O
did VBD O
this DT O
at IN O
least JJS O
5 CD O
times NNS O
between IN O
18 CD O
April NNP O
and CC O
15 CD O
May NNP O
. . O

All PDT O
the DT O
malicious JJ O
Dvmap NNP B-Malware
apps NN O
had VBD O
the DT O
same JJ O
functionality NN O
. . O

They PRP O
decrypt VBP O
several JJ O
archive JJ O
files NNS O
from IN O
the DT O
assets NNS O
folder NN O
of IN O
the DT O
installation NN O
package NN O
, , O
and CC O
launch VBD O
an DT O
executable JJ O
file NN O
from IN O
them PRP O
with IN O
the DT O
name NN O
“ NNP O
start. NN O
” VBD O
The DT O
interesting JJ O
thing NN O
is VBZ O
that IN O
the DT O
Trojan NNP O
supports NNS O
even RB O
the DT O
64-bit JJ O
version NN O
of IN O
Android NNP B-System
, , O
which WDT O
is VBZ O
very RB O
rare JJ O
. . O

All DT O
encrypted VBD O
archives NNS O
can MD O
be VB O
divided VBN O
into IN O
two CD O
groups NNS O
: : O
the DT O
first JJ O
comprises VBZ O
Game321.res NNP B-Indicator
, , O
Game322.res NNP B-Indicator
, , O
Game323.res NNP B-Indicator
and CC O
Game642.res NNP B-Indicator
– NNP O
and CC O
these DT O
are VBP O
used VBN O
in IN O
the DT O
initial JJ O
phase NN O
of IN O
infection NN O
, , O
while IN O
the DT O
second JJ O
group NN O
: : O
Game324.res NNS B-Indicator
and CC O
Game644.res NNP B-Indicator
, , O
are VBP O
used VBN O
in IN O
the DT O
main JJ O
phase NN O
. . O

Initial JJ O
phase NN O
During IN O
this DT O
phase NN O
, , O
the DT O
Trojan NNP O
tries NNS O
to TO O
gain VB O
root NN O
rights NNS O
on IN O
the DT O
device NN O
and CC O
to TO O
install VB O
some DT O
modules NNS O
. . O

All DT O
archives VBZ O
from IN O
this DT O
phase NN O
contain VBP O
the DT O
same JJ O
files NNS O
except IN O
for IN O
one CD O
called VBN O
“ NN O
common JJ O
” NN O
. . O

This DT O
is VBZ O
a DT O
local JJ O
root NN O
exploit JJ O
pack NN O
, , O
and CC O
the DT O
Trojan NNP O
uses VBZ O
4 CD O
different JJ O
exploit JJ O
pack NN O
files NNS O
, , O
3 CD O
for IN O
32-bit JJ O
systems NNS O
and CC O
1 CD O
for IN O
64-bit-systems NNS O
. . O

If IN O
these DT O
files NNS O
successfully RB O
gain VBP O
root NN O
rights NNS O
, , O
the DT O
Trojan NNP O
will MD O
install VB O
several JJ O
tools NNS O
into IN O
the DT O
system NN O
. . O

It PRP O
will MD O
also RB O
install VB O
the DT O
malicious JJ O
app NN O
“ NNP O
com.qualcmm.timeservices. NN B-Indicator
” NNP O
These DT O
archives NNS O
contain VBP O
the DT O
file NN O
“ NNP O
.root.sh NNP B-Indicator
” NNP O
which WDT O
has VBZ O
some DT O
comments NNS O
in IN O
Chinese JJ O
: : O
Main JJ O
phase NN O
In IN O
this DT O
phase NN O
, , O
the DT O
Trojan NNP O
launches VBZ O
the DT O
“ JJ O
start NN O
” NNP O
file NN O
from IN O
Game324.res NNP B-Indicator
or CC O
Game644.res NNP B-Indicator
. . O

It PRP O
will MD O
check VB O
the DT O
version NN O
of IN O
Android NNP B-System
installed VBD O
and CC O
decide VB O
which WDT O
library NN O
should MD O
be VB O
patched VBN O
. . O

For IN O
Android NNP B-System
4.4.4 CD I-System
and CC O
older JJR O
, , O
the DT O
Trojan NNP O
will MD O
patch VB O
method NN O
_Z30dvmHeapSourceStartupBeforeForkv NN O
from IN O
libdvm.so NN B-Indicator
, , O
and CC O
for IN O
Android NNP B-System
5 CD O
and CC O
newer JJR O
it PRP O
will MD O
patch VB O
method NN O
nativeForkAndSpecialize NN O
from IN O
libandroid_runtime.so NN B-Indicator
. . O

Both DT O
of IN O
these DT O
libraries NNS O
are VBP O
runtime JJ O
libraries NNS O
related VBN O
to TO O
Dalvik NNP B-System
and CC O
ART NNP B-System
runtime NN O
environments NNS O
. . O

Before IN O
patching NN O
, , O
the DT O
Trojan NNP O
will MD O
backup VB O
the DT O
original JJ O
library NN O
with IN O
a DT O
name NN O
bak_ RB O
{ ( O
original JJ O
name NN O
} ) O
. . O

During IN O
patching NN O
, , O
the DT O
Trojan NNP O
will MD O
overwrite VB O
the DT O
existing VBG O
code NN O
with IN O
malicious JJ O
code NNS O
so IN O
that IN O
all DT O
it PRP O
can MD O
do VB O
is VBZ O
execute VB O
/system/bin/ip NNP B-Indicator
. . O

This DT O
could MD O
be VB O
very RB O
dangerous JJ O
and CC O
cause VB O
some DT O
devices NNS O
to TO O
crash VB O
following VBG O
the DT O
overwrite NN O
. . O

Then RB O
the DT O
Trojan NNP O
will MD O
put VB O
the DT O
patched JJ O
library NN O
back RB O
into IN O
the DT O
system NN O
directory NN O
. . O

After IN O
that DT O
, , O
the DT O
Trojan NNP O
will MD O
replace VB O
the DT O
original JJ O
/system/bin/ip NN B-Indicator
with IN O
a DT O
malicious JJ O
one CD O
from IN O
the DT O
archive NN O
( ( O
Game324.res VBZ B-Indicator
or CC O
Game644.res NNP B-Indicator
) ) O
. . O

In IN O
doing VBG O
so RB O
, , O
the DT O
Trojan NNP O
can MD O
be VB O
sure JJ O
that IN O
its PRP$ O
malicious JJ O
module NN O
will MD O
be VB O
executed VBN O
with IN O
system NN O
rights NNS O
. . O

But CC O
the DT O
malicious JJ O
ip NN O
file NN O
does VBZ O
not RB O
contain VB O
any DT O
methods NNS O
from IN O
the DT O
original JJ O
ip NN O
file NN O
. . O

This DT O
means VBZ O
that IN O
all DT O
apps NNS O
that WDT O
were VBD O
using VBG O
this DT O
file NN O
will MD O
lose VB O
some DT O
functionality NN O
or CC O
even RB O
start VB O
crashing NN O
. . O

Malicious JJ O
module NN O
“ NNP O
ip NN O
” NN O
This DT O
file NN O
will MD O
be VB O
executed VBN O
by IN O
the DT O
patched JJ O
system NN O
library NN O
. . O

It PRP O
can MD O
turn VB O
off RP O
“ NNP O
VerifyApps NNP O
” NNP O
and CC O
enable VB O
the DT O
installation NN O
of IN O
apps NN O
from IN O
3rd CD O
party NN O
stores NNS O
by IN O
changing VBG O
system NN O
settings NNS O
. . O

Furthermore RB O
, , O
it PRP O
can MD O
grant VB O
the DT O
“ NN O
com.qualcmm.timeservices NNS B-Indicator
” VBP O
app JJ O
Device NNP O
Administrator NNP O
rights NNS O
without IN O
any DT O
interaction NN O
with IN O
the DT O
user NN O
, , O
just RB O
by IN O
running VBG O
commands NNS O
. . O

It PRP O
is VBZ O
a DT O
very RB O
unusual JJ O
way NN O
to TO O
get VB O
Device NNP O
Administrator NNP O
rights NNS O
. . O

Malicious JJ O
app NN O
com.qualcmm.timeservices NNS B-Indicator
As IN O
I PRP O
mentioned VBD O
before RB O
, , O
in IN O
the DT O
“ NNP O
initial JJ O
phase NN O
” NN O
, , O
the DT O
Trojan NNP O
will MD O
install VB O
the DT O
“ NNP O
com.qualcmm.timeservices NNS B-Indicator
” NNP O
app NN O
. . O

Its PRP$ O
main JJ O
purpose NN O
is VBZ O
to TO O
download VB O
archives NNS O
and CC O
execute VB O
the DT O
“ NNP O
start NN O
” NNP O
binary NN O
from IN O
them PRP O
. . O

During IN O
the DT O
investigation NN O
, , O
this DT O
app NN O
was VBD O
able JJ O
to TO O
successfully RB O
connect VB O
to TO O
the DT O
command NN O
and CC O
control NN O
server NN O
, , O
but CC O
it PRP O
received VBD O
no DT O
commands NNS O
. . O

So RB O
I PRP O
don VBP O
’ JJ O
t NN O
know VBP O
what WP O
kind NN O
of IN O
files NNS O
will MD O
be VB O
executed VBN O
, , O
but CC O
they PRP O
could MD O
be VB O
malicious JJ O
or CC O
advertising NN O
files NNS O
. . O

Conclusions NNS O
This DT O
Trojan NNP O
was VBD O
distributed VBN O
through IN O
the DT O
Google NNP B-System
Play NNP I-System
Store NNP I-System
and CC O
uses VBZ O
a DT O
number NN O
of IN O
very RB O
dangerous JJ O
techniques NNS O
, , O
including VBG O
patching VBG O
system NN O
libraries NNS O
. . O

It PRP O
installs VBZ O
malicious JJ O
modules NNS O
with IN O
different JJ O
functionality NN O
into IN O
the DT O
system NN O
. . O

It PRP O
looks VBZ O
like IN O
its PRP$ O
main JJ O
purpose NN O
is VBZ O
to TO O
get VB O
into IN O
the DT O
system NN O
and CC O
execute NN O
downloaded VBD O
files NNS O
with IN O
root NN O
rights NNS O
. . O

But CC O
I PRP O
never RB O
received VBD O
such JJ O
files NNS O
from IN O
their PRP$ O
command NN O
and CC O
control NN O
server NN O
. . O

These DT O
malicious JJ O
modules NNS O
report NN O
to TO O
the DT O
attackers NNS O
about IN O
every DT O
step NN O
they PRP O
are VBP O
going VBG O
to TO O
make VB O
. . O

So RB O
I PRP O
think VBP O
that IN O
the DT O
authors NNS O
are VBP O
still RB O
testing VBG O
this DT O
malware NN O
, , O
because IN O
they PRP O
use VBP O
some DT O
techniques NNS O
which WDT O
can MD O
break VB O
the DT O
infected JJ O
devices NNS O
. . O

But CC O
they PRP O
already RB O
have VBP O
a DT O
lot NN O
of IN O
infected JJ O
users NNS O
on IN O
whom WP O
to TO O
test VB O
their PRP$ O
methods NNS O
. . O

I PRP O
hope VBP O
that IN O
by IN O
uncovering VBG O
this DT O
malware NN O
at IN O
such PDT O
an DT O
early JJ O
stage NN O
, , O
we PRP O
will MD O
be VB O
able JJ O
to TO O
prevent VB O
a DT O
massive JJ O
and CC O
dangerous JJ O
attack NN O
when WRB O
the DT O
attackers NNS O
are VBP O
ready JJ O
to TO O
actively RB O
use VB O
their PRP$ O
methods NNS O
. . O

MD5 NNP O
43680D1914F28E14C90436E1D42984E2 CD B-Indicator
20D4B9EB9377C499917C4D69BF4CCEBE CD B-Indicator
First NNP O
widely RB O
distributed VBD O
Android NNP B-System
bootkit NN O
Malware NNP O
infects VBZ O
more JJR O
than IN O
350,000 CD O
Devices NNS O
January NNP O
29 CD O
, , O
2014 CD O
In IN O
the DT O
last JJ O
quarter NN O
of IN O
2013 CD O
, , O
sale NN O
of IN O
a DT O
Smartphone NN O
with IN O
ANDROID NNP B-System
operating VBG O
system NN O
has VBZ O
increased VBN O
and CC O
every DT O
second JJ O
person NN O
you PRP O
see VBP O
is VBZ O
a DT O
DROID NNP B-System
user NN O
. . O

A DT O
Russian JJ O
security NN O
firm NN O
'Doctor NNP O
Web NNP B-Organization
' POS O
identified VBD O
the DT O
first JJ O
mass NN O
distributed VBN O
Android NNP B-System
bootkit NN O
malware NN O
called VBN O
'Android.Oldboot NNP O
' '' O
, , O
a DT O
piece NN O
of IN O
malware NN O
that WDT O
's VBZ O
designed VBN O
to TO O
re-infect JJ O
devices NNS O
after IN O
reboot NN O
, , O
even RB O
if IN O
you PRP O
delete VBP O
all DT O
working JJ O
components NNS O
of IN O
it PRP O
. . O

The DT O
bootkit NN O
Android.Oldboot NNP B-Malware
has VBZ O
infected VBN O
more JJR O
than IN O
350,000 CD O
android JJ B-System
users NNS O
in IN O
China NNP O
, , O
Spain NNP O
, , O
Italy NNP O
, , O
Germany NNP O
, , O
Russia NNP O
, , O
Brazil NNP O
, , O
the DT O
USA NNP O
and CC O
some DT O
Southeast NNP O
Asian JJ O
countries NNS O
. . O

China NNP O
seems VBZ O
to TO O
a DT O
mass NN O
victim NN O
of IN O
this DT O
kind NN O
of IN O
malware NN O
having VBG O
a DT O
92 CD O
% NN O
share NN O
. . O

A DT O
Bootkit NNP O
is VBZ O
a DT O
rootkit NN O
malware NN O
variant NN O
which WDT O
infects VBZ O
the DT O
device NN O
at IN O
start-up JJ O
and CC O
may MD O
encrypt VB O
disk NN O
or CC O
steal NN O
data NNS O
, , O
remove VB O
the DT O
application NN O
, , O
open JJ O
connection NN O
for IN O
Command NNP O
and CC O
controller NN O
. . O

A DT O
very RB O
unique JJ O
technique NN O
is VBZ O
being VBG O
used VBN O
to TO O
inject VB O
this DT O
Trojan NNP O
into IN O
an DT O
Android NNP B-System
system NN O
where WRB O
an DT O
attacker NN O
places VBZ O
a DT O
component NN O
of IN O
it PRP O
into IN O
the DT O
boot JJ O
partition NN O
of IN O
the DT O
file NN O
system NN O
and CC O
modify VB O
the DT O
'init NNP O
' POS O
script NN O
( ( O
initialize VB O
the DT O
operating NN O
system NN O
) ) O
to TO O
re-load VB O
the DT O
malware NN O
as IN O
you PRP O
switch VBP O
on IN O
your PRP$ O
android NN B-System
. . O

When WRB O
you PRP O
start VBP O
your PRP$ O
device NN O
, , O
this DT O
script NN O
loads VBZ O
the DT O
Trojan NNP O
'imei_chk NNP O
' POS O
( ( O
detects NNS O
it PRP O
as IN O
Android.Oldboot.1 NNP B-Indicator
) ) O
which WDT O
extract VBP O
two CD O
files NNS O
libgooglekernel.so FW B-Indicator
( ( O
Android.Oldboot.2 NNP B-Indicator
) ) O
and CC O
GoogleKernel.apk NNP B-Indicator
( ( O
Android.Oldboot.1.origin NNP B-Indicator
) ) O
, , O
copy VBP O
them PRP O
respectively RB O
in IN O
/system/lib NNP B-Indicator
and CC I-Indicator
/system/app NNP I-Indicator
. . O

Android.Oldboot JJ B-Malware
acts NNS O
as IN O
a DT O
system NN O
service NN O
and CC O
connects NNS O
to TO O
the DT O
command-and-controller NN O
server NN O
using VBG O
libgooglekernel.so JJ B-Indicator
library NN O
and CC O
receives VBZ O
commands NNS O
to TO O
download VB O
, , O
remove VB O
installed VBN O
apps NN O
, , O
and CC O
install RB O
malicious JJ O
apps NNS O
. . O

Since IN O
it PRP O
becomes VBZ O
a DT O
part NN O
of IN O
the DT O
boot NN O
partition NN O
, , O
formatting VBG O
the DT O
device NN O
will MD O
not RB O
solve VB O
the DT O
problem NN O
. . O

The DT O
researchers NNS O
believe VBP O
that IN O
the DT O
devices NNS O
somehow RB O
had VBD O
the DT O
malware JJ O
pre-loaded JJ O
at IN O
the DT O
time NN O
of IN O
shipping VBG O
from IN O
the DT O
manufacturer NN O
, , O
or CC O
was VBD O
likely RB O
distributed VBN O
inside RB O
modified VBN O
Android NNP B-System
firmware NN O
. . O

So RB O
, , O
users NNS O
should MD O
beware VB O
of IN O
certain JJ O
modified JJ O
Android NNP B-System
firmware NN O
. . O

Two CD O
weeks NNS O
ago RB O
, , O
Some DT O
Chinese JJ O
Security NNP O
Researchers NNP O
have VBP O
also RB O
detected VBN O
a DT O
bootkit NN O
called VBN O
'Oldboot NNP O
' POS O
, , O
possibly RB O
the DT O
same JJ O
malware NN O
or CC O
another DT O
variant NN O
of IN O
it PRP O
. . O

" NNS O
Due NNP O
to TO O
the DT O
special JJ O
RAM NNP O
disk NN O
feature NN O
of IN O
Android NNP B-System
devices NNS O
' POS O
boot NN O
partition NN O
, , O
all DT O
current JJ O
mobile JJ O
antivirus NN O
products NNS O
in IN O
the DT O
world NN O
ca MD O
n't RB O
completely RB O
remove VB O
this DT O
Trojan NNP O
or CC O
effectively RB O
repair VB O
the DT O
system NN O
. . O

'' '' O
" NN O
According VBG O
to TO O
our PRP$ O
statistics NNS O
, , O
as IN O
of IN O
today NN O
, , O
there EX O
're VBP O
more JJR O
than IN O
500 CD O
, , O
000 CD O
Android NNP B-System
devices NNS O
infected VBN O
by IN O
this DT O
bootkit NN O
in IN O
China NNP O
in IN O
last JJ O
six CD O
months NNS O
. . O

The DT O
Android NNP B-System
malware NN O
Android.Oldboot NNP B-Malware
is VBZ O
almost RB O
impossible JJ O
to TO O
remove VB O
, , O
not RB O
even RB O
with IN O
formatting VBG O
your PRP$ O
device NN O
. . O

But CC O
if IN O
your PRP$ O
device NN O
is VBZ O
not RB O
from IN O
a DT O
Chinese JJ O
manufacturer NN O
, , O
then RB O
chances VBZ O
that IN O
you PRP O
are VBP O
a DT O
victim NN O
of IN O
it PRP O
, , O
are VBP O
very RB O
less RB O
. . O

This DT O
bootkit NN O
is VBZ O
not RB O
the DT O
first JJ O
of IN O
this DT O
kind NN O
. . O

Two CD O
years NNS O
back RB O
, , O
in IN O
the DT O
month NN O
of IN O
March NNP O
we PRP O
reported VBD O
, , O
NQ NNP B-Organization
Mobile NNP I-Organization
Security NNP I-Organization
Research NNP O
Center NNP O
uncovered VBD O
the DT O
world NN O
's POS O
first JJ O
Android NNP B-System
bootkit NN O
malware NN O
called VBN O
'DKFBootKit NNP O
' POS O
, , O
that IN O
replaces VBZ O
certain JJ O
boot NN O
processes NNS O
and CC O
can MD O
begin VB O
running VBG O
even RB O
before IN O
the DT O
system NN O
is VBZ O
completely RB O
booted VBN O
up RP O
. . O

But CC O
Android.Oldboot NNP B-Malware
malware NN O
is VBZ O
a DT O
bit RB O
more RBR O
dangerous JJ O
because IN O
even RB O
if IN O
you PRP O
remove VBP O
all DT O
working JJ O
components NNS O
of IN O
it PRP O
from IN O
your PRP$ O
android NN B-System
successfully RB O
, , O
the DT O
component NN O
imei_chk NN B-Indicator
will MD O
persist VB O
in IN O
a DT O
protected JJ O
boot NN O
memory NN O
area NN O
and CC O
hence NN O
will MD O
reinstall VB O
itself PRP O
on IN O
next JJ O
boot NN O
and CC O
continuously RB O
infect VB O
the DT O
Smartphone NNP O
. . O

Users NNS O
are VBP O
recommended VBN O
to TO O
install VB O
apps NN O
from IN O
authorized VBN O
stores NNS O
such JJ O
as IN O
Google NNP B-System
Play NNP I-System
, , O
disable JJ O
installation NN O
of IN O
apps NN O
from IN O
'Unknown JJ O
Sources NNS O
' POS O
and CC O
for IN O
a DT O
better JJR O
security NN O
install VB O
a DT O
reputed JJ O
security NN O
application NN O
. . O

You PRP O
can MD O
also RB O
try VB O
to TO O
re-flash VB O
your PRP$ O
device NN O
with IN O
its PRP$ O
original JJ O
ROM NNP O
. . O

After IN O
flashing VBG O
, , O
the DT O
bootkit NN O
will MD O
be VB O
removed VBN O
. . O

FrozenCell NN B-Malware
: : O
Multi-Platform JJ O
Surveillance NNP O
Campaign NNP O
Against NNP O
Palestinians NNP O
October NNP O
5 CD O
, , O
2017 CD O
FrozenCell NNP B-Malware
has VBZ O
been VBN O
seen VBN O
masquerading VBG O
as IN O
various JJ O
well RB O
known VBN O
social JJ O
media NNS O
and CC O
chat NN O
applications NNS O
as RB O
well RB O
as IN O
an DT O
app NN O
likely RB O
only RB O
used VBN O
by IN O
Palestinian JJ O
or CC O
Jordanian JJ O
students NNS O
sitting VBG O
their PRP$ O
2016 CD O
general JJ O
exams NNS O
. . O

Lookout NN B-Organization
researchers NNS O
have VBP O
discovered VBN O
a DT O
new JJ O
mobile JJ O
surveillanceware NN O
family NN O
, , O
FrozenCell NNP B-Malware
. . O

The DT O
threat NN O
is VBZ O
likely JJ O
targeting VBG O
employees NNS O
of IN O
various JJ O
Palestinian JJ O
government NN O
agencies NNS O
, , O
security NN O
services NNS O
, , O
Palestinian JJ O
students NNS O
, , O
and CC O
those DT O
affiliated VBN O
with IN O
the DT O
Fatah NNP B-Organization
political JJ O
party NN O
. . O

FrozenCell NNP B-Malware
is VBZ O
the DT O
mobile JJ O
component NN O
of IN O
a DT O
multi-platform JJ O
attack NN O
we PRP O
've VBP O
seen VBN O
a DT O
threat NN O
actor NN O
known VBN O
as IN O
" JJ O
Two-tailed JJ B-Malware
Scorpion/APT-C-23 NN I-Malware
, , O
'' '' O
use NN O
to TO O
spy VB O
on IN O
victims NNS O
through IN O
compromised VBN O
mobile JJ O
devices NNS O
and CC O
desktops NNS O
. . O

The DT O
desktop JJ O
components NNS O
of IN O
this DT O
attack NN O
, , O
previously RB O
discovered VBN O
by IN O
Palo NNP B-Organization
Alto NNP I-Organization
Network NNP I-Organization
, , O
are VBP O
known VBN O
as IN O
KasperAgent NNP B-Malware
and CC O
Micropsia NNP B-Malware
. . O

We PRP O
discovered VBD O
561MB CD O
of IN O
exfiltrated VBN O
data NNS O
from IN O
24 CD O
compromised VBN O
Android NNP B-System
devices NNS O
while IN O
investigating VBG O
this DT O
threat NN O
. . O

More JJR O
data NNS O
is VBZ O
appearing VBG O
daily RB O
, , O
leading VBG O
us PRP O
to TO O
believe VB O
the DT O
actors NNS O
are VBP O
still RB O
highly RB O
active JJ O
. . O

We PRP O
are VBP O
continuing VBG O
to TO O
watch VB O
it PRP O
closely RB O
. . O

This DT O
threat NN O
is VBZ O
another DT O
proof NN O
point NN O
that IN O
attackers NNS O
are VBP O
clearly RB O
incorporating VBG O
the DT O
mobile JJ O
device NN O
into IN O
their PRP$ O
surveillance NN O
campaigns NNS O
as IN O
a DT O
primary JJ O
attack NN O
vector NN O
. . O

Government NN O
agencies NNS O
and CC O
enterprises NNS O
should MD O
look VB O
at IN O
this DT O
threat NN O
as IN O
an DT O
example NN O
of IN O
the DT O
kind NN O
of IN O
spying VBG O
that DT O
is VBZ O
now RB O
possible JJ O
given VBN O
how WRB O
ubiquitous JJ O
mobile JJ O
devices NNS O
are VBP O
in IN O
the DT O
workplace NN O
. . O

Attackers NNS O
are VBP O
keenly RB O
aware JJ O
of IN O
the DT O
information NN O
they PRP O
can MD O
derive VB O
from IN O
these DT O
devices NNS O
and CC O
are VBP O
using VBG O
multi-stage NN O
( ( O
phishing VBG O
+ PDT O
an DT O
executable JJ O
) ) O
, , O
multi-platform JJ O
( ( O
Android NNP B-System
+ NNP O
desktop NN O
) ) O
attacks VBZ O
to TO O
accomplish VB O
their PRP$ O
spying NN O
. . O

All DT O
Lookout NNP B-Organization
customers NNS O
are VBP O
protected VBN O
from IN O
this DT O
threat NN O
. . O

What WP O
it PRP O
does VBZ O
FrozenCell NNP B-Malware
masquerades NNS O
as IN O
fake JJ O
updates NNS O
to TO O
chat VB O
applications NNS O
like IN O
Facebook NNP B-System
, , O
WhatsApp NNP B-System
, , O
Messenger NNP B-System
, , O
LINE NNP B-System
, , O
and CC O
LoveChat NNP B-System
. . O

We PRP O
also RB O
detected VBD O
it PRP O
in IN O
apps NN O
targeted VBN O
toward IN O
specific JJ O
Middle NNP O
Eastern NNP O
demographics NNS O
. . O

For IN O
example NN O
, , O
the DT O
actors NNS O
behind IN O
FrozenCell NNP B-Malware
used VBD O
a DT O
spoofed JJ O
app NN O
called VBN O
Tawjihi NNP B-Indicator
2016 CD I-Indicator
, , O
which WDT O
Jordanian NNP O
or CC O
Palestinian JJ O
students NNS O
would MD O
ordinarily RB O
use VB O
during IN O
their PRP$ O
general JJ O
secondary JJ O
examination NN O
. . O

Once RB O
installed VBN O
on IN O
a DT O
device NN O
FrozenCell NNP B-Malware
is VBZ O
capable JJ O
of IN O
: : O
Recording VBG O
calls NNS O
Retrieving VBG O
generic JJ O
phone NN O
metadata NN O
( ( O
e.g. JJ O
, , O
cell NN O
location NN O
, , O
mobile JJ O
country NN O
code NN O
, , O
mobile JJ O
network NN O
code NN O
) ) O
Geolocating VBG O
a DT O
device NN O
Extracting NNP O
SMS NNP O
messages NNS O
Retrieving VBG O
a DT O
victim NN O
's POS O
accounts NNS O
Exfiltrating VBG O
images NNS O
Downloading NNP O
and CC O
installing VBG O
additional JJ O
applications NNS O
Searching VBG O
for IN O
and CC O
exfiltrating VBG O
pdf NN O
, , O
doc NN O
, , O
docx NN O
, , O
ppt NN O
, , O
pptx NN O
, , O
xls NNP O
, , O
and CC O
xlsx NNP O
file VBP O
types NNS O
Retrieving VBG O
contacts NNS O
The DT O
graph NN O
below IN O
represents VBZ O
a DT O
split NN O
of IN O
the DT O
types NNS O
of IN O
data NNS O

from IN O
only RB O
one CD O
misconfigured VBD O
command NN O
and CC O
control NN O
server NN O
( ( O
out IN O
of IN O
over IN O
37 CD O
servers NNS O
) ) O
. . O

This DT O
is VBZ O
only RB O
a DT O
small JJ O
picture NN O
of IN O
the DT O
threat NN O
actor NN O
's POS O
operations NNS O
. . O

Split NN O
of IN O
exfiltrated VBN O
data NNS O
Some DT O
noteworthy JJ O
files NNS O
identified VBN O
in IN O
content NN O
taken VBN O
from IN O
compromised JJ O
devices NNS O
include VBP O
passport NN O
photos NNS O
, , O
audio JJ O
recordings NNS O
of IN O
calls NNS O
, , O
other JJ O
images NNS O
, , O
and CC O
a DT O
PDF NNP O
document NN O
with IN O
data NNS O
on IN O
484 CD O
individuals NNS O
. . O

The DT O
PDF NNP O
lists VBZ O
dates NNS O
of IN O
birth NN O
, , O
gender NN O
, , O
passport NN O
numbers NNS O
, , O
and CC O
names NNS O
. . O

Potential JJ O
targets NNS O
The DT O
actors NNS O
behind IN O
FrozenCell NNP B-Malware
used VBD O
an DT O
online JJ O
service NN O
that WDT O
geolocates VBZ O
mobile JJ O
devices NNS O
based VBN O
on IN O
nearby JJ O
cell NN O
towers NNS O
to TO O
track VB O
targets NNS O
. . O

This DT O
data NN O
shows VBZ O
a DT O
distinct JJ O
concentration NN O
of IN O
infected JJ O
devices NNS O
beaconing VBG O
from IN O
Gaza NNP O
, , O
Palestine NNP O
. . O

Map NNP O
of IN O
potential JJ O
targets NNS O
Early JJ O
samples NNS O
of IN O
FrozenCell NNP B-Malware
used VBD O
an DT O
online JJ O
service NN O
for IN O
storing VBG O
geolocation NN O
information NN O
of IN O
infected JJ O
devices NNS O
. . O

Analysis NN O
of IN O
this DT O
telemetry NN O
shows VBZ O
infected VBN O
devices NNS O
are VBP O
completely RB O
based VBN O
in IN O
Gaza NNP O
, , O
Palestine NNP O
. . O

It PRP O
has VBZ O
not RB O
been VBN O
confirmed VBN O
whether IN O
these DT O
are VBP O
from IN O
test NN O
devices NNS O
or CC O
the DT O
devices NNS O
of IN O
victims NNS O
. . O

We PRP O
were VBD O
also RB O
able JJ O
to TO O
link VB O
the DT O
FrozenCell NNP B-Malware
's POS O
Android NNP B-System
infrastructure NN O
to TO O
numerous JJ O
desktop NN O
samples NNS O
that WDT O
are VBP O
part NN O
of IN O
the DT O
larger JJR O
multi-platform JJ O
attack NN O
. . O

It PRP O
appears VBZ O
the DT O
attackers NNS O
sent VBD O
malicious JJ O
executables NNS O
though IN O
phishing VBG O
campaigns NNS O
impersonating VBG O
individuals NNS O
associated VBN O
with IN O
the DT O
Palestinian NNP B-Organization
Security NNP I-Organization
Services NNPS I-Organization
, , O
the DT O
General NNP B-Organization
Directorate NNP I-Organization
of IN I-Organization
Civil NNP I-Organization
Defence NNP I-Organization
- : O
Ministry NNP B-Organization
of IN I-Organization
the DT I-Organization
Interior NNP I-Organization
, , O
and CC O
the DT O
7th CD O
Fateh NNP O
Conference NNP O
of IN O
the DT O
Palestinian JJ B-Organization
National NNP I-Organization
Liberation NNP I-Organization
Front NNP I-Organization
( ( O
held VBN O
in IN O
late JJ O
2016 CD O
) ) O
. . O

The DT O
titles NNS O
and CC O
contents NNS O
of IN O
these DT O
files NNS O
suggest VBP O
that IN O
the DT O
actor NN O
targeted VBD O
individuals NNS O
affiliated VBN O
with IN O
these DT O
government NN O
agencies NNS O
and CC O
the DT O
Fatah NNP B-Organization
political JJ O
party NN O
. . O

Some DT O
malicious JJ O
files NNS O
associated VBN O
with IN O
these DT O
samples NNS O
were VBD O
titled VBN O
the DT O
following NN O
: : O
Council_of_ministres_decision NNP O
Minutes NNP O
of IN O
the DT O
Geneva NNP O
Meeting NNP O
on IN O
Troops NNP O
Summary NNP O
of IN O
today NN O
's POS O
meetings.doc.exe PDT B-Indicator
The DT O
most RBS O
important JJ O
points NNS O
of IN O
meeting VBG O
the DT O
memory NN O
of IN O
the DT O
late JJ O
President NNP O
Abu NNP O
Omar NNP O
may MD O
Allah VB O
have VB O
mercy VBN O
on IN O
him PRP O
- : O
Paper NN O
No NNP O
. . O

1 CD O
Fadi NNP O
Alsalamin NNP O
scandal NN O
with IN O
an DT O
Israeli JJ O
officer NN O
- : O
exclusive JJ O
- : O
watched VBN O
before IN O
the DT O
deletion NN O
- : O
Fadi NNP O
Elsalameen NNP O
The DT O
details NNS O
of IN O
the DT O
assassination NN O
of IN O
President NNP O
Arafat_06-12-2016_docx NNP O
Quds.rar NNP B-Indicator
Many NNP O
of IN O
these DT O
executables NNS O
are VBP O
associated VBN O
with IN O
various JJ O
short JJ O
links NNS O
created VBD O
using VBG O
Bit.ly NNP B-System
, , O
a DT O
URL NNP O
shortening NN O
service NN O
. . O

After IN O
analyzing VBG O
the DT O
traffic NN O
associated VBN O
with IN O
these DT O
short JJ O
links NNS O
, , O
we PRP O
determined VBD O
that IN O
each DT O
one CD O
was VBD O
associated VBN O
with IN O
a DT O
referral JJ O
path NN O
from IN O
mail.mosa.pna.ps NN B-Indicator
. . O

MOSA NNP B-Organization
is VBZ O
the DT O
Palestinian JJ O
Directorate NNP O
of IN O
Social NNP O
Development NNP O
whose WP$ O
mandate NN O
is VBZ O
to TO O
achieve VB O
comprehensive JJ O
development NN O
, , O
social JJ O
security NN O
, , O
and CC O
economic JJ O
growth NN O
for IN O
Palestinian JJ O
families NNS O
, , O
according VBG O
to TO O
publicly RB O
available JJ O
information NN O
on IN O
this DT O
ministry NN O
. . O

Infrastructure NN O
At IN O
the DT O
time NN O
of IN O
writing VBG O
the DT O
following JJ O
domains NNS O
have VBP O
either DT O
been VBN O
used VBN O
by IN O
this DT O
family NN O
or CC O
are VBP O
currently RB O
active JJ O
. . O

We PRP O
expect VBP O
this DT O
list NN O
to TO O
grow VB O
given VBN O
that IN O
this DT O
actor NN O
has VBZ O
changed VBN O
its PRP$ O
infrastructure NN O
numerous JJ O
times NNS O
in IN O
2017 CD O
. . O

cecilia-gilbert JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
comgooogel NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
orgmary-crawley JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
commydriveweb NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
comrose-sturat JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
infokalisi NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
xyzdebra-morgan JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
comarnani NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
infoacount-manager JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
infogooogel-drive JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
commediauploader NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
meacount-manager NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
netupload404 JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
clubupload999 NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
infoal-amalhumandevelopment JJ I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
commargaery NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
coupload202 NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
comgo-mail-accounts NNS I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
comupload101 NN I-Indicator
[ NN B-Indicator
. . I-Indicator

] JJ I-Indicator
netsybil-parks JJ I-Indicator
[ NN O
. . O

] JJ O
infodavos-seaworth JJ O
[ NN O
. . O

] JJ O
infoupload999 NN O
[ NN O
. . O

] JJ O
orgacount-manager JJ O
[ NN O
. . O

] JJ O
comlila-tournai JJ O
[ NN O
. . O

] JJ O
comaccount-manager NN O
[ NN O
. . O

] JJ O
orgmediauploader NN O
[ NN O
. . O

] JJ O
infokalisi NN O
[ NN O
. . O

] JJ O
orgaryastark NN O
[ NN O
. . O

] JJ O
infomavis-dracula JJ O
[ NN O
. . O

] JJ O
comkalisi NN O
[ NN O
. . O

] JJ O
infogoogle-support-team JJ O
[ NN O
. . O

] JJ O
com9oo91e NN O
[ NN O
. . O

] JJ O
comuseraccount NN O
[ NN O
. . O

] JJ O
websiteaccounts-fb JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
comakashipro NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
comfeteh-asefa JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
comlagertha-lothbrok JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
info NN I-Indicator
OpSec NNP O
fails NNS O
and CC O
use NN O
of IN O
cryptography NN O
While IN O
looking VBG O
at IN O
this DT O
infrastructure NN O
, , O
we PRP O
identified VBD O
that IN O
one CD O
of IN O
these DT O
domains NNS O
has VBZ O
directory NN O
indexing VBG O
enabled VBN O
. . O

This DT O
mistake NN O
in IN O
operational JJ O
security NN O
allowed VBD O
us PRP O
to TO O
gain VB O
visibility NN O
into IN O
exfiltrated JJ O
content NN O
for IN O
a DT O
number NN O
of IN O
devices NNS O
. . O

Continued JJ O
mirroring VBG O
suggests VBZ O
it PRP O
is VBZ O
likely JJ O
a DT O
regularly RB O
cleaned VBN O
staging VBG O
server NN O
. . O

We PRP O
sourced VBD O
the DT O
over IN O
561MB CD O
of IN O
exfiltrated VBN O
data NN O
from IN O
this DT O
domain NN O
alone RB O
, , O
all DT O
of IN O
which WDT O
we PRP O
found VBD O
to TO O
be VB O
7z CD O
compressed JJ O
and CC O
password NN O
protected VBN O
. . O

Password NNP O
generation NN O
for IN O
compressed JJ O
files NNS O
takes VBZ O
place NN O
client-side JJ O
with IN O
each DT O
device NN O
using VBG O
a DT O
unique JJ O
key NN O
in IN O
most JJS O
scenarios NNS O
. . O

Key NNP O
information NN O
consists VBZ O
of IN O
an DT O
MD5 NNP O
hash NN O
of IN O
the DT O
device NN O
's POS O
Android NNP B-System
ID NNP O
, , O
the DT O
device NN O
manufacturer NN O
, , O
and CC O
the DT O
device NN O
model NN O
with IN O
each DT O
separated VBN O
by IN O
an DT O
underscore NN O
. . O

Visually RB O
, , O
this DT O
can MD O
be VB O
represented VBN O
as IN O
follows VBZ O
: : O
Android NNP B-System
ID NNP O
When WRB O
combined VBN O
with IN O
our PRP$ O
analysis NN O
of IN O
indexed JJ O
directories NNS O
on IN O
C2 NNP O
infrastructure NN O
, , O
we PRP O
were VBD O
able JJ O
to TO O
easily RB O
automate VB O
the DT O
generation NN O
of IN O
the DT O
password NN O
used VBN O
by IN O
each DT O
device NN O
and CC O
, , O
in IN O
turn NN O
, , O
successfully RB O
decompress VB O
all DT O
exfiltrated VBN O
content NN O
from IN O
compromised JJ O
devices NNS O
. . O

Indexed NNP O
directories NNS O
on IN O
C2 NNP O
infrastructure NN O
While IN O
exfiltrated VBN O
content NN O
is VBZ O
encrypted VBN O
, , O
information NN O
used VBN O
to TO O
generate VB O
the DT O
password NN O
is VBZ O
plainly RB O
visible JJ O
in IN O
the DT O
top JJ O
level NN O
directories NNS O
for IN O
each DT O
device NN O
. . O

Taking VBG O
this DT O
information NN O
from IN O
directory NN O
listings NNS O
, , O
like IN O
the DT O
one CD O
shown VBN O
above IN O
, , O
allowed VBN O
for IN O
the DT O
decryption NN O
of IN O
all DT O
content NN O
. . O

In IN O
this DT O
case NN O
, , O
FrozenCell NNP B-Malware
has VBZ O
primarily RB O
netted VBN O
the DT O
actors NNS O
behind IN O
it PRP O
with IN O
recorded VBN O
outbound NN O
calls VBZ O
followed VBN O
closely RB O
by IN O
images NNS O
and CC O
recorded VBD O
incoming VBG O
calls NNS O
. . O

FrozenCell NNP B-Malware
is VBZ O
part NN O
of IN O
a DT O
very RB O
successful JJ O
, , O
multi-platform JJ O
surveillance NN O
campaign NN O
. . O

Attackers NNS O
are VBP O
growing VBG O
smarter RBR O
, , O
targeting VBG O
individuals NNS O
through IN O
the DT O
devices NNS O
and CC O
the DT O
services NNS O
they PRP O
use VBP O
most RBS O
. . O

Government NN O
agencies NNS O
and CC O
enterprises NNS O
should MD O
plan VB O
to TO O
be VB O
hit VBN O
from IN O
all DT O
angles NNS O
- : O
cloud NN O
services NNS O
, , O
mobile JJ O
devices NNS O
, , O
laptops SYM O
- : O
in IN O
order NN O
to TO O
build VB O
comprehensive JJ O
security NN O
strategies NNS O
that WDT O
work VBP O
. . O

TUESDAY NNP O
, , O
MAY NNP O
19 CD O
, , O
2020 CD O
The DT O
wolf NN O
is VBZ O
back RB O
... : O
NEWS NNP O
SUMMARY NNP O
Thai NNP O
Android NNP B-System
devices NNS O
and CC O
users NNS O
are VBP O
being VBG O
targeted VBN O
by IN O
a DT O
modified JJ O
version NN O
of IN O
DenDroid NNP B-Malware
we PRP O
are VBP O
calling VBG O
" NNP O
WolfRAT NNP B-Malware
, , O
'' '' O
now RB O
targeting VBG O
messaging VBG O
apps NN O
like IN O
WhatsApp NNP B-System
, , O
Facebook NNP B-System
Messenger NNP I-System
and CC O
Line NNP B-System
. . O

We PRP O
assess VBP O
with IN O
high JJ O
confidence NN O
that IN O
this DT O
modified JJ O
version NN O
is VBZ O
operated VBN O
by IN O
the DT O
infamous JJ O
Wolf NNP B-Organization
Research NNP I-Organization
. . O

This DT O
actor NN O
has VBZ O
shown VBN O
a DT O
surprising JJ O
level NN O
of IN O
amateur JJ O
actions NNS O
, , O
including VBG O
code NN O
overlaps NNS O
, , O
open-source JJ O
project NN O
copy/paste NN O
, , O
classes VBZ O
never RB O
being VBG O
instanced VBN O
, , O
unstable JJ O
packages NNS O
and CC O
unsecured JJ O
panels NNS O
. . O

EXECUTIVE NNP O
SUMMARY NNP O
Cisco NNP B-Organization
Talos NNP I-Organization
has VBZ O
discovered VBN O
a DT O
new JJ O
Android NNP O
malware NN O
based VBN O
on IN O
a DT O
leak NN O
of IN O
the DT O
DenDroid NNP B-Malware
malware NN O
family NN O
. . O

We PRP O
named VBD O
this DT O
malware NN O
" VBZ O
WolfRAT NNP B-Malware
'' '' O
due JJ O
to TO O
strong JJ O
links NNS O
between IN O
this DT O
malware NN O
( ( O
and CC O
the DT O
command NN O
and CC O
control NN O
( ( O
C2 NNP O
) ) O
infrastructure NN O
) ) O
and CC O
Wolf NNP B-Organization
Research NNP I-Organization
, , O
an DT O
infamous JJ O
organization NN O
that WDT O
developed VBD O
interception NN O
and CC O
espionage-based JJ O
malware NN O
and CC O
was VBD O
publicly RB O
described VBN O
by IN O
CSIS NNP O
during IN O
Virus NNP O
Bulletin NNP O
2018 CD O
. . O

We PRP O
identified VBD O
infrastructure NN O
overlaps NNS O
and CC O
string VBG O
references NNS O
to TO O
previous JJ O
Wolf NNP B-Organization
Research NNP I-Organization
work NN O
. . O

The DT O
organization NN O
appears VBZ O
to TO O
be VB O
shut VBN O
down RP O
, , O
but CC O
the DT O
threat NN O
actors NNS O
are VBP O
still RB O
very RB O
active JJ O
. . O

We PRP O
identified VBD O
campaigns NNS O
targeting VBG O
Thai NNP O
users NNS O
and CC O
their PRP$ O
devices NNS O
. . O

Some DT O
of IN O
the DT O
C2 NNP O
servers NNS O
are VBP O
located VBN O
in IN O
Thailand NNP O
. . O

The DT O
panels NNS O
also RB O
contain VBP O
Thai NNP O
JavaScript NNP O
comments NNS O
and CC O
the DT O
domain NN O
names NNS O
also RB O
contain VBP O
references NNS O
to TO O
Thai NNP O
food NN O
, , O
a DT O
tactic JJ O
commonly RB O
employed VBN O
to TO O
entice VB O
users NNS O
to TO O
click/visit VB O
these DT O
C2 NNP O
panels NNS O
without IN O
much JJ O
disruption NN O
. . O

We PRP O
identified VBD O
a DT O
notable JJ O
lack NN O
of IN O
sophistication NN O
in IN O
this DT O
investigation NN O
such JJ O
as IN O
copy/paste NN O
, , O
unstable JJ O
code NN O
, , O
dead JJ O
code NN O
and CC O
panels NNS O
that WDT O
are VBP O
freely RB O
open JJ O
. . O

What WP O
's VBZ O
new JJ O
? . O

WolfRAT NNP B-Malware
is VBZ O
based VBN O
on IN O
a DT O
previously RB O
leaked VBN O
malware NN O
named VBN O
DenDroid NNP B-Malware
. . O

The DT O
new JJ O
malware NN O
appears VBZ O
to TO O
be VB O
linked VBN O
to TO O
the DT O
infamous JJ O
Wolf NNP B-Organization
Research NNP I-Organization
organization NN O
and CC O
targets NNS O
Android NNP B-System
devices NNS O
located VBN O
in IN O
Thailand NNP O
. . O

How WRB O
did VBD O
it PRP O
work VB O
? . O

The DT O
malware NN O
mimics NNS O
legit JJ O
services NNS O
such JJ O
as IN O
Google NNP B-Organization
service NN O
, , O
GooglePlay NNP B-System
or CC O
Flash NNP B-System
update NN O
. . O

The DT O
malware NN O
is VBZ O
not RB O
really RB O
advanced JJ O
and CC O
is VBZ O
based VBN O
on IN O
a DT O
lot NN O
of IN O
copy/paste NN O
from IN O
public JJ O
sources NNS O
available JJ O
on IN O
the DT O
Internet NNP O
. . O

The DT O
C2 NNP O
infrastructure NN O
contains VBZ O
a DT O
lack NN O
of IN O
sophistication NN O
such JJ O
as IN O
open JJ O
panels NNS O
, , O
reuse NN O
of IN O
old JJ O
servers NNS O
publicly RB O
tagged VBN O
as IN O
malicious… NN O
So IN O
what WP O
? . O

After IN O
being VBG O
publicly RB O
denounced VBN O
by IN O
CSIS NNP B-Organization
Group NNP I-Organization
— VBD O
a DT O
threat NN O
intelligence NN O
company NN O
in IN O
Denmark NNP O
— NNP O
Wolf NNP B-Organization
Research NNP I-Organization
was VBD O
closed VBN O
and CC O
a DT O
new JJ O
organization NN O
named VBN O
LokD NNP B-Organization
was VBD O
created VBN O
. . O

This DT O
new JJ O
organization NN O
seems VBZ O
to TO O
work VB O
on IN O
securing VBG O
Android NNP B-Organization
devices NNS O
. . O

However RB O
, , O
thanks NNS O
to TO O
the DT O
infrastructure NN O
sharing NN O
and CC O
forgotten JJ O
panel NN O
names NNS O
, , O
we PRP O
assess VBP O
with IN O
high JJ O
confidence NN O
that IN O
this DT O
actor NN O
is VBZ O
still RB O
active JJ O
, , O
it PRP O
is VBZ O
still RB O
developing VBG O
malware NN O
and CC O
has VBZ O
been VBN O
using VBG O
it PRP O
from IN O
mid-June NN O
to TO O
today NN O
. . O

On IN O
the DT O
C2 NNP O
panel NN O
, , O
we PRP O
found VBD O
a DT O
potential JJ O
link NN O
between IN O
Wolf NNP B-Organization
Research NNP I-Organization
and CC O
another DT O
Cyprus NNP O
organization NN O
named VBN O
Coralco NNP B-Organization
Tech NNP I-Organization
. . O

This DT O
organization NN O
is VBZ O
also RB O
working VBG O
on IN O
interception NN O
technology NN O
. . O

LINKS NNP O
TO NNP O
WOLF NNP O
INTELLIGENCE NNP O
During IN O
the DT O
Virus NNP O
Bulletin NNP O
conference NN O
in IN O
2018 CD O
, , O
CSIS NNP B-Organization
researchers NNS O
Benoît NNP O
Ancel NNP O
and CC O
Aleksejs NNP O
Kuprins NNP O
did VBD O
a DT O
presentation NN O
on IN O
Wolf NNP B-Organization
Research NNP I-Organization
and CC O
the DT O
offensive JJ O
arsenal NN O
developed VBN O
by IN O
the DT O
organization NN O
. . O

They PRP O
mentioned VBD O
an DT O
Android NNP B-System
, , O
iOS NN B-System
and CC O
Windows NNP B-System
remote VBP O
access NN O
tool NN O
( ( O
RAT NNP O
) ) O
. . O

Their PRP$ O
findings NNS O
showed VBD O
that IN O
Wolf NNP O
is VBZ O
headquartered VBN O
in IN O
Germany NNP O
with IN O
offices NNS O
in IN O
Cyprus NNP O
, , O
Bulgaria NNP O
, , O
Romania NNP O
, , O
India NNP O
and CC O
( ( O
possibly RB O
) ) O
the DT O
U.S NNP O
. . O

The DT O
organization NN O
was VBD O
closed VBN O
after IN O
the DT O
CSIS NNP B-Organization
presentation NN O
. . O

However RB O
, , O
the DT O
director NN O
created VBD O
a DT O
new JJ O
organization NN O
in IN O
Cyprus NNP O
named VBD O
LokD NNP B-Organization
. . O

This DT O
new JJ O
organization NN O
proposed VBD O
the DT O
creation NN O
of IN O
a DT O
more RBR O
secure JJ O
Android NNP B-System
phone NN O
. . O

Based VBN O
on IN O
the DT O
organization NN O
website NN O
, , O
it PRP O
also RB O
proposes VBZ O
services NNS O
and CC O
developed VBD O
zero-day JJ B-Vulnerability
vulnerabilities NNS I-Vulnerability
to TO O
test VB O
their PRP$ O
own JJ O
products NNS O
: : O
Zero-day JJ O
research NN O
from IN O
lokd.com IN B-Organization
We PRP O
can MD O
see VB O
that IN O
the DT O
organization NN O
owner NN O
still RB O
has VBZ O
an DT O
interest NN O
in IN O
Android NNP B-System
devices NNS O
. . O

Based VBN O
on IN O
infrastructure NN O
overlaps NNS O
and CC O
leaked JJ O
information NN O
, , O
we PRP O
assess VBP O
with IN O
high JJ O
confidence NN O
that IN O
the DT O
malware NN O
we PRP O
identified VBD O
and CC O
present JJ O
in IN O
this DT O
paper NN O
is VBZ O
linked VBN O
to TO O
Wolf NNP B-Organization
Research NNP I-Organization
. . O

One CD O
of IN O
the DT O
samples NNS O
( ( O
e19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1 NN B-Indicator
) ) O
uses VBZ O
the DT O
C2 NNP O
server NN O
svcws NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
ponethus NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
. . O

Based VBN O
on IN O
our PRP$ O
research NN O
and CC O
Benoît NNP O
Ancel NNP O
's POS O
tracker NN O
, , O
this DT O
C2 NNP O
was VBD O
used VBN O
by IN O
Wolf NNP B-Organization
Intelligence NNP I-Organization
: : O
Additionally RB O
, , O
we PRP O
identified VBD O
two CD O
empty JJ O
panels NNS O
on IN O
a DT O
C2 NNP O
server NN O
. . O

The DT O
new JJ O
one NN O
with IN O
the DT O
title NN O
" NNP O
Coralco NNP O
Archimedes NNP O
, , O
'' '' O
and CC O
an DT O
older JJR O
version NN O
with IN O
the DT O
title NN O
" NNP O
Wolf NNP O
Intelligence NN O
: : O
'' '' O
New NNP O
panel NN O
Old NNP O
panel NN O
The DT O
new JJ O
panel NN O
name NN O
contains VBZ O
" JJ O
Coralco NNP O
'' '' O
in IN O
its PRP$ O
name NN O
. . O

Coralco NNP B-Organization
Tech NNP I-Organization
is VBZ O
an DT O
organization NN O
located VBN O
in IN O
Cyprus NNP O
and CC O
providing VBG O
interception NN O
tools NNS O
. . O

We PRP O
can MD O
not RB O
say VB O
for IN O
sure JJ O
if IN O
Wolf NNP B-Organization
Research NNP I-Organization
and CC O
Coralco NNP B-Organization
Tech NNP I-Organization
are VBP O
linked VBN O
, , O
but CC O
this DT O
panel NN O
name NN O
, , O
their PRP$ O
offerings NNS O
and CC O
the DT O
panel NN O
layout NN O
would MD O
suggest VB O
it PRP O
should MD O
be VB O
considered VBN O
suspiciously RB O
linked VBN O
. . O

Coralco NNP O
Tech NNP O
's POS O
services NNS O
description NN O
. . O

VICTIMOLOGY NNP O
ON NNP O
THE NNP O
IDENTIFIED NNP O
CAMPAIGNS NNP O
The DT O
campaigns NN O
we PRP O
analyzed VBD O
targeted VBN O
Android NNP B-System
devices NNS O
in IN O
Thailand NNP O
. . O

The DT O
C2 NNP O
server NN O
domain NN O
is VBZ O
linked VBN O
to TO O
Thai NNP O
food NN O
: : O
Nampriknum NNP B-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
net NN I-Indicator
: : O
Nam NNP O
Phrik NNP O
Num NNP O
Somtum NNP B-Indicator
[ NNP I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
: : O
Som NNP O
Tum NNP O
We PRP O
also RB O
identified VBD O
comments NNS O
in IN O
Thai NNP O
on IN O
the DT O
C2 NNP O
infrastructure NN O
mentioned VBD O
in IN O
the DT O
previous JJ O
chapter NN O
: : O
MALWARE NNP O
DenDroid NNP B-Malware
The DT O
Android NNP B-System
malware NN O
is VBZ O
based VBN O
on IN O
the DT O
DenDroid NNP B-Malware
Android NNP O
malware NN O
. . O

Several JJ O
analysis NN O
reports NNS O
were VBD O
published VBN O
on IN O
this DT O
malware NN O
in IN O
2014 CD O
and CC O
, , O
finally RB O
, , O
the DT O
source NN O
code NN O
was VBD O
leaked VBN O
in IN O
2015 CD O
. . O

The DT O
original JJ O
leak NN O
is VBZ O
no RB O
longer RBR O
available JJ O
on IN O
github.com NN O
, , O
but CC O
a DT O
copy NN O
can MD O
be VB O
found VBN O
here RB O
. . O

The DT O
table NN O
below IN O
shows VBZ O
the DT O
commands NNS O
available JJ O
to TO O
the DT O
operator NN O
for IN O
tasking VBG O
on IN O
infected JJ O
devices NNS O
. . O

This DT O
malware NN O
is VBZ O
simplistic JJ O
in IN O
comparison NN O
to TO O
some DT O
modern-day JJ O
Android NNP B-System
malware NN O
. . O

The DT O
best JJS O
example NN O
of IN O
that DT O
is VBZ O
that IN O
it PRP O
does VBZ O
n't RB O
take VB O
advantage NN O
of IN O
the DT O
accessibility NN O
framework NN O
, , O
collecting VBG O
information NN O
on IN O
non-rooted JJ O
devices NNS O
. . O

The DT O
commands NNS O
are VBP O
self-explanatory JJ O
and CC O
show VB O
the DT O
features NNS O
included VBD O
in IN O
the DT O
malware NN O
. . O

Some DT O
of IN O
them PRP O
like IN O
takephoto NN O
, , O
takevideo NN O
, , O
recordaudio NN O
, , O
getsentsms NNS O
and CC O
uploadpictures NNS O
are VBP O
focused VBN O
on IN O
espionage NN O
activities NNS O
. . O

Others NNS O
like IN O
transferbot NN O
, , O
promptupdate NN O
and CC O
promptuninstall NN O
are VBP O
meant VBN O
to TO O
help VB O
the DT O
operator NN O
manage NN O
the DT O
malware NN O
. . O

Version NNP O
# # O
1 CD O
: : O
June NNP O
2019 CD O
— NNP O
Domain NNP O
: : O
databit NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
During IN O
our PRP$ O
investigation NN O
, , O
we PRP O
identified VBD O
at IN O
least JJS O
four CD O
major JJ O
releases NNS O
of IN O
the DT O
RAT NNP O
. . O

The DT O
permissions NNS O
on IN O
the DT O
first JJ O
version NN O
of IN O
the DT O
malware NN O
lay VBD O
out RP O
the DT O
foundations NNS O
of IN O
a DT O
spying NN O
trojan NN O
. . O

Permissions NNS O
The DT O
package NN O
name NN O
follows VBZ O
the DT O
original JJ O
style NN O
name NN O
used VBN O
on IN O
DenDroid NNP B-Malware
. . O

The DT O
code NN O
is VBZ O
obfuscated VBN O
but CC O
not RB O
packed VBN O
. . O

This DT O
malware NN O
also RB O
contains VBZ O
a DT O
screen NN O
recorder NN O
. . O

This DT O
feature NN O
is VBZ O
implemented VBN O
using VBG O
another DT O
open-source NN O
software NN O
package NN O
that WDT O
can MD O
be VB O
found VBN O
here RB O
. . O

The DT O
service NN O
is VBZ O
implemented VBN O
in IN O
the DT O
class NN O
com.serenegiant.service.ScreenRecorderService NN B-Indicator
which WDT O
is VBZ O
declared VBN O
in IN O
the DT O
package NN O
manifest JJS O
. . O

During IN O
our PRP$ O
analysis NN O
of IN O
this DT O
sample NN O
, , O
we PRP O
did VBD O
notice RB O
that IN O
the DT O
class NN O
itself PRP O
is VBZ O
never RB O
called VBN O
or CC O
used VBN O
by IN O
the DT O
malware NN O
. . O

It PRP O
remains VBZ O
available JJ O
within IN O
the DT O
source NN O
code NN O
but CC O
no DT O
method NN O
of IN O
use NN O
takes VBZ O
place NN O
. . O

Version NNP O
# # O
2 CD O
: : O
June NNP O
- : O
Aug. NNP O
2019 CD O
— NNP O
Domain NNP O
: : O
somtum NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
today NN I-Indicator
This DT O
is VBZ O
the DT O
first JJ O
version NN O
that WDT O
shows VBZ O
the DT O
code NN O
organization NN O
evolution NN O
that WDT O
will MD O
continue VB O
to TO O
be VB O
used VBN O
on IN O
all DT O
other JJ O
functions NNS O
throughout IN O
this DT O
malware NN O
. . O

Code NNP O
structure NN O
Obviously RB O
, , O
this DT O
code NN O
is VBZ O
not RB O
obfuscated VBN O
when WRB O
compared VBN O
with IN O
the DT O
previous JJ O
version NN O
it PRP O
becomes VBZ O
clear JJ O
that IN O
this DT O
is VBZ O
the DT O
same JJ O
code NN O
base NN O
. . O

One CD O
of IN O
the DT O
first JJ O
changes NNS O
that WDT O
stands VBZ O
out RP O
is VBZ O
that IN O
the DT O
screen NN O
recording VBG O
feature NN O
mentioned VBN O
in IN O
the DT O
previous JJ O
sample NN O
has VBZ O
been VBN O
removed VBN O
. . O

A DT O
new JJ O
class NN O
was VBD O
added VBN O
called VBN O
com.utils.RestClient NN B-Indicator
. . O

This DT O
class NN O
is VBZ O
based VBN O
on IN O
public JJ O
code NN O
belonging NN O
to TO O
the DT O
package NN O
praeda.muzikmekan NN B-Indicator
, , O
which WDT O
can MD O
be VB O
found VBN O
here RB O
among IN O
other JJ O
places NNS O
. . O

Just RB O
like IN O
in IN O
previous JJ O
examples NNS O
, , O
the DT O
malware NN O
author NN O
does VBZ O
not RB O
use VB O
this DT O
package NN O
. . O

Missing VBG O
permissions NNS O
The DT O
lack NN O
of IN O
the DT O
READ_FRAME_BUFFER NNP O
permission NN O
can MD O
be VB O
justified VBN O
by IN O
the DT O
removal NN O
of IN O
the DT O
screen NN O
record NN O
feature NN O
. . O

The DT O
ACCESS_SUPERUSER NNP O
may MD O
have VB O
been VBN O
removed VBN O
because IN O
it PRP O
was VBD O
deprecated VBN O
upon IN O
the DT O
release NN O
of IN O
Android NNP B-System
5.0 CD I-System
Lollipop NNP B-System
which WDT O
happened VBD O
in IN O
2014 CD O
. . O

The DT O
reality NN O
is VBZ O
that IN O
the DT O
RAT NNP O
permissions NNS O
can MD O
be VB O
implemented VBN O
just RB O
with IN O
the DT O
permissions NNS O
declared VBD O
on IN O
the DT O
manifest JJS O
, , O
thus RB O
there EX O
is VBZ O
no DT O
need NN O
for IN O
higher JJR O
permissions NNS O
. . O

Version NNP O
# # O
3 CD O
: : O
Sept. NNP O
- : O
Dec. NN O
2019 CD O
— NN O
Domain NN O
: : O
ponethus NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
Given NNP O
that IN O
there EX O
is VBZ O
some DT O
overlap NN O
in IN O
the DT O
previous JJ O
two CD O
versions NNS O
, , O
it PRP O
came VBD O
as IN O
no DT O
surprise NN O
to TO O
us PRP O
that IN O
we PRP O
finally RB O
identified VBD O
a DT O
sample NN O
which WDT O
is VBZ O
an DT O
evolution NN O
based VBN O
on IN O
both DT O
previous JJ O
versions NNS O
. . O

This DT O
sample NN O
is VBZ O
clearly RB O
a DT O
mix NN O
between IN O
the DT O
two CD O
. . O

This DT O
is VBZ O
also RB O
the DT O
first JJ O
version NN O
where WRB O
the DT O
package NN O
name NN O
changes NNS O
into IN O
something NN O
that IN O
a DT O
less JJR O
aware JJ O
user NN O
may MD O
be VB O
tricked VBN O
by IN O
, , O
com.android.playup NN B-Indicator
. . O

This DT O
version NN O
brings VBZ O
back RP O
the DT O
ACCESS_SUPERUSER NNP O
and CC O
READ_FRAME_BUFFER NNP O
permissions NNS O
. . O

However RB O
, , O
this DT O
time NN O
, , O
the DT O
permission NN O
is VBZ O
actually RB O
used VBN O
. . O

WhatsApp NNP B-System
message NN O
capture NN O
The DT O
service NN O
com.serenegiant.service.ScreenRecorderService NN B-Indicator
, , O
is VBZ O
invoked VBN O
by IN O
the DT O
ScreenRecorderActivity NNP O
. . O

Upon IN O
creation NN O
, , O
this DT O
activity NN O
launches VBZ O
a DT O
thread NN O
that WDT O
will MD O
loop VB O
on IN O
a DT O
50-second JJ O
interval NN O
. . O

In IN O
the DT O
first JJ O
iteration NN O
, , O
the DT O
screen NN O
recording NN O
is VBZ O
started VBN O
and CC O
will MD O
only RB O
stop VB O
when WRB O
the DT O
RAT NNP O
determines VBZ O
that IN O
WhatsApp NNP B-System
is VBZ O
not RB O
running VBG O
. . O

It PRP O
's VBZ O
restarted VBN O
in IN O
the DT O
next JJ O
cycle NN O
independently RB O
based VBN O
on IN O
if IN O
WhatsApp NNP B-System
is VBZ O
running VBG O
. . O

In IN O
this DT O
version NN O
, , O
the DT O
developer NN O
added VBD O
more JJR O
classes NNS O
from IN O
the DT O
same JJ O
package NN O
. . O

Even RB O
though IN O
we PRP O
could MD O
not RB O
find VB O
indications NNS O
of IN O
being VBG O
in IN O
use NN O
, , O
two CD O
stand VBP O
out RP O
. . O

Bluetooth NNP O
— NNP O
which WDT O
allows VBZ O
the DT O
interaction NN O
with IN O
the DT O
Bluetooth NNP O
interface NN O
, , O
and CC O
net/deacon NN O
— NN O
which WDT O
implements VBZ O
a DT O
beaconing NN O
system NN O
based VBN O
on IN O
UDP NNP O
. . O

Android NNP B-System
shell VBP O
A NNP O
new JJ O
package NN O
was VBD O
added VBN O
that IN O
allows VBZ O
the DT O
execution NN O
of IN O
commands NNS O
in IN O
the DT O
Android NNP B-System
shell NN O
. . O

Again RB O
, , O
this DT O
package NN O
source NN O
code NN O
is VBZ O
publicly RB O
available JJ O
and CC O
can MD O
be VB O
found VBN O
here RB O
. . O

One CD O
of IN O
the DT O
uses NNS O
the DT O
malware NN O
gives VBZ O
to TO O
this DT O
package NN O
is VBZ O
the DT O
execution NN O
of IN O
the DT O
command NN O
" NNP O
dumpsys NN O
'' '' O
to TO O
determine VB O
if IN O
certain JJ O
activities NNS O
are VBP O
running VBG O
. . O

Check VB O
if IN O
chat DT O
apps NN O
are VBP O
running VBG O
In IN O
the DT O
above JJ O
example NN O
, , O
the DT O
malware NN O
is VBZ O
searching VBG O
for IN O
Line NNP O
, , O
Facebook NNP B-System
Messenger NNP I-System
and CC O
WhatsApp NNP B-System
activities NNS O
. . O

This DT O
is VBZ O
part NN O
of IN O
a DT O
class NN O
called VBN O
CaptureService NNP O
, , O
which WDT O
already RB O
existed VBD O
in IN O
the DT O
previous JJ O
version NN O
but CC O
it PRP O
was VBD O
not RB O
duly RB O
implemented VBN O
. . O

Previous JJ O
version NN O
The DT O
capture NN O
service NN O
class NN O
implements VBZ O
the DT O
chat NN O
applications VBZ O
interception NN O
. . O

Upon IN O
creation NN O
the DT O
class NN O
will MD O
start VB O
to TO O
take VB O
screenshots NNS O
that WDT O
will MD O
be VB O
stopped VBN O
and CC O
uploaded VBN O
to TO O
the DT O
C2 NNP O
once RB O
the DT O
service NN O
ca MD O
n't RB O
find VB O
the DT O
targeted JJ O
applications NNS O
running VBG O
. . O

The DT O
core NN O
of IN O
this DT O
functionality NN O
is VBZ O
also RB O
based VBN O
on IN O
an DT O
open-source NN O
project NN O
that WDT O
can MD O
be VB O
found VBN O
here RB O
. . O

Another DT O
novelty NN O
is VBZ O
a DT O
VPN-related JJ O
package NN O
, , O
which WDT O
is VBZ O
based VBN O
on IN O
OrbotVPN NNP B-System
. . O

Once RB O
again RB O
, , O
it PRP O
does VBZ O
n't RB O
seem VB O
to TO O
actually RB O
be VB O
in IN O
use NN O
. . O

The DT O
same JJ O
happens VBZ O
with IN O
the DT O
package NN O
squareup.otto NN B-Indicator
, , O
which WDT O
is VBZ O
an DT O
open-source JJ O
bus NN O
implementation NN O
focused VBD O
on IN O
Android NNP B-System
implementation NN O
. . O

Both DT O
sources NNS O
can MD O
be VB O
found VBN O
here RB O
and CC O
here RB O
. . O

Version NNP O
# # O
4 CD O
: : O
April NNP O
2020 CD O
— NNP O
Domain NNP O
: : O
nampriknum.net NN B-Indicator
Following VBG O
the DT O
same JJ O
pattern NN O
, , O
this DT O
version NN O
has VBZ O
some DT O
added VBN O
features NNS O
and CC O
others NNS O
, , O
which WDT O
were VBD O
not RB O
in IN O
use NN O
, , O
removed VBD O
. . O

First NNP O
of IN O
all PDT O
the DT O
new JJ O
package NN O
name NN O
is VBZ O
com.google.services NNS B-Indicator
, , O
which WDT O
can MD O
easily RB O
be VB O
confused VBN O
with IN O
a DT O
legitimate JJ O
Google NNP B-Organization
service NN O
. . O

The DT O
VPN NNP O
package NN O
is VBZ O
no DT O
longer RBR O
present JJ O
, , O
further JJ O
reinforcing VBG O
our PRP$ O
conclusion NN O
that IN O
it PRP O
was VBD O
not RB O
in IN O
use NN O
. . O

WolfRAT NNP B-Malware
application NN O
screen VBD O
The DT O
Google NNP B-System
GMS NNP I-System
and CC O
Firebase NNP B-System
service NN O
has VBZ O
been VBN O
added VBN O
, , O
however RB O
, , O
no DT O
configuration NN O
has VBZ O
been VBN O
found VBN O
, , O
even RB O
though IN O
services NNS O
seem VBP O
to TO O
be VB O
referenced VBN O
in IN O
the DT O
of IN O
a DT O
new JJ O
class NN O
. . O

The DT O
new JJ O
class NN O
is VBZ O
called VBN O
NotificationListener NNP O
and CC O
extends VBZ O
the DT O
NotificationListenerService NNP O
class NN O
. . O

This DT O
would MD O
allow VB O
the DT O
RAT NNP O
to TO O
receive VB O
system NN O
notifications NNS O
. . O

Notification NN O
handling VBG O
method PDT O
The DT O
class NN O
is VBZ O
only RB O
implemented VBN O
in IN O
debug NN O
mode NN O
, , O
pushing VBG O
all DT O
captured VBN O
information NN O
into IN O
the DT O
log NN O
. . O

The DT O
usage NN O
of IN O
the DT O
PlusShare NNP B-System
API NNP O
in IN O
2020 CD O
denotes VBZ O
some DT O
unprofessional JJ O
development NN O
, , O
since IN O
this DT O
is VBZ O
the DT O
API NNP O
to TO O
access NN O
Google+ NNP B-Organization
. . O

This DT O
service NN O
, , O
along IN O
with IN O
the DT O
API NNP O
, , O
was VBD O
fully RB O
decommissioned VBN O
in IN O
March NNP O
2019 CD O
. . O

This DT O
version NN O
adds VBZ O
one CD O
significant JJ O
class NN O
— NN O
it PRP O
requests VBZ O
DEVICE_ADMIN NNP O
privileges NNS O
. . O

Device NNP O
admin NN O
policies NNS O
Looking VBG O
at IN O
the DT O
policy NN O
's POS O
definition NN O
, , O
we PRP O
can MD O
see VB O
that IN O
it PRP O
lists VBZ O
all PDT O
the DT O
available JJ O
policies NNS O
even RB O
if IN O
most JJS O
of IN O
them PRP O
are VBP O
deprecated VBN O
on IN O
Android NNP B-System
10.0 CD I-System
and CC O
their PRP$ O
usage JJ O
results NNS O
in IN O
a DT O
security NN O
exception NN O
. . O

The DT O
code NN O
implementation NN O
again RB O
seems VBZ O
that IN O
it PRP O
has VBZ O
been VBN O
added VBN O
for IN O
testing VBG O
purposes NNS O
only RB O
. . O

Versions NNS O
overview VBP O
The DT O
DenDroid NNP B-Malware
code NN O
base NN O
was VBD O
kept VBN O
to TO O
such PDT O
an DT O
extent NN O
that WDT O
even RB O
the DT O
original JJ O
base64-encoded JJ O
password NN O
was VBD O
kept VBN O
. . O

Original JJ O
password NN O
The DT O
main JJ O
service NN O
follows VBZ O
the DT O
same JJ O
structure NN O
as IN O
the DT O
first JJ O
version NN O
, , O
the DT O
anti-analysis NN O
features NNS O
are VBP O
primitive JJ O
, , O
only RB O
checking VBG O
the DT O
emulator NN O
environment NN O
without IN O
any DT O
kind NN O
of IN O
packing NN O
or CC O
obfuscation NN O
. . O

The DT O
malware NN O
will MD O
start VB O
the DT O
main JJ O
service NN O
if IN O
all PDT O
the DT O
requested VBN O
permissions NNS O
and CC O
the DT O
device NN O
admin NN O
privileges NNS O
are VBP O
granted VBN O
. . O

Otherwise RB O
, , O
it PRP O
will MD O
launch VB O
an DT O
ACTION_APPLICATION_SETTINGS NNP O
intent NN O
trying VBG O
to TO O
trick VB O
the DT O
user NN O
to TO O
grant VB O
the DT O
permissions NNS O
. . O

Each DT O
sample NN O
contains VBZ O
a DT O
userId NN O
hardcoded VBN O
, , O
meaning VBG O
that IN O
each DT O
sample NN O
can MD O
only RB O
be VB O
used VBN O
in IN O
a DT O
victim NN O
. . O

It PRP O
seems VBZ O
, , O
however RB O
, , O
if IN O
the DT O
same JJ O
victim NN O
has VBZ O
more JJR O
than IN O
one CD O
device NN O
the DT O
malware NN O
can MD O
be VB O
reused VBN O
since IN O
the DT O
IMEI NNP O
is VBZ O
sent VBN O
along IN O
with IN O
each DT O
data NN O
exfiltration NN O
. . O

It PRP O
is VBZ O
clear JJ O
that IN O
this DT O
RAT NNP O
is VBZ O
under IN O
intense JJ O
development NN O
, , O
however RB O
, , O
the DT O
addition NN O
and CC O
removal NN O
of IN O
packages NNS O
, , O
along IN O
with IN O
the DT O
huge JJ O
quantity NN O
of IN O
unused JJ O
code NN O
and CC O
usage NN O
of IN O
deprecated VBN O
and CC O
old JJ O
techniques NNS O
denotes VBZ O
an DT O
amateur NN O
development NN O
methodology NN O
. . O

CONCLUSION NN O
We PRP O
witness VBP O
actors NNS O
continually RB O
using VBG O
open-source JJ O
platforms NNS O
, , O
code NN O
and CC O
packages NNS O
to TO O
create VB O
their PRP$ O
own JJ O
software NN O
. . O

Some DT O
are VBP O
carried VBN O
out RP O
well RB O
, , O
others NNS O
, , O
like IN O
WolfRAT NNP B-Malware
, , O
are VBP O
designed VBN O
with IN O
an DT O
overload NN O
of IN O
functionality NN O
in IN O
mind NN O
as IN O
opposed VBN O
to TO O
factoring VBG O
any DT O
sensible JJ O
approach NN O
to TO O
the DT O
development NN O
aspect NN O
. . O

After IN O
all DT O
, , O
a DT O
working JJ O
product NN O
is VBZ O
often RB O
more RBR O
important JJ O
than IN O
a DT O
stable JJ O
product NN O
. . O

We PRP O
watched VBD O
WolfRAT NNP B-Malware
evolve CC O
through IN O
various JJ O
iterations NNS O
which WDT O
shows VBZ O
that IN O
the DT O
actor NN O
wanted VBD O
to TO O
ensure VB O
functional JJ O
improvements NNS O
— VBP O
perhaps RB O
they PRP O
had VBD O
deadlines NNS O
to TO O
meet VB O
for IN O
their PRP$ O
customers NNS O
, , O
but CC O
with IN O
no DT O
thought NN O
given VBN O
to TO O
removing VBG O
old JJ O
code NN O
blocks NNS O
, , O
classes NNS O
, , O
etc FW O
. . O

throughout IN O
the DT O
Android NNP B-System
package NN O
. . O

WolfRAT NNP B-Malware
is VBZ O
a DT O
specifically RB O
targeted VBN O
RAT NNP O
which WDT O
we PRP O
assess VBP O
to TO O
be VB O
aimed VBN O
at IN O
Thai NNP O
individuals NNS O
and CC O
, , O
based VBN O
on IN O
previous JJ O
work NN O
from IN O
Wolf NNP B-Organization
Research NNP I-Organization
, , I-Organization
most JJS O
likely RB O
used VBN O
as IN O
an DT O
intelligence-gathering JJ O
tool NN O
or CC O
interception NN O
tool NN O
. . O

This DT O
can MD O
be VB O
packaged VBN O
and CC O
" PRP O
sold VBD O
'' '' O
in IN O
many JJ O
different JJ O
ways NNS O
to TO O
customers NNS O
. . O

A DT O
" JJ O
Tracking NNP O
tool NN O
'' '' O
or CC O
an DT O
" JJ O
Admin NNP O
tool NN O
'' '' O
are VBP O
often RB O
cited VBN O
for IN O
these DT O
kinds NNS O
of IN O
tools NNS O
for IN O
" JJ O
commercial JJ O
'' '' O
or CC O
" VB O
enterprise NN O
'' '' O
usage NN O
. . O

Wolf NNP I-Malware
Research NNP I-Organization
claimed VBD O
to TO O
shut VB O
down RP O
their PRP$ O
operations NNS O
but CC O
we PRP O
clearly RB O
see VBP O
that IN O
their PRP$ O
previous JJ O
work NN O
continues VBZ O
under IN O
another DT O
guise NN O
. . O

The DT O
ability NN O
to TO O
carry VB O
out RP O
these DT O
types NNS O
of IN O
intelligence-gathering JJ O
activities NNS O
on IN O
phones NNS O
represents VBZ O
a DT O
huge JJ O
score NN O
for IN O
the DT O
operator NN O
. . O

The DT O
chat NN O
details NNS O
, , O
WhatsApp NNP B-System
records NNS O
, , O
messengers NNS O
and CC O
SMSs NNP O
of IN O
the DT O
world NN O
carry VBP O
some DT O
sensitive JJ O
information NN O
which WDT O
people NNS O
often RB O
forget VBP O
when WRB O
communicating VBG O
with IN O
their PRP$ O
devices NNS O
. . O

We PRP O
see VBP O
WolfRAT NNP B-Malware
specifically RB O
targeting VBG O
a DT O
highly RB O
popular JJ O
encrypted VBD O
chat WP O
app NN O
in IN O
Asia NNP O
, , O
Line NNP B-System
, , O
which WDT O
suggests VBZ O
that IN O
even RB O
a DT O
careful JJ O
user NN O
with IN O
some DT O
awareness NN O
around IN O
end-to-end JJ O
encryption NN O
chats NNS O
would MD O
still RB O
be VB O
at IN O
the DT O
mercy NN O
of IN O
WolfRAT NNP B-Malware
and CC O
it PRP O
's VBZ O
prying VBG O
eyes NNS O
. . O

IOCS NNP O
Hashes NNP O
139edb1bc033725539b117f50786f3d3362ed45845c57fe1f82e7ed72b044367 CD B-Indicator
e19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1 NN B-Indicator
e19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1 NN B-Indicator
e5f346d8f312cc1f93c2c6af611e2f50805c528934786ea173cabc6a39b14cda NN B-Indicator

1849a50a6ac9b3eec51492745eeb14765fe2e78488d476b0336d8e41c2c581d4 CD B-Indicator
d328fca14c4340fcd4a15e47562a436085e6b1bb5376b5ebd83d3e7218db64e7 JJ B-Indicator
59b9809dba857c5969f23f460a2bf0a337a71622a79671066675ec0acf89c810 CD B-Indicator
120474682ea439eb0b28274c495d9610a73d892a4b8feeff268c670570db97e2 CD B-Indicator

ed234e61849dcb95223676abe2312e1378d6130c0b00851d82cda545b946ec83 RB B-Indicator
27410d4019251a70d38f0635277f931fb73f67ac9f2e1f3b475ce680ebfde12a CD B-Indicator
6e6c210535b414c5aa2dd9e67f5153feeb43a8ac8126d8e249e768f501323a3e CD B-Indicator
4a32ced20df7001da7d29edc31ca76e13eef0c9b355f62c44888853435e9794f CD B-Indicator

ac5abaebd9f516b8b389450f7d27649801d746fb14963b848f9d6dad0a505e66 RB B-Indicator
3a45d7a16937d4108b5b48f44d72bb319be645cbe15f003dc9e77fd52f45c065 CD B-Indicator
Domains NNS O
cvcws JJ B-Indicator
[ NNP I-Indicator
. . I-Indicator

] JJ I-Indicator
ponethus NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
svc NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
ponethus NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
www NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
ponethus NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
webmail NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
ponethus NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
com NN I-Indicator
nampriknum NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
www NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
nampriknum NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
svc NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
nampriknum NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
svcws NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
nampriknum NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
net JJ I-Indicator
svc NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
somtum NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
svcws VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
somtum NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
www VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
somtum NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
somtum VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
shop NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
databit NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
svc VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
databit NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
test NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
databit NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
www VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
databit NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
admin VBP B-Indicator
[ JJ I-Indicator
.databit NNP I-Indicator
[ NNP I-Indicator
.today NNP I-Indicator
cendata VBD B-Indicator
[ NNP I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
svc VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
cendata NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
svcws VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
cendata NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
www VBP B-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
cendata NN I-Indicator
[ NN I-Indicator
. . I-Indicator

] NN I-Indicator
today NN I-Indicator
PHA NNP O
Family NNP O
Highlights NNP O
: : O
Zen NNP B-Malware
and CC O
its PRP$ O
cousins NNS O
January NNP O
11 CD O
, , O
2019 CD O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
detects VBZ O
Potentially RB O
Harmful JJ O
Applications NNS O
( ( O
PHAs NNP O
) ) O
which WDT O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
defines VBZ O
as IN O
any DT O
mobile JJ O
app NN O
that WDT O
poses VBZ O
a DT O
potential JJ O
security NN O
risk NN O
to TO O
users NNS O
or CC O
to TO O
user VB O
data—commonly RB O
referred VBN O
to TO O
as IN O
" NNP O
malware NN O
. . O

'' '' O
in IN O
a DT O
variety NN O
of IN O
ways NNS O
, , O
such JJ O
as IN O
static JJ O
analysis NN O
, , O
dynamic JJ O
analysis NN O
, , O
and CC O
machine NN O
learning NN O
. . O

While IN O
our PRP$ O
systems NNS O
are VBP O
great JJ O
at IN O
automatically RB O
detecting VBG O
and CC O
protecting VBG O
against IN O
PHAs NNP O
, , O
we PRP O
believe VBP O
the DT O
best JJS O
security NN O
comes VBZ O
from IN O
the DT O
combination NN O
of IN O
automated JJ O
scanning NN O
and CC O
skilled VBD O
human JJ O
review NN O
. . O

With IN O
this DT O
blog NN O
series NN O
we PRP O
will MD O
be VB O
sharing VBG O
our PRP$ O
research NN O
analysis NN O
with IN O
the DT O
research NN O
and CC O
broader JJR O
security NN O
community NN O
, , O
starting VBG O
with IN O
the DT O
PHA NNP O
family NN O
, , O
Zen NNP B-Malware
. . O

Zen NNP B-Malware
uses VBZ O
root JJ O
permissions NNS O
on IN O
a DT O
device NN O
to TO O
automatically RB O
enable VB O
a DT O
service NN O
that WDT O
creates VBZ O
fake VBP O
Google NNP B-Organization
accounts NNS O
. . O

These DT O
accounts NNS O
are VBP O
created VBN O
by IN O
abusing VBG O
accessibility NN O
services NNS O
. . O

Zen NNP B-Malware
apps NN O
gain NN O
access NN O
to TO O
root VB O
permissions NNS O
from IN O
a DT O
rooting VBG O
trojan NN O
in IN O
its PRP$ O
infection NN O
chain NN O
. . O

In IN O
this DT O
blog NN O
post NN O
, , O
we PRP O
do VBP O
not RB O
differentiate VB O
between IN O
the DT O
rooting VBG O
component NN O
and CC O
the DT O
component NN O
that WDT O
abuses VBZ O
root NN O
: : O
we PRP O
refer VBP O
to TO O
them PRP O
interchangeably RB O
as IN O
Zen NNP B-Malware
. . O

We PRP O
also RB O
describe VBP O
apps NNS O
that IN O
we PRP O
think VBP O
are VBP O
coming VBG O
from IN O
the DT O
same JJ O
author NN O
or CC O
a DT O
group NN O
of IN O
authors NNS O
. . O

All DT O
of IN O
the DT O
PHAs NNP O
that WDT O
are VBP O
mentioned VBN O
in IN O
this DT O
blog NN O
post NN O
were VBD O
detected VBN O
and CC O
removed VBN O
by IN O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
. . O

Background IN O
Uncovering NNP O
PHAs NNP O
takes VBZ O
a DT O
lot NN O
of IN O
detective JJ O
work NN O
and CC O
unraveling VBG O
the DT O
mystery NN O
of IN O
how WRB O
they PRP O
're VBP O
possibly RB O
connected VBN O
to TO O
other JJ O
apps NN O
takes VBZ O
even RB O
more RBR O
. . O

PHA NNP O
authors NNS O
usually RB O
try VBP O
to TO O
hide VB O
their PRP$ O
tracks NNS O
, , O
so IN O
attribution NN O
is VBZ O
difficult JJ O
. . O

Sometimes RB O
, , O
we PRP O
can MD O
attribute VB O
different JJ O
apps NN O
to TO O
the DT O
same JJ O
author NN O
based VBN O
on IN O
a DT O
small JJ O
, , O
unique JJ O
pieces NNS O
of IN O
evidence NN O
that IN O
suggest JJS O
similarity NN O
, , O
such JJ O
as IN O
a DT O
repetition NN O
of IN O
an DT O
exceptionally RB O
rare JJ O
code NN O
snippet NN O
, , O
asset NN O
, , O
or CC O
a DT O
particular JJ O
string NN O
in IN O
the DT O
debug NN O
logs NNS O
. . O

Every DT O
once RB O
in IN O
a DT O
while NN O
, , O
authors NNS O
leave VBP O
behind IN O
a DT O
trace NN O
that WDT O
allows VBZ O
us PRP O
to TO O
attribute VB O
not RB O
only RB O
similar JJ O
apps NN O
, , O
but CC O
also RB O
multiple JJ O
different JJ O
PHA NNP O
families NNS O
to TO O
the DT O
same JJ O
group NN O
or CC O
person NN O
. . O

However RB O
, , O
the DT O
actual JJ O
timeline NN O
of IN O
the DT O
creation NN O
of IN O
different JJ O
variants NNS O
is VBZ O
unclear JJ O
. . O

In IN O
April NNP O
2013 CD O
, , O
we PRP O
saw VBD O
the DT O
first JJ O
sample NN O
, , O
which WDT O
made VBD O
heavy JJ O
use NN O
of IN O
dynamic JJ O
code NN O
loading NN O
( ( O
i.e. FW O
, , O
fetching VBG O
executable JJ O
code NN O
from IN O
remote JJ O
sources NNS O
after IN O
the DT O
initial JJ O
app NN O
is VBZ O
installed VBN O
) ) O
. . O

Dynamic NNP O
code NN O
loading VBG O
makes VBZ O
it PRP O
impossible JJ O
to TO O
state NN O
what WP O
kind NN O
of IN O
PHA NNP O
it PRP O
was VBD O
. . O

This DT O
sample JJ O
displayed JJ O
ads NNS O
from IN O
various JJ O
sources NNS O
. . O

More RBR O
recent JJ O
variants NNS O
blend VBP O
rooting VBG O
capabilities NNS O
and CC O
click NN O
fraud NN O
. . O

As IN O
rooting VBG O
exploits NNS O
on IN O
Android NNP B-System
become NN O
less CC O
prevalent JJ O
and CC O
lucrative JJ O
, , O
PHA NNP O
authors NNS O
adapt VBP O
their PRP$ O
abuse NN O
or CC O
monetization NN O
strategy NN O
to TO O
focus VB O
on IN O
tactics NNS O
like IN O
click NN O
fraud NN O
. . O

This DT O
post NN O
does VBZ O
n't RB O
follow VB O
the DT O
chronological JJ O
evolution NN O
of IN O
Zen NNP B-Malware
, , O
but CC O
instead RB O
covers NNS O
relevant VBP O
samples NNS O
from IN O
least JJS O
to TO O
most RBS O
complex JJ O
. . O

Apps NNP O
with IN O
a DT O
custom-made JJ O
advertisement NN O
SDK NNP O
The DT O
simplest JJS O
PHA NN O
from IN O
the DT O
author NN O
's POS O
portfolio NN O
used VBD O
a DT O
specially RB O
crafted VBN O
advertisement NN O
SDK NNP O
to TO O
create VB O
a DT O
proxy NN O
for IN O
all DT O
ads-related JJ O
network NN O
traffic NN O
. . O

By IN O
proxying VBG O
all DT O
requests NNS O
through IN O
a DT O
custom NN O
server NN O
, , O
the DT O
real JJ O
source NN O
of IN O
ads NNS O
is VBZ O
opaque JJ O
. . O

This DT O
example NN O
shows VBZ O
one CD O
possible JJ O
implementation NN O
of IN O
this DT O
technique NN O
. . O

This DT O
approach NN O
allows VBZ O
the DT O
authors NNS O
to TO O
combine VB O
ads NNS O
from IN O
third-party JJ O
advertising NN O
networks NNS O
with IN O
ads NNS O
they PRP O
created VBD O
for IN O
their PRP$ O
own JJ O
apps NN O
. . O

It PRP O
may MD O
even RB O
allow VB O
them PRP O
to TO O
sell VB O
ad NN O
space NN O
directly RB O
to TO O
application NN O
developers NNS O
. . O

The DT O
advertisement NN O
SDK NNP O
also RB O
collects VBZ O
statistics NNS O
about IN O
clicks NNS O
and CC O
impressions NNS O
to TO O
make VB O
it PRP O
easier JJR O
to TO O
track VB O
revenue NN O
. . O

Selling VBG O
the DT O
ad NN O
traffic NN O
directly RB O
or CC O
displaying VBG O
ads NNS O
from IN O
other JJ O
sources NNS O
in IN O
a DT O
very RB O
large JJ O
volume NN O
can MD O
provide VB O
direct JJ O
profit NN O
to TO O
the DT O
app NN O
author NN O
from IN O
the DT O
advertisers NNS O
. . O

We PRP O
have VBP O
seen VBN O
two CD O
types NNS O
of IN O
apps NN O
that WDT O
use VBP O
this DT O
custom-made JJ O
SDK NNP O
. . O

The DT O
first JJ O
are VBP O
games NNS O
of IN O
very RB O
low JJ O
quality NN O
that WDT O
mimic VBZ O
the DT O
experience NN O
of IN O
popular JJ O
mobile JJ O
games NNS O
. . O

While IN O
the DT O
counterfeit JJ O
games NNS O
claim VBP O
to TO O
provide VB O
similar JJ O
functionality NN O
to TO O
the DT O
popular JJ O
apps NN O
, , O
they PRP O
are VBP O
simply RB O
used VBN O
to TO O
display VB O
ads NNS O
through IN O
a DT O
custom JJ O
advertisement NN O
SDK NNP O
. . O

The DT O
second JJ O
type NN O
of IN O
apps NN O
reveals NNS O
an DT O
evolution NN O
in IN O
the DT O
author NN O
's POS O
tactics NNS O
. . O

Instead RB O
of IN O
implementing VBG O
very RB O
basic JJ O
gameplay NN O
, , O
the DT O
authors NNS O
pirated VBD O
and CC O
repackaged VBD O
the DT O
original JJ O
game NN O
in IN O
their PRP$ O
app NN O
and CC O
bundled VBN O
with IN O
it PRP O
their PRP$ O
advertisement JJ O
SDK NNP O
. . O

The DT O
only JJ O
noticeable JJ O
difference NN O
is VBZ O
the DT O
game NN O
has VBZ O
more JJR O
ads NNS O
, , O
including VBG O
ads NNS O
on IN O
the DT O
very RB O
first JJ O
screen NN O
. . O

In IN O
all DT O
cases NNS O
, , O
the DT O
ads NNS O
are VBP O
used VBN O
to TO O
convince VB O
users NNS O
to TO O
install VB O
other JJ O
apps NN O
from IN O
different JJ O
developer NN O
accounts NNS O
, , O
but CC O
written VBN O
by IN O
the DT O
same JJ O
group NN O
. . O

Those DT O
apps JJ O
use VBP O
the DT O
same JJ O
techniques NNS O
to TO O
monetize VB O
their PRP$ O
actions NNS O
. . O

Click NNP O
fraud NN O
apps VBZ O
The DT O
authors NNS O
' POS O
tactics NNS O
evolved VBD O
from IN O
advertisement JJ O
spam NN O
to TO O
real JJ O
PHA NNP O
( ( O
Click NNP O
Fraud NNP O
) ) O
. . O

Click NNP O
fraud NN O
PHAs NNP O
simulate NN O
user NN O
clicks NNS O
on IN O
ads NNS O
instead RB O
of IN O
simply RB O
displaying VBG O
ads NNS O
and CC O
waiting VBG O
for IN O
users NNS O
to TO O
click VB O
them PRP O
. . O

This DT O
allows VBZ O
the DT O
PHA NNP O
authors NNS O
to TO O
monetize VB O
their PRP$ O
apps NN O
more RBR O
effectively RB O
than IN O
through IN O
regular JJ O
advertising NN O
. . O

This DT O
behavior NN O
negatively RB O
impacts VBZ O
advertisement JJ O
networks NNS O
and CC O
their PRP$ O
clients NNS O
because IN O
advertising NN O
budget NN O
is VBZ O
spent VBN O
without IN O
acquiring VBG O
real JJ O
customers NNS O
, , O
and CC O
impacts NNS O
user JJ O
experience NN O
by IN O
consuming VBG O
their PRP$ O
data NNS O
plan NN O
resources NNS O
. . O

The DT O
click NN O
fraud NN O
PHA NNP O
requests VBZ O
a DT O
URL NNP O
to TO O
the DT O
advertising NN O
network NN O
directly RB O
instead RB O
of IN O
proxying VBG O
it PRP O
through IN O
an DT O
additional JJ O
SDK NNP O
. . O

The DT O
command NN O
& CC O
control NN O
server NN O
( ( O
C NNP O
& CC O
C NNP O
server NN O
) ) O
returns VBZ O
the DT O
URL NNP O
to TO O
click VB O
along RP O
with IN O
a DT O
very RB O
long JJ O
list NN O
of IN O
additional JJ O
parameters NNS O
in IN O
JSON NNP O
format NN O
. . O

After IN O
rendering VBG O
the DT O
ad NN O
on IN O
the DT O
screen NN O
, , O
the DT O
app NN O
tries VBZ O
to TO O
identify VB O
the DT O
part NN O
of IN O
the DT O
advertisement NN O
website NN O
to TO O
click VB O
. . O

If IN O
that DT O
part NN O
is VBZ O
found VBN O
, , O
the DT O
app NN O
loads VBZ O
Javascript NNP O
snippets NNS O
from IN O
the DT O
JSON NNP O
parameters NNS O
to TO O
click VB O
a DT O
button NN O
or CC O
other JJ O
HTML NNP O
element NN O
, , O
simulating VBG O
a DT O
real JJ O
user NN O
click NN O
. . O

Because IN O
a DT O
user NN O
interacting VBG O
with IN O
an DT O
ad NN O
often RB O
leads VBZ O
to TO O
a DT O
higher JJR O
chance NN O
of IN O
the DT O
user NN O
purchasing VBG O
something NN O
, , O
ad NN O
networks NNS O
often RB O
" JJ O
pay NN O
per IN O
click NN O
'' '' O
to TO O
developers NNS O
who WP O
host VBP O
their PRP$ O
ads NNS O
. . O

Therefore RB O
, , O
by IN O
simulating VBG O
fraudulent JJ O
clicks NNS O
, , O
these DT O
developers NNS O
are VBP O
making VBG O
money NN O
without IN O
requiring VBG O
a DT O
user NN O
to TO O
click VB O
on IN O
an DT O
advertisement NN O
. . O

This DT O
example NN O
code NN O
shows VBZ O
a DT O
JSON NNP O
reply NN O
returned VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

It PRP O
has VBZ O
been VBN O
shortened VBN O
for IN O
brevity NN O
. . O

Based VBN O
on IN O
this DT O
JSON NNP O
reply NN O
, , O
the DT O
app NN O
looks VBZ O
for IN O
an DT O
HTML NNP O
snippet NN O
that WDT O
corresponds VBZ O
to TO O
the DT O
active JJ O
element NN O
( ( O
show_hide JJ O
btnnext NN O
) ) O
and CC O
, , O
if IN O
found VBN O
, , O
the DT O
Javascript NNP O
snippet NN O
tries NNS O
to TO O
perform VB O
a DT O
click NN O
( ( O
) ) O
method NN O
on IN O
it PRP O
. . O

Rooting VBG O
trojans VBZ O
The DT O
Zen NNP B-Malware
authors NNS O
have VBP O
also RB O
created VBN O
a DT O
rooting VBG O
trojan NN O
. . O

Using VBG O
a DT O
publicly RB O
available JJ O
rooting VBG O
framework NN O
, , O
the DT O
PHA NNP O
attempts NNS O
to TO O
root VB O
devices NNS O
and CC O
gain NN O
persistence NN O
on IN O
them PRP O
by IN O
reinstalling VBG O
itself PRP O
on IN O
the DT O
system NN O
partition NN O
of IN O
rooted JJ O
device NN O
. . O

Installing VBG O
apps NN O
on IN O
the DT O
system NN O
partition NN O
makes VBZ O
it PRP O
harder JJR O
for IN O
the DT O
user NN O
to TO O
remove VB O
the DT O
app NN O
. . O

This DT O
technique NN O
only RB O
works VBZ O
for IN O
unpatched JJ O
devices NNS O
running VBG O
Android NNP B-System
4.3 CD I-System
or CC O
lower JJR O
. . O

Devices NNS O
running VBG O
Android NNP B-System
4.4 CD I-System
and CC O
higher JJR O
are VBP O
protected VBN O
by IN O
Verified NNP O
Boot NNP O
. . O

Zen NNP B-Malware
's POS O
rooting VBG O
trojan JJ O
apps NN O
target NN O
a DT O
specific JJ O
device NN O
model NN O
with IN O
a DT O
very RB O
specific JJ O
system NN O
image NN O
. . O

After IN O
achieving VBG O
root JJ O
access NN O
the DT O
app NN O
tries VBZ O
to TO O
replace VB O
the DT O
framework.jar NN B-Indicator
file NN O
on IN O
the DT O
system NN O
partition NN O
. . O

Replicating VBG O
framework.jar NN B-Indicator
allows VBZ O
the DT O
app NN O
to TO O
intercept VB O
and CC O
modify VB O
the DT O
behavior NN O
of IN O
the DT O
Android NNP B-System
standard NN O
API NNP O
. . O

In IN O
particular JJ O
, , O
these DT O
apps NNS O
try VBP O
to TO O
add VB O
an DT O
additional JJ O
method NN O
called VBN O
statistics NNS O
( ( O
) ) O
into IN O
the DT O
Activity NNP O
class NN O
. . O

When WRB O
inserted VBN O
, , O
this DT O
method NN O
runs VBZ O
every DT O
time NN O
any DT O
Activity NNP O
object VBP O
in IN O
any DT O
Android NNP O
app NN O
is VBZ O
created VBN O
. . O

This DT O
happens VBZ O
all PDT O
the DT O
time NN O
in IN O
regular JJ O
Android NNP B-System
apps NN O
, , O
as IN O
Activity NNP O
is VBZ O
one CD O
of IN O
the DT O
fundamental JJ O
Android NNP B-System
UI NNP O
elements NNS O
. . O

The DT O
only JJ O
purpose NN O
of IN O
this DT O
method NN O
is VBZ O
to TO O
connect VB O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

The DT O
Zen NNP B-Malware
trojan NN O
After IN O
achieving VBG O
persistence NN O
, , O
the DT O
trojan NN O
downloads VBZ O
additional JJ O
payloads NNS O
, , O
including VBG O
another DT O
trojan NN O
called VBN O
Zen NNP B-Malware
. . O

Zen NNP B-Malware
requires VBZ O
root NN O
to TO O
work VB O
correctly RB O
on IN O
the DT O
Android NNP B-System
operating NN O
system NN O
. . O

The DT O
Zen NNP B-Malware
trojan NN O
uses VBZ O
its PRP$ O
root NN O
privileges NNS O
to TO O
turn VB O
on IN O
accessibility NN O
service NN O
( ( O
a DT O
service NN O
used VBN O
to TO O
allow VB O
Android NNP B-System
users NNS O
with IN O
disabilities NNS O
to TO O
use VB O
their PRP$ O
devices NNS O
) ) O
for IN O
itself PRP O
by IN O
writing VBG O
to TO O
a DT O
system-wide JJ O
setting NN O
value NN O
enabled_accessibility_services NNS O
. . O

Zen NNP B-Malware
does VBZ O
n't RB O
even RB O
check VB O
for IN O
the DT O
root NN O
privilege NN O
: : O
it PRP O
just RB O
assumes VBZ O
it PRP O
has VBZ O
it PRP O
. . O

This DT O
leads VBZ O
us PRP O
to TO O
believe VB O
that DT O
Zen NNP B-Malware
is VBZ O
just RB O
part NN O
of IN O
a DT O
larger JJR O
infection NN O
chain NN O
. . O

The DT O
trojan NN O
implements NNS O
three CD O
accessibility NN O
services NNS O
directed VBN O
at IN O
different JJ O
Android NNP B-System
API NNP I-System
levels NNS O
and CC O
uses VBZ O
these DT O
accessibility NN O
services NNS O
, , O
chosen VBN O
by IN O
checking VBG O
the DT O
operating NN O
system NN O
version NN O
, , O
to TO O
create VB O
new JJ O
Google NNP B-Organization
accounts NNS O
. . O

This DT O
is VBZ O
done VBN O
by IN O
opening VBG O
the DT O
Google NNP B-Organization
account NN O
creation NN O
process NN O
and CC O
parsing VBG O
the DT O
current JJ O
view NN O
. . O

The DT O
app NN O
then RB O
clicks VBZ O
the DT O
appropriate JJ O
buttons NNS O
, , O
scrollbars NNS O
, , O
and CC O
other JJ O
UI NNP O
elements NNS O
to TO O
go VB O
through IN O
account NN O
sign-up NN O
without IN O
user JJ O
intervention NN O
. . O

During IN O
the DT O
account NN O
sign-up JJ O
process NN O
, , O
Google NNP B-Organization
may MD O
flag VB O
the DT O
account NN O
creation NN O
attempt NN O
as IN O
suspicious JJ O
and CC O
prompt VB O
the DT O
app NN O
to TO O
solve VB O
a DT O
CAPTCHA NNP O
. . O

To TO O
get VB O
around IN O
this DT O
, , O
the DT O
app NN O
then RB O
uses VBZ O
its PRP$ O
root NN O
privilege NN O
to TO O
inject VB O
code NN O
into IN O
the DT O
Setup NNP O
Wizard NNP O
, , O
extract VB O
the DT O
CAPTCHA NNP O
image NN O
, , O
and CC O
sends VBZ O
it PRP O
to TO O
a DT O
remote JJ O
server NN O
to TO O
try VB O
to TO O
solve VB O
the DT O
CAPTCHA NNP O
. . O

It PRP O
is VBZ O
unclear JJ O
if IN O
the DT O
remote JJ O
server NN O
is VBZ O
capable JJ O
of IN O
solving VBG O
the DT O
CAPTCHA NNP O
image NN O
automatically RB O
or CC O
if IN O
this DT O
is VBZ O
done VBN O
manually RB O
by IN O
a DT O
human JJ O
in IN O
the DT O
background NN O
. . O

After IN O
the DT O
server NN O
returns VBZ O
the DT O
solution NN O
, , O
the DT O
app NN O
enters VBZ O
it PRP O
into IN O
the DT O
appropriate JJ O
text JJ O
field NN O
to TO O
complete VB O
the DT O
CAPTCHA NNP O
challenge NN O
. . O

The DT O
Zen NNP B-Malware
trojan NN O
does VBZ O
not RB O
implement VB O
any DT O
kind NN O
of IN O
obfuscation NN O
except IN O
for IN O
one CD O
string NN O
that WDT O
is VBZ O
encoded VBN O
using VBG O
Base64 NNP O
encoding NN O
. . O

It PRP O
's VBZ O
one CD O
of IN O
the DT O
strings NNS O
- : O
" VB O
How WRB O
you PRP O
'll MD O
sign VB O
in IN O
'' '' O
- : O
that IN O
it PRP O
looks VBZ O
for IN O
during IN O
the DT O
account NN O
creation NN O
process NN O
. . O

The DT O
code NN O
snippet NN O
below IN O
shows NNS O
part NN O
of IN O
the DT O
screen NN O
parsing VBG O
process NN O
. . O

Apart RB O
from IN O
injecting VBG O
code NN O
to TO O
read VB O
the DT O
CAPTCHA NNP O
, , O
the DT O
app NN O
also RB O
injects VBZ O
its PRP$ O
own JJ O
code NN O
into IN O
the DT O
system_server NN O
process NN O
, , O
which WDT O
requires VBZ O
root NN O
privileges NNS O
. . O

This DT O
indicates VBZ O
that IN O
the DT O
app NN O
tries VBZ O
to TO O
hide VB O
itself PRP O
from IN O
any DT O
anti-PHA JJ O
systems NNS O
that WDT O
look VBP O
for IN O
a DT O
specific JJ O
app NN O
process NN O
name NN O
or CC O
does VBZ O
not RB O
have VB O
the DT O
ability NN O
to TO O
scan VB O
the DT O
memory NN O
of IN O
the DT O
system_server NN O
process NN O
. . O

The DT O
app NN O
also RB O
creates VBZ O
hooks NNS O
to TO O
prevent VB O
the DT O
phone NN O
from IN O
rebooting VBG O
, , O
going VBG O
to TO O
sleep VB O
or CC O
allowing VBG O
the DT O
user NN O
from IN O
pressing VBG O
hardware NN O
buttons NNS O
during IN O
the DT O
account NN O
creation NN O
process NN O
. . O

These DT O
hooks NNS O
are VBP O
created VBN O
using VBG O
the DT O
root NN O
access NN O
and CC O
a DT O
custom NN O
native JJ O
code NN O
called VBN O
Lmt_INJECT NNP O
, , O
although IN O
the DT O
algorithm NN O
for IN O
this DT O
is VBZ O
well RB O
known VBN O
. . O

First RB O
, , O
the DT O
app NN O
has VBZ O
to TO O
turn VB O
off RP O
SELinux NNP B-System
protection NN O
. . O

Then RB O
the DT O
app NN O
finds VBZ O
a DT O
process NN O
id NN O
value NN O
for IN O
the DT O
process NN O
it PRP O
wants VBZ O
to TO O
inject VB O
with IN O
code NN O
. . O

This DT O
is VBZ O
done VBN O
using VBG O
a DT O
series NN O
of IN O
syscalls NNS O
as IN O
outlined VBN O
below IN O
. . O

The DT O
" NNP O
source NN O
process NN O
'' '' O
refers NNS O
to TO O
the DT O
Zen NNP B-Malware
trojan NN O
running VBG O
as IN O
root NN O
, , O
while IN O
the DT O
" NNP O
target NN O
process NN O
'' '' O
refers NNS O
to TO O
the DT O
process NN O
to TO O
which WDT O
the DT O
code NN O
is VBZ O
injected VBN O
and CC O
[ NNP O
pid VBP O
] JJ O
refers NNS O
to TO O
the DT O
target NN O
process NN O
pid JJ O
value NN O
. . O

The DT O
source NN O
process NN O
checks VBZ O
the DT O
mapping NN O
between IN O
a DT O
process NN O
id NN O
and CC O
a DT O
process NN O
name NN O
. . O

This DT O
is VBZ O
done VBN O
by IN O
reading VBG O
the DT O
/proc/ NNP B-Indicator
[ NNP I-Indicator
pid JJ I-Indicator
] NNP I-Indicator
/cmdline NNP I-Indicator
file NN O
. . O

This DT O
very RB O
first JJ O
step NN O
fails VBZ O
in IN O
Android NNP B-System
7.0 CD I-System
and CC O
higher JJR O
, , O
even RB O
with IN O
a DT O
root NN O
permission NN O
. . O

The DT O
/proc NNP B-Indicator
filesystem NN O
is VBZ O
now RB O
mounted VBN O
with IN O
a DT O
hidepid=2 NN O
parameter NN O
, , O
which WDT O
means VBZ O
that IN O
the DT O
process NN O
can MD O
not RB O
access NN O
other JJ O
process NN O
/proc/ NNP B-Indicator
[ NNP I-Indicator
pid JJ I-Indicator
] NNP I-Indicator
directory NN O
. . O

A DT O
ptrace_attach NN O
syscall NN O
is VBZ O
called VBN O
. . O

This DT O
allows VBZ O
the DT O
source NN O
process NN O
to TO O
trace VB O
the DT O
target NN O
. . O

The DT O
source NN O
process NN O
looks VBZ O
at IN O
its PRP$ O
own JJ O
memory NN O
to TO O
calculate VB O
the DT O
offset NN O
between IN O
the DT O
beginning NN O
of IN O
the DT O
libc JJ O
library NN O
and CC O
the DT O
mmap NN O
address NN O
. . O

The DT O
source NN O
process NN O
reads VBZ O
/proc/ NNP B-Indicator
[ NNP I-Indicator
pid JJ I-Indicator
] NNP I-Indicator
/maps NNS I-Indicator
to TO O
find VB O
where WRB O
libc NN O
is VBZ O
located VBN O
in IN O
the DT O
target NN O
process NN O
memory NN O
. . O

By IN O
adding VBG O
the DT O
previously RB O
calculated VBN O
offset NN O
, , O
it PRP O
can MD O
get VB O
the DT O
address NN O
of IN O
the DT O
mmap NN O
function NN O
in IN O
the DT O
target NN O
process NN O
memory NN O
. . O

The DT O
source NN O
process NN O
tries NNS O
to TO O
determine VB O
the DT O
location NN O
of IN O
dlopen NN O
, , O
dlsym NN O
, , O
and CC O
dlclose JJ O
functions NNS O
in IN O
the DT O
target NN O
process NN O
. . O

It PRP O
uses VBZ O
the DT O
same JJ O
technique NN O
as IN O
it PRP O
used VBD O
to TO O
determine VB O
the DT O
offset NN O
to TO O
the DT O
mmap NN O
function NN O
. . O

The DT O
source NN O
process NN O
writes VBZ O
the DT O
native JJ O
shellcode NN O
into IN O
the DT O
memory NN O
region NN O
allocated VBN O
by IN O
mmap NN O
. . O

Additionally RB O
, , O
it PRP O
also RB O
writes VBZ O
addresses NNS O
of IN O
dlopen NN O
, , O
dlsym NN O
, , O
and CC O
dlclose VB O
into IN O
the DT O
same JJ O
region NN O
, , O
so IN O
that IN O
they PRP O
can MD O
be VB O
used VBN O
by IN O
the DT O
shellcode NN O
. . O

Shellcode NNP O
simply RB O
uses VBZ O
dlopen JJ O
to TO O
open VB O
a DT O
.so NN O
file NN O
within IN O
the DT O
target NN O
process NN O
and CC O
then RB O
dlsym VB O
to TO O
find VB O
a DT O
symbol NN B-Organization
in IN O
that DT O
file NN O
and CC O
run VB O
it PRP O
. . O

The DT O
source NN O
process NN O
changes VBZ O
the DT O
registers NNS O
in IN O
the DT O
target NN O
process NN O
so IN O
that DT O
PC NN O
register NN O
points NNS O
directly RB O
to TO O
the DT O
shellcode NN O
. . O

This DT O
is VBZ O
done VBN O
using VBG O
the DT O
ptrace NN O
syscall NN O
. . O

This DT O
diagram NN O
illustrates VBZ O
the DT O
whole JJ O
process NN O
. . O

Summary JJ O
PHA NNP O
authors NNS O
go VBP O
to TO O
great JJ O
lengths NNS O
to TO O
come VB O
up RP O
with IN O
increasingly RB O
clever JJ O
ways NNS O
to TO O
monetize VB O
their PRP$ O
apps NN O
. . O

Zen NNP B-Malware
family NN O
PHA NNP O
authors NNS O
exhibit VBP O
a DT O
wide JJ O
range NN O
of IN O
techniques NNS O
, , O
from IN O
simply RB O
inserting VBG O
an DT O
advertising NN O
SDK NNP O
to TO O
a DT O
sophisticated JJ O
trojan NN O
. . O

The DT O
app NN O
that WDT O
resulted VBD O
in IN O
the DT O
largest JJS O
number NN O
of IN O
affected JJ O
users NNS O
was VBD O
the DT O
click NN O
fraud NN O
version NN O
, , O
which WDT O
was VBD O
installed VBN O
over IN O
170,000 CD O
times NNS O
at IN O
its PRP$ O
peak NN O
in IN O
February NNP O
2018 CD O
. . O

The DT O
most RBS O
affected JJ O
countries NNS O
were VBD O
India NNP O
, , O
Brazil NNP O
, , O
and CC O
Indonesia NNP O
. . O

In IN O
most JJS O
cases NNS O
, , O
these DT O
click VBP O
fraud NN O
apps NN O
were VBD O
uninstalled VBN O
by IN O
the DT O
users NNS O
, , O
probably RB O
due JJ O
to TO O
the DT O
low JJ O
quality NN O
of IN O
the DT O
apps NN O
. . O

If IN O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
detects VBZ O
one CD O
of IN O
these DT O
apps NNS O
, , O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
will MD O
show VB O
a DT O
warning NN O
to TO O
users NNS O
. . O

We PRP O
are VBP O
constantly RB O
on IN O
the DT O
lookout NN O
for IN O
new JJ O
threats NNS O
and CC O
we PRP O
are VBP O
expanding VBG O
our PRP$ O
protections NNS O
. . O

Every DT O
device NN O
with IN O
Google NNP B-System
Play NNP I-System
includes VBZ O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
and CC O
all DT O
apps VBP O
on IN O
Google NNP B-System
Play NNP I-System
are VBP O
automatically RB O
and CC O
periodically RB O
scanned VBN O
by IN O
our PRP$ O
solutions NNS O
. . O

You PRP O
can MD O
check VB O
the DT O
status NN O
of IN O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
on IN O
your PRP$ O
device NN O
: : O
Open VB O
your PRP$ O
Android NNP O
device NN O
's POS O
Google NNP B-System
Play NNP I-System
Store NNP I-System
app NN O
. . O

Tap NNP O
Menu NNP O
> NNP O
Play NNP O
Protect NNP O
. . O

Look VB O
for IN O
information NN O
about IN O
the DT O
status NN O
of IN O
your PRP$ O
device NN O
. . O

Hashes NNS O
of IN O
samples NNS O
Type NNP O
Package NNP O
name NN O
SHA256 NNP O
digest JJS O
Custom NNP O
ads NNS O
com.targetshoot.zombieapocalypse.sniper.zombieshootinggame VBP B-Indicator
5d98d8a7a012a858f0fa4cf8d2ed3d5a82937b1a98ea2703d440307c63c6c928 CD B-Indicator
Click NNP O
fraud NN O
com.counterterrorist.cs.elite.combat.shootinggame NN B-Indicator
84672fb2f228ec749d3c3c1cb168a1c31f544970fd29136bea2a5b2cefac6d04 CD B-Indicator

Rooting VBG O
trojan JJ O
com.android.world.news NNS O
bd233c1f5c477b0cc15d7f84392dab3a7a598243efa3154304327ff4580ae213 VBP B-Indicator
Zen NNP B-Malware
trojan NN O
com.lmt.register NN B-Indicator
eb12cd65589cbc6f9d3563576c304273cb6a78072b0c20a155a0951370476d8d VBP B-Indicator
Mobile NNP O
Campaign NNP O
‘ NNP O
Bouncing NNP B-Malware
Golf NNP I-Malware
’ NNP O
Affects NNP O
Middle NNP O
East NNP O
We PRP O
uncovered VBD O
a DT O
cyberespionage NN O
campaign NN O
targeting VBG O
Middle NNP O

Eastern JJ O
countries NNS O
. . O

We PRP O
named VBD O
this DT O
campaign NN O
“ VBZ O
Bouncing NNP B-Malware
Golf NNP I-Malware
” NNP O
based VBN O
on IN O
the DT O
malware NN O
’ NNP O
s NN O
code NN O
in IN O
the DT O
package NN O
named VBN O
“ NNP O
golf. NN O
” NNP O
June NNP O
18 CD O
, , O
2019 CD O
We PRP O
uncovered VBD O
a DT O
cyberespionage NN O
campaign NN O
targeting VBG O
Middle NNP O
Eastern NNP O
countries NNS O
. . O

We PRP O
named VBD O
this DT O
campaign NN O
“ VBZ O
Bouncing NNP B-Malware
Golf NNP I-Malware
” NNP O
based VBN O
on IN O
the DT O
malware NN O
’ NNP O
s NN O
code NN O
in IN O
the DT O
package NN O
named VBN O
“ NNP O
golf. NN O
” VBD O
The DT O
malware NN O
involved VBN O
, , O
which WDT O
Trend VBP B-Organization
Micro NNP I-Organization
detects NNS O
as IN O
AndroidOS_GolfSpy.HRX NNP B-Malware
, , O
is VBZ O
notable JJ O
for IN O
its PRP$ O
wide JJ O
range NN O
of IN O
cyberespionage NN O
capabilities NNS O
. . O

Malicious JJ O
codes NNS O
are VBP O
embedded VBN O
in IN O
apps NN O
that IN O
the DT O
operators NNS O
repackaged VBD O
from IN O
legitimate JJ O
applications NNS O
. . O

Monitoring VBG O
the DT O
command NN O
and CC O
control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
servers NNS O
used VBN O
by IN O
Bouncing VBG B-Malware
Golf NNP I-Malware
, , O
we PRP O
’ VBP O
ve NNS O
so RB O
far RB O
observed VBD O
more JJR O
than IN O
660 CD O
Android JJ B-System
devices NNS O
infected VBN O
with IN O
GolfSpy NNP B-Malware
. . O

Much JJ O
of IN O
the DT O
information NN O
being VBG O
stolen VBN O
appear VBP O
to TO O
be VB O
military-related JJ O
. . O

The DT O
campaign NN O
’ NNP O
s VBZ O
attack NN O
vector NN O
is VBZ O
also RB O
interesting JJ O
. . O

These DT O
repackaged VBN O
, , O
malware-laden JJ O
apps NN O
are VBP O
neither DT O
on IN O
Google NNP B-System
Play NNP I-System
nor CC O
popular JJ O
third-party JJ O
app NN O
marketplaces NNS O
, , O
and CC O
we PRP O
only RB O
saw VBD O
the DT O
website JJ O
hosting VBG O
the DT O
malicious JJ O
apps NN O
being VBG O
promoted VBN O
on IN O
social JJ O
media NNS O
when WRB O
we PRP O
followed VBD O
GolfSpy NNP B-Malware
’ NNP O
s VBD O
trail NN O
. . O

We PRP O
were VBD O
also RB O
able JJ O
to TO O
analyze VB O
some DT O
GolfSpy NNP B-Malware
samples NNS O
sourced VBD O
from IN O
the DT O
Trend NNP B-Organization
Micro NNP I-Organization
mobile JJ O
app NN O
reputation NN O
service NN O
. . O

Also RB O
of IN O
note NN O
is VBZ O
Bouncing VBG B-Malware
Golf NNP I-Malware
’ NNP O
s VBZ O
possible JJ O
connection NN O
to TO O
a DT O
previously RB O
reported VBN O
mobile JJ O
cyberespionage NN O
campaign NN O
that WDT O
researchers NNS O
named VBN O
Domestic NNP B-Malware
Kitten NNP I-Malware
. . O

The DT O
strings NNS O
of IN O
code NN O
, , O
for IN O
one CD O
, , O
are VBP O
similarly RB O
structured VBN O
. . O

The DT O
data NN O
targeted VBD O
for IN O
theft NN O
also RB O
have VBP O
similar JJ O
formats NNS O
. . O

Figure NN O
1 CD O
. . O

GolfSpy NNP B-Malware
’ NNP O
s JJ O
infection NN O
chain NN O
GolfSpy NNP B-Malware
's POS O
Potential NNP O
Impact NNP O
Given NNP O
GolfSpy NNP B-Malware
’ NNP O
s VBD O
information-stealing JJ O
capabilities NNS O
, , O
this DT O
malware NN O
can MD O
effectively RB O
hijack VB O
an DT O
infected JJ O
Android NNP B-System
device NN O
. . O

Here RB O
is VBZ O
a DT O
list NN O
of IN O
information NN O
that IN O
GolfSpy NNP B-Malware
steals NNS O
: : O
Device NNP O
accounts NNS O
List NNP O
of IN O
applications NNS O
installed VBN O
in IN O
the DT O
device NN O
Device NNP O
’ NNP O
s JJ O
current JJ O
running NN O
processes VBZ O
Battery NNP O
status NN O
Bookmarks/Histories NNP O
of IN O
the DT O
device NN O
’ NNP O
s NN O
default NN O
browser NN O
Call NNP O
logs NNS O
and CC O
records NNS O
Clipboard NNP O
contents NNS O
Contacts NNS O
, , O
including VBG O
those DT O
in IN O
VCard NNP O
format VBP O
Mobile NNP O
operator NN O
information NN O
Files NNP O
stored VBD O
on IN O
SDcard NNP O
Device NNP O
location NN O
List NN O
of IN O
image NN O
, , O
audio NN O
, , O
and CC O
video NN O
files NNS O
stored VBN O
on IN O
the DT O
device NN O
Storage NN O
and CC O
memory NN O
information NN O
Connection NNP O
information NN O
Sensor NNP O
information NN O
SMS NNP O
messages VBZ O
Pictures NNP O
GolfSpy NNP B-Malware
also RB O
has VBZ O
a DT O
function NN O
that WDT O
lets VBZ O
it PRP O
connect VB O
to TO O
a DT O
remote JJ O
server NN O
to TO O
fetch VB O
and CC O
perform VB O
commands NNS O

, , O
including VBG O
: : O
searching NN O
for IN O
, , O
listing NN O
, , O
deleting NN O
, , O
and CC O
renaming VBG O
files NNS O
as RB O
well RB O
as IN O
downloading VBG O
a DT O
file NN O
into IN O
and CC O
retrieving VBG O
a DT O
file NN O
from IN O
the DT O
device NN O
; : O
taking VBG O
screenshots NNS O
; : O
installing VBG O
other JJ O
application NN O
packages NNS O
( ( O
APK NNP O
) ) O
; : O
recording VBG O
audio NN O
and CC O
video NN O
; : O
and CC O
updating VBG O
the DT O
malware NN O
. . O

Technical JJ O
Analysis NNP O
The DT O
repackaged VBN O
applications NNS O
are VBP O
embedded VBN O
with IN O
malicious JJ O
code NN O
, , O
which WDT O
can MD O
be VB O
found VBN O
in IN O
the DT O
com.golf NN B-Indicator
package NN O
. . O

These DT O
repackaged VBD O
apps RB O
pose JJ O
as IN O
communication NN O
, , O
news NN O
, , O
lifestyle NN O
, , O
book NN O
, , O
and CC O
reference NN O
apps VBP O
popularly RB O
used VBN O
in IN O
the DT O
Middle NNP O
East NNP O
. . O

The DT O
GolfSpy NNP B-Malware
malware NN O
embedded VBN O
in IN O
the DT O
apps NN O
is VBZ O
hardcoded VBN O
with IN O
an DT O
internal JJ O
name NN O
used VBN O
by IN O
the DT O
attacker NN O
. . O

Figure NN O
2 CD O
. . O

Icons NNS O
of IN O
the DT O
apps NN O
that IN O
Bouncing VBG B-Malware
Golf NNP I-Malware
’ NNP O
s NN O
operators NNS O
repackaged VBD O
( ( O
top JJ O
) ) O
and CC O
a DT O
comparison NN O
of IN O
packages NNS O
between IN O
the DT O
original JJ O
legitimate JJ O
app NN O
( ( O
bottom JJ O
left VBN O
) ) O
and CC O
GolfSpy NNP B-Malware
( ( O
bottom VB O
right RB O
) ) O
Figure NN O
3 CD O
. . O

GolfSpy NNP B-Malware
’ NNP O
s VBD O
configurations NNS O
encoded VBN O
by IN O
a DT O
custom NN O
algorithm NN O
( ( O
right JJ O
) ) O
and CC O
its PRP$ O
decoded JJ O
version NN O
( ( O
left VBN O
) ) O
As IN O
shown VBN O
in IN O
Figure NNP O
3 CD O
, , O
GolfSpy NNP B-Malware
’ NNP O
s NN O
configurations NNS O
( ( O
e.g. NN O
, , O
C NNP O
& CC O
C NNP O
server NN O
, , O
secret JJ O
keys NN O
) ) O
are VBP O
encoded VBN O
by IN O
a DT O
customized JJ O
algorithm NN O
. . O

After IN O
it PRP O
is VBZ O
launched VBN O
, , O
GolfSpy NNP B-Malware
will MD O
generate VB O
a DT O
unique JJ O
ID NNP O
for IN O
the DT O
affected JJ O
device NN O
and CC O
then RB O
collect VB O
its PRP$ O
data NNS O
such JJ O
as IN O
SMS NNP O
, , O
contact JJ O
list NN O
, , O
location NN O
, , O
and CC O
accounts NNS O
in IN O
this DT O
format NN O
: : O
“ CD O
% NN O
, , O
[ NNP O
] NNP O
, , O
time NN O
” NNP O
( ( O
shown VBN O
in IN O
Figure NNP O
4 CD O
) ) O
. . O

The DT O
information NN O
is VBZ O
written VBN O
into IN O
a DT O
file NN O
on IN O
the DT O
device NN O
. . O

The DT O
attacker NN O
can MD O
choose VB O
the DT O
data NN O
types NNS O
to TO O
collect VB O
, , O
which WDT O
are VBP O
written VBN O
in IN O
a DT O
certain JJ O
format NN O
. . O

Figure NN O
4 CD O
. . O

Code NNP O
snippet NN O
showing VBG O
GolfSpy NNP B-Malware
generating VBG O
UUID NNP O
The DT O
value NN O
of IN O
% NN O
is VBZ O
in IN O
the DT O
range NN O
of IN O
1-9 JJ O
or CC O
a-j JJ O
. . O

Each DT O
value NN O
represents VBZ O
a DT O
different JJ O
type NN O
of IN O
data NNS O
to TO O
steal VB O
from IN O
the DT O
device NN O
: : O
Value NNP O
Data NNP O
Type NNP O
1 CD O
Accounts NNS O
2 CD O
Installed NNP O
APP NNP O
list NN O
3 CD O
Running NNP O
processes NNS O
list VBP O
4 CD O
Battery NNP O
status NN O
5 CD O
Browser NNP O
bookmarks NNS O
and CC O
histories NNS O
6 CD O
Call NNP O
logs NNS O
7 CD O
Clipboard NNP O
8 CD O
Contacts NNS O
9 CD O
Mobile NNP O
operator NN O
information NN O
a DT O
File NNP O
list NN O
on IN O
SD NNP O
card NN O
b NN O
Location NNP O
c VBZ O
Image NNP O
list NN O
d NN O
Audio NNP O
list NN O
e NN O
Video NNP O
list NN O
f NN O
Storage NNP O
and CC O
memory NN O
information NN O
g NN O
Connection NNP O
information NN O
h NN O
Sensors NNPS O
information NN O
i NN O
SMS NNP O
messages NNS O
j VBP O
VCard NNP O
format NN O
contacts NNS O
Table JJ O
1 CD O
. . O

The DT O
type NN O
of IN O
data NNS O
corresponding VBG O
to TO O
the DT O
value NN O
coded VBD O
in IN O
GolfSpy NNP B-Malware
Figure NNP O
5 CD O
shows VBZ O
the DT O
code NN O
snippets NNS O
that WDT O
are VBP O
involved VBN O
in IN O
monitoring NN O
and CC O
recording VBG O
the DT O
device NN O
’ NNP O
s VBZ O
phone NN O
call NN O
. . O

It PRP O
will MD O
also RB O
take VB O
a DT O
photo NN O
using VBG O
the DT O
device NN O
’ NNP O
s NN O
front NN O
camera NN O
when WRB O
the DT O
user NN O
wakes VBZ O
the DT O
device NN O
. . O

Apart RB O
from IN O
collecting VBG O
the DT O
above NN O
data NNS O
, , O
the DT O
spyware NN O
monitors VBZ O
users NNS O
’ VBP O
phone NN O
calls NNS O
, , O
records NNS O
them PRP O
, , O
and CC O
saves VBZ O
the DT O
recorded VBN O
file NN O
on IN O
the DT O
device NN O
. . O

GolfSpy NNP B-Malware
encrypts VBZ O
all PDT O
the DT O
stolen VBN O
data NNS O
using VBG O
a DT O
simple JJ O
XOR NNP O
operation NN O
with IN O
a DT O
pre-configured JJ O
key NN O
before IN O
sending VBG O
it PRP O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
using VBG O
the DT O
HTTP NNP O
POST NNP O
method NN O
. . O

Figure NN O
5 CD O
. . O

Code NNP O
snippets NNS O
showing VBG O
how WRB O
GolfSpy JJ B-Malware
monitors NNS O
phone NN O
calls VBZ O
via IN O
register NN O
receiver NN O
( ( O
top JJ O
left NN O
) ) O
, , O
its PRP$ O
actions NNS O
when WRB O
the DT O
device NN O
is VBZ O
woken VBN O
up RP O
( ( O
top JJ O
right NN O
) ) O
, , O
and CC O
how WRB O
it PRP O
encrypts VBZ O
the DT O
stolen VBN O
data NNS O
( ( O
bottom NN O
) ) O
The DT O
malware NN O
retrieves VBZ O
commands NNS O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
via IN O
HTTP NNP O
, , O
and CC O
attackers NNS O
can MD O
steal VB O
specific JJ O
files NNS O
on IN O
the DT O
infected JJ O
device NN O
. . O

The DT O
command NN O
is VBZ O
a DT O
constructed JJ O
string NN O
split NN O
into IN O
three CD O
parts NNS O
using VBG O
" NNP O
" NNP O
as IN O
a DT O
separator NN O
. . O

The DT O
first JJ O
part NN O
is VBZ O
the DT O
target NN O
directory NN O
, , O
the DT O
second JJ O
is VBZ O
a DT O
regular JJ O
expression NN O
used VBN O
to TO O
match VB O
specific JJ O
files NNS O
, , O
while IN O
the DT O
last JJ O
part NN O
is VBZ O
an DT O
ID NNP O
. . O

Figure NN O
6 CD O
. . O

Example NN O
of IN O
a DT O
command NN O
that WDT O
steals VBZ O
specific JJ O
files NNS O
from IN O
an DT O
infected JJ O
device NN O
’ NNP O
s NN O
application NN O
( ( O
top JJ O
) ) O
, , O
and CC O
GolfSpy NNP B-Malware
’ NNP O
s VBD O
parse-and-perform JJ O
command NN O
( ( O
bottom NN O
) ) O
Apart RB O
from IN O
the DT O
HTTP NNP O
POST NNP O
method NN O
, , O
GolfSpy NNP B-Malware
also RB O
creates VBZ O
a DT O
socket NN O
connection NN O
to TO O
the DT O
remote JJ O
C NNP O
& CC O
C NNP O
server NN O
in IN O
order NN O
to TO O
receive VB O
and CC O
perform VB O
additional JJ O
commands NNS O
. . O

Stolen NNP O
data NNS O
will MD O
also RB O
be VB O
encrypted VBN O
and CC O
sent VBN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
via IN O
the DT O
socket NN O
connection NN O
. . O

The DT O
encryption NN O
key NN O
is VBZ O
different JJ O
from IN O
the DT O
one CD O
used VBN O
for IN O
sending VBG O
stolen VBN O
data NNS O
via IN O
HTTP NNP O
. . O

Figure NN O
7 CD O
. . O

The DT O
additional JJ O
commands NNS O
that IN O
attackers NNS O
can MD O
carry VB O
out RP O
via IN O
a DT O
socket NN O
connection NN O
( ( O
top JJ O
) ) O
and CC O
the DT O
key NN O
used VBN O
to TO O
encrypt VB O
the DT O
stolen VBN O
data NNS O
( ( O
bottom NN O
) ) O
Correlating VBG O
Bouncing NNP B-Malware
Golf NNP I-Malware
's POS O
Activities NNPS O
We PRP O
monitored VBD O
Bouncing NNP B-Malware
Golf NNP I-Malware
’ NNP O
s NNP O
C NNP O
& CC O
C-related NNP O
activities NNS O
and CC O
saw VBD O
that IN O
the DT O
campaign NN O
has VBZ O
affected VBN O
more JJR O
than IN O
660 CD O
devices NNS O
as IN O
of IN O
this DT O
writing NN O
. . O

The DT O
small JJ O
or CC O
limited JJ O
number NN O
is VBZ O
understandable JJ O
given VBN O
the DT O
nature NN O
of IN O
this DT O
campaign NN O
, , O
but CC O
we PRP O
also RB O
expect VBP O
it PRP O
to TO O
increase VB O
or CC O
even RB O
diversify VB O
in IN O
terms NNS O
of IN O
distribution NN O
. . O

Most JJS O
of IN O
the DT O
affected JJ O
devices NNS O
were VBD O
located VBN O
in IN O
the DT O
Middle NNP O
East NNP O
, , O
and CC O
many JJ O
of IN O
the DT O
stolen VBN O
data NN O
we PRP O
saw VBD O
is VBZ O
military-related JJ O
( ( O
e.g. JJ O
, , O
images NNS O
, , O
documents NNS O
) ) O
. . O

Bouncing VBG B-Malware
Golf NNP I-Malware
’ NNP O
s NN O
operators NNS O
also RB O
try VBP O
to TO O
cover VB O
their PRP$ O
tracks NNS O
. . O

The DT O
registrant JJ O
contact NN O
details NNS O
of IN O
the DT O
C NNP O
& CC O
C NNP O
domains VBZ O
used VBN O
in IN O
the DT O
campaign NN O
, , O
for IN O
instance NN O
, , O
were VBD O
masked VBN O
. . O

The DT O
C NNP O
& CC O
C NNP O
server NN O
IP NNP O
addresses NNS O
used VBD O
also RB O
appear JJ O
to TO O
be VB O
disparate JJ O
, , O
as IN O
they PRP O
were VBD O
located VBN O
in IN O
many JJ O
European JJ O
countries NNS O
like IN O
Russia NNP O
, , O
France NNP O
, , O
Holland NNP O
, , O
and CC O
Germany NNP O
. . O

It PRP O
’ VBZ O
s PRP O
not RB O
a DT O
definite JJ O
correlation NN O
, , O
but CC O
Bouncing NNP B-Malware
Golf NNP I-Malware
also RB O
seems VBZ O
to TO O
have VB O
a DT O
connection NN O
with IN O
Domestic NNP B-Malware
Kitten NNP I-Malware
due JJ O
to TO O
similarities NNS O
we PRP O
found VBD O
in IN O
their PRP$ O
code NN O
. . O

For IN O
example NN O
, , O
the DT O
Android NNP B-System
malware NN O
that IN O
both DT O
deploy NNS O
share NN O
the DT O
same JJ O
strings NNS O
of IN O
code NN O
for IN O
their PRP$ O
decoding NN O
algorithm NN O
. . O

The DT O
data NN O
that WDT O
Domestic NNP B-Malware
Kitten NNP I-Malware
steals NNS O
follows VBZ O
a DT O
similar JJ O
format NN O
with IN O
Bouncing NNP B-Malware
Golf NNP I-Malware
’ NNP O
s NN O
, , O
with IN O
each DT O
type NN O
of IN O
data NNS O
having VBG O
a DT O
unique JJ O
identifying NN O
character NN O
. . O

It PRP O
’ VBZ O
s NN O
also RB O
worth JJ O
noting VBG O
that IN O
both DT O
campaigns NNS O
repackage NN O
apps NN O
that WDT O
are VBP O
commonly RB O
used VBN O
in IN O
their PRP$ O
target NN O
’ IN O
s JJ O
countries NNS O
, , O
such JJ O
as IN O
Telegram NNP B-System
, , O
Kik NNP B-System
, , O
and CC O
Plus NNP B-System
messaging VBG O
apps NN O
. . O

Figure NN O
8 CD O
. . O

Code NNP O
snippets NNS O
showing VBG O
: : O
the DT O
decoding VBG O
algorithm NN O
shared VBN O
by IN O
both DT O
Bouncing NNP B-Malware
Golf NNP I-Malware
and CC O
Domestic NNP B-Malware
Kitten NNP I-Malware
( ( O
top JJ O
) ) O
, , O
the DT O
format NN O
of IN O
data NNS O
that WDT O
Domestic NNP B-Malware
Kitten NNP I-Malware
’ NNP O
s PRP O
malware VBP O
targets NNS O
to TO O
steal VB O
( ( O
center NN O
) ) O
, , O
and CC O
how WRB O
both DT O
Bouncing NNP B-Malware
Golf NNP I-Malware
( ( O
bottom JJ O
left VBN O
) ) O
and CC O
Domestic NNP B-Malware
Kitten NNP I-Malware
( ( O
bottom VB O
right RB O
) ) O
use VBP O
" JJ O
" NN O
as IN O
a DT O
separator NN O
in IN O
their PRP$ O
command NN O
strings NNS O
. . O

As IN O
we PRP O
’ VBP O
ve JJ O
seen VBN O
in IN O
last JJ O
year NN O
’ VBD O
s NN O
mobile NN O
threat NN O
landscape NN O
, , O
we PRP O
expect VBP O
more JJR O
cyberespionage JJ O
campaigns NNS O
targeting VBG O
the DT O
mobile JJ O
platform NN O
given VBN O
its PRP$ O
ubiquity NN O
, , O
employing VBG O
tried-and-tested JJ O
techniques NNS O
to TO O
lure VB O
unwitting JJ O
users NNS O
. . O

The DT O
extent NN O
of IN O
information NN O
that IN O
these DT O
kinds NNS O
of IN O
threats NNS O
can MD O
steal VB O
is VBZ O
also RB O
significant JJ O
, , O
as IN O
it PRP O
lets VBZ O
attackers NNS O
virtually RB O
take VBP O
over RP O
a DT O
compromised JJ O
device NN O
. . O

Users NNS O
should MD O
adopt VB O
best JJS O
practices NNS O
, , O
while IN O
organizations NNS O
should MD O
ensure VB O
that IN O
they PRP O
balance VBP O
the DT O
need NN O
for IN O
mobility NN O
and CC O
the DT O
importance NN O
of IN O
security NN O
. . O

End NN O
users NNS O
and CC O
enterprises NNS O
can MD O
also RB O
benefit VB O
from IN O
multilayered VBN O
mobile JJ O
security NN O
solutions NNS O
such JJ O
as IN O
Trend NNP B-Organization
Micro™ NNP I-Organization
Mobile NNP O
Security™ NNP O
. . O

Trend NNP B-Organization
Micro™ NNP I-Organization
Mobile NNP B-System
Security NNP I-System
for IN I-System
Enterprise NNP I-System
provides VBZ O
device NN O
, , O
compliance NN O
and CC O
application NN O
management NN O
, , O
data NN O
protection NN O
, , O
and CC O
configuration NN O
provisioning NN O
, , O
as RB O
well RB O
as IN O
protects NNS O
devices NNS O
from IN O
attacks NNS O
that WDT O
exploit VBP O
vulnerabilities NNS O
, , O
preventing VBG O
unauthorized JJ O
access NN O
to TO O
apps VB O
, , O
and CC O
detecting VBG O
and CC O
blocking VBG O
malware NN O
and CC O
fraudulent JJ O
websites NNS O
. . O

Trend NNP B-Organization
Micro NNP I-Organization
’ NNP O
s VBP O
Mobile NNP B-System
App NNP I-System
Reputation NNP I-System
Service NNP I-System
( ( O
MARS NNP O
) ) O
covers VBZ O
Android NNP B-System
and CC O
iOS JJ B-System
threats NNS O
using VBG O
leading VBG O
sandbox NN O
and CC O
machine NN O
learning NN O
technologies NNS O
, , O
protecting VBG O
devices NNS O
against IN O
malware NN O
, , O
zero-day JJ O
and CC O
known JJ O
exploits NNS O
, , O
privacy NN O
leaks NNS O
, , O
and CC O
application NN O
vulnerabilities NNS O
. . O

Several JJ O
weeks NNS O
ago RB O
, , O
Check NNP B-Organization
Point NNP I-Organization
Mobile NNP O
Threat NNP O
Prevention NNP O
detected VBD O
and CC O
quarantined VBD O
the DT O
Android NNP B-System
device NN O
of IN O
an DT O
unsuspecting JJ O
customer NN O
employee NN O
who WP O
downloaded VBD O
and CC O
installed VBD O
a DT O
0day CD O
mobile JJ O
ransomware NN O
from IN O
Google NNP B-System
Play NNP I-System
dubbed VBD O
“ NNP O
Charger. NNP B-Malware
” NNP O
This DT O
incident NN O
demonstrates VBZ O
how WRB O
malware NN O
can MD O
be VB O
a DT O
dangerous JJ O
threat NN O
to TO O
your PRP$ O
business NN O
, , O
and CC O
how WRB O
advanced JJ O
behavioral JJ O
detection NN O
fills NNS O
mobile JJ O
security NN O
gaps NNS O
attackers NNS O
use VBP O
to TO O
penetrate VB O
entire JJ O
networks NNS O
. . O

Charger NNP B-Malware
was VBD O
found VBN O
embedded VBN O
in IN O
an DT O
app NN O
called VBN O
EnergyRescue NNP B-Malware
. . O

The DT O
infected JJ O
app NN O
steals NNS O
contacts NNS O
and CC O
SMS NNP O
messages NNS O
from IN O
the DT O
user NN O
’ NNP O
s NN O
device NN O
and CC O
asks NNS O
for IN O
admin JJ O
permissions NNS O
. . O

If IN O
granted VBN O
, , O
the DT O
ransomware NN O
locks VBZ O
the DT O
device NN O
and CC O
displays VBZ O
a DT O
message NN O
demanding VBG O
payment NN O
: : O
You PRP O
need VBP O
to TO O
pay VB O
for IN O
us PRP O
, , O
otherwise RB O
we PRP O
will MD O
sell VB O
portion NN O
of IN O
your PRP$ O
personal JJ O
information NN O
on IN O
black JJ O
market NN O
every DT O
30 CD O
minutes NNS O
. . O

WE NNP O
GIVE VBP O
100 CD O
% NN O
GUARANTEE NNP O
THAT NNP O
ALL NNP O
FILES NNP O
WILL NNP O
RESTORE NNP O
AFTER NNP O
WE NNP O
RECEIVE NNP O
PAYMENT NNP O
. . O

WE NNP O
WILL NNP O
UNLOCK NNP O
THE NNP O
MOBILE NNP O
DEVICE NNP O
AND NNP O
DELETE NNP O
ALL NNP O
YOUR NNP O
DATA NNP O
FROM NNP O
OUR NNP O
SERVER NNP O
! . O

TURNING VB O
OFF RP O
YOUR PRP$ O
PHONE NNP O
IS NNP O
MEANINGLESS NNP O
, , O
ALL NNP O
YOUR NNP O
DATA NNP O
IS NNP O
ALREADY NNP O
STORED NNP O
ON NNP O
OUR NNP O
SERVERS NN O
! . O

WE NNP O
STILL NNP O
CAN NNP O
SELLING NNP O
IT NNP O
FOR NNP O
SPAM NNP O
, , O
FAKE NNP O
, , O
BANK NNP O
CRIME NNP O
etc… NN O
We PRP O
collect VBP O
and CC O
download VBP O
all DT O
of IN O
your PRP$ O
personal JJ O
data NNS O
. . O

All DT O
information NN O
about IN O
your PRP$ O
social JJ O
networks NNS O
, , O
Bank NNP O
accounts NNS O
, , O
Credit NNP O
Cards NNP O
. . O

We PRP O
collect VBP O
all DT O
data NNS O
about IN O
your PRP$ O
friends NNS O
and CC O
family NN O
. . O

The DT O
ransom JJ O
demand NN O
for IN O
0.2 CD O
Bitcoins NNS O
( ( O
roughly RB O
$ $ O
180 CD O
) ) O
is VBZ O
a DT O
much RB O
higher JJR O
ransom NN O
demand NN O
than IN O
has VBZ O
been VBN O
seen VBN O
in IN O
mobile JJ O
ransomware NN O
so RB O
far RB O
. . O

By IN O
comparison NN O
, , O
the DT O
DataLust NNP B-Malware
ransomware NN O
demanded VBD O
merely RB O
$ $ O
15 CD O
. . O

Payments NNS O
are VBP O
made VBN O
to TO O
a DT O
specific JJ O
Bitcoin NNP B-System
account NN O
, , O
but CC O
we PRP O
haven VBP O
’ JJ O
t NN O
identified VBD O
any DT O
payments NNS O
so RB O
far RB O
. . O

Adware NNP O
commonly RB O
found VBD O
on IN O
Play NNP O
collects VBZ O
profits NNS O
from IN O
ad NN O
networks NNS O
, , O
but CC O
mobile JJ O
ransomware NN O
inflicts NNS O
direct JJ O
harm NN O
to TO O
users NNS O
. . O

Like IN O
FakeDefender NNP B-Malware
and CC O
DataLust NNP B-Malware
, , O
Charger NNP B-Malware
could MD O
be VB O
an DT O
indicator NN O
of IN O
a DT O
wider NN O
effort NN O
by IN O
mobile JJ O
malware NN O
developers NNS O
to TO O
catch VB O
up RP O
with IN O
their PRP$ O
PC NN O
ransomware NN O
cousins NNS O
. . O

Similar JJ O
to TO O
other JJ O
malware NN O
seen VBN O
in IN O
the DT O
past NN O
, , O
Charger NNP B-Malware
checks VBZ O
the DT O
local JJ O
settings NNS O
of IN O
the DT O
device NN O
and CC O
does VBZ O
not RB O
run VB O
its PRP$ O
malicious JJ O
logic NN O
if IN O
the DT O
device NN O
is VBZ O
located VBN O
in IN O
Ukraine NNP O
, , O
Russia NNP O
, , O
or CC O
Belarus NNP O
. . O

This DT O
is VBZ O
likely JJ O
done VBN O
to TO O
keep VB O
the DT O
developers NNS O
from IN O
being VBG O
prosecuted VBN O
in IN O
their PRP$ O
own JJ O
countries NNS O
or CC O
being VBG O
extradited VBN O
between IN O
countries NNS O
. . O

Most JJS O
malware NN O
found VBN O
on IN O
Google NNP B-System
Play NNP I-System
contains VBZ O
only RB O
a DT O
dropper NN O
that IN O
later RB O
downloads VBZ O
the DT O
real JJ O
malicious JJ O
components NNS O
to TO O
the DT O
device NN O
. . O

Charger NNP B-Malware
, , O
however RB O
, , O
uses VBZ O
a DT O
heavy JJ O
packing NN O
approach NN O
which WDT O
it PRP O
harder JJR O
for IN O
the DT O
malware NN O
to TO O
stay VB O
hidden RB O
, , O
so IN O
it PRP O
must MD O
compensate VB O
with IN O
other JJ O
means NNS O
. . O

The DT O
developers NNS O
of IN O
Charger NNP B-Malware
gave VBD O
it PRP O
everything NN O
they PRP O
had VBD O
to TO O
boost VB O
its PRP$ O
evasion NN O
capabilities NNS O
and CC O
so IN O
it PRP O
could MD O
stay VB O
hidden VBN O
on IN O
Google NNP B-System
Play NNP I-System
for IN O
as RB O
long RB O
as IN O
possible JJ O
. . O

The DT O
malware NN O
uses VBZ O
several JJ O
advanced VBD O
techniques NNS O
to TO O
hide VB O
its PRP$ O
real JJ O
intentions NNS O
and CC O
makes VBZ O
it PRP O
harder JJR O
to TO O
detect VB O
. . O

It PRP O
encodes VBZ O
strings NNS O
into IN O
binary JJ O
arrays NNS O
, , O
making VBG O
it PRP O
hard JJ O
to TO O
inspect VB O
them PRP O
. . O

It PRP O
loads VBZ O
code NN O
from IN O
encrypted JJ O
resources NNS O
dynamically RB O
, , O
which WDT O
most JJS O
detection NN O
engines NNS O
can MD O
not RB O
penetrate VB O
and CC O
inspect VB O
. . O

The DT O
dynamically-loaded JJ O
code NN O
is VBZ O
also RB O
flooded VBN O
with IN O
meaningless NN O
commands NNS O
that WDT O
mask VBP O
the DT O
actual JJ O
commands NNS O
passing VBG O
through IN O
. . O

It PRP O
checks VBZ O
whether IN O
it PRP O
is VBZ O
being VBG O
run VBN O
in IN O
an DT O
emulator NN O
before IN O
it PRP O
starts VBZ O
its PRP$ O
malicious JJ O
activity NN O
. . O

PC NN O
malware NN O
first RB O
introduced VBD O
this DT O
technique NN O
which WDT O
is VBZ O
becoming VBG O
a DT O
trend NN O
in IN O
mobile JJ O
malware NN O
having VBG O
been VBN O
adopted VBN O
by IN O
several JJ O
malware JJ O
families NNS O
including VBG O
Dendroid NNP B-Malware
. . O

Emulator NN O
and CC O
location NN O
conditions NNS O
for IN O
the DT O
malware NN O
’ NNP O
s NN O
activity NN O
Check NNP B-Organization
Point NNP I-Organization
Mobile NNP O
Threat NNP O
Prevention NNP O
customers NNS O
are VBP O
protected VBN O
from IN O
Charger NNP B-Malware
and CC O
similar JJ O
malware NN O
. . O

Check NNP B-Organization
Point NNP I-Organization
’ NNP O
s NN O
Analysis NNP O
and CC O
Response NNP O
Team NNP O
( ( O
ART NNP O
) ) O
disclosed VBD O
the DT O
finding NN O
to TO O
Android NNP B-System
’ NNP O
s JJ O
Security NNP O
team NN O
who WP O
took VBD O
the DT O
appropriate JJ O
security NN O
steps NNS O
to TO O
remove VB O
the DT O
infected JJ O
app NN O
and CC O
added VBD O
the DT O
malware NN O
to TO O
Android NNP B-System
’ NNP O
s VBD O
built-in JJ O
protection NN O
mechanisms NNS O
. . O

Charger NNP O
SHA256 NNP O
hash NN O
: : O
58eb6c368e129b17559bdeacb3aed4d9a5d3596f774cf5ed3fdcf51775232ba0 CD B-Indicator
Infostealer NNP O
, , O
Keylogger NNP O
, , O
and CC O
Ransomware NNP O
in IN O
One CD O
: : O
Anubis NNP B-Malware
Targets VBZ O
More JJR O
than IN O
250 CD O
Android JJ B-System
Applications NNP O
October NNP O
29 CD O
, , O
2021 CD O
The DT O
Cofense NNP B-Organization
Phishing NNP I-Organization
Defense NNP I-Organization
Center NNP I-Organization
uncovered VBD O
a DT O
phishing NN O
campaign NN O
that WDT O
specifically RB O
targets VBZ O
users NNS O
of IN O
Android NNP B-System
devices NNS O
that WDT O
could MD O
result VB O
in IN O
compromise NN O
if IN O
unsigned JJ O
Android NNP B-System
applications NNS O
are VBP O
permitted VBN O
on IN O
the DT O
device NN O
. . O

The DT O
campaign NN O
seeks VBZ O
to TO O
deliver VB O
Anubis NNP B-Malware
, , O
a DT O
particularly RB O
nasty JJ O
piece NN O
of IN O
malware NN O
that WDT O
was VBD O
originally RB O
used VBN O
for IN O
cyber JJ O
espionage NN O
and CC O
retooled VBD O
as IN O
a DT O
banking NN O
trojan NN O
. . O

Anubis NNP B-Malware
can MD O
completely RB O
hijack VB O
an DT O
Android NNP B-System
mobile NN O
device NN O
, , O
steal NN O
data NNS O
, , O
record NN O
phone NN O
calls NNS O
, , O
and CC O
even RB O
hold VB O
the DT O
device NN O
to TO O
ransom VB O
by IN O
encrypting VBG O
the DT O
victim NN O
’ NN O
s VBD O
personal JJ O
files NNS O
. . O

With IN O
mobile JJ O
devices NNS O
increasingly RB O
used VBN O
in IN O
the DT O
corporate JJ O
environment NN O
, , O
thanks NNS O
to TO O
the DT O
popularity NN O
of IN O
BYOD NNP O
policies NNS O
, , O
this DT O
malware NN O
has VBZ O
the DT O
potential JJ O
to TO O
cause VB O
serious JJ O
harm NN O
, , O
mostly RB O
to TO O
consumers NNS O
, , O
and CC O
businesses NNS O
that WDT O
allow VBP O
the DT O
installation NN O
of IN O
unsigned JJ O
applications NNS O
. . O

Here RB O
’ NNP O
s VBZ O
how WRB O
it PRP O
works VBZ O
: : O
At IN O
first JJ O
glance NN O
, , O
the DT O
email NN O
shown VBN O
in IN O
Figure NNP O
1 CD O
looks NNS O
like IN O
any DT O
other JJ O
phishing NN O
email NN O
that WDT O
asks VBZ O
the DT O
user NN O
to TO O
download VB O
an DT O
invoice NN O
. . O

However RB O
, , O
this DT O
particular JJ O
email NN O
downloads NNS O
an DT O
Android NNP B-System
Package NNP I-System
Kit NNP I-System
( ( O
APK NNP O
) ) O
, , O
which WDT O
is VBZ O
the DT O
common JJ O
format NN O
used VBN O
by IN O
Android NNP B-System
to TO O
distribute VB O
and CC O
install VB O
applications NNS O
. . O

Let VB O
’ PRP O
s VB O
take VB O
a DT O
closer JJR O
look NN O
at IN O
the DT O
suspicious JJ O
file NN O
. . O

Figure NN O
1 CD O
– NN O
Phishing VBG O
Email NNP O
When WRB O
the DT O
email NN O
link NN O
is VBZ O
opened VBN O
from IN O
an DT O
Android NNP B-System
device NN O
, , O
an DT O
APK NNP O
file NN O
( ( O
Fattura002873.apk NNP B-Indicator
) ) O
, , O
is VBZ O
downloaded VBN O
. . O

Upon IN O
opening VBG O
the DT O
file NN O
, , O
the DT O
user NN O
is VBZ O
asked VBN O
to TO O
enable VB O
“ JJ O
Google NNP B-System
Play NNP I-System
Protect NNP O
” NNP O
as IN O
shown VBN O
in IN O
Figure NNP O
2 CD O
. . O

However RB O
, , O
this DT O
is VBZ O
not RB O
a DT O
genuine JJ O
“ NN O
Google NNP B-System
Play NNP I-System
Protect NNP O
” NNP O
screen NN O
; : O
instead RB O
it PRP O
gives VBZ O
the DT O
app NN O
all PDT O
the DT O
permissions NNS O
it PRP O
needs VBZ O
while IN O
simultaneously RB O
disabling VBG O
the DT O
actual JJ O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
. . O

Figure NN O
2 CD O
– NN O
Granting VBG O
Permissions NNP O
The DT O
following JJ O
permissions NNS O
are VBP O
granted VBN O
to TO O
the DT O
app NN O
: : O
Figure NN O
3 CD O
– NN O
Permissions NNS O
Granted VBN O
to TO O
App VB O
A NNP O
closer JJR O
look NN O
at IN O
the DT O
code NN O
reveals VBZ O
the DT O
application NN O
gathers VBZ O
a DT O
list NN O
of IN O
installed JJ O
applications NNS O
to TO O
compare VB O
the DT O
results NNS O
against IN O
a DT O
list NN O
of IN O
targeted JJ O
applications NNS O
( ( O
Figure NNP O
4 CD O
) ) O
. . O

The DT O
malware NN O
mainly RB O
targets VBZ O
banking NN O
and CC O
financial JJ O
applications NNS O
, , O
but CC O
also RB O
looks VBZ O
for IN O
popular JJ O
shopping NN O
apps NNS O
such JJ O
as IN O
eBay NN B-Organization
or CC O
Amazon NNP B-Organization
. . O

A DT O
full JJ O
list NN O
of IN O
targeted JJ O
applications NNS O
is VBZ O
included VBN O
in IN O
the DT O
IOC NNP O
section NN O
at IN O
the DT O
end NN O
of IN O
this DT O
post NN O
. . O

Once RB O
an DT O
application NN O
has VBZ O
been VBN O
identified VBN O
, , O
Anubis NNP B-Malware
overlays VBZ O
the DT O
original JJ O
application NN O
with IN O
a DT O
fake JJ O
login NN O
page NN O
to TO O
capture VB O
the DT O
user NN O
’ NNP O
s NN O
credentials NNS O
. . O

Figure NN O
4 CD O
– NN O
Checking NNP O
for IN O
installed VBN O
apps NN O
Based VBN O
on IN O
a DT O
thorough JJ O
analysis NN O
of IN O
the DT O
code NN O
, , O
the DT O
most RBS O
interesting JJ O
technical JJ O
capabilities NNS O
include VBP O
: : O
Capturing JJ O
screenshots NNS O
Enabling VBG O
or CC O
changing VBG O
administration NN O
settings NNS O
Opening NNP O
and CC O
visiting VBG O
any DT O
URL NNP O
Disabling NNP O
Play NNP O
Protect NNP O
Recording NNP O
audio NN O
Making NNP O
phone NN O
calls VBZ O
Stealing VBG O
the DT O
contact NN O
list NN O
Controlling VBG O
the DT O
device NN O
via IN O
VNC NNP O
Sending NNP O
, , O
receiving VBG O
and CC O
deleting VBG O
SMS NNP O
Locking VBG O
the DT O
device NN O
Encrypting NNP O
files NNS O
on IN O
the DT O
device NN O
and CC O
external JJ O
drives NNS O
Searching VBG O
for IN O
files NNS O
Retrieving VBG O
the DT O
GPS NNP O
location NN O
Capturing NNP O
remote NN O
control NN O
commands VBZ O
from IN O
Twitter NNP B-System
and CC O
Telegram NNP B-System
Pushing NNP O
overlays VBZ O
Reading VBG O
the DT O
device NN O
ID NNP O
The DT O
malware NN O
includes VBZ O

a DT O
keylogger NN O
that WDT O
works VBZ O
in IN O
every DT O
app NN O
installed VBN O
on IN O
the DT O
Android NNP B-System
device NN O
. . O

However RB O
, , O
the DT O
keylogger NN O
needs VBZ O
to TO O
be VB O
specifically RB O
enabled VBN O
by IN O
a DT O
command NN O
sent NN O
from IN O
the DT O
C2 NNP O
server NN O
. . O

The DT O
keylogger NN O
can MD O
track VB O
three CD O
different JJ O
events NNS O
( ( O
Figure NNP O
5 CD O
) ) O
: : O
TYPE_VIEW_CLICKED NN O
Represents VBZ O
the DT O
event NN O
of IN O
clicking VBG O
on IN O
a DT O
View-like JJ O
Button NNP O
, , O
CompoundButton NNP O
, , O
etc NN O
. . O

TYPE_VIEW_FOCUSED NN O
Represents VBZ O
the DT O
event NN O
of IN O
setting VBG O
input JJ O
focus NN O
of IN O
a DT O
View NNP O
. . O

TYPE_VIEW_TEXT_CHANGED NN O
Represents VBZ O
the DT O
event NN O
of IN O
changing VBG O
the DT O
text NN O
of IN O
an DT O
EditText NNP O
. . O

Figure NN O
5 CD O
– NN O
Keylogger NNP O
component NN O
Figure NN O
6 CD O
shows VBZ O
one CD O
of IN O
the DT O
most RBS O
noteworthy JJ O
functions NNS O
of IN O
Anubis NNP B-Malware
: : O
its PRP$ O
ransomware NN O
module NN O
. . O

The DT O
malware NN O
searches VBZ O
both DT O
internal JJ O
and CC O
external JJ O
storage NN O
and CC O
encrypts VB O
them PRP O
using VBG O
RC4 NNP O
. . O

It PRP O
adds VBZ O
the DT O
file NN O
extension NN O
.AnubisCrypt NN B-Indicator
to TO O
each DT O
encrypted VBN O
file NN O
and CC O
sends VBZ O
it PRP O
to TO O
the DT O
C2 NNP O
. . O

Figure NN O
6 CD O
– NN O
Ransomware NNP O
component NN O
Anubis NNP B-Malware
has VBZ O
been VBN O
known VBN O
to TO O
utilize VB O
Twitter NNP B-Organization
or CC O
Telegram NNP B-Organization
to TO O
retrieve VB O
the DT O
C2 NNP O
address NN O
and CC O
this DT O
sample NN O
is VBZ O
no DT O
exception NN O
( ( O
Figure NNP O
7 CD O
) ) O
. . O

Figure NN O
7 CD O
– NN O
C2 NNP O
As IN O
seen VBN O
in IN O
Figure NNP O
8 CD O
, , O
this DT O
version NN O
of IN O
Anubis NNP B-Malware
is VBZ O
built VBN O
to TO O
run VB O
on IN O
several JJ O
iterations NNS O
of IN O
the DT O
Android NNP B-System
operating NN O
system NN O
, , O
dating VBG O
back RB O
to TO O
version NN O
4.0.3 CD O
, , O
which WDT O
was VBD O
released VBN O
in IN O
2012 CD O
. . O

Figure NN O
8 CD O
– NN O
Android NNP B-System
requirements NNS O
Android NNP B-System
malware NN O
has VBZ O
been VBN O
around IN O
for IN O
many JJ O
years NNS O
and CC O
will MD O
be VB O
with IN O
us PRP O
for IN O
the DT O
foreseeable JJ O
future NN O
. . O

Users NNS O
who WP O
have VBP O
configured VBN O
their PRP$ O
Android NNP B-System
mobile NN O
device NN O
to TO O
receive VB O
work-related JJ O
emails NNS O
and CC O
allow JJ O
installation NN O
of IN O
unsigned JJ O
applications NNS O
face VBP O
the DT O
most RBS O
risk NN O
of IN O
compromise NN O
. . O

APK NNP O
files NNS O
will MD O
not RB O
natively RB O
open JJ O
in IN O
an DT O
environment NN O
other JJ O
than IN O
an DT O
Android NNP B-System
device NN O
. . O

With IN O
the DT O
increased VBN O
use NN O
of IN O
Android NNP B-System
phones NNS O
in IN O
business NN O
environments NNS O
, , O
it PRP O
is VBZ O
important JJ O
to TO O
defend VB O
against IN O
these DT O
threats NNS O
by IN O
ensuring VBG O
devices NNS O
are VBP O
kept VBN O
current JJ O
with IN O
the DT O
latest JJS O
updates NNS O
. . O

Limiting VBG O
app JJ O
installations NNS O
on IN O
corporate JJ O
devices NNS O
, , O
as RB O
well RB O
as IN O
ensuring VBG O
that IN O
applications NNS O
are VBP O
created VBN O
by IN O
trusted JJ O
developers NNS O
on IN O
official JJ O
marketplaces NNS O
, , O
can MD O
help VB O
in IN O
reducing VBG O
the DT O
risk NN O
of IN O
infection NN O
as IN O
well RB O
. . O

ViceLeaker NNP B-Malware
Operation NNP O
: : O
mobile JJ O
espionage NN O
targeting VBG O
Middle NNP O
East NNP O
26 CD O
JUN NNP O
2019 CD O
In IN O
May NNP O
2018 CD O
, , O
we PRP O
discovered VBD O
a DT O
campaign NN O
targeting VBG O
dozens NNS O
of IN O
mobile JJ O
Android NNP B-System
devices NNS O
belonging VBG O
to TO O
Israeli NNP O
citizens NNS O
. . O

Kaspersky NNP B-Organization
spyware NN O
sensors NNS O
caught VBD O
the DT O
signal NN O
of IN O
an DT O
attack NN O
from IN O
the DT O
device NN O
of IN O
one CD O
of IN O
the DT O
victims NNS O
; : O
and CC O
a DT O
hash NN O
of IN O
the DT O
APK NNP O
involved VBN O
( ( O
Android NNP B-System
application NN O
) ) O
was VBD O
tagged VBN O
in IN O
our PRP$ O
sample NN O
feed NN O
for IN O
inspection NN O
. . O

Once RB O
we PRP O
looked VBD O
into IN O
the DT O
file NN O
, , O
we PRP O
quickly RB O
found VBD O
out RP O
that IN O
the DT O
inner-workings NNS O
of IN O
the DT O
APK NNP O
included VBD O
a DT O
malicious JJ O
payload NN O
, , O
embedded VBN O
in IN O
the DT O
original JJ O
code NN O
of IN O
the DT O
application NN O
. . O

This DT O
was VBD O
an DT O
original JJ O
spyware NN O
program NN O
, , O
designed VBN O
to TO O
exfiltrate VB O
almost RB O
all DT O
accessible JJ O
information NN O
. . O

During IN O
the DT O
course NN O
of IN O
our PRP$ O
research NN O
, , O
we PRP O
noticed VBD O
that IN O
we PRP O
were VBD O
not RB O
the DT O
only JJ O
ones NNS O
to TO O
have VB O
found VBN O
the DT O
operation NN O
. . O

Researchers NNS O
from IN O
Bitdefender NNP B-System
also RB O
released VBD O
an DT O
analysis NN O
of IN O
one CD O
of IN O
the DT O
samples NNS O
in IN O
a DT O
blogpost NN O
. . O

Although IN O
something NN O
had VBD O
already RB O
been VBN O
published VBN O
, , O
we PRP O
decided VBD O
to TO O
do VB O
something NN O
different JJ O
with IN O
the DT O
data NN O
we PRP O
acquired VBD O
. . O

The DT O
following VBG O
month NN O
, , O
we PRP O
released VBD O
a DT O
private JJ O
report NN O
on IN O
our PRP$ O
Threat NN O
Intelligence NNP O
Portal NNP O
to TO O
alert VB O
our PRP$ O
clients NNS O
about IN O
this DT O
newly RB O
discovered VBN O
operation NN O
and CC O
began VBD O
writing VBG O
YARA NNP O
rules NNS O
in IN O
order NN O
to TO O
catch VB O
more JJR O
samples NNS O
. . O

We PRP O
decided VBD O
to TO O
call VB O
the DT O
operation NN O
“ NNP O
ViceLeaker NNP B-Malware
” NNP O
, , O
because IN O
of IN O
strings NNS O
and CC O
variables NNS O
in IN O
its PRP$ O
code NN O
. . O

Mobile NNP O
ViceLeaker NNP B-Malware
The DT O
following VBG O
table NN O
shows NNS O
meta VBP O
information NN O
on IN O
the DT O
observed JJ O
samples NNS O
, , O
including VBG O
compiler NN O
timestamps NNS O
: : O
MD5 NNP O
Package NNP O
Compiler NNP O
C2 NNP O
51df2597faa3fce38a4c5ae024f97b1c CD B-Indicator
com.xapps.SexGameForAdults NNS B-Indicator
dexlib VBD O
2.x CD O
188.165.28 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
251 CD I-Indicator
2d108ff3a735dea1d1fdfa430f37fab2 CD B-Indicator
com.psiphon3 NN B-Indicator
dexlib VBD O
2.x CD O
188.165.49 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
7ed754a802f0b6a1740a99683173db73 CD B-Indicator
com.psiphon3 NN B-Indicator
dexlib VBD O
2.x CD O
188.165.49 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
205 CD I-Indicator
3b89e5cd49c05ce6dc681589e6c368d9 CD B-Indicator
ir.abed.dastan JJ B-Indicator
dexlib NN O
2.x CD O
185.141.60 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
213 CD I-Indicator
To TO O
backdoor VB O
legitimate JJ O
applications NNS O
, , O
attackers NNS O
used VBD O
a DT O
Smali NNP O
injection NN O
technique NN O
– VBZ O
a DT O
type NN O
of IN O
injection NN O
that WDT O
allows VBZ O
attackers NNS O
to TO O
disassemble VB O
the DT O
code NN O
of IN O
original JJ O
app NN O
with IN O
the DT O
Baksmali NNP O
tool NN O
, , O
add VB O
their PRP$ O
malicious JJ O
code NN O
, , O
and CC O
assemble JJ O
it PRP O
with IN O
Smali NNP O
. . O

As IN O
a DT O
result NN O
, , O
due JJ O
to TO O
such PDT O
an DT O
unusual JJ O
compilation NN O
process NN O
, , O
there EX O
were VBD O
signs NNS O
in IN O
the DT O
dex NN O
file NN O
that WDT O
point NN O
to TO O
dexlib VB O
, , O
a DT O
library NN O
used VBN O
by IN O
the DT O
Smali NNP O
tool NN O
to TO O
assemble JJ O
dex NN O
files NNS O
. . O

Original JJ O
code NN O
of IN O
the DT O
APK NNP O
on IN O
the DT O
left NN O
, , O
versus NN O
injected VBD O
APK NNP O
on IN O
the DT O
right NN O
The DT O
analysis NN O
of IN O
the DT O
APK NNP O
was VBD O
rather RB O
interesting JJ O
, , O
because IN O
some DT O
of IN O
the DT O
actions NNS O
were VBD O
very RB O
common JJ O
spyware NN O
features NNS O
, , O
such JJ O
as IN O
the DT O
exfiltration NN O
of IN O
SMS NNP O
messages NNS O
, , O
call VB O
logs NNS O
and CC O
other JJ O
data NNS O
. . O

However RB O
, , O
in IN O
addition NN O
to TO O
the DT O
traditional JJ O
functionality NN O
, , O
there EX O
were VBD O
also RB O
backdoor JJ O
capabilities NNS O
such JJ O
as IN O
upload NN O
, , O
download NN O
, , O
delete JJ O
files NNS O
, , O
camera NN O
takeover NN O
and CC O
record NN O
surrounding NN O
audio NN O
. . O

The DT O
malware NN O
uses VBZ O
HTTP NNP O
for IN O
communication NN O
with IN O
the DT O
C2 NNP O
server NN O
for IN O
command NN O
handling NN O
and CC O
data NNS O
exfiltration NN O
. . O

Here RB O
is VBZ O
a DT O
command NN O
and CC O
control NN O
protocol NN O
fragment NN O
: : O
Commands NNS O
from IN O
C2 NNP O
server NN O
parsing NN O
In IN O
total JJ O
, , O
the DT O
malicious JJ O
APK NNP O
handles VBZ O
16 CD O
different JJ O
commands NNS O
: : O
Command NNP O
Endpoint NNP O
Description NNP O
1 CD O
reqsmscal.php NN B-Indicator
Send NNP O
specified VBD O
SMS NNP O
message NN O
2 CD O
reqsmscal.php NN B-Indicator
Call NNP O
specified VBD O
number NN O
3 CD O
reqsmscal.php NN B-Indicator
Exfiltrate NNP O
device NN O
info NN O
, , O
such JJ O
as IN O
phone NN O
model NN O
and CC O
OS NNP O
version NN O
4 CD O
reqsmscal.php NN B-Indicator
Exfiltrate NNP O
a DT O
list NN O
of IN O
all DT O
installed VBN O
applications NNS O
5 CD O
reqsmscal.php NN B-Indicator
Exfiltrate NNP O
default NN O
browser NN O
history NN O
( ( O
limited VBN O
to TO O
a DT O
given VBN O
date NN O
) ) O
6 CD O
reqsmscal.php NN B-Indicator

Exfiltrate NNP O
Chrome NNP O
browser NN O
history NN O
( ( O
limited VBN O
to TO O
a DT O
given VBN O
date NN O
) ) O
7 CD O
reqsmscal.php JJ B-Indicator
Exfiltrate NNP O
memory NN O
card NN O
file NN O
structure NN O
8 CD O
reqsmscal.php NN B-Indicator
Record NNP O
surrounding VBG O
sound NN O
for IN O
80 CD O
seconds NNS O
1 CD O
reqcalllog.php NN B-Indicator
Exfiltrate NNP O
all DT O
call VBP O
logs NNS O
2 CD O
reqcalllog.php JJ B-Indicator
Exfiltrate NNP O
all DT O
SMS NNP O
messages NNS O
3 CD O
reqcalllog.php NN B-Indicator
Upload NNP O
specified VBD O
file NN O
from IN O
the DT O
device NN O
to TO O
the DT O
C2 NNP O
4 CD O
reqcalllog.php NN B-Indicator
Download NNP O
file NN O
from IN O
specified VBN O
URL NNP O
and CC O
save VB O
on IN O
device NN O
5 CD O
reqcalllog.php NN B-Indicator
Delete NNP O
specified VBD O
file JJ O
6,7,8 CD O
reqcalllog.php NN B-Indicator
Commands NNP O
not RB O
yet RB O

implemented VBN O
9 CD O
reqcalllog.php NNS B-Indicator
Take VBP O
photo NN O
( ( O
muted JJ O
audio NN O
) ) O
with IN O
rear JJ O
camera NN O
, , O
send VBP O
to TO O
C2 NNP O
10 CD O
reqcalllog.php NNS B-Indicator
Take VBP O
photo NN O
( ( O
muted JJ O
audio NN O
) ) O
with IN O
front NN O
camera NN O
, , O
send VBP O
to TO O
C2 NNP O
All NNP O
observed VBD O
samples NNS O
with IN O
Smali NNP O
injections NNS O
were VBD O
signed VBN O
by IN O
the DT O
same JJ O
debug NN O
certificate NN O
( ( O
0x936eacbe07f201df CD O
) ) O
. . O

As IN O
we PRP O
know VBP O
from IN O
our PRP$ O
investigation NN O
, , O
traces NNS O
of IN O
the DT O
first JJ O
development NN O
activities NNS O
were VBD O
found VBN O
at IN O
the DT O
end NN O
of IN O
2016 CD O
, , O
but CC O
the DT O
main JJ O
distribution NN O
campaign NN O
began VBD O
in IN O
2018 CD O
( ( O
end NN O
of IN O
2017 CD O
) ) O
. . O

Based VBN O
on IN O
our PRP$ O
detection NN O
statistics NNS O
, , O
the DT O
main JJ O
infection NN O
vector NN O
is VBZ O
the DT O
spread NN O
of IN O
Trojanized NNP O
applications NNS O
directly RB O
to TO O
victims NNS O
via IN O
Telegram NNP O
and CC O
WhatsApp NNP O
messengers NNS O
. . O

There EX O
are VBP O
the DT O
following JJ O
relevant JJ O
detection NN O
paths NNS O
( ( O
the DT O
last JJ O
one NN O
is VBZ O
an DT O
alternative JJ O
Telegram NNP O
client NN O
– NNP O
“ NNP O
Telegram NNP O
X NNP O
“ NNP O
) ) O
: : O
Name NN O
Detection NNP O
path NN O
Sex NNP O
Game NNP O
For IN O
Adults NNP O
18.apk CD B-Indicator
/storage/emulated/0/WhatsApp/Media/WhatsApp NNP B-Indicator
Documents/ NNP I-Indicator
4_6032967490689041387.apk CD I-Indicator
/storage/emulated/0/Telegram/Telegram NNP I-Indicator
Documents/ NNP I-Indicator
Psiphon-v91.apk NNP B-Indicator
/storage/emulated/0/Android/data/org.thunderdog.challegram/files/documents/ NNP B-Indicator
Backdoored NNP O
Open NNP O
Source NNP O
During IN O
the DT O
course NN O

of IN O
our PRP$ O
analysis NN O
, , O
we PRP O
also RB O
found VBD O
samples NNS O
sharing VBG O
code NN O
with IN O
the DT O
ViceLeaker NNP B-Malware
malware NN O
, , O
in IN O
particular JJ O
they PRP O
shared VBD O
a DT O
delimiter NN O
that WDT O
was VBD O
used VBN O
in IN O
both DT O
cases NNS O
to TO O
parse VB O
commands NNS O
from IN O
the DT O
C2 NNP O
server NN O
. . O

This DT O
would MD O
be VB O
a DT O
very RB O
unusual JJ O
coincidence NN O
. . O

Even RB O
when WRB O
a DT O
false JJ O
flag NN O
might MD O
also RB O
be VB O
a DT O
possibility NN O
, , O
we PRP O
consider VBP O
this DT O
to TO O
be VB O
unlikely JJ O
. . O

The DT O
samples NNS O
sharing VBG O
this DT O
overlap NN O
are VBP O
modified VBN O
versions NNS O
of IN O
an DT O
open JJ O
source NN O
Jabber/XMPP NNP B-System
client NN O
called VBN O
“ JJ O
Conversations NNP O
” NN O
with IN O
some DT O
code NN O
additions NNS O
. . O

The DT O
legitimate JJ O
version NN O
of IN O
this DT O
app NN O
is VBZ O
also RB O
available JJ O
on IN O
Google NNP B-System
Play NNP I-System
. . O

The DT O
Conversations NNP O
modified VBD O
samples NNS O
differ VBP O
from IN O
the DT O
original JJ O
one NN O
in IN O
the DT O
getKnownHosts NNS O
method VBP O
that DT O
was VBD O
modified VBN O
to TO O
replace VB O
the DT O
main JJ O
XMPP NN B-System
host NN O
with IN O
the DT O
attackers NNS O
’ VBP O
C2 NNP O
server NN O
: : O
It PRP O
appears VBZ O
that IN O
the DT O
attackers NNS O
were VBD O
using VBG O
a DT O
specific JJ O
C2 NNP O
for IN O
the DT O
use NN O
of IN O
that DT O
app NN O
. . O

Another DT O
important JJ O
modification NN O
is VBZ O
in IN O
the DT O
message NN O
transfer NN O
process NN O
: : O
With IN O
this DT O
modification NN O
, , O
an DT O
application NN O
sends VBZ O
device JJ O
location NN O
coordinates NNS O
with IN O
every DT O
message NN O
. . O

There EX O
are VBP O
also RB O
many JJ O
other JJ O
modifications NNS O
, , O
fully RB O
described VBN O
in IN O
our PRP$ O
private JJ O
report NN O
. . O

In IN O
addition NN O
, , O
we PRP O
did VBD O
not RB O
see VB O
traces NNS O
of IN O
the DT O
Smali NNP O
injection NN O
. . O

In IN O
this DT O
case NN O
we PRP O
found VBD O
traces NNS O
of IN O
dx/dexmerge NN O
compilers NNS O
, , O
which WDT O
means VBZ O
that IN O
, , O
this DT O
time NN O
, , O
the DT O
attackers NNS O
just RB O
imported VBN O
the DT O
original JJ O
source NN O
code NN O
into IN O
an DT O
Android NNP B-System
IDE NNP O
( ( O
such JJ O
as IN O
Android NNP B-System
Studio NNP I-System
, , O
for IN O
instance NN O
) ) O
and CC O
compiled VBD O
it PRP O
with IN O
their PRP$ O
own JJ O
modifications NNS O
. . O

In IN O
addition NN O
to TO O
adding VBG O
the DT O
code NN O
, , O
the DT O
attackers NNS O
also RB O
changed VBD O
the DT O
icon NN O
and CC O
package NN O
name NN O
. . O

We PRP O
do VBP O
not RB O
know VB O
why WRB O
, , O
but CC O
we PRP O
suspect VBP O
that IN O
it PRP O
was VBD O
an DT O
attempt NN O
to TO O
hide VB O
the DT O
origin NN O
of IN O
the DT O
application NN O
. . O

Conversations-based JJ O
app NN O
mimics NNS O
Telegram NNP B-System
messenger NN I-System
Even RB O
when WRB O
we PRP O
originally RB O
thought VBD O
this DT O
was VBD O
a DT O
backdoored JJ O
version NN O
of IN O
the DT O
Conversations NNP O
app NN O
, , O
used VBD O
to TO O
infect VB O
victims NNS O
, , O
we PRP O
didn´t VBP O
discovered VBD O
anything NN O
malicious JJ O
in IN O
it PRP O
. . O

This DT O
brought VBD O
to TO O
us PRP O
the DT O
hypothesis NN O
that IN O
this DT O
might MD O
be VB O
a DT O
version NN O
used VBN O
by IN O
the DT O
group NN O
behind IN O
ViceLeaker NNP B-Malware
for IN O
internal JJ O
communication NN O
or CC O
for IN O
other JJ O
, , O
unclear JJ O
purposes NNS O
. . O

All PDT O
the DT O
detections NNS O
of IN O
this DT O
backdoored VBN O
app NN O
were VBD O
geolocated VBN O
in IN O
Iran NNP O
. . O

Backdoored NNP O
Conversations NNP O
C2 NNP O
server NN O
analysis NN O
During IN O
the DT O
analysis NN O
of IN O
the DT O
Smali NNP O
injected VBD O
apps NNS O
and CC O
their PRP$ O
C2 NNP O
server NN O
infrastructure NN O
we PRP O
hadn VBP O
’ JJ O
t NN O
found VBD O
any DT O
interesting JJ O
clues NNS O
, , O
but CC O
things NNS O
changed VBD O
when WRB O
we PRP O
looked VBD O
at IN O
the DT O
C2 NNP O
server NN O
of IN O
the DT O
linked VBN O
Conversations NNP O
messenger NN O
. . O

It PRP O
uses VBZ O
“ JJ O
185.51.201 CD B-Indicator
[ NN I-Indicator
. . I-Indicator

] RB I-Indicator
133 CD I-Indicator
” NN O
as IN O
a DT O
main JJ O
C2 NNP O
address NN O
, , O
and CC O
there EX O
is VBZ O
only RB O
one CD O
domain NN O
that WDT O
is VBZ O
hosted VBN O
on IN O
this DT O
dedicated VBN O
server NN O
– NN O
iliageram NN B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
ir NN I-Indicator
. . O

Note NN O
that IN O
we PRP O
later RB O
found VBD O
versions NNS O
that WDT O
used VBD O
the DT O
domain NN O
as IN O
a DT O
C2 NNP O
directly RB O
instead RB O
of IN O
the DT O
IP NNP O
address NN O
. . O

The DT O
record NN O
contains VBZ O
a DT O
personal JJ O
email NN O
address NN O
: : O
WHOIS JJ O
records NNS O
of IN O
C2 NNP O
server NN O
exposing VBG O
the DT O
attacker NN O
’ NNP O
s VBD O
email JJ O
address NN O
We PRP O
were VBD O
aware JJ O
of IN O
the DT O
possibility NN O
that IN O
the DT O
attackers NNS O
might MD O
be VB O
using VBG O
a DT O
compromised JJ O
email NN O
account NN O
, , O
so IN O
we PRP O
dug VBP O
deeper JJR O
to TO O
find VB O
more JJR O
information NN O
related VBN O
to TO O
this DT O
email NN O
address NN O
. . O

A DT O
quick JJ O
search NN O
produced VBN O
results NNS O
about IN O
a DT O
personal JJ O
page NN O
and CC O
, , O
what WP O
is VBZ O
more JJR O
interesting JJ O
, , O
a DT O
GitHub NNP B-Organization
account NN O
that WDT O
contains VBZ O
a DT O
forked JJ O
Conversation NNP O
repository NN O
. . O

Related JJ O
Github NNP B-Organization
account NN O
contains NNS O
forked VBD O
Conversations NNP O
repository NN O
Summarizing VBG O
all PDT O
the DT O
found NN O
clues NNS O
, , O
we PRP O
have VBP O
the DT O
following JJ O
attribution NN O
flow NN O
: : O
Conclusion NN O
The DT O
operation NN O
of IN O
ViceLeaker NNP B-Malware
is VBZ O
still RB O
ongoing JJ O
, , O
as IN O
is VBZ O
our PRP$ O
research NN O
. . O

The DT O
attackers NNS O
have VBP O
taken VBN O
down RP O
their PRP$ O
communication NN O
channels NNS O
and CC O
are VBP O
probably RB O
looking VBG O
for IN O
ways NNS O
to TO O
assemble VB O
their PRP$ O
tools NNS O
in IN O
a DT O
different JJ O
manner NN O
. . O

Kaspersky NNP B-Organization
detects NNS O
and CC O
blocks NNS O
samples NNS O
of IN O
the DT O
ViceLeaker NNP B-Malware
operation NN O
using VBG O
the DT O
following JJ O
verdict NN O
: : O
Trojan-Spy.AndroidOS.ViceLeaker NN B-Indicator
. . I-Indicator

* NNS I-Indicator
Actually RB O
, , O
we PRP O
are VBP O
currently RB O
investigating VBG O
whether IN O
this DT O
group NN O
might MD O
also RB O
be VB O
behind IN O
a DT O
large-scale JJ O
web-oriented JJ O
attack NN O
at IN O
the DT O
end NN O
of IN O
2018 CD O
using VBG O
code NN O
injection NN O
and CC O
exploiting VBG O
SQL NNP B-Vulnerability
vulnerabilities NNS I-Vulnerability
. . O

Even RB O
when WRB O
this DT O
would MD O
not RB O
be VB O
directly RB O
related VBN O
to TO O
the DT O
Android NNP B-System
malware NN O
described VBN O
in IN O
this DT O
blogpost NN O
, , O
it PRP O
would MD O
be VB O
an DT O
indicator NN O
of IN O
wider NN O
capabilities NNS O
and CC O
objectives NNS O
of IN O
this DT O
actor NN O
. . O

XLoader NN B-Malware
Android NNP B-System
Spyware NNP O
and CC O
Banking NNP O
Trojan NNP O
Distributed NNP O
via IN O
DNS NNP O
Spoofing NNP O
We PRP O
have VBP O
been VBN O
detecting VBG O
a DT O
new JJ O
wave NN O
of IN O
network NN O
attacks NNS O
since IN O
early JJ O
March NNP O
, , O
which WDT O
, , O
for IN O
now RB O
, , O
are VBP O
targeting VBG O
Japan NNP O
, , O
Korea NNP O
, , O
China NNP O
, , O
Taiwan NNP O
, , O
and CC O
Hong NNP O
Kong NNP O
. . O

Trend NNP B-Organization
Micro NNP I-Organization
detects VBZ O
these DT O
as IN O
ANDROIDOS_XLOADER.HRX NNP B-Indicator
. . O

By IN O
: : O
Trend NNP B-Organization
Micro NNP I-Organization
April NNP O
20 CD O
, , O
2018 CD O
We PRP O
have VBP O
been VBN O
detecting VBG O
a DT O
new JJ O
wave NN O
of IN O
network NN O
attacks NNS O
since IN O
early JJ O
March NNP O
, , O
which WDT O
, , O
for IN O
now RB O
, , O
are VBP O
targeting VBG O
Japan NNP O
, , O
Korea NNP O
, , O
China NNP O
, , O
Taiwan NNP O
, , O
and CC O
Hong NNP O
Kong NNP O
. . O

The DT O
attacks NNS O
use VBP O
Domain NNP O
Name NNP O
System NNP O
( ( O
DNS NNP O
) ) O
cache NN O
poisoning/DNS NN O
spoofing NN O
, , O
possibly RB O
through IN O
infringement NN O
techniques NNS O
such JJ O
as IN O
brute-force NN O
or CC O
dictionary JJ O
attacks NNS O
, , O
to TO O
distribute VB O
and CC O
install VB O
malicious JJ O
Android NNP B-System
apps NN O
. . O

Trend NNP B-Organization
Micro NNP I-Organization
detects VBZ O
these DT O
as IN O
ANDROIDOS_XLOADER.HRX NNP B-Indicator
. . O

These DT O
malware NN O
pose RB O
as IN O
legitimate JJ O
Facebook NNP B-System
or CC O
Chrome NNP B-System
applications NNS O
. . O

They PRP O
are VBP O
distributed VBN O
from IN O
polluted VBN O
DNS NNP O
domains VBZ O
that IN O
send VB O
a DT O
notification NN O
to TO O
an DT O
unknowing JJ O
victim NN O
’ NNP O
s NN O
device NN O
. . O

The DT O
malicious JJ O
apps NN O
can MD O
steal VB O
personally RB O
identifiable JJ O
and CC O
financial JJ O
data NNS O
and CC O
install VB O
additional JJ O
apps NN O
. . O

XLoader NN B-Malware
can MD O
also RB O
hijack VB O
the DT O
infected JJ O
device NN O
( ( O
i.e. FW O
, , O
send VB O
SMSs NNP O
) ) O
and CC O
sports NNS O
self-protection/persistence NN O
mechanisms NNS O
through IN O
device NN O
administrator NN O
privileges NNS O
. . O

Infection NN O
Chain NNP O
As IN O
with IN O
our PRP$ O
earlier JJR O
reports NNS O
in IN O
late JJ O
March NNP O
, , O
the DT O
attack NN O
chain NN O
involves VBZ O
diverting VBG O
internet NN O
traffic NN O
to TO O
attacker-specified JJ O
domains NNS O
by IN O
compromising VBG O
and CC O
overwriting VBG O
the DT O
router NN O
’ NNP O
s NN O
DNS NNP O
settings NNS O
. . O

A DT O
fake JJ O
alert NN O
will MD O
notify VB O
and CC O
urge VB O
the DT O
user NN O
to TO O
access NN O
the DT O
malicious JJ O
domain NN O
and CC O
download NN O
XLoader NN B-Malware
. . O

Technical JJ O
Analysis NNP O
XLoader NNP B-Malware
first RB O
loads VBZ O
the DT O
encrypted JJ O
payload NN O
from IN O
Assets/db NNP B-Indicator
as IN O
test.dex NN B-Indicator
to TO O
drop VB O
the DT O
necessary JJ O
modules NNS O
then RB O
requests NNS O
for IN O
device NN O
administrator NN O
privileges NNS O
. . O

Once RB O
granted VBN O
permission NN O
, , O
it PRP O
hides VBZ O
its PRP$ O
icon NN O
from IN O
the DT O
launcher JJR O
application NN O
list NN O
then RB O
starts VBZ O
a DT O
service NN O
that IN O
it PRP O
keeps VBZ O
running VBG O
in IN O
the DT O
background NN O
. . O

The DT O
background NN O
service NN O
uses VBZ O
the DT O
reflection NN O
technique NN O
( ( O
a DT O
feature NN O
that WDT O
allows VBZ O
the DT O
inspection NN O
and CC O
modification NN O
of IN O
Java-based JJ O
programs NNS O
’ VBP O
internal JJ O
properties NNS O
) ) O
to TO O
invoke VB O
the DT O
method JJ O
com.Loader.start NN B-Indicator
in IN O
the DT O
payload NN O
. . O

Monitoring VBG O
Broadcast NNP O
Events NNS O
XLoader VBP B-Malware
registers NNS O
many JJ O
broadcast NN O
receivers NNS O
in IN O
the DT O
payload NN O
dynamically RB O
( ( O
to TO O
monitor VB O
broadcast JJ O
events NNS O
sent VBD O
between IN O
system NN O
and CC O
applications NNS O
) ) O
. . O

Registering VBG O
broadcast NN O
receivers NNS O
enable JJ O
XLoader NN B-Malware
to TO O
trigger VB O
its PRP$ O
malicious JJ O
routines NNS O
. . O

Here RB O
is VBZ O
a DT O
list NN O
of IN O
broadcast JJ O
actions NNS O
: : O
android.provider.Telephony.SMS_RECEIVED NN B-Indicator
android.net.conn.CONNECTIVITY_CHANGE NNS B-Indicator
android.intent.action.BATTERY_CHANGED VBP B-Indicator
android.intent.action.USER_PRESENT JJ B-Indicator
android.intent.action.PHONE_STATE NN B-Indicator
android.net.wifi.SCAN_RESULTS NN B-Indicator
android.intent.action.PACKAGE_ADDED NN B-Indicator
android.intent.action.PACKAGE_REMOVED NN B-Indicator
android.intent.action.SCREEN_OFF NN B-Indicator
android.intent.action.SCREEN_ON NN B-Indicator

android.media.RINGER_MODE_CHANGED JJ B-Indicator
android.sms.msg.action.SMS_SEND NN B-Indicator
android.sms.msg.action.SMS_DELIVERED NN B-Indicator
Creating VBG O
a DT O
Web NNP O
Server NNP O
to TO O
Phish VB O
XLoader NNP B-Malware
creates VBZ O
a DT O
provisional JJ O
web NN O
server NN O
to TO O
receive VB O
the DT O
broadcast NN O
events NNS O
. . O

It PRP O
can MD O
also RB O
create VB O
a DT O
simple JJ O
HTTP NNP O
server NN O
on IN O
the DT O
infected JJ O
device NN O
to TO O
deceive VB O
victims NNS O
. . O

It PRP O
shows VBZ O
a DT O
web JJ O
phishing NN O
page NN O
whenever WRB O
the DT O
affected JJ O
device NN O
receives VBZ O
a DT O
broadcast JJ O
event NN O
( ( O
i.e. FW O
, , O
if IN O
a DT O
new JJ O
package NN O
is VBZ O
installed VBN O
or CC O
if IN O
the DT O
device NN O
’ NNP O
s NN O
screen NN O
is VBZ O
on IN O
) ) O
to TO O
steal VB O
personal JJ O
data NNS O
, , O
such JJ O
as IN O
those DT O
keyed VBN O
in IN O
for IN O
banking NN O
apps NN O
. . O

The DT O
phishing NN O
page NN O
is VBZ O
translated VBN O
in IN O
Korean NNP O
, , O
Japanese JJ O
, , O
Chinese JJ O
, , O
and CC O
English NNP O
, , O
which WDT O
are VBP O
hardcoded VBN O
in IN O
the DT O
payload NN O
. . O

It PRP O
will MD O
appear VB O
differently RB O
to TO O
users NNS O
depending VBG O
on IN O
the DT O
language NN O
set VBN O
on IN O
the DT O
device NN O
. . O

XLoader NN B-Malware
as IN O
Spyware NNP O
and CC O
Banking NNP O
Trojan NNP O
XLoader NN B-Indicator
can MD O
also RB O
collect VB O
information NN O
related VBN O
to TO O
usage NN O
of IN O
apps NN O
installed VBN O
in IN O
the DT O
device NN O
. . O

Its PRP$ O
data-stealing JJ O
capabilities NNS O
include VBP O
collecting VBG O
SMSs NNP O
after IN O
receiving VBG O
an DT O
SMS-related JJ O
broadcast NN O
event NN O
and CC O
covertly RB O
recording VBG O
phone NN O
calls NNS O
. . O

XLoader NN B-Malware
can MD O
also RB O
hijack VB O
accounts NNS O
linked VBN O
to TO O
financial JJ O
or CC O
game-related JJ O
apps NN O
installed VBN O
on IN O
the DT O
affected JJ O
device NN O
. . O

XLoader NN B-Malware
can MD O
also RB O
start VB O
other JJ O
attacker-specified JJ O
packages NNS O
. . O

A DT O
possible JJ O
attack NN O
scenario NN O
involves VBZ O
replacing VBG O
legitimate JJ O
apps NN O
with IN O
repackaged JJ O
or CC O
malicious JJ O
versions NNS O
. . O

By IN O
monitoring VBG O
the DT O
package NN O
installation NN O
broadcast NN O
event NN O
, , O
XLoader NN B-Malware
can MD O
start VB O
their PRP$ O
packages NNS O
. . O

This DT O
enables VBZ O
it PRP O
to TO O
launch VB O
malicious JJ O
apps NNS O
without IN O
the DT O
user NN O
’ NNP O
s NN O
awareness NN O
and CC O
explicit JJ O
consent NN O
. . O

We PRP O
reverse VBP O
engineered VBN O
XLoader NN B-Malware
and CC O
found VBD O
that IN O
it PRP O
appears VBZ O
to TO O
target VB O
South NNP O
Korea-based JJ O
banks NNS O
and CC O
game NN O
development NN O
companies NNS O
. . O

XLoader NN B-Malware
also RB O
prevents VBZ O
victims NNS O
from IN O
accessing VBG O
the DT O
device NN O
’ NNP O
s NN O
settings NNS O
or CC O
using VBG O
a DT O
known VBN O
antivirus NN O
( ( O
AV NNP O
) ) O
app NN O
in IN O
the DT O
country NN O
. . O

XLoader NN B-Malware
can MD O
also RB O
load VB O
multiple RB O
malicious JJ O
modules NNS O
to TO O
receive VB O
and CC O
execute VB O
commands NNS O
from IN O
its PRP$ O
remote JJ O
command-and-control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server RB O
, , O
as IN O
shown VBN O
below IN O
: : O
Here RB O
’ VBZ O
s PRP O
a DT O
list NN O
of IN O
the DT O
modules NNS O
and CC O
their PRP$ O
functions NNS O
: : O
sendSms NN O
— NNP O
send NN O
SMS/MMS NNP O
to TO O
a DT O
specified VBN O
address NN O
setWifi NN O
— NNP O
enable NN O
or CC O
disable JJ O
Wi-Fi JJ O
connection NN O
gcont NN O
— NN O
collect VBP O
all PDT O
the DT O
device NN O
’ NNP O
s NN O
contacts NNS O
lock VBP O
— NNP O
currently RB O
just RB O
an DT O
input NN O
lock NN O
status NN O
in IN O
the DT O
settings NNS O
( ( O
pref NN O
) ) O
file NN O
, , O
but CC O
may MD O
be VB O
used VBN O
as IN O
a DT O
screenlocking NN O
ransomware NN O
bc NN O
— NNP O
collect VBP O
all DT O
contacts NNS O

from IN O
the DT O
Android NNP B-System
device NN O
and CC O
SIM NNP O
card RB O
setForward VBD O
— NNP O
currently RB O
not RB O
implemented VBN O
, , O
but CC O
can MD O
be VB O
used VBN O
to TO O
hijack VB O
the DT O
infected JJ O
device NN O
getForward NN O
— NNP O
currently RB O
not RB O
implemented VBN O
, , O
but CC O
can MD O
be VB O
used VBN O
to TO O
hijack VB O
the DT O
infected JJ O
device NN O
hasPkg NN O
— NNP O
check VB O
the DT O
device NN O
whether IN O
a DT O
specified JJ O
app NN O
is VBZ O
installed VBN O
or CC O
not RB O
setRingerMode JJ O
— NN O
set VBD O
the DT O
device NN O
’ NNP O
s NN O
ringer NN O
mode NN O
setRecEnable JJ O
— NN O
set VBD O
the DT O
device NN O
’ NNP O
s NN O
ringer NN O
mode NN O
as IN O
silent JJ O
reqState NN O
— NNP O
get VB O
a DT O
detailed JJ O
phone NN O
connection NN O
status NN O
, , O
which WDT O
includes VBZ O
activated JJ O
network NN O
and CC O
Wi-Fi NNP O
( ( O
with IN O
or CC O
without IN O
password NN O
) ) O
showHome NN O
— NN O

force NN O
the DT O
device NN O
’ NNP O
s VBZ O
back RB O
to TO O
the DT O
home NN O
screen NN O
getnpki NN O
: : O
get VB O
files/content NN O
from IN O
the DT O
folder NN O
named VBN O
NPKI NNP O
( ( O
contains NNS O
certificates NNS O
related VBD O
to TO O
financial JJ O
transactions NNS O
) ) O
http VBP O
— JJ O
access NN O
a DT O
specified VBN O
network NN O
using VBG O
HttpURLConnection NNP O
onRecordAction NN O
— NNP O
simulate VB O
a DT O
number-dialed JJ O
tone NN O
call NN O
— NNP O
call VB O
a DT O
specified JJ O
number NN O
get_apps NN O
— NNP O
get VB O
all PDT O
the DT O
apps NN O
installed VBN O
on IN O
the DT O
device NN O
show_fs_float_window NN O
— NNP O
show VBP O
a DT O
full-screen JJ O
window NN O
for IN O
phishing NN O
Of IN O
note NN O
is VBZ O
XLoader NNP B-Malware
’ NNP O
s JJ O
abuse NN O
of IN O
the DT O
WebSocket NNP O
protocol NN O
( ( O
supported VBN O
in IN O
many JJ O
browsers NNS O

and CC O
web VB O
applications NNS O
) ) O
via IN O
ws NN O
( ( O
WebSockets NNPS O
) ) O
or CC O
wss NN O
( ( O
WebSockets NNPS O
over IN O
SSL/TLS NNP O
) ) O
to TO O
communicate VB O
with IN O
its PRP$ O
C NNP O
& CC O
C NNP O
servers NNS O
. . O

The DT O
URLs NNP O
— NNP O
abused VBD O
as IN O
part NN O
of IN O
XLoader NNP B-Malware
’ NNP O
s NNP O
C NNP O
& CC O
C NNP O
— NNP O
are VBP O
hidden VBN O
in IN O
three CD O
webpages NNS O
, , O
and CC O
the DT O
C NNP O
& CC O
C NNP O
server NN O
that WDT O
XLoader VBZ B-Malware
connects NNS O
to TO O
differ VB O
per IN O
region NN O
. . O

The DT O
abuse NN O
of IN O
the DT O
WebSocket NNP O
protocol NN O
provides VBZ O
XLoader NN B-Malware
with IN O
a DT O
persistent JJ O
connection NN O
between IN O
clients NNS O
and CC O
servers NNS O
where WRB O
data NNS O
can MD O
be VB O
transported VBN O
any DT O
time NN O
. . O

XLoader NN B-Malware
abuses VBZ O
the DT O
MessagePack NNP O
( ( O
a DT O
data NN O
interchange NN O
format NN O
) ) O
to TO O
package VB O
the DT O
stolen VBN O
data NNS O
and CC O
exfiltrate VB O
it PRP O
via IN O
the DT O
WebSocket NNP O
protocol NN O
for IN O
faster JJR O
and CC O
more RBR O
efficient JJ O
transmission NN O
. . O

Mitigations NNS O
XLoader VBP B-Malware
will MD O
not RB O
download VB O
malicious JJ O
apps NN O
if IN O
the DT O
Android NNP O
device NN O
uses VBZ O
a DT O
mobile JJ O
data NN O
connection NN O
. . O

Nevertheless RB O
, , O
users NNS O
should MD O
practice NN O
proper IN O
security NN O
hygiene NN O
to TO O
mitigate VB O
threats NNS O
that WDT O
may MD O
take VB O
advantage NN O
of IN O
a DT O
home NN O
or CC O
business NN O
router NN O
’ NNP O
s VBZ O
security NN O
gaps NNS O
. . O

Employ NNP O
stronger NN O
credentials NNS O
, , O
for IN O
instance NN O
, , O
to TO O
make VB O
them PRP O
less RBR O
susceptible JJ O
to TO O
unauthorized JJ O
access NN O
. . O

Regularly RB O
update JJ O
and CC O
patch VB O
the DT O
router NN O
’ NNP O
s NN O
software NN O
and CC O
firmware NN O
to TO O
prevent VB O
exploits NNS O
, , O
and CC O
enable VB O
its PRP$ O
built-in JJ O
firewall NN O
. . O

For IN O
system NN O
administrators NNS O
and CC O
information NN O
security NN O
professionals NNS O
, , O
configuring VBG O
the DT O
router NN O
to TO O
be VB O
more RBR O
resistant JJ O
to TO O
attacks NNS O
like IN O
DNS NNP O
cache NN O
poisoning NN O
can MD O
help VB O
mitigate VB O
similar JJ O
threats NNS O
. . O

Everyday JJ O
users NNS O
can MD O
do VB O
the DT O
same JJ O
by IN O
checking VBG O
the DT O
router NN O
’ NNP O
s NN O
DNS NNP O
settings NNS O
if IN O
they PRP O
’ VBP O
ve RB O
been VBN O
modified VBN O
. . O

Even RB O
threats NNS O
like IN O
DNS NNP O
cache NN O
poisoning VBG O
employ JJ O
social JJ O
engineering NN O
, , O
so IN O
users NNS O
should MD O
also RB O
be VB O
more RBR O
prudent JJ O
against IN O
suspicious JJ O
or CC O
unknown JJ O
messages NNS O
that WDT O
have VBP O
telltale JJ O
signs NNS O
of IN O
malware NN O
. . O

We PRP O
have VBP O
worked VBN O
with IN O
Google NNP B-Organization
and CC O
they PRP O
ensure VB O
that IN O
Google NNP B-System
Play NNP I-System
Protect NNP I-System
proactively RB O
catches VBZ O
apps NN O
of IN O
this DT O
nature NN O
. . O

No DT O
instances NNS O
of IN O
these DT O
apps NNS O
were VBD O
found VBN O
in IN O
Google NNP B-System
Play NNP I-System
. . O

September NNP O
08 CD O
, , O
2020 CD O
TikTok NNP B-System
Spyware NNP O
A NNP O
detailed JJ O
analysis NN O
of IN O
spyware NN O
masquerading VBG O
as IN O
TikTok NNP B-System
A NNP O
recent JJ O
threat NN O
to TO O
ban VB O
TikTok NNP B-System
in IN O
the DT O
United NNP O
States NNPS O
has VBZ O
taken VBN O
the DT O
internet NN O
by IN O
storm NN O
and CC O
received VBD O
mixed JJ O
reactions NNS O
from IN O
social JJ O
media NNS O
and CC O
internet NN O
users NNS O
. . O

U.S. NNP O
President NNP O
Donald NNP O
Trump NNP O
has VBZ O
ordered VBN O
ByteDance NNP B-Organization
, , O
the DT O
parent NN O
company NN O
of IN O
TikTok NNP B-System
, , O
to TO O
sell VB O
its PRP$ O
U.S. NNP O
TikTok NNP B-System
assets NNS O
and CC O
also RB O
issued VBN O
executive NN O
orders NNS O
that WDT O
would MD O
ban VB O
the DT O
social JJ O
media NNS O
apps JJ O
TikTok NNP B-System
and CC O
WeChat NNP B-System
from IN O
operating NN O
in IN O
the DT O
U.S. NNP O
if IN O
the DT O
sale NN O
doesn NN O
’ NNP O
t NN O
happen NN O
in IN O
the DT O
next JJ O
few JJ O
weeks NNS O
. . O

On IN O
the DT O
other JJ O
side NN O
, , O
ByteDance NNP B-Organization
has VBZ O
filed VBN O
a DT O
lawsuit NN O
suing VBG O
the DT O
Trump NNP O
administration NN O
. . O

When WRB O
popular JJ O
applications NNS O
come VBP O
under IN O
fire NN O
and CC O
are VBP O
featured VBN O
prominently RB O
in IN O
the DT O
news NN O
, , O
hackers NNS O
get VBP O
excited VBN O
as IN O
these DT O
newsworthy JJ O
apps NN O
can MD O
become VB O
their PRP$ O
latest JJS O
target NN O
. . O

And CC O
TikTok NNP B-System
is VBZ O
no DT O
exception NN O
. . O

Generally RB O
, , O
after IN O
an DT O
application NN O
gets VBZ O
banned VBN O
from IN O
an DT O
official JJ O
app NN O
store NN O
, , O
such JJ O
as IN O
Google NNP B-System
Play NNP I-System
, , O
users NNS O
try VBP O
to TO O
find VB O
alternative JJ O
ways NNS O
to TO O
download VB O
the DT O
app NN O
. . O

In IN O
doing VBG O
so RB O
, , O
users NNS O
can MD O
become VB O
victims NNS O
to TO O
malicious JJ O
apps JJ O
portraying VBG O
themselves PRP O
as IN O
the DT O
original JJ O
app NN O
. . O

Recently RB O
there EX O
was VBD O
a DT O
huge JJ O
wave NN O
of IN O
SMS NNP O
messages NNS O
, , O
as RB O
well RB O
as IN O
Whatsapp NNP B-System
messages NNS O
, , O
making VBG O
the DT O
rounds NNS O
asking VBG O
users NNS O
to TO O
download VB O
the DT O
latest JJS O
version NN O
of IN O
TikTok NNP B-System
at IN O
hxxp NN B-Indicator
: : I-Indicator
//tiny JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
cc/TiktokPro NN I-Indicator
. . O

In IN O
reality NN O
, , O
this DT O
downloaded JJ O
app NN O
is VBZ O
a DT O
fake JJ O
app NN O
that WDT O
asks VBZ O
for IN O
credentials NNS O
and CC O
Android NNP B-System
permissions NNS O
( ( O
including VBG O
camera NN O
and CC O
phone NN O
permissions NNS O
) ) O
, , O
resulting VBG O
in IN O
the DT O
user NN O
being VBG O
bombarded VBN O
with IN O
advertisements NNS O
. . O

Recently RB O
, , O
we PRP O
have VBP O
come VBN O
across IN O
another DT O
variant NN O
of IN O
this DT O
app NN O
portraying VBG O
itself PRP O
as IN O
TikTok NNP B-System
Pro NNP I-System
, , O
but CC O
this DT O
is VBZ O
a DT O
full-fledged JJ O
spyware NN O
with IN O
premium JJ O
features NNS O
to TO O
spy VB O
on IN O
victim NN O
with IN O
ease NN O
. . O

( ( O
Please NNP O
note VB O
this DT O
is VBZ O
a DT O
different JJ O
app NN O
and CC O
not RB O
the DT O
same JJ O
as IN O
the DT O
one CD O
being VBG O
spread VBN O
by IN O
hxxp NN B-Indicator
: : I-Indicator
//tiny JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
cc/TiktokPro NN I-Indicator
. . I-Indicator

) ) I-Indicator
Technical JJ O
Analysis NNP O
App NNP O
Name NN O
: : O
TikTok NNP B-System
Pro NNP I-System
Hash NNP O
: : O
9fed52ee7312e217bd10d6a156c8b988 CD B-Indicator
Package NN O
Name NN O
: : O
com.example.dat.a8andoserverx NN B-Indicator
Upon IN O
installation NN O
, , O
the DT O
spyware NN O
portrays VBZ O
itself PRP O
as IN O
TikTok NNP B-System
using VBG O
the DT O
name NN O
TikTok NNP B-System
Pro NNP I-System
. . O

As RB O
soon RB O
as IN O
a DT O
user NN O
tries VBZ O
to TO O
open VB O
the DT O
app NN O
, , O
it PRP O
launches VBZ O
a DT O
fake JJ O
notification NN O
and CC O
soon RB O
the DT O
notification NN O
as RB O
well RB O
as IN O
the DT O
app NN O
icon NN O
disappears NNS O
. . O

This DT O
fake JJ O
notification NN O
tactic NN O
is VBZ O
used VBN O
to TO O
redirect VB O
the DT O
user NN O
's POS O
attention NN O
, , O
meanwhile RB O
the DT O
app NN O
hides VBZ O
itself PRP O
, , O
making VBG O
the DT O
user NN O
believe VBP O
the DT O
app NN O
to TO O
be VB O
faulty NN O
. . O

This DT O
functionality NN O
can MD O
be VB O
seen VBN O
in IN O
Figure NNP O
1 CD O
. . O

App NNP O
Icon NNP O
Figure NNP O
1 CD O
: : O
App NNP O
icon NN O
and CC O
fake JJ O
notification NN O
. . O

Behind IN O
the DT O
scenes NNS O
, , O
there EX O
are VBP O
number NN O
of IN O
process NN O
occurring VBG O
simultaneously RB O
. . O

First RB O
, , O
an DT O
activity NN O
named VBN O
MainActivity NNP O
fires VBZ O
up RP O
, , O
taking VBG O
care NN O
of IN O
hiding VBG O
the DT O
icon NN O
and CC O
showing VBG O
the DT O
fake JJ O
notification NN O
. . O

It PRP O
also RB O
starts VBZ O
an DT O
Android NNP B-System
service NN O
named VBN O
MainService NNP O
. . O

The DT O
spyware NN O
also RB O
appears VBZ O
to TO O
have VB O
an DT O
additional JJ O
payload NN O
stored VBN O
under IN O
the DT O
/res/raw/ NNP O
directory NN O
. . O

This DT O
is VBZ O
a DT O
common JJ O
technique NN O
used VBN O
by IN O
malware NN O
developers NNS O
to TO O
bundle VB O
the DT O
main JJ O
payload NN O
inside IN O
the DT O
Android NNP B-System
package NN O
to TO O
avoid VB O
easy JJ O
detection NN O
. . O

As IN O
seen VBN O
in IN O
Figure NNP O
2 CD O
, , O
the DT O
app NN O
tries VBZ O
to TO O
open VB O
the DT O
payload NN O
from IN O
the DT O
/res/raw/ NNP O
directory NN O
and CC O
generate VB O
an DT O
additional JJ O
Android NNP B-System
Package NNP I-System
Kit NNP I-System
( ( O
APK NNP O
) ) O
named VBD O
.app.apk NN B-Indicator
: : O
Decoy NNP O
Code NNP O
Figure NNP O
2 CD O
: : O
The DT O
decoy NN O
code NN O
for IN O
the DT O
fake JJ O
TikTok NNP B-System
. . O

Upon IN O
analysis NN O
, , O
we PRP O
discovered VBD O
that IN O
this DT O
is VBZ O
a DT O
decoy JJ O
functionality NN O
and CC O
no DT O
new JJ O
payload NN O
is VBZ O
generated VBN O
. . O

The DT O
conditions NNS O
to TO O
build VB O
an DT O
additional JJ O
payload NN O
are VBP O
never RB O
met VBN O
. . O

Going VBG O
one CD O
step NN O
further RB O
, , O
we PRP O
rebuilt VBP O
the DT O
malware NN O
to TO O
execute VB O
the DT O
apparent JJ O
functionality NN O
of IN O
generating VBG O
a DT O
payload NN O
, , O
but CC O
discovered VBD O
that IN O
the DT O
APK NNP O
stored VBD O
in IN O
the DT O
/res/raw/ NNP O
directory NN O
is VBZ O
empty JJ O
. . O

The DT O
placement NN O
of IN O
the DT O
decoy JJ O
functionality NN O
is VBZ O
likely JJ O
designed VBN O
to TO O
confuse VB O
the DT O
malware NN O
researchers NNS O
. . O

It PRP O
is VBZ O
also RB O
possible JJ O
that IN O
this DT O
functionality NN O
is VBZ O
under IN O
development NN O
, , O
making VBG O
this DT O
placeholder NN O
code NN O
incomplete NN O
. . O

Coming VBG O
back RB O
to TO O
the DT O
execution NN O
flow NN O
, , O
once RB O
the DT O
spyware NN O
hides VBZ O
itself PRP O
, , O
it PRP O
starts VBZ O
an DT O
Android NNP B-System
service NN O
named VBN O
MainService NNP O
. . O

Android NNP B-System
services NNS O
are VBP O
components NNS O
that WDT O
can MD O
be VB O
made VBN O
to TO O
execute VB O
independently RB O
in IN O
the DT O
background NN O
without IN O
the DT O
victim NN O
's POS O
knowledge NN O
. . O

MainService NNP O
is VBZ O
the DT O
brain NN O
of IN O
this DT O
spyware NN O
and CC O
controls NNS O
almost RB O
everything—from IN O
stealing VBG O
the DT O
victim NN O
's POS O
data NNS O
to TO O
deleting VBG O
it PRP O
. . O

All DT O
of IN O
its PRP$ O
capabilities NNS O
are VBP O
discussed VBN O
later RB O
in IN O
this DT O
blog NN O
. . O

Hide NNP O
Icon NNP O
Figure NNP O
3 CD O
: : O
Code NN O
showing VBG O
the DT O
hiding NN O
icon NN O
and CC O
starting VBG O
service NN O
. . O

As IN O
MainService NNP O
is VBZ O
the DT O
main JJ O
controller NN O
, , O
the DT O
developer NN O
has VBZ O
taken VBN O
the DT O
appropriate JJ O
actions NNS O
to TO O
keep VB O
it PRP O
functional JJ O
and CC O
running VBG O
at IN O
all DT O
times NNS O
. . O

The DT O
malware NN O
developer NN O
uses VBZ O
various JJ O
tactics NNS O
to TO O
do VB O
so RB O
, , O
and CC O
one CD O
of IN O
them PRP O
is VBZ O
using VBG O
Android NNP B-System
's POS O
broadcast NN O
receivers NNS O
. . O

Broadcast NN O
receivers NNS O
are VBP O
components NNS O
that IN O
allow VBP O
you PRP O
to TO O
register VB O
for IN O
various JJ O
Android NNP B-System
events NNS O
. . O

In IN O
this DT O
case NN O
, , O
it PRP O
registers VBZ O
three CD O
broadcast NN O
receivers NNS O
: : O
MyReceiver NNP O
- : O
Triggers NNS O
when WRB O
the DT O
device NN O
is VBZ O
booted VBN O
. . O

Intercept NNP O
Call NNP O
- : O
Triggers NNS O
on IN O
incoming NN O
and CC O
outgoing VBG O
calls NNS O
. . O

AlarmReceiver NNP O
- : O
Triggers NNS O
every DT O
three CD O
minutes NNS O
. . O

MyReceiver NNP O
and CC O
AlarmReceiver NNP O
start VBP O
the DT O
MainService NNP O
whenever WRB O
appropriate JJ O
events NNS O
occur VBP O
. . O

This DT O
tactic JJ O
is VBZ O
very RB O
common JJ O
among IN O
malware JJ O
developers NNS O
to TO O
ensure VB O
the DT O
malware NN O
is VBZ O
not RB O
killed VBN O
by IN O
the DT O
Android NNP B-System
OS NNP O
or CC O
by IN O
any DT O
other JJ O
means NNS O
. . O

Figure NN O
4 CD O
shows NNS O
MyReceiver NNP O
in IN O
action NN O
where WRB O
it PRP O
eventually RB O
calls VBZ O
the DT O
MainService NNP O
service NN O
. . O

Broadcast NNP O
Receiver NNP O
Figure NNP O
4 CD O
: : O
MyReceiver NN O
broadcast NN O
receiver NN O
. . O

The DT O
InterceptCall NNP O
receiver NN O
is VBZ O
triggered VBN O
whenever WRB O
there EX O
is VBZ O
an DT O
incoming NN O
or CC O
outgoing VBG O
call NN O
. . O

It PRP O
sets VBZ O
particular JJ O
parameters NNS O
in IN O
relation NN O
to TO O
call VB O
details NNS O
and CC O
a DT O
further JJ O
service NN O
named VBN O
calls VBZ O
takes VBZ O
the DT O
control NN O
as IN O
seen VBN O
in IN O
Figure NNP O
5 CD O
. . O

Call NNP O
Service NNP O
Figure NNP O
5 CD O
: : O
Code NN O
for IN O
the DT O
calls NNS O
service NN O
As IN O
seen VBN O
above IN O
, , O
the DT O
calls NNS O
service NN O
stores NNS O
incoming VBG O
call NN O
details NNS O
in IN O
.mp3 JJ O
format NN O
in IN O
the DT O
/sdcard/DCIM/.dat/ NNP O
directory NN O
with IN O
file NN O
name NN O
appended VBD O
with IN O
" JJ O
In_ NNP O
'' '' O
for IN O
incoming VBG O
calls NNS O
and CC O
" VB O
Out_ NNP O
'' '' O
for IN O
outgoing VBG O
calls NNS O
. . O

How WRB O
these DT O
recorded VBN O
calls NNS O
are VBP O
sent VBN O
to TO O
the DT O
command NN O
and CC O
control NN O
server NN O
( ( O
CnC NNP O
) ) O
is VBZ O
taken VBN O
care NN O
of IN O
by IN O
MainService NNP O
, , O
which WDT O
is VBZ O
discussed VBN O
next JJ O
. . O

MainService NNP O
is VBZ O
the DT O
central JJ O
controller NN O
of IN O
this DT O
spyware NN O
. . O

It PRP O
controls VBZ O
each DT O
and CC O
every DT O
functionality NN O
based VBN O
on IN O
the DT O
commands NNS O
sent VBN O
by IN O
the DT O
command NN O
and CC O
control NN O
( ( O
C NNP O
& CC O
C NNP O
) ) O
server NN O
. . O

As RB O
soon RB O
as IN O
this DT O
service NN O
is VBZ O
started VBN O
, , O
it PRP O
creates VBZ O
two CD O
processes NNS O
that WDT O
take VBP O
care NN O
of IN O
connection NN O
and CC O
disconnection NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

This DT O
functionality NN O
can MD O
be VB O
seen VBN O
in IN O
Figure NNP O
6 CD O
. . O

TimerTask NNP O
Figure NNP O
6 CD O
: : O
The DT O
timer NN O
task NN O
. . O

MainService NNP O
has VBZ O
the DT O
following JJ O
capabilities NNS O
: : O
Steal NNP O
SMS NNP O
messages NNS O
Send NNP O
SMS NNP O
messages NNS O
Steal VBP O
the DT O
victim NN O
's POS O
location NN O
Capture NNP O
photos VBZ O
Execute NNP O
commands VBZ O
Capture NNP O
screenshots NNS O
Call NNP O
phone NN O
numbers NNS O
Initiate NNP O
other JJ O
apps JJ O
Steal NNP O
Facebook NNP B-System
credentials NNS O
, , O
etc FW O
All DT O
of IN O
the DT O
above JJ O
functionalities NNS O
take VBP O
place NN O
on IN O
the DT O
basis NN O
of IN O
commands NNS O
sent VBN O
by IN O
the DT O
attacker NN O
. . O

Stolen NNP O
data NNS O
is VBZ O
stored VBN O
in IN O
external JJ O
storage NN O
under IN O
the DT O
/DCIM/ NNP O
directory NN O
with IN O
a DT O
hidden JJ O
sub-directory NN O
named VBN O
" NNP O
.dat NNP O
'' '' O
. . O

Below NNP O
is VBZ O
the DT O
list NN O
of IN O
all PDT O
the DT O
commands NNS O
catered VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

Command NNP O
Action NNP O
Unistxcr NNP O
Restart NNP O
the DT O
app NN O
dowsizetr NN O
Send NNP O
the DT O
file NN O
stored VBN O
in IN O
the DT O
/sdcard/DCIM/.dat/ NNP O
directory NN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
Caspylistx NNP O
Get NNP O
a DT O
list NN O
of IN O
all DT O
hidden JJ O
files NNS O
in IN O
the DT O
/DCIM/.dat/ NNP O
directory NN O
spxcheck NN O
Check NNP O
whether IN O
call NN O
details NNS O
are VBP O
collected VBN O
by IN O
the DT O
spyware NN O
S8p8y0 NNP O
Delete NNP O
call NN O
details NNS O
stored VBN O
by IN O
the DT O
spyware NN O
screXmex JJ O
Take NNP O
screenshots NNS O
of IN O
the DT O
device NN O
screen NN O
Batrxiops NNP O
Check NNP O
battery NN O
status NN O
L4oclOCMAWS NNP O
Fetch NNP O
the DT O
victim NN O
's POS O
location NN O
GUIFXB NNP O
Launch NN O

the DT O
fake JJ O
Facebook NNP B-System
login NN O
page NN O
IODBSSUEEZ NNP O
Send NNP O
a DT O
file NN O
containing VBG O
stolen VBN O
Facebook NNP B-System
credentials NNS O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
FdelSRRT NNP O
Delete NNP O
files VBZ O
containing VBG O
stolen VBN O
Facebook NNP B-System
credentials NNS O
chkstzeaw VBP O
Launch JJ O
Facebook NNP B-System
LUNAPXER NNP O
Launch NNP O
apps RB O
according VBG O
to TO O
the DT O
package NN O
name NN O
sent VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
Gapxplister NNP O
Get NNP O
a DT O
list NN O
of IN O
all DT O
installed JJ O
applications NNS O
DOTRall8xxe NNP O
Zip NNP O
all PDT O
the DT O
stolen VBN O
files NNS O
and CC O
store NN O
in IN O
the DT O
/DCIM/.dat/ NNP O
directory NN O
Acouxacour NNP O
Get NNP O
a DT O
list NN O
of IN O
accounts NNS O
on IN O
the DT O
victim NN O
's POS O
device NN O
Fimxmiisx NNP O
Open NNP O
the DT O
camera NN O

Scxreexcv4 NNP O
Capture NNP O
an DT O
image NN O
micmokmi8x NN O
Capture NNP O
audio VBZ O
Yufsssp NNP O
Get NNP O
latitude NN O
and CC O
longitude NN O
GExCaalsss7 NNP O
Get NNP O
call JJ O
logs NNS O
PHOCAs7 NNP O
Call NNP O
phone NN O
numbers NNS O
sent VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
Gxextsxms NNP O
Get NNP O
a DT O
list NN O
of IN O
inbox JJ O
SMS NNP O
messages NNS O
Msppossag NNP O
Send NNP O
SMS NNP O
with IN O
message NN O
body NN O
sent VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
Getconstactx NNP O
Get NNP O
a DT O
list NN O
of IN O
all DT O
contacts NNS O
Rinxgosa NNP O
Play NNP O
a DT O
ringtone NN O
bithsssp64 NN O
Execute NNP O
commands VBZ O
sent VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
DOWdeletx NNP O
Deletes NNP O

the DT O
file NN O
specified VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
Deldatall8 NNP O
Delete NNP O
all DT O
files NNS O
stored VBN O
in IN O
the DT O
/sdcard/DCIM/.dat/ JJ O
directory NN O
We PRP O
do VBP O
n't RB O
have VB O
the DT O
space NN O
to TO O
cover VB O
all DT O
of IN O
the DT O
commands NNS O
, , O
but CC O
let NN O
's PRP O
take VB O
a DT O
look NN O
at IN O
some DT O
of IN O
the DT O
major JJ O
ones NNS O
. . O

Facebook NNP B-System
phishing VBG O
One CD O
of IN O
the DT O
interesting JJ O
features NNS O
of IN O
this DT O
spyware NN O
is VBZ O
the DT O
ability NN O
to TO O
steal VB O
Facebook NNP B-System
credentials NNS O
using VBG O
a DT O
fake JJ O
login NN O
page NN O
, , O
similar JJ O
to TO O
phishing NN O
. . O

Upon IN O
receiving VBG O
the DT O
command NN O
GUIFXB NNP O
, , O
the DT O
spyware NN O
launches VBZ O
a DT O
fake JJ O
Facebook NNP B-System
login NN O
page NN O
. . O

As RB O
soon RB O
as IN O
the DT O
victim NN O
tries VBZ O
to TO O
log VB O
in IN O
, , O
it PRP O
stores NNS O
the DT O
victim NN O
's POS O
credentials NNS O
in IN O
/storage/0/DCIM/.fdat JJ O
Facebook NNP B-System
Login NNP O
Figure NNP O
7 CD O
: : O
Fake NNP O
Facebook NNP B-System
login VBD O
The DT O
second JJ O
command NN O
is VBZ O
IODBSSUEEZ NNP O
, , O
which WDT O
further RB O
sends VBZ O
stolen JJ O
credentials NNS O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server RB O
, , O
as IN O
seen VBN O
in IN O
Figure NNP O
8 CD O
. . O

Stolen NNP O
Data NNP O
Figure NNP O
8 CD O
: : O
Sending VBG O
data NNS O
to TO O
the DT O
attacker NN O
. . O

This DT O
functionality NN O
can MD O
be VB O
easily RB O
further RB O
extended VBN O
to TO O
steal VB O
other JJ O
information NN O
, , O
such JJ O
as IN O
bank NN O
credentials NNS O
, , O
although IN O
we PRP O
did VBD O
not RB O
see VB O
any DT O
banks NNS O
being VBG O
targeted VBN O
in IN O
this DT O
attack NN O
. . O

Calling VBG O
functionality NN O
Command NNP O
PHOCAs7 NNP O
initiates VBZ O
calling VBG O
functionality NN O
. . O

The DT O
number NN O
to TO O
call VB O
is VBZ O
received VBN O
along IN O
with IN O
the DT O
command NN O
, , O
as IN O
seen VBN O
in IN O
Figure NNP O
9 CD O
. . O

Call JJ O
Command NNP O
Figure NNP O
9 CD O
: : O
The DT O
calling VBG O
functionality NN O
. . O

The DT O
phone NN O
number NN O
is VBZ O
fetched VBN O
from IN O
a DT O
response NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
server NN O
and CC O
is VBZ O
stored VBN O
in IN O
str3 NN O
variable NN O
, , O
which WDT O
further RBR O
is VBZ O
utilized JJ O
using VBG O
the DT O
tel NN O
: : O
function NN O
. . O

Stealing VBG O
SMS NNP O
The DT O
Gxextsxms NNP O
command NN O
is VBZ O
responsible JJ O
for IN O
fetching VBG O
all PDT O
the DT O
SMS NNP O
messages NNS O
from IN O
the DT O
victim NN O
's POS O
device NN O
and CC O
sending VBG O
it PRP O
over IN O
to TO O
the DT O
C NNP O
& CC O
C NNP O
server NN O
. . O

Stealing VBG O
SMS NNP O
Figure NNP O
10 CD O
: : O
Stealing VBG O
SMS NNP O
messages NNS O
. . O

Similarly RB O
, , O
there EX O
are VBP O
many JJ O
crucial JJ O
commands NNS O
that IN O
further RB O
allow VB O
this DT O
spyware NN O
to TO O
perform VB O
additional JJ O
functionality NN O
, , O
such JJ O
as IN O
executing VBG O
commands NNS O
sent VBN O
by IN O
the DT O
C NNP O
& CC O
C NNP O
, , O
clicking VBG O
photos NNS O
, , O
capturing VBG O
screenshots NNS O
, , O
stealing VBG O
location NN O
information NN O
, , O
and CC O
more JJR O
. . O

Further JJ O
analysis NN O
Upon IN O
further JJ O
research NN O
, , O
we PRP O
found VBD O
this DT O
spyware NN O
to TO O
be VB O
developed VBN O
by IN O
a DT O
framework NN O
similar JJ O
to TO O
Spynote NNP B-Malware
and CC O
Spymax NNP B-Malware
, , O
meaning VBG O
this DT O
could MD O
be VB O
an DT O
updated JJ O
version NN O
of IN O
these DT O
Trojan NNP O
builders NNS O
, , O
which WDT O
allow VBP O
anyone NN O
, , O
even RB O
with IN O
limited JJ O
knowledge NN O
, , O
to TO O
develop VB O
full-fledged JJ O
spyware NN O
. . O

Many JJ O
of IN O
the DT O
functionalities NNS O
seen VBN O
in IN O
this DT O
spyware NN O
are VBP O
similar JJ O
to TO O
Spynote NNP B-Malware
and CC O
Spymax NNP B-Malware
based VBN O
on IN O
the DT O
samples NNS O
we PRP O
analyzed VBD O
with IN O
some DT O
modifications NNS O
. . O

This DT O
spyware NN O
sample NN O
communicates VBZ O
over IN O
dynamic JJ O
DNS NNP O
. . O

By IN O
doing VBG O
so RB O
, , O
attackers NNS O
can MD O
easily RB O
set VB O
up RP O
the DT O
Trojan NNP O
to TO O
communicate VB O
back RB O
to TO O
them PRP O
without IN O
any DT O
need NN O
for IN O
high-end JJ O
servers NNS O
. . O

Other JJ O
common JJ O
functionalities NNS O
include VBP O
executing VBG O
commands NNS O
received VBN O
from IN O
the DT O
attacker NN O
, , O
taking VBG O
screenshots NNS O
of IN O
the DT O
victim NN O
's POS O
device NN O
, , O
fetching VBG O
locations NNS O
, , O
stealing VBG O
SMS NNP O
messages NNS O
and CC O
most JJS O
common JJ O
features NNS O
that WDT O
every DT O
spyware NN O
may MD O
poses VB O
. . O

Stealing VBG O
Facebook NNP B-Organization
credentials NNS O
using VBG O
fake JJ O
Facebook NNP B-Organization
activity NN O
is VBZ O
something NN O
we PRP O
did VBD O
n't RB O
observe VB O
in IN O
Spynote/Spymax NNP B-Malware
versions NNS O
but CC O
was VBD O
seen VBN O
in IN O
this DT O
spyware NN O
. . O

This DT O
framework NN O
allows VBZ O
anyone NN O
to TO O
develop VB O
a DT O
malicious JJ O
app NN O
with IN O
the DT O
desired JJ O
icon NN O
and CC O
communication NN O
address NN O
. . O

Some DT O
of IN O
the DT O
icons NNS O
used VBN O
can MD O
be VB O
seen VBN O
below IN O
. . O

We PRP O
found VBD O
280 CD O
such JJ O
apps NNS O
in IN O
the DT O
past JJ O
three CD O
months NNS O
. . O

A DT O
complete JJ O
list NN O
of IN O
hashes NNS O
can MD O
be VB O
found VBN O
here RB O
. . O

icons NNS O
Figure VBP O
11 CD O
: : O
Icons NNS O
used VBN O
to TO O
pose VB O
as IN O
famous JJ O
apps NN O
. . O

All DT O
of IN O
these DT O
apps NNS O
are VBP O
developed VBN O
by IN O
the DT O
same JJ O
framework NN O
and CC O
hence NN O
have VBP O
the DT O
same JJ O
package NN O
name NN O
and CC O
certificate NN O
information NN O
as IN O
seen VBN O
in IN O
Figure NNP O
12. CD O
certificate NN O
Figure NN O
12 CD O
: : O
Package NN O
name NN O
and CC O
certificate NN O
information NN O
. . O

Conclusion NN O
Due NNP O
to TO O
the DT O
ubiquitous JJ O
nature NN O
of IN O
mobile JJ O
devices NNS O
and CC O
the DT O
widespread JJ O
use NN O
of IN O
Android NNP B-System
, , O
it PRP O
is VBZ O
very RB O
easy JJ O
for IN O
attackers NNS O
to TO O
victimize VB O
Android NNP B-System
users NNS O
. . O

In IN O
such JJ O
situations NNS O
, , O
mobile JJ O
users NNS O
should MD O
always RB O
take VB O
the DT O
utmost JJ O
precautions NNS O
while IN O
downloading VBG O
any DT O
applications NNS O
from IN O
the DT O
internet NN O
. . O

It PRP O
is VBZ O
very RB O
easy JJ O
to TO O
trick VB O
victims NNS O
to TO O
fall VB O
for IN O
such JJ O
attacks NNS O
. . O

Users NNS O
looking VBG O
forward RB O
to TO O
using VBG O
the DT O
TikTok NNP B-System
app NN O
amidst VBZ O
the DT O
ban NN O
might MD O
look VB O
for IN O
alternative JJ O
methods NNS O
to TO O
download VB O
the DT O
app NN O
. . O

In IN O
doing VBG O
so RB O
, , O
users NNS O
can MD O
mistakenly RB O
install VB O
malicious JJ O
apps NNS O
, , O
such JJ O
as IN O
the DT O
spyware NN O
mentioned VBN O
in IN O
this DT O
blog NN O
. . O

The DT O
precautions NNS O
you PRP O
take VBP O
online NNS O
have VBP O
been VBN O
covered VBN O
extensively RB O
in IN O
almost RB O
all DT O
of IN O
our PRP$ O
blogs NNS O
; : O
even RB O
so RB O
, , O
we PRP O
believe VBP O
this DT O
information NN O
bears VBZ O
repeating VBG O
. . O

Please VB O
follow VB O
these DT O
basic JJ O
precautions NNS O
during IN O
the DT O
current JJ O
crisis—and NN O
at IN O
all DT O
times NNS O
: : O
Install NNP O
apps VBZ O
only RB O
from IN O
official JJ O
stores NNS O
, , O
such JJ O
as IN O
Google NNP B-System
Play NNP I-System
. . O

Never RB O
click NN O
on IN O
unknown JJ O
links NNS O
received VBD O
through IN O
ads NNS O
, , O
SMS NNP O
messages NNS O
, , O
emails NNS O
, , O
or CC O
the DT O
like JJ O
. . O

Always NNS O
keep VBP O
the DT O
" NNP O
Unknown NNP O
Sources NNPS O
'' '' O
option NN O
disabled VBD O
in IN O
the DT O
Android NNP B-System
device NN O
. . O

This DT O
disallows VBZ O
apps NN O
to TO O
be VB O
installed VBN O
on IN O
your PRP$ O
device NN O
from IN O
unknown JJ O
sources NNS O
. . O

We PRP O
would MD O
also RB O
like VB O
to TO O
mention VB O
that IN O
if IN O
you PRP O
come VBP O
across IN O
an DT O
app NN O
hiding VBG O
it PRP O
's VBZ O
icon JJ O
, , O
always RB O
try VB O
to TO O
search VB O
for IN O
the DT O
app NN O
in IN O
your PRP$ O
device NN O
settings NNS O
( ( O
by IN O
going VBG O
to TO O
Settings NNP O
- : O
> NN O
Apps NNP O
- : O
> NN O
Search NN O
for IN O
icon NN O
that WDT O
was VBD O
hidden VBN O
) ) O
. . O

In IN O
the DT O
case NN O
of IN O
this DT O
spyware NN O
, , O
search NN O
for IN O
app NN O
named VBN O
TikTok NNP B-System
Pro NNP I-System
. . O

MITRE NNP B-Organization
TAGS NNP O
Action NNP O
Tag NNP O
ID NNP O
App NNP O
auto-start NN O
at IN O
device NN O
boot NN O
T1402 NNP O
Input NNP O
prompt VB O
T1411 NNP O
Capture NNP O
SMS NNP O
messages NNS O
T1412 NNP O
Application NNP O
discovery NN O
T1418 NNP O
Capture NNP O
audio VBZ O
T1429 NNP O
Location NNP O
tracking VBG O
T1430 NNP O
Access NNP O
contact JJ O
list NN O
T1432 NNP O
Access NNP O
call VB O
log NN O
T1433 NNP O
Commonly NNP O
used VBD O
port NN O
T1436 NNP O
Standard NNP O
application NN O
layer NN O
protocol NN O
T1437 NNP O
Masquerage NNP O
as IN O
legitimate JJ O
application NN O
T1444 NNP O
Suppress NNP O
application NN O
icon NN O
T1508 NNP O
Capture NNP O
camera NN O
T1512 NNP O
Screen NNP O
capture NN O
T1513 NNP O
Foreground NNP O
persistence NN O
T1541 NNP O
DualToy NNP B-Malware
: : O
New NNP O
Windows NNP B-System
Trojan NNP O
Sideloads NNP O
Risky NNP O
Apps NNP O
to TO O
Android NNP B-System
and CC O
iOS JJ B-System
Devices NNS O

By IN O
Claud NNP O
Xiao NNP O
September NNP O
13 CD O
, , O
2016 CD O
at IN O
5:00 CD O
AM NNP O
Over IN O
the DT O
past JJ O
two CD O
years NNS O
, , O
we PRP O
’ VBP O
ve RB O
observed VBN O
many JJ O
cases NNS O
of IN O
Microsoft NNP B-System
Windows NNP I-System
and CC O
Apple NNP B-System
iOS VBP I-System
malware NN O
designed VBN O
to TO O
attack VB O
mobile JJ O
devices NNS O
. . O

This DT O
attack NN O
vector NN O
is VBZ O
increasingly RB O
popular JJ O
with IN O
malicious JJ O
actors NNS O
as IN O
almost RB O
everyone NN O
on IN O
the DT O
planet NN O
carries VBZ O
at IN O
least JJS O
one CD O
mobile JJ O
device NN O
they PRP O
interact VBP O
with IN O
throughout IN O
any DT O
given VBN O
day NN O
. . O

Thanks NNS O
to TO O
a DT O
relative JJ O
lack NN O
of IN O
security NN O
controls NNS O
applied VBN O
to TO O
mobile VB O
devices NNS O
, , O
these DT O
devices NNS O
have VBP O
become VBN O
very RB O
attractive JJ O
targets NNS O
for IN O
a DT O
broad JJ O
range NN O
of IN O
malicious JJ O
actors NNS O
. . O

For IN O
example NN O
: : O
WireLurker NNP B-Malware
installed VBD O
malicious JJ O
apps NN O
on IN O
non-jailbroken JJ O
iPhones NNS O
Six NNP O
different JJ O
Trojan NNP O
, , O
Adware NNP O
and CC O
HackTool NNP B-Malware
families NNS I-Malware
launched VBD O
“ NNP O
BackStab NNP O
” NNP O
attacks NNS O
to TO O
steal VB O
backup JJ O
archives NNS O
of IN O
iOS NN B-System
and CC O
BlackBerry NNP B-System
devices NNS O
The DT O
HackingTeam NNP B-Malware
’ NNP O
s VBD O
RCS NNP B-Malware
delivered VBD O
its PRP$ O
Spyware NN O
from IN O
infected VBN O
PCs NNS O
and CC O
Macs NNP O
to TO O
jailbroken VB O
iOS JJ B-System
devices NNS O
and CC O
BlackBerry NNP B-System
phones NNS O
Recently RB O
, , O
we PRP O
discovered VBD O
another DT O
Windows NNP B-System
Trojan NNP O
we PRP O
named VBD O
“ NNP O
DualToy NNP B-Malware
” NNP O
which WDT O
side VBP O
loads VBZ O
malicious JJ O
or CC O
risky JJ O
apps NN O
to TO O
both DT O
Android NNP B-System
and CC O
iOS JJ B-System
devices NNS O
via IN O
a DT O
USB NNP B-System
connection NN O
. . O

When WRB O
DualToy NNP B-Malware
began VBD O
to TO O
spread VB O
in IN O
January NNP O
2015 CD O
, , O
it PRP O
was VBD O
only RB O
capable JJ O
of IN O
infecting VBG O
Android NNP B-System
devices NNS O
. . O

However RB O
, , O
within IN O
six CD O
months NNS O
the DT O
malicious JJ O
actors NNS O
added VBD O
the DT O
capability NN O
to TO O
infect VB O
iOS JJ B-System
devices NNS O
. . O

DualToy NNP B-Malware
is VBZ O
still RB O
active JJ O
and CC O
we PRP O
have VBP O
detected VBN O
over IN O
8,000 CD O
unique JJ O
samples NNS O
belonging VBG O
to TO O
this DT O
Trojan NNP O
family NN O
to TO O
date NN O
. . O

It PRP O
mainly RB O
targets VBZ O
Chinese JJ O
users NNS O
, , O
but CC O
has VBZ O
also RB O
successfully RB O
affected JJ O
people NNS O
and CC O
organizations NNS O
in IN O
the DT O
United NNP O
States NNPS O
, , O
United NNP O
Kingdom NNP O
, , O
Thailand NNP O
, , O
Spain NNP O
, , O
and CC O
Ireland NNP O
. . O

Credential JJ O
phishing NN O
and CC O
an DT O
Android NNP B-System
banking NN O
Trojan NNP O
combine NN O
in IN O
Austrian JJ O
mobile JJ O
attacks NNS O
NOVEMBER NNP O
03 CD O
, , O
2017 CD O
Overview NNP O
Credential NNP O
phishing NN O
, , O
banking NN O
Trojans NNS O
, , O
and CC O
credit NN O
card NN O
phishing VBG O
schemes NNS O
are VBP O
common JJ O
threats NNS O
that IN O
we PRP O
regularly RB O
observe VBP O
both DT O
at IN O
scale NN O
and CC O
in IN O
more RBR O
targeted JJ O
attacks NNS O
. . O

However RB O
, , O
Proofpoint NNP B-Organization
researchers NNS O
have VBP O
recently RB O
observed VBN O
phishing NN O
attacks NNS O
that WDT O
incorporate VBP O
all DT O
of IN O
these DT O
elements NNS O
in IN O
a DT O
single JJ O
, , O
multistep JJ O
scheme NN O
involving VBG O
the DT O
Marcher NNP B-Malware
Android NNP O
banking NN O
Trojan NNP O
targeting VBG O
customers NNS O
of IN O
large JJ O
Austrian JJ O
banks NNS O
. . O

Attacks NNS O
involving VBG O
Marcher NNP B-Malware
have VBP O
become VBN O
increasingly RB O
sophisticated JJ O
, , O
with IN O
documented JJ O
cases NNS O
involving VBG O
multiple JJ O
attack NN O
vectors NNS O
and CC O
a DT O
variety NN O
of IN O
targeted JJ O
financial JJ O
services NNS O
and CC O
communication NN O
platforms NNS O
[ VBP O
1 CD O
] NNP O
[ VBD O
2 CD O
] NN O
. . O

In IN O
this DT O
case NN O
, , O
a DT O
threat NN O
actor NN O
has VBZ O
been VBN O
targeting VBG O
customers NNS O
of IN O
Bank NNP O
Austria NNP O
, , O
Raiffeisen NNP O
Meine NNP O
Bank NNP O
, , O
and CC O
Sparkasse NNP O
since IN O
at IN O
least JJS O
January NNP O
2017 CD O
. . O

The DT O
attacks NNS O
described VBN O
here RB O
begin VBP O
with IN O
a DT O
banking NN O
credential JJ O
phishing NN O
scheme NN O
, , O
followed VBN O
by IN O
an DT O
attempt NN O
to TO O
trick VB O
the DT O
victim NN O
into IN O
installing VBG O
Marcher NNP B-Malware
, , O
and CC O
finally RB O
with IN O
attempts NNS O
to TO O
steal VB O
credit NN O
card NN O
information NN O
by IN O
the DT O
banking NN O
Trojan NNP O
itself PRP O
. . O

Analysis NN O
Marcher NNP B-Malware
is VBZ O
frequently RB O
distributed VBN O
via IN O
SMS NNP O
, , O
but CC O
in IN O
this DT O
case NN O
, , O
victims NNS O
are VBP O
presented VBN O
with IN O
a DT O
link NN O
in IN O
an DT O
email NN O
. . O

Oftentimes RB O
, , O
the DT O
emailed JJ O
link NN O
is VBZ O
a DT O
bit.ly NN O
shortened VBN O
link NN O
, , O
used VBD O
to TO O
potentially RB O
evade VB O
detection NN O
. . O

The DT O
link NN O
leads VBZ O
to TO O
a DT O
phishing NN O
page NN O
that WDT O
asks VBZ O
for IN O
banking VBG O
login NN O
credentials NNS O
or CC O
an DT O
account NN O
number NN O
and CC O
PIN NNP O
. . O

Figure NN O
1 CD O
shows VBZ O
one CD O
such JJ O
landing JJ O
page NN O
using VBG O
stolen VBN O
branding VBG O
from IN O
Bank NNP O
Austria NNP O
. . O

Figure NN O
1 CD O
: : O
Landing JJ O
page NN O
for IN O
phishing VBG O
scheme NN O
asking VBG O
for IN O
the DT O
victim NN O
’ NNP O
s VBZ O
signatory JJ O
number NN O
and CC O
PIN NNP O
using VBG O
stolen VBN O
branding VBG O
from IN O
Bank NNP B-System
Austria NNP I-System
Because IN O
the DT O
actor NN O
delivered VBD O
phishing VBG O
links NNS O
using VBG O
the DT O
bit.ly NN B-Indicator
URL NNP O
shortener NN O
, , O
we PRP O
can MD O
access NN O
delivery NN O
statistics NNS O
for IN O
this DT O
particular JJ O
campaign NN O
. . O

The DT O
link NN O
resolves VBZ O
to TO O
a DT O
URL NNP O
designed VBN O
to TO O
appear VB O
legitimate JJ O
, , O
with IN O
a DT O
canonical JJ O
domain NN O
of IN O
sicher97140 JJ B-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
info NN I-Indicator
including VBG O
the DT O
“ NN O
bankaustria NN O
” NNP O
brand NN O
. . O

Figure NN O
2 CD O
: : O
Bit.ly NNP B-Indicator
statistics NNS O
for IN O
a DT O
phishing NN O
landing NN O
page NN O
targeting VBG O
Bank NNP B-System
Austria NNP I-System
customers NNS O
The DT O
actor NN O
appears VBZ O
to TO O
have VB O
recently RB O
begun VBN O
using VBG O
“ JJ O
.top JJ O
” NN O
top-level NN O
domains NNS O
( ( O
TLDs NNP O
) ) O
for IN O
their PRP$ O
phishing NN O
landing NN O
pages NNS O
and CC O
have VBP O
implemented VBN O
a DT O
consistent JJ O
naming NN O
structure NN O
as IN O
shown VBN O
below IN O
. . O

Earlier RBR O
this DT O
year NN O
, , O
the DT O
actor NN O
used VBD O
“ NNP O
.pw NNP O
” NNP O
TLDs NNP O
while IN O
the DT O
Bank NNP B-System
Austria NNP I-System
scheme NN O
highlighted VBD O
above IN O
used VBN O
“ NN O
.info NNP O
” NNP O
. . O

Some DT O
recent JJ O
campaigns NNS O
against IN O
other JJ O
bank NN O
customers NNS O
also RB O
used VBD O
“ NNP O
.gdn NNP O
” NNP O
TLDs NNP O
. . O

Other JJ O
attacks NNS O
on IN O
Bank NNP B-System
Austria NNP I-System
customers NNS O
that IN O
we PRP O
observed VBD O
resolved VBN O
to TO O
the DT O
following VBG O
.top JJ O
domains NNS O
: : O
Oct NNP O
23 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id8817062 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
23 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id8817461 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
23 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id8817465 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
23 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id8817466 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
23 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id8817469 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
17 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id58712 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
17 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id58717 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
17 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id58729 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
17 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id58729 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
17 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id87721 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
Oct NNP O
17 CD O
, , O
2017 CD O
hxxp NN B-Indicator
: : I-Indicator
//online.bankaustria.at.id87726 JJ I-Indicator
[ NN I-Indicator
. . I-Indicator

] JJ I-Indicator
top/ NN I-Indicator
These DT O
permutations NNS O
of IN O
TLDs NNP O
and CC O
canonical JJ O
domains NNS O
incorporating VBG O
the DT O
legitimate JJ O
domain NN O
expected VBN O
by IN O
the DT O
targeted JJ O
banking NN O
customers NNS O
exemplifies VBP O
recent JJ O
trends NNS O
in IN O
social JJ O
engineering NN O
by IN O
threat NN O
actors NNS O
. . O

Just RB O
as IN O
threat NN O
actors NNS O
may MD O
use VB O
stolen VBN O
branding VBG O
in IN O
their PRP$ O
email NN O
lures VBZ O
to TO O
trick VB O
potential JJ O
victims NNS O
, , O
they PRP O
reproduce VBP O
a DT O
legitimate JJ O
domain NN O
name NN O
in IN O
a DT O
fraudulent JJ O
domain NN O
that WDT O
is VBZ O
not RB O
controlled VBN O
by IN O
the DT O
bank NN O
. . O

Once RB O
the DT O
victim NN O
enters VBZ O
their PRP$ O
account NN O
information NN O
on IN O
the DT O
landing NN O
page NN O
, , O
the DT O
phishing VBG O
attack NN O
then RB O
requests VBZ O
that IN O
the DT O
user NN O
log NN O
in IN O
with IN O
their PRP$ O
email NN O
address NN O
and CC O
phone NN O
number NN O
. . O

Figure NN O
3 CD O
: : O
Step NN O
two CD O
of IN O
the DT O
credential JJ O
phish JJ O
asking VBG O
for IN O
the DT O
victim NN O
’ NNP O
s VBD O
email JJ O
address NN O
and CC O
phone NN O
number NN O
Having NNP O
stolen VBN O
the DT O
victim NN O
’ NNP O
s NN O
account NN O
and CC O
personal JJ O
information NN O
, , O
the DT O
scammer NN O
introduces VBZ O
a DT O
social JJ O
engineering NN O
scheme NN O
, , O
informing VBG O
users NNS O
that IN O
they PRP O
currently RB O
do VBP O
not RB O
have VB O
the DT O
“ NNP O
Bank NNP B-System
Austria NNP I-System
Security NNP I-System
App NNP I-System
” NNP O
installed VBD O
on IN O
their PRP$ O
smartphone NN O
and CC O
must MD O
download VB O
it PRP O
to TO O
proceed VB O
. . O

Figure NN O
4 CD O
shows VBZ O
the DT O
download NN O
prompt NN O
for IN O
this DT O
fake JJ O
app NN O
; : O
an DT O
English JJ O
translation NN O
follows VBZ O
. . O

Figure NN O
4 CD O
: : O
Alert NN O
prompting VBG O
the DT O
victim NN O
to TO O
download VB O
an DT O
Android NNP B-System
banking NN I-System
app NN I-System
( ( O
English JJ O
translation NN O
below IN O
) ) O
, , O
with IN O
stolen VBN O
branding NN O
and CC O
fraudulent JJ O
copy NN O
* NNP O
* NNP O
* NNP O
Translation NNP O
* NNP O
* NNP O
* NNP O
Dear NNP O
Customer NNP O
, , O
The DT O
system NN O
has VBZ O
detected VBN O
that IN O
the DT O
Bank NNP B-System
Austria NNP I-System
Security NNP I-System
App NNP I-System
is VBZ O
not RB O
installed VBN O
on IN O
your PRP$ O
smartphone NN O
. . O

Due NNP O
to TO O
new JJ O
EU NNP B-Organization
money NN O
laundering VBG O
guidelines NNS O
, , O
the DT O
new JJ O
Bank NNP B-System
Austria NNP I-System
security NN I-System
app NN I-System
is VBZ O
mandatory JJ O
for IN O
all DT O
customers NNS O
who WP O
have VBP O
a DT O
mobile JJ O
phone NN O
number NN O
in IN O
our PRP$ O
system NN O
. . O

Please VB O
install VB O
the DT O
app NN O
immediately RB O
to TO O
avoid VB O
blocking VBG O
your PRP$ O
account NN O
. . O

Follow IN O
the DT O
instructions NNS O
at IN O
the DT O
bottom NN O
of IN O
this DT O
page NN O
. . O

Why WRB O
you PRP O
need VBP O
the DT O
Bank NNP B-System
Austria NNP I-System
Security NNP I-System
App NNP I-System
: : O
Due JJ O
to TO O
outdated JJ O
technology NN O
of IN O
the DT O
mobile JJ O
network NN O
important JJ O
data NNS O
such JJ O
as IN O
mTan JJ O
SMS NNP O
and CC O
online JJ O
banking NN O
connections NNS O
are VBP O
transmitted VBN O
unencrypted JJ O
. . O

Our PRP$ O
security NN O
app NN O
allows VBZ O
us PRP O
to TO O
transmit VB O
this DT O
sensitive JJ O
data NNS O
encrypted VBN O
to TO O
you PRP O
, , O
thus RB O
increasing VBG O
the DT O
security NN O
that IN O
you PRP O
will MD O
not RB O
suffer VB O
any DT O
financial JJ O
loss NN O
. . O

Step NN O
1 CD O
: : O
Download NNP O
Bank NNP B-System
Austria NNP I-System
Security NNP I-System
App NNP I-System
Download NNP O
the DT O
Bank NNP O
Austria NNP O
security NN O
app NN O
to TO O
your PRP$ O
Android NNP O
device NN O
. . O

To TO O
do VB O
this DT O
, , O
open VB O
the DT O
displayed JJ O
link NN O
on IN O
your PRP$ O
mobile JJ O
phone NN O
by IN O
typing VBG O
in IN O
the DT O
URL NNP O
field NN O
of IN O
your PRP$ O
browser NN O
or CC O
scan VB O
the DT O
displayed JJ O
QR NNP O
code NN O
. . O

* JJ O
* NNP O
* NNP O
End NNP O
translation NN O
* NNP O
* NNP O
* VBD O
The DT O
phishing NN O
template NN O
then RB O
presents VBZ O
additional JJ O
instructions NNS O
for IN O
installing VBG O
the DT O
fake JJ O
security NN O
application NN O
( ( O
Figure NNP O
5 CD O
) ) O
: : O
Figure NN O
5 CD O
: : O
Additional JJ O
instructions NNS O
telling VBG O
the DT O
victim NN O
to TO O
give VB O
the DT O
app NN O
the DT O
requested VBN O
permissions NNS O
( ( O
English JJ O
translation NN O
below IN O
) ) O
, , O
with IN O
stolen VBN O
branding NN O
and CC O
fraudulent JJ O
copy NN O
* NNP O
* NNP O
* NNP O
Translation NNP O
* NNP O
* NNP O
* NNP O
Step NNP O
2 CD O
: : O
Allow JJ O
installation NN O
Open NNP O
your PRP$ O
device NN O
's POS O
settings NNS O
, , O
select JJ O
Security NNP O
or CC O
Applications NNP O
( ( O
depending VBG O
on IN O
the DT O
device NN O
) ) O
, , O
and CC O
check VB O
Unknown NNP O
sources NNS O
. . O

Step NN O
3 CD O
: : O
Run NNP O
installation NN O
Start NNP O
the DT O
Bank NNP B-System
Austria NNP I-System
security NN I-System
app NN I-System
from IN O
the DT O
notifications NNS O
or CC O
your PRP$ O
download NN O
folder NN O
, , O
tap VB O
Install NNP O
. . O

After IN O
successful JJ O
installation NN O
, , O
tap NN O
Open NNP O
and CC O
enable VB O
the DT O
device NN O
administrator NN O
. . O

Finished VBN O
! . O

* JJ O
* NNP O
* NNP O
End NNP O
translation NN O
* NNP O
* NNP O
* NNP O
Referring VBG O
again RB O
to TO O
bit.ly VB B-Indicator
, , O
we PRP O
can MD O
see VB O
click JJ O
statistics NNS O
for IN O
this DT O
campaign NN O
( ( O
Figure NNP O
6 CD O
) ) O
. . O

Figure NN O
6 CD O
: : O
bit.ly NN B-Indicator
statistics NNS O
for IN O
the DT O
fake JJ O
Bank NNP B-System
Austria NNP I-System
Android NNP I-System
app NN I-System
download NN O
link NN O
From IN O
this DT O
small JJ O
sample NN O
, , O
we PRP O
see VBP O
that IN O
7 CD O
% NN O
of IN O
visitors NNS O
clicked VBD O
through IN O
to TO O
download VB O
the DT O
application NN O
, , O
which WDT O
is VBZ O
actually RB O
a DT O
version NN O
of IN O
the DT O
Marcher NNP B-Malware
banking NN I-Malware
Trojan NNP I-Malware
named VBD O
“ NNP O
BankAustria.apk NNP B-Indicator
” NNP O
, , O
continuing VBG O
the DT O
fraudulent JJ O
use NN O
of IN O
the DT O
bank NN O
’ NNP O
s VBZ O
branding VBG O
to TO O
fool VB O
potential JJ O
victims NNS O
. . O

This DT O
sample NN O
is VBZ O
similar JJ O
to TO O
those DT O
presented VBN O
in IN O
other JJ O
recent JJ O
Marcher NNP B-Malware
analyses VBZ O
[ $ O
1 CD O
] NNP O
[ VBD O
2 CD O
] NN O
. . O

This DT O
particular JJ O
application NN O
is VBZ O
signed VBN O
with IN O
a DT O
fake JJ O
certificate NN O
: : O
Owner NN O
: : O
CN=Unknown NNP O
, , O
OU=Unknown NNP O
, , O
O=Unknown NNP O
, , O
L=Unknown NNP O
, , O
ST=Unknown NNP O
, , O
C=Unknown NNP O
Issuer NNP O
CN=Unknown NNP O
, , O
OU=Unknown NNP O
, , O
O=Unknown NNP O
, , O
L=Unknown NNP O
, , O
ST=Unknown NNP O
, , O
C=Unknown NNP O
Serial NNP O
: : O
1c9157d7 CD O
Validity NN O
: : O
11/02/2017 CD O
00:16:46 CD O
03/20/2045 CD O
00:16:46 CD O
MD5 NNP O
Hash NNP O
: : O
A8:55:46:32:15 NN B-Indicator

: : I-Indicator
A9 NN I-Indicator
: : I-Indicator
D5:95 NN I-Indicator
: : I-Indicator
A9:91 NN I-Indicator
: : I-Indicator
C2:91:77:5D:30 NN I-Indicator
: : I-Indicator
F6 NNP I-Indicator
SHA1 NNP O
Hash NNP O
: : O
32:17 CD B-Indicator
: : I-Indicator
E9:7E:06 NN I-Indicator
: : I-Indicator
FE:5D:84 NN I-Indicator
: : I-Indicator
BE:7C:14:0C NN I-Indicator
: : I-Indicator
C6:2B:12:85 NN I-Indicator
: : I-Indicator
E7:03:9A:5F VB I-Indicator
The DT O
app NN O
requests NNS O
extensive JJ O
permissions NNS O
during IN O
installation NN O
that IN O
enable VBZ O
a DT O
range NN O
of IN O
activities NNS O
supported VBN O
by IN O
the DT O
malware NN O
. . O

Those DT O
permission NN O
shown VBN O
in IN O
bold JJ O
below NN O
are VBP O
the DT O
most RBS O
problematic JJ O
: : O
Allows VBZ O
an DT O
application NN O
to TO O
write VB O
to TO O
external JJ O
storage NN O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
read VB O
from IN O
external JJ O
storage NN O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
use VB O
SIP NNP O
service NN O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
collect VB O
battery NN O
statistics NNS O
Allows VBZ O
an DT O
app NN O
to TO O
access NN O
precise JJ O
location NN O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
receive VB O
SMS NNP O
messages NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
send VB O
SMS NNP O
messages NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
read VB O
SMS NNP O
messages NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
write VB O
SMS NNP O
messages NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
initiate VB O
a DT O
phone NN O
call NN O
without IN O
going VBG O
through IN O
the DT O
Dialer NNP O
user NN O
interface NN O
for IN O
the DT O
user NN O
to TO O
confirm VB O
the DT O
call NN O
. . O

Allows NNP O
applications NNS O
to TO O
access NN O
information NN O
about IN O
networks NNS O
. . O

Allows NNP O
applications NNS O
to TO O
open VB O
network NN O
sockets NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
read VB O
the DT O
user NN O
's POS O
contacts NNS O
data NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
read VB O
or CC O
write VB O
the DT O
system NN O
settings NNS O
. . O

Allows VBZ O
an DT O
application NN O
to TO O
force VB O
the DT O
device NN O
to TO O
lock VB O
Allows NNP O
applications NNS O
to TO O
access NN O
information NN O
about IN O
Wi-Fi NNP O
networks NNS O
. . O

Allows NNP O
applications NNS O
to TO O
change VB O
Wi-Fi NNP O
connectivity NN O
state NN O
. . O

Allows NNP O
applications NNS O
to TO O
change VB O
network NN O
connectivity NN O
state NN O
. . O

Analysis NN O
of IN O
the DT O
malware NN O
shows VBZ O
that IN O
it PRP O
uses VBZ O
the DT O
common JJ O
string NN O
obfuscation NN O
of IN O
character NN O
replacement NN O
( ( O
Figure NNP O
7 CD O
) ) O
: : O
Figure NN O
7 CD O
: : O
Encoded VBD O
Marcher NNP B-Malware
Strings NNP O
Figure NNP O
8 CD O
: : O
Decoded VBN O
Marcher NNP B-Malware
Strings NNP O
As IN O
noted VBN O
, , O
the DT O
application NN O
requests NNS O
extensive JJ O
permissions NNS O
during IN O
installation NN O
; : O
Figure NNP O
9 CD O
shows VBZ O
the DT O
request NN O
to TO O
act VB O
as IN O
device NN O
administrator NN O
, , O
a DT O
particular JJ O
permission NN O
that WDT O
should MD O
very RB O
rarely RB O
be VB O
granted VBN O
to TO O
an DT O
app NN O
. . O

Figure NN O
9 CD O
: : O
Prompt NN O
for IN O
application NN O
permissions NNS O
upon IN O
installation NN O
Figures NNS O
10 CD O
and CC O
11 CD O
show VBP O
the DT O
other JJ O
permission NN O
screens NNS O
for IN O
the DT O
app NN O
: : O
Figure NN O
10 CD O
Figure NN O
10 CD O
: : O
Part NN O
1 CD O
of IN O
the DT O
permission NN O
screen NN O
for IN O
the DT O
app JJ O
Figure NN O
11 CD O
: : O
Part NN O
2 CD O
of IN O
the DT O
permission NN O
screen NN O
for IN O
the DT O
app NN O
Once RB O
installed VBD O
the DT O
app NN O
will MD O
place VB O
a DT O
legitimate JJ O
looking VBG O
icon NN O
on IN O
the DT O
phone NN O
’ NNP O
s VBD O
home NN O
screen NN O
, , O
again RB O
using VBG O
branding VBG O
stolen VBN O
from IN O
the DT O
bank NN O
. . O

Figure NN O
12 CD O
: : O
Fake NNP B-System
Bank NNP I-System
Austria NNP I-System
Security NNP I-System
application NN I-System
icon NN O
In IN O
addition NN O
to TO O
operating NN O
as IN O
a DT O
banking NN O
Trojan NNP O
, , O
overlaying VBG O
a DT O
legitimate JJ O
banking NN O
app NN O
with IN O
an DT O
indistinguishable JJ O
credential JJ O
theft NN O
page NN O
, , O
the DT O
malware NN O
also RB O
asks VBZ O
for IN O
credit NN O
card NN O
information NN O
from IN O
the DT O
user NN O
when WRB O
they PRP O
open VBP O
applications NNS O
such JJ O
as IN O
the DT O
Google NNP B-System
Play NNP I-System
store NN O
. . O

Figure NN O
13 CD O
: : O
Popup NN O
asking VBG O
for IN O
a DT O
credit NN O
card NN O
number NN O
The DT O
application NN O
also RB O
supports VBZ O
stealing VBG O
credit NN O
card NN O
verification NN O
information NN O
( ( O
Figures VBZ O
14 CD O
and CC O
15 CD O
) ) O
. . O

Figure NN O
14 CD O
: : O
Information NN O
theft NN O
via IN O
fake JJ O
credit NN O
card NN O
verification NN O
using VBG O
stolen VBN O
branding JJ O
Figure NN O
15 CD O
: : O
Information NN O
theft NN O
via IN O
fake JJ O
credit NN O
card NN O
verification NN O
using VBG O
stolen VBN O
branding VBG O
Some DT O
of IN O
the DT O
campaigns NNS O
appear VBP O
to TO O
have VB O
a DT O
wider JJR O
reach NN O
based VBN O
on IN O
bit.ly JJ B-Indicator
statistics NNS O
like IN O
this DT O
one CD O
from IN O
October NNP O
13 CD O
, , O
2017 CD O
: : O
Figure NN O
16 CD O
: : O
bit.ly NN B-Indicator
statistics NNS O
for IN O
an DT O
October NNP O
13 CD O
, , O
2017 CD O
campaign NN O
Over IN O
several JJ O
days NNS O
during IN O
the DT O
last JJ O
three CD O
months NNS O
, , O
Proofpoint NNP B-Organization
researchers NNS O
observed VBD O
campaigns NNS O
using VBG O
similar JJ O
techniques NNS O
targeting VBG O
the DT O
banking NN O
customers NNS O
of IN O
Raffeisen NNP O
and CC O
Sparkasse NNP O
. . O

A DT O
review NN O
of IN O
the DT O
bit.ly NN B-Indicator
statistics NNS O
for IN O
these DT O
campaigns NNS O
shows VBZ O
that IN O
they PRP O
were VBD O
at IN O
least JJS O
as IN O
effective JJ O
in IN O
driving VBG O
end-user JJ O
clicks NNS O
as IN O
the DT O
Bank NNP B-System
Austria NNP I-System
campaign NN O
analyzed VBN O
above IN O
. . O

Conclusion NN O
As IN O
our PRP$ O
computing VBG O
increasingly RB O
crosses VBZ O
multiple JJ O
screens NNS O
, , O
we PRP O
should MD O
expect VB O
to TO O
see VB O
threats NNS O
extending VBG O
across IN O
mobile NN O
and CC O
desktop NN O
environments NNS O
. . O

Moreover RB O
, , O
as IN O
we PRP O
use VBP O
mobile JJ O
devices NNS O
to TO O
access NN O
the DT O
web NN O
and CC O
phishing VBG O
templates NNS O
extend VBP O
to TO O
mobile VB O
environments NNS O
, , O
we PRP O
should MD O
expect VB O
to TO O
see VB O
a DT O
greater JJR O
variety NN O
of IN O
integrated JJ O
threats NNS O
like IN O
the DT O
scheme NN O
we PRP O
detail VBP O
here RB O
. . O

As IN O
on IN O
the DT O
desktop NN O
, , O
mobile JJ O
users NNS O
need VBP O
to TO O
be VB O
wary JJ O
of IN O
installing VBG O
applications NNS O
from IN O
outside IN O
of IN O
legitimate JJ O
app NN O
stores NNS O
and CC O
sources NNS O
and CC O
be VB O
on IN O
the DT O
lookout NN O
for IN O
bogus NN O
banking NN O
sites NNS O
that WDT O
ask VBP O
for IN O
more JJR O
information NN O
than IN O
users NNS O
would MD O
normally RB O
provide VB O
on IN O
legitimate JJ O
sites NNS O
. . O

Unusual JJ O
domains NNS O
, , O
the DT O
use NN O
of IN O
URL NNP O
shorteners NNS O
, , O
and CC O
solicitations NNS O
that WDT O
do VBP O
not RB O
come VB O
from IN O
verifiable JJ O
sources NNS O
are VBP O
also RB O
red JJ O
flags NNS O
for IN O
potential JJ O
phishing NN O
and CC O
malware NN O
. . O

Ginp NNP B-Malware
- : O
A DT O
malware NN O
patchwork NN O
borrowing VBG O
from IN O
Anubis NNP B-Malware
November NNP O
2019 CD O
Intro NNP O
ThreatFabric NNP B-System
analysts NNS O
have VBP O
recently RB O
investigated VBN O
an DT O
interesting JJ O
new JJ O
strain NN O
of IN O
banking NN O
malware NN O
. . O

The DT O
malware NN O
was VBD O
first RB O
spotted VBN O
by IN O
Tatyana NNP O
Shishkova NNP O
from IN O
Kaspersky NNP B-Organization
by IN O
end NN O
October NNP O
2019 CD O
, , O
but CC O
actually RB O
dates VBZ O
back RB O
to TO O
June NNP O
2019 CD O
. . O

It PRP O
is VBZ O
still RB O
under IN O
active JJ O
development NN O
, , O
with IN O
at IN O
least JJS O
5 CD O
different JJ O
versions NNS O
of IN O
the DT O
Trojan NNP O
released VBD O
within IN O
the DT O
last JJ O
5 CD O
months NNS O
( ( O
June NNP O
- : O
November NNP O
2019 CD O
) ) O
. . O

What WP O
makes VBZ O
Ginp NNP B-Malware
stand VB O
out RP O
is VBZ O
that IN O
it PRP O
was VBD O
built VBN O
from IN O
scratch NN O
being VBG O
expanded VBN O
through IN O
regular JJ O
updates NNS O
, , O
the DT O
last JJ O
of IN O
which WDT O
including VBG O
code NN O
copied VBD O
from IN O
the DT O
infamous JJ O
Anubis NNP B-Malware
banking NN O
Trojan NNP O
, , O
indicating VBG O
that IN O
its PRP$ O
author NN O
is VBZ O
cherry-picking VBG O
the DT O
most RBS O
relevant JJ O
functionality NN O
for IN O
its PRP$ O
malware NN O
. . O

In IN O
addition NN O
, , O
its PRP$ O
original JJ O
target NN O
list NN O
is VBZ O
extremely RB O
narrow JJ O
and CC O
seems VBZ O
to TO O
be VB O
focused VBN O
on IN O
Spanish JJ O
banks NNS O
. . O

Last JJ O
but CC O
not RB O
least JJS O
, , O
all DT O
the DT O
overlay NN O
screens NNS O
( ( O
injects NNS O
) ) O
for IN O
the DT O
banks NNS O
include VBP O
two CD O
steps NNS O
; : O
first RB O
stealing VBG O
the DT O
victim NN O
’ NNP O
s VBZ O
login NN O
credentials NNS O
, , O
then RB O
their PRP$ O
credit NN O
card NN O
details NNS O
. . O

Although IN O
multi-step JJ O
overlays NNS O
are VBP O
not RB O
something NN O
new JJ O
, , O
their PRP$ O
usage NN O
is VBZ O
generally RB O
limited VBN O
to TO O
avoid VB O
raising VBG O
suspicion NN O
. . O

Evolution NN O
The DT O
initial JJ O
version NN O
of IN O
the DT O
malware NN O
dates VBZ O
back RB O
to TO O
early JJ O
June NNP O
2019 CD O
, , O
masquerading VBG O
as IN O
a DT O
“ NN O
Google NNP B-System
Play NNP I-System
Verificator NNP I-System
” NNP O
app NN O
. . O

At IN O
that DT O
time NN O
, , O
Ginp NNP B-Malware
was VBD O
a DT O
simple JJ O
SMS NNP O
stealer NN O
whose WP$ O
purpose NN O
was VBD O
only RB O
to TO O
send VB O
a DT O
copy NN O
of IN O
incoming NN O
and CC O
outgoing VBG O
SMS NNP O
messages NNS O
to TO O
the DT O
C2 NNP O
server NN O
. . O

A DT O
couple NN O
of IN O
months NNS O
later RB O
, , O
in IN O
August NNP O
2019 CD O
, , O
a DT O
new JJ O
version NN O
was VBD O
released VBN O
with IN O
additional JJ O
banking-specific NN O
features NNS O
. . O

This DT O
and CC O
following VBG O
versions NNS O
were VBD O
masquerading VBG O
as IN O
fake JJ O
“ NNP O
Adobe NNP B-System
Flash NNP I-System
Player NNP I-System
” NNP O
apps NN O
. . O

The DT O
malware NN O
was VBD O
able JJ O
to TO O
perform VB O
overlay NN O
attacks NNS O
and CC O
become VB O
the DT O
default NN O
SMS NNP O
app VBZ O
through IN O
the DT O
abuse NN O
of IN O
the DT O
Accessibility NNP O
Service NNP O
. . O

The DT O
overlay NN O
consisted VBD O
of IN O
a DT O
generic JJ O
credit NN O
card NN O
grabber NN O
targeting VBG O
social JJ O
and CC O
utility NN O
apps RB O
, , O
such JJ O
as IN O
Google NNP B-System
Play NNP I-System
, , O
Facebook NNP B-System
, , O
WhatsApp NNP B-System
, , O
Chrome NNP B-System
, , O
Skype NNP B-System
, , O
Instagram NNP B-System
and CC O
Twitter NNP B-System
. . O

Although IN O
early JJ O
versions NNS O
had VBD O
some DT O
basic JJ O
code NN O
and CC O
string NN O
obfuscation NN O
, , O
protection NN O
of IN O
the DT O
third JJ O
version NN O
of IN O
the DT O
malware NN O
was VBD O
enhanced VBN O
with IN O
the DT O
use NN O
of IN O
payload NN O
obfuscation NN O
. . O

The DT O
capabilities NNS O
remained VBD O
unchanged JJ O
, , O
but CC O
a DT O
new JJ O
endpoint NN O
was VBD O
added VBN O
to TO O
the DT O
Trojan NNP O
C2 NNP O
allowing VBG O
it PRP O
to TO O
handle VB O
the DT O
generic JJ O
card NN O
grabber NN O
overlay NN O
and CC O
specific JJ O
target NN O
overlays NNS O
( ( O
banking VBG O
apps NN O
) ) O
separately RB O
. . O

In IN O
addition NN O
, , O
the DT O
credit NN O
card NN O
grabber NNP O
target NN O
list NN O
was VBD O
expanded VBN O
with IN O
Snapchat NNP B-System
and CC O
Viber NNP B-System
. . O

In IN O
the DT O
third JJ O
version NN O
spotted VBD O
in IN O
the DT O
wild NN O
, , O
the DT O
author NN O
introduced VBD O
parts NNS O
of IN O
the DT O
source NN O
code NN O
of IN O
the DT O
infamous JJ O
Anubis NNP B-Malware
Trojan NNP O
( ( O
which WDT O
was VBD O
leaked VBN O
earlier RBR O
in IN O
2019 CD O
) ) O
. . O

This DT O
change NN O
came VBD O
hand NN O
in IN O
hand NN O
with IN O
a DT O
new JJ O
overlay NN O
target NN O
list NN O
, , O
no RB O
longer RBR O
targeting VBG O
social JJ O
apps NN O
, , O
but CC O
focusing VBG O
on IN O
banking NN O
instead RB O
. . O

A DT O
remarkable JJ O
fact NN O
is VBZ O
that IN O
all PDT O
the DT O
targeted VBN O
apps NN O
relate NN O
to TO O
Spanish JJ O
banks NNS O
, , O
including VBG O
targets NNS O
never RB O
seen VBN O
before IN O
in IN O
any DT O
other JJ O
Android NNP B-System
banking NN O
Trojan NNP O
. . O

The DT O
24 CD O
target NN O
apps NN O
belong NN O
to TO O
7 CD O
different JJ O
Spanish JJ O
banks NNS O
: : O
Caixa NNP B-System
bank NN I-System
, , O
Bankinter NNP B-System
, , O
Bankia NNP B-System
, , O
BBVA NNP B-System
, , O
EVO NNP B-System
Banco NNP I-System
, , O
Kutxabank NNP B-System
and CC O
Santander NNP B-System
. . O

The DT O
specific JJ O
apps NN O
can MD O
be VB O
found VBN O
in IN O
the DT O
target NN O
list NN O
in IN O
the DT O
appendix NN O
. . O

The DT O
most RBS O
recent JJ O
version NN O
of IN O
Ginp NNP B-Malware
( ( O
at IN O
the DT O
time NN O
of IN O
writing VBG O
) ) O
was VBD O
detected VBN O
at IN O
the DT O
end NN O
of IN O
November NNP O
2019 CD O
. . O

This DT O
version NN O
has VBZ O
some DT O
small JJ O
modifications NNS O
which WDT O
seems VBZ O
to TO O
be VB O
unused JJ O
, , O
as IN O
the DT O
malware NN O
behaviour NN O
is VBZ O
the DT O
same JJ O
as IN O
the DT O
previous JJ O
version NN O
. . O

The DT O
author NN O
has VBZ O
introduced VBN O
the DT O
capability NN O
to TO O
grant VB O
the DT O
app NN O
the DT O
device NN O
admin NN O
permission NN O
. . O

Additionally RB O
new JJ O
endpoint NN O
was VBD O
added VBN O
that IN O
seems VBZ O
related VBN O
to TO O
downloading VBG O
a DT O
module NN O
for IN O
the DT O
malware NN O
, , O
probably RB O
with IN O
new JJ O
features NNS O
or CC O
configuration NN O
. . O

How WRB O
it PRP O
works VBZ O
When WRB O
the DT O
malware NN O
is VBZ O
first RB O
started VBN O
on IN O
the DT O
device NN O
it PRP O
will MD O
begin VB O
by IN O
removing VBG O
its PRP$ O
icon NN O
from IN O
the DT O
app NN O
drawer NN O
, , O
hiding VBG O
from IN O
the DT O
end NN O
user NN O
. . O

In IN O
the DT O
second JJ O
step NN O
it PRP O
asks VBZ O
the DT O
victim NN O
for IN O
the DT O
Accessibility NNP O
Service NNP O
privilege NN O
as IN O
visible JJ O
in IN O
following VBG O
screenshot NN O
: : O
Ginp NNP B-Malware
Accessibility NNP O
request NN O
Once IN O
the DT O
user NN O
grants VBZ O
the DT O
requested JJ O
Accessibility NNP O
Service NNP O
privilege NN O
, , O
Ginp NNP B-Malware
starts VBZ O
by IN O
granting VBG O
itself PRP O
additional JJ O
permissions NNS O
, , O
such JJ O
as IN O
( ( O
dynamic JJ O
) ) O
permissions NNS O
required VBN O
in IN O
order NN O
to TO O
be VB O
able JJ O
to TO O
send VB O
messages NNS O
and CC O
make VB O
calls NNS O
, , O
without IN O
requiring VBG O
any DT O
further JJ O
action NN O
from IN O
the DT O
victim NN O
. . O

When WRB O
done VBN O
, , O
the DT O
bot NN O
is VBZ O
functional JJ O
and CC O
ready JJ O
to TO O
receive VB O
commands NNS O
and CC O
perform VB O
overlay NN O
attacks NNS O
. . O

The DT O
commands NNS O
supported VBN O
by IN O
the DT O
most RBS O
recent JJ O
version NN O
of IN O
the DT O
bot NN O
are VBP O
listed VBN O
below IN O
. . O

As IN O
can MD O
be VB O
observed VBN O
, , O
the DT O
possibilities NNS O
offered VBN O
by IN O
the DT O
bot NN O
are VBP O
pretty JJ O
common JJ O
. . O

Command NNP O
Description NNP O
SEND_SMS NNP O
Send NNP O
an DT O
SMS NNP O
from IN O
the DT O
bot NN O
to TO O
a DT O
specific JJ O
number NN O
NEW_URL NNP O
Update NNP O
the DT O
C2 NNP O
URL NNP O
KILL NNP O
Disable NNP O
the DT O
bot NN O
PING_DELAY NNP O
Update NNP O
interval NN O
between IN O
each DT O
ping VBG O
request NN O
CLEAN_IGNORE_PKG NNP O
Empty NNP O
list NN O
of IN O
overlayed JJ O
apps NN O
WRITE_INJECTS NNP O
Update NNP O
target NN O
list NN O
READ_INJECTS NNP O
Get NNP O
current JJ O
target NN O
list NN O
START_ADMIN NNP O
Request NNP O
Device NNP O
Admin NNP O
privileges VBZ O
ALL_SMS NNP O
Get NNP O
all DT O
SMS NNP O
messages NNS O
DISABLE_ACCESSIBILITY NNP O
Stop NNP O
preventing VBG O
user NN O
from IN O
disabling VBG O
the DT O
accessibility NN O
service NN O
ENABLE_ACCESSIBILITY NNP O
Prevent NNP O
user NN O
from IN O
disabling VBG O

the DT O
accessibility NN O
service NN O
ENABLE_HIDDEN_SMS NNP O
Set NNP O
malware NN O
as IN O
default NN O
SMS NNP O
app NN O
DISABLE_HIDDEN_SMS NNP O
Remove NNP O
malware NN O
as IN O
default NN O
SMS NNP O
app NN O
ENABLE_EXTENDED_INJECT NNP O
Enable NNP O
overlay NN O
attacks NNS O
DISABLE_EXTENDED_INJECT NNP O
Disable NNP O
overlay NN O
attacks NNS O
ENABLE_CC_GRABBER NNP O
Enable NNP O
the DT O
Google NNP B-System
Play NNP I-System
overlay VBD O
DISABLE_CC_GRABBER NNP O
Disable NNP O
the DT O
Google NNP B-System
Play NNP I-System
overlay MD O
START_DEBUG NNP O
Enable NNP O
debugging VBG O
GET_LOGCAT NNP O
Get NNP O
logs NNS O
from IN O
the DT O
device NN O
STOP_DEBUG NNP O
Disable NNP O
debugging VBG O
GET_APPS NNP O

Get NNP O
installed VBD O
applications NNS O
GET_CONTACTS NNP O
Get NNP O
contacts VBZ O
SEND_BULK_SMS NNP O
Send NNP O
SMS NNP O
to TO O
multiple VB O
numbers NNS O
UPDATE_APK NNP O
Not RB O
implemented VBD O
INJECT_PACKAGE NNP O
Add NNP O
new JJ O
overlay NN O
target NN O
CALL_FORWARD NNP O
Enable/disable NNP O
call NN O
forwarding NN O
START_PERMISSIONS NNP O
Starts NNP O
request NN O
for IN O
additional JJ O
permissions NNS O
( ( O
Accessibility NNP O
privileges VBZ O
, , O
battery NN O
optimizations NNS O
bypass NN O
, , O
dynamic JJ O
permissions NNS O
) ) O
Features VBZ O
The DT O
most RBS O
recent JJ O
version NN O
of IN O
Ginp NNP O
has VBZ O
the DT O
same JJ O
capabilities NNS O
as IN O
most JJS O
other JJ O
Android NNP B-System
banking NN O
Trojans NNPS O
, , O
such JJ O
as IN O
the DT O
use NN O
of IN O
overlay NN O
attacks NNS O
, , O
SMS NNP O
control NN O
and CC O
contact NN O

list NN O
harvesting NN O
. . O

Overall JJ O
, , O
it PRP O
has VBZ O
a DT O
fairly RB O
common JJ O
feature NN O
list NN O
, , O
but CC O
it PRP O
is VBZ O
expected VBN O
to TO O
expand VB O
in IN O
future JJ O
updates NNS O
. . O

Since IN O
Ginp NNP O
is VBZ O
already RB O
using VBG O
some DT O
code NN O
from IN O
the DT O
Anubis NNP B-Malware
Trojan NNP O
, , O
it PRP O
is VBZ O
quite RB O
likely JJ O
that IN O
other JJ O
, , O
more RBR O
advanced JJ O
features NNS O
from IN O
Anubis NNP B-System
or CC O
other JJ O
malware NN O
, , O
such JJ O
as IN O
a DT O
back-connect JJ O
proxy NN O
, , O
screen-streaming JJ O
and CC O
RAT NNP O
will MD O
also RB O
be VB O
added VBN O
in IN O
the DT O
future NN O
. . O

Ginp NNP B-Malware
embeds VBZ O
the DT O
following JJ O
set NN O
of IN O
features NNS O
, , O
allowing VBG O
it PRP O
to TO O
remain VB O
under IN O
the DT O
radar NN O
and CC O
successfully RB O
perform JJ O
attacks NNS O
: : O
Overlaying NN O
: : O
Dynamic NNP O
( ( O
local JJ O
overlays NNS O
obtained VBN O
from IN O
the DT O
C2 NNP O
) ) O
SMS NNP O
harvesting NN O
: : O
SMS NNP O
listing VBG O
SMS NNP O
harvesting NN O
: : O
SMS NNP O
forwarding VBG O
Contact NNP O
list NN O
collection NN O
Application NNP O
listing VBG O
Overlaying VBG O
: : O
Targets NNS O
list VBP O
update JJ O
SMS NNP O
: : O
Sending VBG O
Calls NNS O
: : O
Call VB O
forwarding VBG O
C2 NNP O
Resilience NN O
: : O
Auxiliary JJ O
C2 NNP O
list NN O
Self-protection NN O
: : O
Hiding VBG O
the DT O
App NNP O
icon JJ O
Self-protection NN O
: : O
Preventing VBG O
removal JJ O
Self-protection NN O
: : O
Emulation-detection NN O
Update NN O

10/03/2020 CD O
At IN O
the DT O
end NN O
of IN O
February NNP O
the DT O
actors NNS O
behind IN O
Ginp NNP B-Malware
added VBD O
screen JJ O
capture NN O
capabilities NNS O
to TO O
their PRP$ O
Trojan NNP O
. . O

Like IN O
previously RB O
added VBN O
functionality NN O
, , O
the DT O
code NN O
is VBZ O
borrowed VBN O
from IN O
the DT O
leaked JJ O
Anubis NNP B-Malware
Trojan NNP O
source NN O
code NN O
. . O

It PRP O
enables VBZ O
the DT O
bot NN O
to TO O
stream VB O
screenshots NNS O
and CC O
send VB O
them PRP O
to TO O
the DT O
C2 NNP O
so IN O
that IN O
actors NNS O
can MD O
see VB O
what WP O
is VBZ O
happening VBG O
on IN O
the DT O
screen NN O
of IN O
the DT O
infected JJ O
device NN O
. . O

Overlay NNP O
attack NN O
Ginp NNP O
uses VBZ O
the DT O
Accessibility NNP O
Service NNP O
to TO O
check VB O
which WDT O
application NN O
runs VBZ O
is VBZ O
the DT O
foreground NN O
. . O

If IN O
the DT O
package NN O
name NN O
of IN O
the DT O
foreground NN O
app NN O
is VBZ O
included VBN O
in IN O
the DT O
target NN O
list NN O
, , O
an DT O
overlay NN O
is VBZ O
shown VBN O
. . O

The DT O
WebView-based JJ O
overlay NN O
is VBZ O
loading VBG O
an DT O
HTML NNP O
page NN O
provided VBN O
by IN O
the DT O
C2 NNP O
in IN O
response NN O
to TO O
the DT O
package NN O
name NN O
provided VBN O
by IN O
the DT O
bot NN O
. . O

Something VBG O
that DT O
makes VBZ O
Ginp NNP B-Malware
special JJ O
is VBZ O
that IN O
all DT O
of IN O
its PRP$ O
overlay NN O
screens NNS O
for IN O
banking NN O
apps NNS O
are VBP O
consist JJ O
of IN O
multiple JJ O
steps NNS O
, , O
first RB O
stealing VBG O
the DT O
victim NN O
’ NNP O
s VBZ O
login NN O
credentials NNS O
, , O
then RB O
stealing VBG O
the DT O
credit NN O
card NN O
details NNS O
( ( O
to TO O
“ VB O
validate NN O
” IN O
the DT O
user NN O
identity NN O
) ) O
, , O
as IN O
shown VBN O
in IN O
the DT O
screenshots NNS O
hereafter NN O
: : O
The DT O
following JJ O
code NN O
snippet NN O
shows NNS O
that WDT O
after IN O
the DT O
second JJ O
overlay NN O
is VBZ O
filled-in JJ O
and CC O
validated JJ O
, , O
it PRP O
disappears VBZ O
and CC O
the DT O
targeted JJ O
application NN O
is VBZ O
added VBN O
to TO O
the DT O
list NN O
of IN O
packages NNS O
names NNS O
to TO O
be VB O
ignored VBN O
for IN O
future JJ O
overlays NNS O
attacks NNS O
. . O

Targets NNS O
The DT O
initial JJ O
version NN O
of IN O
Ginp NNP B-Malware
had VBD O
a DT O
generic JJ O
credit NN O
card NN O
grabber VBP O
overlay NN O
screen NN O
used VBN O
for IN O
all DT O
targeted JJ O
applications NNS O
. . O

Still RB O
included VBN O
in IN O
the DT O
last JJ O
versions NNS O
, , O
this DT O
screen NN O
is VBZ O
only RB O
used VBN O
to TO O
overlay VB O
the DT O
official JJ O
Google NNP B-System
Play NNP I-System
Store NNP I-System
app NN O
. . O

More RBR O
apps NNS O
could MD O
be VB O
added VBN O
to TO O
the DT O
grabber NN O
target NN O
list NN O
in IN O
the DT O
future NN O
, , O
such JJ O
as IN O
the DT O
ones NNS O
that WDT O
were VBD O
targeted VBN O
in IN O
older JJR O
versions NNS O
: : O
Facebook NNP B-System
WhatsApp NNP B-System
Skype NNP B-System
Twitter NNP B-System
Chrome NNP B-System
Instagram NNP B-System
Snapchat NNP B-System
Viber NNP B-System
The DT O
following JJ O
screenshot NN O
shows VBZ O
the DT O
generic JJ O
card NN O
grabber NN O
overlay NN O
screen NN O
: : O
Ginp NNP B-Malware
generic JJ O
grabber VBP O
The DT O
current JJ O
active JJ O
target NN O
list NN O
is VBZ O
available JJ O
in IN O
the DT O
appendix NN O
, , O
containing VBG O
a DT O
total NN O
of IN O
24 CD O
unique JJ O
targets NNS O
. . O

The DT O
following JJ O
screenshots NNS O
show VBP O
what WP O
type NN O
of IN O
information NN O
is VBZ O
collected VBN O
in IN O
both DT O
steps NNS O
of IN O
the DT O
overlay NN O
attack NN O
: : O
Ginp NNP B-Malware
overlaysGinp MD O
overlaysGinp VB O
overlaysGinp NN O
overlays NNS O
Based VBN O
on IN O
Anubis NNP B-Malware
Once NNP O
the DT O
Anubis NNP B-Malware
bot NN O
code NN O
got VBD O
leaked VBN O
, , O
it PRP O
was VBD O
just RB O
a DT O
matter NN O
of IN O
time NN O
before IN O
new JJ O
banking NN O
Trojans NNS O
based VBN O
on IN O
Anubis NNP B-Malware
would MD O
surface VB O
. . O

When WRB O
analyzing VBG O
the DT O
Ginp NNP B-Malware
’ NNP O
s VBD O
recent JJ O
samples NNS O
, , O
ThreatFabric NNP B-System
analysts NNS O
found VBD O
some DT O
similarities NNS O
with IN O
the DT O
famous JJ O
Android NNP O
banking NN O
Trojan NNP O
. . O

Based VBN O
on IN O
the DT O
evolution NN O
of IN O
Ginp NNP B-Malware
it PRP O
is VBZ O
clear JJ O
that IN O
it PRP O
isn VBZ O
’ NNP O
t NN O
based VBN O
on IN O
Anubis NNP B-Malware
, , O
but CC O
rather RB O
reuses VBZ O
some DT O
of IN O
its PRP$ O
code NN O
. . O

Below NNP O
are VBP O
some DT O
of IN O
the DT O
elements NNS O
showing VBG O
the DT O
relation NN O
. . O

The DT O
names NNS O
used VBN O
for IN O
Android JJ B-System
components NNS O
are VBP O
similar JJ O
: : O
Similarities NNS O
with IN O
AnubisSimilarities NNS O
with IN O
Anubis NNP B-Malware
When WRB O
analyzing VBG O
these DT O
components NNS O
, , O
similarities NNS O
were VBD O
found VBN O
in IN O
the DT O
code NN O
of IN O
both DT O
malware JJ O
families NNS O
: : O
Similarities NNS O
with IN O
Anubis NNP B-System
Another DT O
major JJ O
change NN O
that WDT O
indicated VBD O
that IN O
the DT O
actor NN O
copied VBD O
code NN O
from IN O
the DT O
Anubis NNP B-Malware
Trojan NNP O
is VBZ O
the DT O
way NN O
of IN O
handling VBG O
configuration NN O
values NNS O
. . O

Previous JJ O
versions NNS O
were VBD O
storing VBG O
config NN O
values NNS O
within IN O
the DT O
variables NNS O
of IN O
a DT O
class NN O
, , O
while IN O
the DT O
latest JJS O
version NN O
is VBZ O
using VBG O
SharedPreferences NNS O
with IN O
some DT O
of IN O
the DT O
keys NNS O
being VBG O
identical JJ O
to TO O
those DT O
used VBN O
by IN O
Anubis NNP B-System
: : O
isAccessibility NN O
time_work NN O
time_start_permission NN O
url_inj JJ O
Conclusion NNP O
Ginp NNP B-Malware
is VBZ O
a DT O
simple JJ O
but CC O
rather RB O
efficient JJ O
banking NN O
Trojan NNP O
providing VBG O
the DT O
basic JJ O
functionality NN O
to TO O
be VB O
able JJ O
to TO O
trick VB O
victims NNS O
into IN O
delivering VBG O
personal JJ O
information NN O
. . O

In IN O
a DT O
5-month JJ O
timespan NN O
, , O
actor NN O
managed VBD O
to TO O
create VB O
a DT O
Trojan NNP O
from IN O
scratch NN O
which WDT O
will MD O
presumably RB O
continue VB O
evolving VBG O
offering VBG O
new JJ O
features NNS O
such JJ O
as IN O
keylogging NN O
, , O
back-connect JJ O
proxy NN O
or CC O
RAT NNP O
capabilities NNS O
. . O

Ginp NNP B-Malware
’ NNP O
s VBD O
unusual JJ O
target NN O
selection NN O
is VBZ O
not RB O
just RB O
about IN O
its PRP$ O
focus NN O
on IN O
Spanish JJ O
banks NNS O
but CC O
also RB O
the DT O
wide JJ O
selection NN O
of IN O
targeted JJ O
apps NNS O
per IN O
bank NN O
. . O

The DT O
fact NN O
that IN O
the DT O
overlay NN O
screens NNS O
are VBP O
almost RB O
identical JJ O
to TO O
the DT O
legitimate JJ O
banking NN O
apps NN O
suggests VBZ O
that IN O
the DT O
actors NNS O
might MD O
be VB O
very RB O
familiar JJ O
with IN O
the DT O
Spanish JJ O
banking NN O
applications NNS O
and CC O
might MD O
even RB O
be VB O
accustomed VBN O
to TO O
the DT O
language NN O
. . O

Although IN O
the DT O
current JJ O
target NN O
list NN O
is VBZ O
limited VBN O
to TO O
Spanish VB O
apps NN O
, , O
it PRP O
seems VBZ O
that IN O
the DT O
actor NN O
is VBZ O
taking VBG O
into IN O
account NN O
that IN O
the DT O
bot NN O
should MD O
also RB O
be VB O
able JJ O
to TO O
target VB O
other JJ O
countries NNS O
, , O
seeing VBG O
that IN O
the DT O
path NN O
used VBN O
in IN O
the DT O
inject NN O
requests VBZ O
contains VBZ O
the DT O
country NN O
code NN O
of IN O
the DT O
targeted JJ O
institution NN O
. . O

This DT O
could MD O
indicate VB O
that DT O
actor NN O
already RB O
has VBZ O
plans NNS O
in IN O
expanding VBG O
the DT O
targets NNS O
to TO O
applications NNS O
from IN O
different JJ O
countries NNS O
and CC O
regions NNS O
. . O

Appendix NNP O
Samples NNP O
Some DT O
of IN O
the DT O
latest JJS O
Ginp NN B-Malware
samples NNS O
found VBN O
in IN O
the DT O
wild NN O
: : O
App NNP O
name NN O
Package NNP O
name NN O
SHA-256 NNP O
hash NN O
Google NNP B-System
Play NNP I-System
Verificator NNP I-System
sing.guide.false VBD B-Indicator
0ee075219a2dfde018f17561467272633821d19420c08cba14322cc3b93bb5d5 CD B-Indicator
Google NNP B-System
Play NNP I-System
Verificator NNP I-System
park.rather.dance NN B-System
087a3beea46f3d45649b7506073ef51c784036629ca78601a4593759b253d1b7 CD B-Indicator
Adobe NNP B-System
Flash NNP I-System
Player NNP I-System
ethics.unknown.during VBG B-Indicator

5ac6901b232c629bc246227b783867a0122f62f9e087ceb86d83d991e92dba2f CD B-Indicator
Adobe NNP B-System
Flash NNP I-System
Player NNP I-System
solution.rail.forward VBD B-Indicator
7eb239cc86e80e6e1866e2b3a132b5af94a13d0d24f92068a6d2e66cfe5c2cea CD B-Indicator
Adobe NNP B-System
Flash NNP I-System
Player NNP I-System
com.pubhny.hekzhgjty VBD B-Indicator
14a1b1dce69b742f7e258805594f07e0c5148b6963c12a8429d6e15ace3a503c CD B-Indicator

Adobe NNP B-System
Flash NNP I-System
Player NNP I-System
sentence.fancy.humble JJ B-Indicator
78557094dbabecdc17fb0edb4e3a94bae184e97b1b92801e4f8eb0f0626d6212 CD B-Indicator
Target NNP O
list NN O
The DT O
current JJ O
list NN O
of IN O
apps NN O
observed VBN O
to TO O
be VB O
targeted VBN O
by IN O
Ginp NNP B-Malware
contains VBZ O
a DT O
total NN O
of IN O
24 CD O
unique JJ O
applications NNS O
as IN O
seen VBN O
below IN O
. . O

This DT O
list NN O
is VBZ O
expected VBN O
to TO O
grow VB O
in IN O
the DT O
future NN O
. . O

